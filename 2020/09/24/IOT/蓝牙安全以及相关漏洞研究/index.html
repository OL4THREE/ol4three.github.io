<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>蓝牙安全以及相关漏洞研究 - ol4three</title><meta description="放大佬总结的一张图：  蓝牙是一种无线通信标准，工作在2.4～2.485Ghz的ISM频段，主要用于短距离的数据连接，可以建立所谓的PAN(Personal Area Network)网络。蓝牙设备最常见的应用是各种以手机和电脑为中心的外围设备，例如与手机配合使用的蓝牙耳机、手机与汽车音响的互联、蓝牙键盘和鼠标等。 0x00 蓝牙技术简介蓝牙”，即Bluetooth，是斯堪的纳维亚语中 Blåta"><meta property="og:type" content="blog"><meta property="og:title" content="蓝牙安全以及相关漏洞研究"><meta property="og:url" content="http://www.ol4three.com/2020/09/24/IOT/%E8%93%9D%E7%89%99%E5%AE%89%E5%85%A8%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/"><meta property="og:site_name" content="ol4three"><meta property="og:description" content="放大佬总结的一张图：  蓝牙是一种无线通信标准，工作在2.4～2.485Ghz的ISM频段，主要用于短距离的数据连接，可以建立所谓的PAN(Personal Area Network)网络。蓝牙设备最常见的应用是各种以手机和电脑为中心的外围设备，例如与手机配合使用的蓝牙耳机、手机与汽车音响的互联、蓝牙键盘和鼠标等。 0x00 蓝牙技术简介蓝牙”，即Bluetooth，是斯堪的纳维亚语中 Blåta"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/BLE%E5%AE%89%E5%85%A8.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/33981.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34133.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34168.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34183.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/t01fa596689092bd57a.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34506.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34523.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34532.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34544.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34546.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34548.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34568.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34607.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34606.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34640.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34644.jpeg"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34646.jpeg"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34650.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984345-9d153e00-ffa2-11e8-8db0-9a32847bcc14.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984344-9d153e00-ffa2-11e8-877a-7ff3b7963762.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984347-9e466b00-ffa2-11e8-943a-caef7f703349.jpg"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984319-9981b700-ffa2-11e8-9850-dd3b4187f32f.jpg"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984323-9981b700-ffa2-11e8-8e99-1ef51eab3cd2.jpg"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984325-9a1a4d80-ffa2-11e8-8c4b-23c0b851d5da.jpg"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984340-9c7ca780-ffa2-11e8-9f1a-ef9a2fca5d95.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984338-9c7ca780-ffa2-11e8-8c9c-71b47e26f060.jpg"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984339-9c7ca780-ffa2-11e8-9052-bc6aa1aa6bd1.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984348-9e466b00-ffa2-11e8-93ae-59086af28fb8.jpeg"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200928121643528.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200930155140338.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49418350-b6590600-f7bc-11e8-8cea-fbd09c9c318c.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200930161720845.png"><meta property="og:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200930161645370.png"><meta property="article:published_time" content="2020-09-24T09:39:19.000Z"><meta property="article:modified_time" content="2020-12-02T06:40:04.886Z"><meta property="article:author" content="ol4three"><meta property="article:tag" content="BLE"><meta property="article:tag" content="蓝牙"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://oss-map.oss-cn-beijing.aliyuncs.com/img/BLE%E5%AE%89%E5%85%A8.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://www.ol4three.com/2020/09/24/IOT/%E8%93%9D%E7%89%99%E5%AE%89%E5%85%A8%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/"},"headline":"ol4three","image":["https://oss-map.oss-cn-beijing.aliyuncs.com/img/BLE%E5%AE%89%E5%85%A8.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/33981.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34133.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34168.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34183.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/t01fa596689092bd57a.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34506.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34523.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34532.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34544.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34546.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34548.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34568.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34607.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34606.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34640.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/34650.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984345-9d153e00-ffa2-11e8-8db0-9a32847bcc14.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984344-9d153e00-ffa2-11e8-877a-7ff3b7963762.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984347-9e466b00-ffa2-11e8-943a-caef7f703349.jpg","https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984319-9981b700-ffa2-11e8-9850-dd3b4187f32f.jpg","https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984323-9981b700-ffa2-11e8-8e99-1ef51eab3cd2.jpg","https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984325-9a1a4d80-ffa2-11e8-8c4b-23c0b851d5da.jpg","https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984340-9c7ca780-ffa2-11e8-9f1a-ef9a2fca5d95.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984338-9c7ca780-ffa2-11e8-8c9c-71b47e26f060.jpg","https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984339-9c7ca780-ffa2-11e8-9052-bc6aa1aa6bd1.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200928121643528.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200930155140338.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/49418350-b6590600-f7bc-11e8-8cea-fbd09c9c318c.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200930161720845.png","https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200930161645370.png"],"datePublished":"2020-09-24T09:39:19.000Z","dateModified":"2020-12-02T06:40:04.886Z","author":{"@type":"Person","name":"ol4three"},"description":"放大佬总结的一张图：  蓝牙是一种无线通信标准，工作在2.4～2.485Ghz的ISM频段，主要用于短距离的数据连接，可以建立所谓的PAN(Personal Area Network)网络。蓝牙设备最常见的应用是各种以手机和电脑为中心的外围设备，例如与手机配合使用的蓝牙耳机、手机与汽车音响的互联、蓝牙键盘和鼠标等。 0x00 蓝牙技术简介蓝牙”，即Bluetooth，是斯堪的纳维亚语中 Blåta"}</script><link rel="canonical" href="http://www.ol4three.com/2020/09/24/IOT/%E8%93%9D%E7%89%99%E5%AE%89%E5%85%A8%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/"><link rel="icon" href="/img/logo.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><script data-ad-client="1" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="ol4three" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="ol4three" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/Security%20Incidents">Security Incidents</a><a class="navbar-item" href="/Vulnerabilities">Vulnerabilities</a><a class="navbar-item" href="/Read%20Team">Read Team</a><a class="navbar-item" href="/Stop%20learning">Stop learning</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-24T09:39:19.000Z" title="2020-09-24T09:39:19.000Z">2020-09-24</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-02T06:40:04.886Z" title="2020-12-02T06:40:04.886Z">2020-12-02</time></span><span class="level-item"><a class="link-muted" href="/categories/IOT/">IOT</a></span><span class="level-item">an hour read (About 12702 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">蓝牙安全以及相关漏洞研究</h1><div class="content"><p>放大佬总结的一张图：</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/BLE%E5%AE%89%E5%85%A8.png" alt="BLE安全"></p>
<p>蓝牙是一种无线通信标准，工作在2.4～2.485Ghz的ISM频段，主要用于短距离的数据连接，可以建立所谓的PAN(Personal Area Network)网络。蓝牙设备最常见的应用是各种以手机和电脑为中心的外围设备，例如与手机配合使用的蓝牙耳机、手机与汽车音响的互联、蓝牙键盘和鼠标等。</p>
<h2 id="0x00-蓝牙技术简介"><a href="#0x00-蓝牙技术简介" class="headerlink" title="0x00 蓝牙技术简介"></a><strong>0x00 蓝牙技术简介</strong></h2><p>蓝牙”，即Bluetooth，是斯堪的纳维亚语中 Blåtand / Blåtann 的英化版本。该词是十世纪的一位国王Harald Bluetooth的绰号，相传他将纷争不断的丹麦部落统一为一个王国，并引入了基督教。蓝牙技术开发者Jim Kardach于1997年提出用Bluetooth这个名词，据说他当时正在读一本名为The Long Ships的小说，讲述的就是维京人和Harald Bluetooth国王的故事。他认为蓝牙可以把各种不同的通信协议统一在一起，诚如这位国王做的事情一样。至于蓝牙的logo，取自国王Harald Bluetooth名字中的【H】和【B】两个字母的组合，用古北欧文字来表示：</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/33981.png" alt="0"></p>
<p>蓝牙技术最早是1994年由爱立信发明的，最初的目的是用无线连接来代替RS-232线缆连接。目前蓝牙标准由Bluetooth Special Interest Group (SIG) 组织管理。这一组织有超过25000个成员公司，分布在电信、计算机、网络和消费电子领域。</p>
<p>蓝牙工作在2.4～2.485GHz频段，有79个频道，每个频道占据1MHz宽带。因为2.4GHz的ISM频段是非常繁忙的，为了对抗其他系统的干扰，蓝牙采取跳频式的扩频技术，通常1秒钟跳跃1600次。BLE(Bluetooth Low Energy)只有40个频道，每个频道占据2MHz宽带.</p>
<p>蓝牙是一种基于数据包通信的协议，使用主-从式的网络结构。在一个piconet中，1个主节点可以与多达7个从节点通信。所有的设备都共享主节点的时钟。数据包以312.5us的间隔互相交换，这个时间成为clock tick。两个clock tick构成一个625us的时隙，两个时隙构成一个1250us的时隙对。一种比较简单的时隙配置是，主节点在偶数时隙发送数据包，在奇数时隙接受数据包；从节点相反，在偶数时隙接受数据包，在奇数时隙发送数据包。这里讨论的是经典的蓝牙协议，BLE的空中接口协议与经典的蓝牙协议有很大的不同。蓝牙协议还支持多个piconet连接在一起，组成scatternet。在这种情况下，某些设备可以在一个piconet中担任主节点，在离另一个piconet中知识从节点。</p>
<p>蓝牙技术已经发展了很多年，蓝牙规范有很多个版本，从最早的蓝牙1.0到2014年发布的蓝牙4.2。早期的蓝牙标准只能支持几百Kbps的传输速率，而到了蓝牙3.0版本，已经可以支持最高24Mbps的传输速度。蓝牙4.0版本引入了BLE协议，即低功耗蓝牙，其功耗非常低，可以使设备的电池维持很长的时间，因此在很多可穿戴设备中得到了应用。</p>
<p>一文读懂蓝牙技术从 1.0 到 5.0 的前世今生                                  (<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/37725574">https://zhuanlan.zhihu.com/p/37725574</a>)</p>
<h2 id="0x01-蓝牙安全概述"><a href="#0x01-蓝牙安全概述" class="headerlink" title="0x01 蓝牙安全概述"></a><strong>0x01 蓝牙安全概述</strong></h2><p>蓝牙协议有加密和鉴权功能。蓝牙的密钥产生是基于蓝牙的PIN码的。PIN码需要输入到蓝牙设备中，或者出场时就已经写入设备里。在美国国家标准技术研究所官网上有一份蓝牙安全指南Guide to Bluetooth Security(<a target="_blank" rel="noopener" href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-172-draft.pdf)中介绍了如何安全的使用蓝牙技术。使用蓝牙技术非常简单、易用、但是也有明显的缺点，容易被拒绝服务攻击、窃听、中间人攻击、数据篡改、占用资源。所有在选用蓝牙技术时，必须充分评估能否接受这样的风险。这份指南同时也给出了一些知道，在创建和维护一个蓝牙系统时，如何去降低他的安全风险。">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-172-draft.pdf)中介绍了如何安全的使用蓝牙技术。使用蓝牙技术非常简单、易用、但是也有明显的缺点，容易被拒绝服务攻击、窃听、中间人攻击、数据篡改、占用资源。所有在选用蓝牙技术时，必须充分评估能否接受这样的风险。这份指南同时也给出了一些知道，在创建和维护一个蓝牙系统时，如何去降低他的安全风险。</a></p>
<p>2001年，内尔实验室的Jakobsson和Wetzel发现了蓝牙配对协议中的缺陷，以及加密方法中的漏洞。2003年，A.L.Digital公司的两位研究人员Ben和Adam Laurie发现，在一些蓝牙产品中有严重的漏洞，能够导致个人隐私数据的泄漏。于是，接下来就出现了一种利用这种BlueBug攻击手法，开始展现出这一漏洞的危害性</p>
<p>2004年，第一个所谓的蓝牙病毒出现，它可以在Symbian操作系统的手机中传播。这个”病毒”是一个名叫”29A”的团队编写的PoC程序，写出来之后就交给了反病毒机构，因此它具有威胁性，但并没有真正的传播过。2004年8月，一项实验创纪录地把蓝牙连接的距离增加到了1.79公里，在实验中使用了方向性天线和功率放大器。这就增加了蓝牙病毒的危险性，使得它能够威胁到距离非常远的蓝牙设备</p>
<p>2005年1月，出现了一种名为”Lasco.A”的手机蠕虫病毒，也是针对Symbian手机的。用户一旦通过蓝牙接收这个病毒文件，病毒就会自动地安装在系统中，然后开始寻找周围其他的蓝牙设备去感染。另外这种病毒还能感染系统中的其他SIS文件。最终的后果是导致手机系统不稳定。</p>
<p>2005 年4月，剑桥大学的安全研究人员公布了他们发现的一种被动式攻击方式， 能够攻击基于PIN码的配对协议。这种攻击方式操作起来非常快，证实了蓝牙的对称密钥的建立方法是有缺陷的。为了抵御这种攻击，研究人员提出了-种更强的非对称密钥加密方法。</p>
<p>2005年6月，Yaniv Shaked和Avishai Wool发表了一篇论文，提出了被动式和主动式两种攻击方式，可以获得PIN码。在被动式攻击中，攻击者在蓝牙设备初始配对的时刻就能窃听到通信的内容:而主动式攻击则需要在某个特定的时刻发出一-种特殊构造的数据包，使主节点和从节点重复配对过程，之后就可以使用被动式攻击在配对过程中侦听密钥了。这种攻击的主要弱点在于，它需要受到攻击的用户在攻击期间重新输入PIN码，此时设备会有提示。另外，这种攻击还需要一些特别的设备在恰当的时刻发出一种特殊构造的数据包，现成的蓝牙芯片是不.能做到这一- 点的。</p>
<p>蓝牙地址还可以用于追踪设备的位置。2005 年8月，英格兰剑桥郡的警方发出警示说，有些小偷利用蓝牙来探查车内是否有被遗忘的手机或电脑等设备，提示人们在不使用蓝牙功能时尽量关闭它。</p>
<p>2006年4月，来自Secure Network和F-Secure的研究人员发布了一份报告，警告有大量留在“可见”状态的设备，还报告了各种蓝牙服务的普及程度，以及与蓝牙蠕虫传播的危险性有关的统计数据。</p>
<p>2007年10月，在卢森堡的Hack.lu Security会议上，Kevin Finistere和Thiery Zoller演示了通过蓝牙远程rootMacOSXv10.3.9和v10.4系统，还演示了一个蓝牙PIN码和Linkeys破解器。</p>
<p>维基百科.上介绍的以上这些蓝牙安全的案例都至少是9年以前的事情了。那么近些年来，在蓝牙安全领域又有什么攻击方式</p>
<h2 id="0x02-BLE工作流程"><a href="#0x02-BLE工作流程" class="headerlink" title="0x02 BLE工作流程"></a><strong>0x02 BLE工作流程</strong></h2><h3 id="1-工作流程"><a href="#1-工作流程" class="headerlink" title="1.工作流程"></a><strong>1.工作流程</strong></h3><p>BLE低功耗蓝牙适用于短距离无线通信，正常与形式传输距离为10m(低功耗模式下为100m)，频段2.4Ghz。先进行三个蓝牙术语介绍：</p>
<ul>
<li>配对：配对是指两个蓝牙设备首次通讯时，互相确认的过程。两个蓝牙设备之间一经配对之后，随后的通讯连接就不必每次都要做确认，非常的方便</li>
<li>PIN：个人识别码，蓝牙适用的PIN码长度为1-8个十进制位(8-128比特)</li>
<li>DB_ADDR：蓝牙设备地址。每个蓝牙收发器被分配了唯一的一个48位的设备地址，类似于PC机网卡的MAC地址。两个蓝牙设备在通讯开始时通过询问的方式获取对方的DB_ADDR地址</li>
</ul>
<p>蓝牙的工作过程为:</p>
<p>​                蓝牙启动 -&gt; 扫描设备 -&gt; 设备配对（未配对的设备） -&gt; 数据传输              </p>
<h3 id="2-设备配对模式"><a href="#2-设备配对模式" class="headerlink" title="2.设备配对模式"></a><strong>2.设备配对模式</strong></h3><ul>
<li>Numeric Comparison：配对双方都显示一个6位数的数字，由用户来核对数字是否一致，一致即可配对。例如手机之前的配对。</li>
<li>Just Works：用于配对没有显示没有输入的设备，主动发起连接即可配对，用户看不到配对过程。例如连接蓝牙耳机。</li>
<li>Passkey Entry：要求配对目标输入一个在本地设备上显示的6位数字，输入正确即可配对。例如连接蓝牙键盘</li>
<li>Out of Band：两设备通过别的途径交换配对信息，例如nfc等。例如一些NFC蓝牙音响</li>
</ul>
<h3 id="3-设备配对过程"><a href="#3-设备配对过程" class="headerlink" title="3.设备配对过程"></a><strong>3.设备配对过程</strong></h3><h4 id="a-PIN码配对"><a href="#a-PIN码配对" class="headerlink" title="a PIN码配对"></a><strong>a PIN码配对</strong></h4><p>在老的蓝牙2.0协议中，配对过程需要输入一个PIN码，长度可以从4到16个数字。（很多设备默认为0000或者1234）</p>
<p>在配对的过程中通过PIN码来生成Linkkey。两个配对后的设备共享一个Linkkey，这个行为叫绑定。绑定之后下次两个设备接近后，用Linkkey进行认证，认证通过后生成EncryptionKey进行session的加密。认证的过程采用challenge-reponse的模式，以claimant and the verifier的方式来验证linkkey。认证完一方之后交换身份，在认证另一方。</p>
<h4 id="b-密钥交换配对"><a href="#b-密钥交换配对" class="headerlink" title="b 密钥交换配对"></a><strong>b 密钥交换配对</strong></h4><p>后续蓝牙协议配对则通过密钥交换来完成，又分为生成初始密钥(Kinit)、生成链路密钥(Kab)和双方认证三个过程。</p>
<ul>
<li>生成舒适密钥(Kinit)：初始密钥Kinit长度为128位，由E22算法产生。首先提出通信要求的设备成为主设备(Master)，用A表示;被动进行通信的设备称为从设备(Slave),用B表示。E22算法的输入(明文）由以下三部分组成：</li>
</ul>
<ol>
<li>从设备的物理地址：BD_ADDR,在生成Kinit前，主设备通过询问方式获得从设备的地址BD_ADDR。</li>
<li>PIN码及其长度，PIN码是双方设备预先设定的。</li>
<li>有一个128位的随机数(IN_RAND)。由主设备产生，并以明文方式传送给从设备。</li>
</ol>
<p>由于主、从设备使用了相同的E22算法，如果双方设备以上三部分的值都相等，那么各自算出来的Kinit也应该相同。</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34133.png" alt="0"></p>
<ul>
<li>生成链路密钥(Kab)：首先主设备A产生128位的随机数LK_RANDA，从设备B也产生128位的随机数LK_RANDB。在主设备A中，Kinit与LK_RAND进行位比特逻辑异或运算，异或结果发送给B设备；同样的，在B设备中，Kinit和LK_RANDB进行位比特逻辑异或运算，结果发送给A设备。通过这些交换后，A和B设备都具有相同的Kinit、LK_RANDA和LK_RANDAB。设备A和B分别用E21算法将LK_RANDA和LK_RANDB。设备A和B分别用E21算法将LK_RANDA和BD_ADDRA、LK_RANDB和BD_ADDRB加密，并将结果进行异或得到Kab。</li>
</ul>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34168.png" alt="0"></p>
<ul>
<li>双方认证：双向认证采用challenge-response(挑战-应答)方式。主设备A位应答方，从设备B为请求方。作为应答方的A设备产生一个128位的随机数AU_RANDA，并以明文的方式传送至B设备。A、B设备都用E1算法将各自的到的AU_RAND、Kab和BD_ADDRB加密运算分别生成32位的SRESA和SRESB。B设备将结果SRESB传送给A设备，A设备比较SERESA和SERSB，如果两个的值相等，此次认证通过，如果两个的值不想等，则认证不通过。执行完此次认证后，A设备和B设备的角色对换，即A设备作为请求方，B设备作为应答方，采用同样的方式进行认证。</li>
</ul>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34183.png" alt="0"></p>
<h2 id="0x03-BLE常见问题"><a href="#0x03-BLE常见问题" class="headerlink" title="0x03 BLE常见问题"></a><strong>0x03 BLE常见问题</strong></h2><p>蓝牙（bluetooth）同WIF和zigbee等等网络协议一样，因此它的网络协议通信结构和它们大同小异。</p>
<p>因此，它的攻击手段不外乎鉴权攻击、密钥攻击、拒绝服务攻击等等几种手段，只不过随着具体的场景不同，这些攻击手段所赐啊去的具体方法也不同。</p>
<p>在上述的几种攻击方法里，蓝牙的安全问题可以分为两类：第一类是蓝牙协议本存在的问题。例如有攻击工具：Bluenarfing、Bluebugging、Hijacking等。</p>
<h3 id="1-针对蓝牙协议本身的攻击"><a href="#1-针对蓝牙协议本身的攻击" class="headerlink" title="1.针对蓝牙协议本身的攻击"></a><strong>1.针对蓝牙协议本身的攻击</strong></h3><h4 id="a-节点密钥攻击（中间人）"><a href="#a-节点密钥攻击（中间人）" class="headerlink" title="a.节点密钥攻击（中间人）"></a><strong>a.节点密钥攻击（中间人）</strong></h4><p>假设一个设备A和B之前已经通信过，当通信完成之后，A和B是互相知道彼此的链路密钥的。这里解释一下什么叫链路密钥：A和B之间的通信是需要加密的，怎么加密的不管，总之就是需要一个链路密钥这样的一个东西，每次通信的链路密钥是根据蓝牙本身自带生成的，这个链路密钥不是放在协议层生产的，而是蓝牙硬件自身就有的。那么B显然之后A所使用的链路密钥，那么B通过修改自身地址，把自己的地址改为A的地址后，伪装成A和C通信，那么C此时就以为自己和A通信。B也可以伪装成C和A去通信，因为B知道A的链路密钥，B是能够通过A的认证从而和A进行连接 。</p>
<p>这样 A和 C之间并没有进行实质的通信 ，都是B分别伪装和A，C通信。这样就造成了中间人攻击。</p>
<p>这种中间人攻击的主要原因在于蓝牙通信链路密钥在硬件层生产，而且每次认证都相同。</p>
<h4 id="b-针对PIN码攻击"><a href="#b-针对PIN码攻击" class="headerlink" title="b.针对PIN码攻击"></a><strong>b.针对PIN码攻击</strong></h4><p>两个设备之间的链接，在应用层上使用PIN码，4位PIN码破解仅仅需要0.06秒，8位暴力攻击不到两个小时就能破解。</p>
<h4 id="c-中继攻击"><a href="#c-中继攻击" class="headerlink" title="c.中继攻击"></a><strong>c.中继攻击</strong></h4><p>蓝牙设备使用中继以夸大传输距离，几乎所有的中继攻击，中继设备都有可能遭到信息窃取</p>
<h4 id="d-鉴权DOS攻击"><a href="#d-鉴权DOS攻击" class="headerlink" title="d.鉴权DOS攻击"></a><strong>d.鉴权DOS攻击</strong></h4><p>鉴权时的DOS攻击是从上一次鉴权失败到下一次可以发起鉴权期间，第三方通过伪装发起故意使鉴权失败，从而使间隔时间持续上升，知道达到允许的最大值，在此期间双方不能进行正常的鉴权。</p>
<p>还有一种形式的DOS攻击，快速不断的给远程蓝牙发送文件，而远端设备呗大量的是否要接收该文件的命令冲击直到瘫痪。</p>
<h3 id="2-针对蓝牙实现过程发起的攻击"><a href="#2-针对蓝牙实现过程发起的攻击" class="headerlink" title="2.针对蓝牙实现过程发起的攻击"></a><strong>2.针对蓝牙实现过程发起的攻击</strong></h3><h4 id="a-BlueBorne"><a href="#a-BlueBorne" class="headerlink" title="a. BlueBorne"></a><strong>a. BlueBorne</strong></h4><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/t01fa596689092bd57a.png" alt="image"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://armis.com/blueborne/">https://armis.com/blueborne/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.antiy.cn/research/notice&report/research_report/20170918.html">基于蓝牙协议漏洞的BLUEBORNE攻击综合分析报告</a></li>
<li><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/86949">BlueBorne 蓝牙漏洞深入分析与PoC</a></li>
</ul>
<p>是由armis爆出的一系列蓝牙的漏洞，只要手机开启了蓝牙，就可能被远程控制。当然根据上面的分析可以看到通过多种平台的漏洞综合利用，可以完成对大部分支持蓝牙的设备进行攻击。但是在安天的报告里有一句我没懂“不像其它驱动一样，每个操作系统都只有一个蓝牙协议栈，这导致一个漏洞的出现将会影响一系列基于此系统的设备。”其他驱动是啥样？大概的意思就是内核驱动的漏洞吧，不过能看到的是通过这组漏洞可以实现ios，android，linux的rce，以及windows下的中间人攻击。</p>
<h4 id="b-GATT"><a href="#b-GATT" class="headerlink" title="b. GATT"></a><strong>b. GATT</strong></h4><ul>
<li><a target="_blank" rel="noopener" href="https://gattack.io/">https://gattack.io/</a></li>
</ul>
<p>从蓝牙4.0的低功耗蓝牙（BLE）开始到4.2开始支持GATT（Generic Attribute Profile）再到BLE5，蓝牙技术已经瞄准了物联网这个方向。所以很多特性都是针对物联网的情景而生的，比如GATT。GATT中的三个要素Profile、Service、Characteristic以及他们的层级关系。值得注意的是，“Profile”是基于GATT所派生出的真正的Profile，乃SIG蓝牙技术联盟对一些同范畴内的Service打包后的集合，如电池、心率、血压等用于让两个设备进行连接后的通讯。GATT 定义设备之间通过 Service 和 Characteristic 的东西来进行通讯，不同的 Characteristic 代表设备的不同功能。GATT协议可以在蓝牙设备不完成配对的情况下进行访问，因此，通信流量明文传输，如果应用层没有加密或者校验，则可以被轻易地嗅探和伪造数据。</p>
<p>相关paper:</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://gattack.io/whitepaper.pdf">GATTACKING BLUETOOTH SMART DEVICES</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndss-symposium.org/wp-content/uploads/2019/02/ndss2019_06B-4_Xu_paper.pdf">BadBluetooth: Breaking Android Security Mechanisms via Malicious Bluetooth Peripherals</a></li>
</ul>
<h4 id="c-Bluesnarfing"><a href="#c-Bluesnarfing" class="headerlink" title="c.Bluesnarfing"></a><strong>c.Bluesnarfing</strong></h4><p>蓝牙定义了OBEX协议，只鹅个协议的重要目的是实现数据对象的交换。蓝牙早期规范定义了一个基于OBEX的应用，这个应用主要用来实现使用蓝牙来传输一些名片，这个过程并不需要使用鉴权机制，Bluesnarfing就是利用此漏洞连接到手机用户，并且不提示用户已连接。</p>
<p>当不使用蓝牙时，将设备设置成不可发现的模式，或者在通信时将设备设置成为安全模式3来启动链路鉴权，对一些蓝牙设备进行升级可以有效预防此类攻击。</p>
<h4 id="d-Bluebugging"><a href="#d-Bluebugging" class="headerlink" title="d.Bluebugging"></a><strong>d.Bluebugging</strong></h4><p>Bluebugging和Bluesnarfing相似，在事先不通知货提示手机用户的情况下，访问手机命令。</p>
<h4 id="e-Peripheral-Hijacking"><a href="#e-Peripheral-Hijacking" class="headerlink" title="e.Peripheral Hijacking"></a><strong>e.Peripheral Hijacking</strong></h4><p>有些设备尽管没有进入连接模式也会对连接请求进行相应，这类设备通常是一些没有MMI（Man Machine Interface）的设备。例如一些蓝牙耳机会被强制连接，还有一些设备有固定的PIN码，Peripheral Hijacking即是对此类设备进行攻击。</p>
<h4 id="f-Bluejacking"><a href="#f-Bluejacking" class="headerlink" title="f.Bluejacking"></a><strong>f.Bluejacking</strong></h4><p>Bluejacking是指手机用户使用蓝牙无线技术匿名向赴京的蓝牙用户发送名片或不许奥信息的行为。Bluejacking通常会寻找ping的通的手机或者有反应的手机，随后会发送更多的其他个人信息到该设备。现在市场上已经出现了很多Bluejacking软件。可以通过把手机设置成不可发现模式来避免此类攻击。</p>
<h2 id="0x04-信道"><a href="#0x04-信道" class="headerlink" title="0x04 信道"></a><strong>0x04 信道</strong></h2><p>BLE的物理通道即”频道”，分别是‘f=2402+k*2 MKz, k=0 , … ,39’, 宽带为2MHz的40个RF Channel。</p>
<p>其中，有3个信道是advertising channel(广播通道)，分别是37、38、39，用于发现设备(Scanning devices)、初始化连接(initiating a connection)和广播数据(broadcasting date)</p>
<p>剩下的37个信道为data channel(数据通道)，用于两个连接的设备间的通讯。</p>
<h2 id="0x05-BLE数据包格式"><a href="#0x05-BLE数据包格式" class="headerlink" title="0x05 BLE数据包格式"></a><strong>0x05 BLE数据包格式</strong></h2><p>在低功耗蓝牙规范中，分广播报文和数据报文这两种。设备利用广播报文发现、连接其它设备，而在连接建立之后，便开始使用数据报文。无论是广播报文还是数据报文，链路层只使用一中数据包格式，它由”前导码”(preamble)、”访问码”(access code)、”有效载荷”和”循环冗余校验”（Cyclical Redundancy CHeck，CRC）校验码组成。其中，”访问码”有时又称为”访问地址”(access address)</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34506.png" alt="0"></p>
<h3 id="1-Preamble"><a href="#1-Preamble" class="headerlink" title="1.Preamble"></a>1.Preamble</h3><p>1个字节长度，接受中用于频率同步、数据速率同步、自动增益控制调整，固定为                        01010101或者10101010序列</p>
<h3 id="2-Access-Address"><a href="#2-Access-Address" class="headerlink" title="2.Access Address"></a>2.Access Address</h3><p>4个字节长度，广播报文接入地址为：0x8E89BED6,数据报文接入地址为：32bits随机数</p>
<h3 id="3-PDU"><a href="#3-PDU" class="headerlink" title="3.PDU"></a>3.PDU</h3><p>i.广播报文（见嫌疑BLUETOOTH SPECIFICATION Version 4.0 [Vol 6] Part B 2.3）</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34523.png" alt="0"></p>
<p>i. PDU Type: 有效载荷内容的类型，通过这一字段确定改数据包是一个”通告”还是”扫描请求”或”响应”等</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34532.png" alt="0"></p>
<p>ii. RFU 保留位</p>
<p>iii. TxAdd：发送地址字段</p>
<p>iv. RxAdd：接收地址字段</p>
<p>v. Payload Length：用来表示”有效载荷数据”(payload data)的长度，不包括头部内容</p>
<p>ii.数据报文（见协议BLUETOOTH SPECIFICATION Version 4.0 [Vol 6] Part B 2.4）</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34544.png" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34546.png" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34548.png" alt="0"></p>
<p>1.LLID（逻辑链路ID）：0x01表示该数据包是一个帧的延续内容，或者这是一个空的“逻辑链路控制及适配协议”数据包；0x02表示一个“逻辑链路控制及适配协议”数据包的开始；0x03表示这是一个“逻辑链路控制”数据包的内容</p>
<p>2.NESN：下一个期望的序列号，用于对接受到的数据包进行确认</p>
<p>3.MD：更多数据字段，主要是为了说明发送发是否还有要发给接收者的数据</p>
<p>4.RFU 保留位</p>
<p>5.Payload Length：用以表示包含”信息完整性校验码”（Message Integrity Check，MIC）在内的“有效载荷数据”的长度</p>
<p>4.CRC</p>
<p>3个字节长度，“循环冗余校验”（Cyclical Redundancy Check, CRC），可检查数据的正确性</p>
<h2 id="0x06-BLE-协议栈"><a href="#0x06-BLE-协议栈" class="headerlink" title="0x06 BLE 协议栈"></a><strong>0x06 BLE 协议栈</strong></h2><p>BLE协议栈的结构图如下所示：</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34568.png" alt="0"></p>
<p>各个结构简述：</p>
<ul>
<li>PHY：使蓝牙可以使用2.4GHz频道，并且能自适应的调频。</li>
<li>LL层：控制设备处于 准备、广播、监听、初始化、连接等5个状态</li>
<li>HCI层：向上为主机提供软件应用程序接口，对外为外部硬件提供控制接口</li>
<li>L2CAP层：对传输数据实行封装。</li>
<li>SM层：提供主机和客机的配对和密钥分发，实现安全连接和数据交换。</li>
<li>ATT层：对数据主机或客机传入的指令进行指令搜索处理</li>
<li>GATT层：接受和处理主机或客机传入的指令进行指令搜索处理</li>
<li>GAP层：向上提供API，向下合理分配各个层工作。</li>
</ul>
<h3 id="1-Physical-Layer"><a href="#1-Physical-Layer" class="headerlink" title="1. Physical Layer"></a><strong>1. Physical Layer</strong></h3><p>任何一个通信系统，首先要确定的就是通信介质(物理通道，Physical Channel)，BLE也不例外。在BLE协议中，”通信介质”的定义是由Physical Layer（其他通信协议也类似）负责。</p>
<p>Physical Layer是这样描述BLE的通信介质的：</p>
<p>​                由于BLE属于无线通信，则其通信介质是实顶频率范围下的频率资源(Frequency Band) BLE的市场定位是个体和名用，因此使用免费的ISM频段(频率范围是2.400-2.4835Ghz) 为了同时支持多个设备，将真个频带分为40份，每份的宽带为2MHz，称作RF Channel              </p>
<p>所以经过上面的定义之后，可以推测出BLE的物理通道，即“评到分别是’f=2402+k*2 MHz，k=0,…,39’,宽带为2MHz”的40个RFChannel。其中，有3个信道是advertising channel（广播通道），分别是37、38、39，用于发现设备（Scanning devices）、舒适化连接(initiating a connection)和广播数据(broadcasting date)；剩下的37个信道为data channel（数据通道），用于两个连接的设备间的通讯。</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34607.png" alt="0"></p>
<h3 id="2-Link-Layer"><a href="#2-Link-Layer" class="headerlink" title="2. Link Layer"></a><strong>2. Link Layer</strong></h3><p>Link Layer用于控制设备的射频状态，设备将处于Standby(待机)、Advertising（通告）、Scanning（扫描）、Initiating（初始化）、Connection（连接）这五种状态中的一种。</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34606.png" alt="0"></p>
<ul>
<li>待机状态（Standby State）：此时即不发送数据，也不接受数据，对设备来说也是最节能的状态；</li>
<li>通告状态（Advertising State）：通告状态下的设备一般也被称为 “通告者”（Advertiser），它会通过advertising channel（广播通道）周期性的发送数据，广播的数据可以由处于Scanning state或Initiating state的实体接受；</li>
<li>扫描状态（Scanning State）：可以通过advertising channel（广播通道）接受数据的装填，该状态下的设备又被称为“扫描者”（Scanner）。此外，更具advertiser所广播的数据类型，有些Scanner还可以主动向Advertiser请求一些额外数据</li>
<li>初始化状态（Initiating State）：和Scanning State类似，不过是一种特殊的状态。Scanner会侦听所有的advertising channel，而Initator（初始化者）则只侦听某个特定设备的广播，并在接受到数据后，发送连接请求，以便和Advertiser建立连接</li>
<li>连接状态（Connection State）：由Initiating State或Advertising State自动切换而来，处于Connection State的双方，分别有两种角色。其中，Initiater方被称为Mater（主设备），Advertiser方则称作Slave（从设备）。</li>
</ul>
<h3 id="3-HCI"><a href="#3-HCI" class="headerlink" title="3. HCI"></a><strong>3. HCI</strong></h3><p>主机控制接口层（Host Controller Interface，简写HCI）：定义Host（主机）和Controller（控制器）之间的通信协议，这一层可以是软件或者硬件接口，入UART、SPI、USB等</p>
<h3 id="4-Generic-Access-Profile-GAP"><a href="#4-Generic-Access-Profile-GAP" class="headerlink" title="4. Generic Access Profile(GAP)"></a><strong>4. Generic Access Profile(GAP)</strong></h3><p>前面Link Layer虽然对连接建立的过程做了定义，但它听没有体现到Application（或者 Profile）层面，而GAP则是直接与应用程序或配置文件通信的接口，它实现了如下功能：</p>
<ul>
<li><p>定义GAP层的蓝牙设备角色（role）</p>
</li>
<li><ul>
<li>Broadcaster（广播者）：设备正在发送advertising events</li>
<li>Obserber（观察者）：设备正在接受advertising events</li>
<li>Peripheral（外设）：设备接受Link Layer连接（对应Link Layer的slave角色）</li>
<li>Central（主机）：设备发起Link Layer连接（对应Link Layer的master角色）</li>
</ul>
</li>
<li><p>定义GAP层的用于实现各种通信的操作模式（Operational Mode）和过程（Procedures）</p>
</li>
<li><ul>
<li>Broadcastmode and observation procedure，实现单向的、无连接的通信方式</li>
<li>Discovery modes and procedures，实现蓝牙设备的发现操作</li>
<li>Connection modes and procedures，实现蓝牙设备的连接操作</li>
<li>Bonding modes and procedures，实现蓝牙设备的配对操作</li>
</ul>
</li>
<li><p>定义User Interface有关的蓝牙参数，包括蓝牙地址、蓝牙名称、蓝牙的PIN码等</p>
</li>
<li><p>Security相关的定义</p>
</li>
</ul>
<h3 id="5-Logical-Link-Control-and-Adaptation-Protocol（L2CAP-Protocol）"><a href="#5-Logical-Link-Control-and-Adaptation-Protocol（L2CAP-Protocol）" class="headerlink" title="5. Logical Link Control and Adaptation Protocol（L2CAP Protocol）"></a><strong>5. Logical Link Control and Adaptation Protocol（L2CAP Protocol）</strong></h3><p>逻辑链路控制及自适应协议层（Logical Link Control and Adaptation Protocol）：为上层提供数据封装服务，允许逻辑上的点对点数据通信。</p>
<h3 id="6-Security-Manager（SM）"><a href="#6-Security-Manager（SM）" class="headerlink" title="6. Security Manager（SM）"></a><strong>6. Security Manager（SM）</strong></h3><p>Security Manager负责BLE通信中有关安全的内容，包括配对（pairing,）、认证（authentication）和加密（encryption）等过程。</p>
<h3 id="7-Attribute-protocol（ATT）"><a href="#7-Attribute-protocol（ATT）" class="headerlink" title="7. Attribute protocol（ATT）"></a><strong>7. Attribute protocol（ATT）</strong></h3><p>在BLE协议栈中，Physical Layer负责提供一系列的Physical Channel；基于这些Physical Channel，Link Layer可在两个设备之间建立用于点对点通信的Logical Channel；而L2CAP则将这个Logical Channel换分为一个个的L2CAP Channel，以便提供应用程序级别的通道复用。到此之后，基本协议栈已经构建完毕，应用程序已经可以基于L2CAP欢快的run起来了。</p>
<p>谈起应用程序，就不得不说BLE的初衷——物联网。物联网中传输的数据和传统的互联网有什么区别呢？抛开其它不谈，物联网中最重要、最广泛的一类应用是：信息的采集。</p>
<p>这些信息往往都很简单，如温度、湿度、速度、位置信息、电量、水压、等等。</p>
<p>采集的过程也很简单，节点设备定时的向中心设备汇报信息数据，或者，中心设备在需要的时候主动查询。</p>
<p>基于信息采集的需求，BLE抽象出一个协议：Attribute protocol，该协议将这些“信息”以“Attribute（属性）”的形式抽象出来，并提供一些方法，供远端设备（remote device）读取、修改这些属性的值（Attribute value）。</p>
<p>Attribute Protocol的主要思路包括：</p>
<ol>
<li>基于L2CAP，使用固定的Channel ID</li>
<li>采用client-server的形式。提供信息（以后都将其称为Attribute）的一方称作ATT server（一般是那些传感器节点），访问信息的一方称作ATT client。</li>
<li>一个Attribute由Attribute Type、Attribute Handle和Attribute Value组成。</li>
</ol>
<ul>
<li><ol>
<li>Attribute Type用以标示Attribute的类型，类似于我们常说的“温度”、“湿度”等人类可识别的术语，通过UUID进行区分。</li>
<li>Attribute Handle是一个16-bit的数值，用作唯一识别Attribute server上的所有Attribute。Attribute Handle的存在有如下意义：</li>
</ol>
</li>
<li><ul>
<li><ol>
<li>一个server上可能存在多个相同type的Attribute，显然，client有区分这些Attribute的需要。</li>
<li>同一类型的多个Attribute，可以组成一个Group，client可以通过这个Group中的起、始handle访问所有的Attributes。</li>
</ol>
</li>
</ul>
</li>
<li><ol>
<li>Attribute Value代表Attribute的值，可以是任何固定长度或者可变长度的octet array。</li>
</ol>
</li>
</ul>
<ol>
<li>Attribute能够定义一些权限（Permissions），以便server控制client的访问行为，包括：</li>
</ol>
<ul>
<li><ol>
<li>访问有关的权限（access permissions），Readable、Writeable以及Readable and writable；</li>
<li>加密有关的权限（encryption permissions），Encryption required和No encryption required；</li>
<li>认证有关的权限（authentication permissions），Authentication Required和No Authentication Required；</li>
<li>授权有关的权限（authorization permissions），Authorization Required和No Authorization Required。</li>
</ol>
</li>
</ul>
<ol>
<li>根据所定义的Attribute PDU的不同，client可以对server有多种访问方式，包括：</li>
</ol>
<ul>
<li><ol>
<li>Find Information，获取Attribute type和Attribute Handle的对应关系；</li>
<li>Reading Attributes，有Read by type、Read by handle、Read by blob（只读取部分信息）、Read Multiple（读取多个handle的value）等方式；</li>
<li>Writing Attributes，包括需要应答的writing、不需要应答的writing等。</li>
</ol>
</li>
</ul>
<h3 id="8-Generic-Attribute-profile（-GATT）"><a href="#8-Generic-Attribute-profile（-GATT）" class="headerlink" title="8. Generic Attribute profile（ GATT）"></a>8. Generic Attribute profile（ GATT）</h3><p>ATT之所以称作“protocol”，是因为它还比较抽象，仅仅定义了一套机制，允许client和server通过Attribute的形式共享信息。至于具体共享哪些信息，ATT并不关心，这是GATT（Generic Attribute Profile）的主场。GATT相对ATT只多了一个‘G‘，然含义却大不同，因为GATT是一个profile（更准确的说是profile framework）。</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34640.png" alt="0"></p>
<p>由上图可知，GATT中的三个要素Profile、Service、Characteristic以及他们的层级关系。值得注意的是，“Profile”是基于GATT所派生出的真正的Profile，乃SIG蓝牙技术联盟对一些同范畴内的Service打包后的集合，如电池、心率、血压等，可参照<a target="_blank" rel="noopener" href="https://developer.bluetooth.org/TechnologyOverview/Pages/Profiles.aspx#GATT">官方Profiles Overview</a>，对分析并无大用。</p>
<p>Service和Characteristic则是比较重要的，Service可以理解为PHP中的“类”、功能对象的集合。Characteristic可以理解为PHP的“函数”，是GATT中具体的功能对象，每个Service都可以包含一个或多个Characteristic（特征）。Characteristic是GATT profile中最基本的数据单位，由一个Properties、一个Value、一个或者多个Descriptor组成。</p>
<p>以上除“Profile”外的每一个定义，Service、Characteristic、Characteristic Properties、Characteristic Value、Characteristic Descriptor等等，都是作为一个Attribute存在的，具备前面所描述的Attribute的所有特征：Attribute Handle、Attribute Types、Attribute Value和Attribute Permissions。</p>
<p>在理解了GATT后，就已经能够分析或是“黑掉”一些BLE设备了。这里拿小米手环做例子，当LightBlue连上小米手环后，可以看到一个名为FEE7的UUID，如下所示：</p>
<p>其中，FEE7是一个私有Service的UUID，里面的0xFE**则是私有Characteristic的UUID。下面的Immediate Alert 显示出了名称，代表其不是小米私有的Service，而是官方公开定义的Service。点击进入这个Characteristic，看到它的UUID为2A06。然后我们到蓝牙官网定义的列表<a target="_blank" rel="noopener" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicsHome.aspx">Characteristics</a>搜索2A06，进入Characteristic的详情页面。</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34644.jpeg" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34646.jpeg" alt="0"></p>
<p>其中，FEE7是一个私有Service的UUID，里面的0xFE**则是私有Characteristic的UUID。下面的Immediate Alert 显示出了名称，代表其不是小米私有的Service，而是官方公开定义的Service。点击进入这个Characteristic，看到它的UUID为2A06。然后我们到蓝牙官网定义的列表搜索2A06，进入Characteristic的详情页面。</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/34650.png" alt="0"></p>
<p>于是，该Characteristic操作定义非常明确了。点击“Write new value”，可以写入新的值。若写入1或2，则可以引起手环的震动。</p>
<h2 id="0x07-嗅探工具"><a href="#0x07-嗅探工具" class="headerlink" title="0x07 嗅探工具"></a>0x07 嗅探工具</h2><p>商业级的Ellisys BEX400侦听工具最为符合对BLE流量捕获及分析的要求，然而售价过于昂贵；</p>
<p>其次，作为开源硬件且配有混杂模式追踪的“超牙”设备——Ubertooth One拥有二次开发和嗅探已建立连接的蓝牙通信数据包的能力；</p>
<p>而淘宝购买的廉价CC2540开发板则作为最佳替补方案。</p>
<h3 id="1-低功耗蓝牙SOC"><a href="#1-低功耗蓝牙SOC" class="headerlink" title="1. 低功耗蓝牙SOC"></a>1. 低功耗蓝牙SOC</h3><p>低功耗蓝牙推出以来，众多厂商根据标准规范实现了不同的解决方案，包括TI的CC2540\2541、北欧Nordic的nRF51822、CSR的1000\1001、Quintic的QN9020\9021（现在被NXP收购）、Broadcom的BCM20732等。其中，在开发者当中比较知名的是TI的CC254x系列和Nordic的NRF51822，并且这两款产品当有着自己的开发板和用于嗅探的调试工具。</p>
<h4 id="a-CC2540"><a href="#a-CC2540" class="headerlink" title="a. CC2540"></a>a. CC2540</h4><p>德州仪器的CC2540，是一款高性价比、低功耗的片上系统（SOC）解决方案，适合蓝牙低功耗应用。它包含了一个8051内核的RF收发器，可编程闪存，8KB RAM和其他功能强大的配套特征及外设。CC2540有两种版本：CC2540F128 / F256，分别为128和256 KB的闪存，结合TI的低功耗蓝牙协议栈，CC2540F128 / F256形成了市场上最灵活，性价比也最高的单模式蓝牙BLE解决方案。<br>CC2540 USB Dongle的实物图如下，它可以配合TI的PacketSniffer软件实现对BLE无线抓包：</p>
<p>实际上，任意包含CC2540芯片的开发板都能实现BLE流量嗅探的功能。不过，TI官方并没有将侦听BLE的源代码放出，仅提供了烧写到USB Dongle的固件</p>
<p>在这个基础上，如果想要实现更多的功能，比如监听指定范围内所有的低功耗蓝牙设备的流量，就有必要对其进行逆向或者自己完全重写个程序。。</p>
<h4 id="b-NRF51822"><a href="#b-NRF51822" class="headerlink" title="b. NRF51822"></a>b. NRF51822</h4><p>挪威Nordic Semiconductor（简称Nordic）公司的nRF51822，是一款多协议ARM内核蓝牙4.0低功耗/ 2.4GHz 专用RF的单芯片解决方案。它基于Cortex-M0 内核，配备16kB RAM，可编程闪存，提供128 KB和 256 KB Flash两种版本供用户选择。</p>
<p>nRF51822 USB Dongle及开发板套件如下所示：</p>
<p><a target="_blank" rel="noopener" href="https://user-images.githubusercontent.com/11291711/49984345-9d153e00-ffa2-11e8-8db0-9a32847bcc14.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984345-9d153e00-ffa2-11e8-8db0-9a32847bcc14.png" alt="img"></a></p>
<p>刷入以下固件，配合官方的BLE sniffer程序，即可实现蓝牙流量的嗅探功能</p>
<p><a target="_blank" rel="noopener" href="https://user-images.githubusercontent.com/11291711/49984344-9d153e00-ffa2-11e8-877a-7ff3b7963762.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984344-9d153e00-ffa2-11e8-877a-7ff3b7963762.png" alt="img"></a></p>
<p>不同与cc2540的Packet Sniffer，该程序无需事先在3个广播信道中指定其一进行守候，只要指定要监听的设备，就会自动进行追踪，并能够配合Wireshark解析BLE数据包，可以很直观的显示出内部的层级关系和各字段含义。比较遗憾的是，实际使用发现它并没有CC2540 USB Dongle稳定，经常会抓不到后面数据通信的网络包，不过这一问题应该是可以通过优化算法得到解决的，但需要对官方的固件进行逆向或自己根据Nordic公司提供的BLE协议栈重写代码。。</p>
<p><a target="_blank" rel="noopener" href="https://user-images.githubusercontent.com/11291711/49984347-9e466b00-ffa2-11e8-943a-caef7f703349.jpg"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984347-9e466b00-ffa2-11e8-943a-caef7f703349.jpg" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://user-images.githubusercontent.com/11291711/49984319-9981b700-ffa2-11e8-9850-dd3b4187f32f.jpg"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984319-9981b700-ffa2-11e8-9850-dd3b4187f32f.jpg" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://user-images.githubusercontent.com/11291711/49984323-9981b700-ffa2-11e8-8e99-1ef51eab3cd2.jpg"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984323-9981b700-ffa2-11e8-8e99-1ef51eab3cd2.jpg" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://user-images.githubusercontent.com/11291711/49984325-9a1a4d80-ffa2-11e8-8c4b-23c0b851d5da.jpg"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984325-9a1a4d80-ffa2-11e8-8c4b-23c0b851d5da.jpg" alt="img"></a></p>
<p>优点：</p>
<ul>
<li>价格便宜，USB Dongle淘宝价70元左右，整套开发板售价约200软妹币上下</li>
<li>无需事先在3个广播信道中指定其一进行守候，只要指定要监听的设备，就会自动进行追踪</li>
<li>官方提供的BLE Sniffer程序可配合Wireshark工具对嗅探到的低功耗蓝牙数据包进行解析，能够很直观的显示出内部的层级关系和各字段含义</li>
</ul>
<p>缺点：</p>
<ul>
<li>不用指定广播信道，确实操作起来比较方便，但与之相对的是经常无法抓到后面的通信数据包。无论是作为开发用的调试工具，还是分析用的嗅探工具，都不够理想</li>
</ul>
<h5 id><a href="#" class="headerlink" title></a></h5><h3 id="2-商业侦听工具"><a href="#2-商业侦听工具" class="headerlink" title="2. 商业侦听工具"></a>2. 商业侦听工具</h3><h4 id="a-Frontline-BPA®-600"><a href="#a-Frontline-BPA®-600" class="headerlink" title="a. Frontline BPA® 600"></a>a. Frontline BPA® 600</h4><p>Frontline Test Equipment——“前线测试设备”（简称“前线”，Frontline），主要是针对各种各样的协议所做的一个“协议分析器”。“前线”系统的销售策略是“卖硬件，送软件”，而软件自然是和硬件相关联的，其侦听范围包括SCADA系统、RS-232串口通信、Ethernet以太网通信、ZigBee网络通信，以及蓝牙网络技术。Frontline旗下的BPA® 600双模蓝牙协议分析仪，能够把从空中获取到的基础速率/ 增强数据速率（BR/EDR）的传统蓝牙无线通信和低功耗蓝牙无线通信数据同时直观的显示出来。</p>
<p><a target="_blank" rel="noopener" href="https://user-images.githubusercontent.com/11291711/49984340-9c7ca780-ffa2-11e8-9f1a-ef9a2fca5d95.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984340-9c7ca780-ffa2-11e8-9f1a-ef9a2fca5d95.png" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://user-images.githubusercontent.com/11291711/49984338-9c7ca780-ffa2-11e8-8c9c-71b47e26f060.jpg"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984338-9c7ca780-ffa2-11e8-8c9c-71b47e26f060.jpg" alt="img"></a></p>
<p>优点：</p>
<ul>
<li>无角色指定链路抓取意味着在初始化设置时不再需要指定哪个设备是主设备（master），哪个设备是从设备（slave）</li>
<li>能够同时可视化的监视低功耗蓝牙技术所使用的三个广播信道</li>
<li>同时抓取和解密多条蓝牙链路</li>
<li>链路密钥可自动从第三方软件或调试工具导入到BPA 600</li>
<li>支持蓝牙SIG组织发布的所有的协议和应用层协议，完全支持蓝牙4.1版本</li>
</ul>
<p>缺点：</p>
<ul>
<li>十分昂贵，<a target="_blank" rel="noopener" href="http://www.fte.com/">官网</a>上虽并未公布具体的价格信息，需要与对方进行联系，但淘宝价格在15万左右</li>
<li>需要捕获到蓝牙的“连接建立”过程，对于已经建立好连接的蓝牙网络，无法从一个正在处理的进程中，嗅探到这个“微微网”里面的通信数据包</li>
</ul>
<h4 id="b-Ellisys-BEX400"><a href="#b-Ellisys-BEX400" class="headerlink" title="b. Ellisys BEX400"></a>b. Ellisys BEX400</h4><p>Ellisys公司的BLuetooth Explorer 400（简称“BEX400”），是个独特的蓝牙数据通信捕获系统。它使用了一个wideband的接收器，能够同时侦听蓝牙整个79MHz的所有频谱。通过这种无线接入方法，嗅探蓝牙数据包以及对蓝牙活动的评估变得很容易。在BEX400强大的宽带接收能力支持下，我们能够同时捕获蓝牙的所有活动，且无需指定“蓝牙设备地址”信息。此外，该设备在捕获一个“微微网”中的蓝牙通信数据时，既可以是在连接建立前，也可以在连接建立后</p>
<p><a target="_blank" rel="noopener" href="https://user-images.githubusercontent.com/11291711/49984339-9c7ca780-ffa2-11e8-9052-bc6aa1aa6bd1.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984339-9c7ca780-ffa2-11e8-9052-bc6aa1aa6bd1.png" alt="img"></a></p>
<p>优点：</p>
<ul>
<li>对于BLE的流量捕获没有必须在建立连接前就开始嗅探的限制</li>
<li>能够同时侦听蓝牙的所有信道，且无需指定“蓝牙设备地址”信息</li>
</ul>
<p>缺点：</p>
<ul>
<li>价格极其昂贵</li>
<li>除价格外，几乎完全符合需求，暂未发现明显缺点</li>
</ul>
<h3 id="3-开源侦听工具Ubertooth"><a href="#3-开源侦听工具Ubertooth" class="headerlink" title="3. 开源侦听工具Ubertooth"></a>3. 开源侦听工具Ubertooth</h3><p>“超牙项目”（Project Ubertooth）是一个开源的硬件项目，由Great Scott Gadgets团队的Michael Ossmann开发。超牙的硬件系统，目前处于版本为1的阶段，称为“超牙一号”（Ubertooth One）。通过这个工具，可以创建属于自己的“传统蓝牙”和“低功耗蓝牙”底层通信数据包捕获工具。</p>
<p><a target="_blank" rel="noopener" href="https://user-images.githubusercontent.com/11291711/49984348-9e466b00-ffa2-11e8-93ae-59086af28fb8.jpeg"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49984348-9e466b00-ffa2-11e8-93ae-59086af28fb8.jpeg" alt="img"></a></p>
<p>此外，Ubertooth的固件源代码，可以直接从github：<a target="_blank" rel="noopener" href="https://github.com/greatscottgadgets/ubertooths">https://github.com/greatscottgadgets/ubertooth</a>下载到最新的发布版。</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200928121643528.png" alt="image-20200928121643528"></p>
<p>优点：</p>
<ul>
<li>售价约120美元，比较亲民</li>
<li>本身是一个开源的硬件和软件工程，其设计目的就是用来进行蓝牙网络的嗅探，便于研究员和黑客使用</li>
<li>针对不同的蓝牙规范，具有不同的应对工具，支持传统蓝牙和低功耗蓝牙两种数据包的捕获</li>
<li>能够在混杂模式下进行跟踪，通过ubertooth-btle程序对捕获的数据包进行识别和匹配，进而确定“访问地址”、“循环冗余校验”初始值、“跳转间隔”、“跳转增量”等，并还原出数据包的值</li>
</ul>
<p>缺点：</p>
<ul>
<li>说是支持“传统蓝牙”，但其实只能捕获“基本速率蓝牙”在网络中的活动，并不支持后来的“增强速率蓝牙”在规范改进后的设备。不过这与我们的工作没有太大联系，主要关注的应是低功耗蓝牙</li>
</ul>
<h2 id="0x08-移动端工具"><a href="#0x08-移动端工具" class="headerlink" title="0x08 移动端工具"></a>0x08 移动端工具</h2><h3 id="1-Android手机抓取app蓝牙数据"><a href="#1-Android手机抓取app蓝牙数据" class="headerlink" title="1. Android手机抓取app蓝牙数据"></a>1. Android手机抓取app蓝牙数据</h3><h4 id="a-Android蓝牙HCI日志"><a href="#a-Android蓝牙HCI日志" class="headerlink" title="a .Android蓝牙HCI日志"></a><strong>a .Android蓝牙HCI日志</strong></h4><p>在部分Android机型为开发人员提供了保存蓝牙日志的选项，即可保存手机向设备发送的数据和设备响应的数据，打开方式如下：</p>
<p>开发者模式→蓝牙HCI日志</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200930155140338.png" alt="image-20200930155140338"></p>
<p>不同的平台存放HCI log的路径会不一样，MTK存放HCI log的路径为<code>/sdcard/mtklog/btlog/btsnoop_hci.log</code>，高通的存放路径为<code>/sdcard/btsnoop_hci.log</code></p>
<p>如果上面提到的路径下都没有HCI log，还可以通过手机上的蓝牙配置文件<code>bt_stack.conf</code>来查看路径</p>
<p><code>bt_stack.conf</code>位于<code>/etc/bluetooth/路径下，HCI log路径通过</code>BtSnoopFileName=/sdcard/btsnoop_hci.log`来进行设置的</p>
<p>另外如果没有<code>bt_stack.conf</code>文件，设备也会在默认路径下生成日志：<code>/data/misc/bluetooth/logs/btsnoop_hci.log</code></p>
<p>之后导出到wireshark查看即可，如图清晰的展示了蓝牙各协议栈的内容，分析时候重点关注发送的数据内容即<code>Handle</code>、<code>uuid</code>、<code>Value</code>等值即可</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/49418350-b6590600-f7bc-11e8-8cea-fbd09c9c318c.png" alt="img"></p>
<h4 id="b-Bluez调试工具hcidump"><a href="#b-Bluez调试工具hcidump" class="headerlink" title="b. Bluez调试工具hcidump"></a><strong>b. Bluez调试工具hcidump</strong></h4><p>虽然Android 4.2已经将蓝牙协议栈替换为Bluedroid，但仍可使用BlueZ调试工具（需自行编译，或网上下载），且hcidump输出的数据与<code>开发者模式</code>里的<code>蓝牙HCI日志</code>基本一样，源码如下：</p>
<p><a target="_blank" rel="noopener" href="https://android.googlesource.com/platform/external/bluetooth/bluez/+/android-4.1.2_r1">https://android.googlesource.com/platform/external/bluetooth/bluez/+/android-4.1.2_r1</a></p>
<p>hcidump抓取 log :</p>
<ul>
<li>打开蓝牙</li>
<li>用adb shell 登陆android设备 并且用 <code>hcidump -w /sdcard/hcilog</code></li>
<li>开始测试</li>
<li>测试完成，停止hcidump</li>
<li>导出到wireshark分析 <code>hcilog</code> 文件</li>
</ul>
<h3 id="2-扫描器"><a href="#2-扫描器" class="headerlink" title="2. 扫描器"></a>2. 扫描器</h3><h4 id="a-LightBlue"><a href="#a-LightBlue" class="headerlink" title="a. LightBlue"></a>a. LightBlue</h4><p><code>LightBlue</code>使用简单，打开蓝牙和app，即自动扫描蓝牙设备，未连接之前，大部分设备都是<code>Unnamed</code>和<code>No services</code>，选择其中一个会尝试连接，连接成功后即可获取蓝牙设备的设备信息、UUID、服务等信息了，选择其中一个服务，还可以尝试对其读写数据</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200930161720845.png" alt="image-20200930161720845"></p>
<h4 id="b-nRF-Connect"><a href="#b-nRF-Connect" class="headerlink" title="b. nRF Connect"></a>b. nRF Connect</h4><p><code>nRF Connect</code>的使用方式和<code>LightBlue</code>基本一致，优点在于对设备服务信息展示更为直观：</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200930161645370.png" alt="image-20200930161645370"></p>
<h2 id="0x09-针对利用蓝牙的应用攻击（私有协议）"><a href="#0x09-针对利用蓝牙的应用攻击（私有协议）" class="headerlink" title="0x09 针对利用蓝牙的应用攻击（私有协议）"></a>0x09 针对利用蓝牙的应用攻击（私有协议）</h2><p>目前针对私有协议的分析基本都是通过蓝牙dongle抓包例如CC2540，并且逆向app进行分析应用实现是否安全。</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://drops.xmd5.com/static/drops/tips-10109.html">YeeLight 2 代蓝牙灯泡，小爱爱智能跳蛋，小米手环</a></li>
<li><a target="_blank" rel="noopener" href="https://future-sec.com/how-to-crack-a-ble-lock.html">如何破解一个蓝牙锁</a></li>
<li><a target="_blank" rel="noopener" href="http://www.droidsec.cn/ble安全入门及实战（1）/">BLE安全入门及实战（1）</a></li>
<li><a target="_blank" rel="noopener" href="https://www.secpulse.com/archives/75963.html">BLE安全入门及实战（2）</a></li>
<li><a target="_blank" rel="noopener" href="https://www.secpulse.com/archives/76377.html">BLE安全入门及实战（3）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/u013183495/article/details/51736605">体脂秤</a></li>
</ul>
<h2 id="0x10-可以研究的点"><a href="#0x10-可以研究的点" class="headerlink" title="0x10 可以研究的点"></a>0x10 可以研究的点</h2><p>经过多年的历史发展，蓝牙本身已经变成一个比较复杂的协议了，如果需要整理完整的攻击面需要对整个蓝牙的实现有很清晰的梳理，网上大部分的文章都是关于协议本身的，对于协议的实现还是说的不是很清楚。而且协议本身的发展方向就是IOT方向，例如GATT这种很明显就是支持物联网设备的协议。所以搞清BLE5.0在真实的物联网设备上的架构以及实现我认为非常关键。</p>
<h2 id="0x11-参考链接"><a href="#0x11-参考链接" class="headerlink" title="0x11 参考链接"></a>0x11 参考链接</h2><p><a target="_blank" rel="noopener" href="https://xuanxuanblingbling.github.io/wireless/ble/2018/08/01/ble/">https://xuanxuanblingbling.github.io/wireless/ble/2018/08/01/ble/</a></p>
<p><a target="_blank" rel="noopener" href="http://www.gandalf.site/2019/02/ble.html">http://www.gandalf.site/2019/02/ble.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.ndss-symposium.org/wp-content/uploads/2019/02/ndss2019_06B-4_Xu_paper.pdf">https://www.ndss-symposium.org/wp-content/uploads/2019/02/ndss2019_06B-4_Xu_paper.pdf</a></p>
<p><a target="_blank" rel="noopener" href="http://drops.xmd5.com/static/drops/tips-10109.html">http://drops.xmd5.com/static/drops/tips-10109.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u013183495/article/details/51736605">https://blog.csdn.net/u013183495/article/details/51736605</a></p>
<p><a target="_blank" rel="noopener" href="https://www.secpulse.com/archives/75963.html">https://www.secpulse.com/archives/75963.html</a></p>
<h2 id="更新中…"><a href="#更新中…" class="headerlink" title="更新中…"></a>更新中…</h2></div><div class="article-licensing box"><div class="licensing-title"><p>蓝牙安全以及相关漏洞研究</p><p><a href="http://www.ol4three.com/2020/09/24/IOT/%E8%93%9D%E7%89%99%E5%AE%89%E5%85%A8%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/">http://www.ol4three.com/2020/09/24/IOT/%E8%93%9D%E7%89%99%E5%AE%89%E5%85%A8%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>ol4three</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2020-09-24</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2020-12-02</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/BLE/">BLE</a><a class="link-muted mr-2" rel="tag" href="/tags/%E8%93%9D%E7%89%99/">蓝牙</a></div><div class="sharethis-inline-share-buttons"></div><script src=" " defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/10/14/IOT/%E4%BD%BF%E7%94%A8Ubertooth-one%E6%89%AB%E6%8F%8F%E5%97%85%E6%8E%A2%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">使用Ubertooth one扫描嗅探低功耗蓝牙</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/09/22/Android/Hook%E6%A1%86%E6%9E%B6Firada/"><span class="level-item">Hook框架Firada</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="content" id="valine-thread"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script>new Valine({
            el: '#valine-thread' ,
            appId: "Mi7VTJ1Ohx0XKeYNBRfjWrY5-gzGzoHsz",
            appKey: "kqSPJKxTTPM9aNVRrWttS4HT",
            
            avatar: "mm",
            
            meta: ["nick","mail","link"],
            pageSize: 10,
            lang: "en",
            
            highlight: true,
            
            
            
            
            
            requiredFields: [],
        });</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="ol4three"></figure><p class="title is-size-4 is-block line-height-inherit">ol4three</p><p class="is-size-6 is-block">醒来时世界都远了，我需要最狂的风，和最静的海。</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Chendu,China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">63</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">12</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">65</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ol4three" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ol4three"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="http://b0urne.top" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">B0urne</span></span><span class="level-right"><span class="level-item tag">b0urne.top</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://xcniao.ol4three.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Xcniao</span></span><span class="level-right"><span class="level-item tag">xcniao.ol4three.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://tengxiaofei.run" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Tengxiaofei</span></span><span class="level-right"><span class="level-item tag">tengxiaofei.run</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://lalalaxiaoyuren.github.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">smail_fish</span></span><span class="level-right"><span class="level-item tag">lalalaxiaoyuren.github.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://vinadiak.github.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">vinadiak</span></span><span class="level-right"><span class="level-item tag">vinadiak.github.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://www.oldthree.site/micro8/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Micro8</span></span><span class="level-right"><span class="level-item tag">www.oldthree.site</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://www.oldthree.site/pycharm/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Jetbrains</span></span><span class="level-right"><span class="level-item tag">www.oldthree.site</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://118.25.15.216:8080/login" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Java-sec-code</span></span><span class="level-right"><span class="level-item tag">118.25.15.216</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://www.oldthree.site/hacktool/index.html" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">hacktool</span></span><span class="level-right"><span class="level-item tag">www.oldthree.site</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://www.oldthree.site/wooyun/wooyun_articles-gh-pages/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">wooyun_drop_page</span></span><span class="level-right"><span class="level-item tag">www.oldthree.site</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Android/"><span class="level-start"><span class="level-item">Android</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Android%E6%B5%8B%E8%AF%95/"><span class="level-start"><span class="level-item">Android测试</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/"><span class="level-start"><span class="level-item">CTF</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/IOT/"><span class="level-start"><span class="level-item">IOT</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/WEB/"><span class="level-start"><span class="level-item">WEB</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/WEB%E5%AE%89%E5%85%A8/"><span class="level-start"><span class="level-item">WEB安全</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"><span class="level-start"><span class="level-item">二进制安全</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"><span class="level-start"><span class="level-item">内网渗透</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90/"><span class="level-start"><span class="level-item">协议分析</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><span class="level-start"><span class="level-item">反序列化</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><span class="level-start"><span class="level-item">环境配置</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E8%B7%AF%E7%94%B1%E5%99%A8/"><span class="level-start"><span class="level-item">路由器</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-10-14T07:17:42.000Z">2020-10-14</time></p><p class="title is-6"><a class="link-muted" href="/2020/10/14/IOT/%E4%BD%BF%E7%94%A8Ubertooth-one%E6%89%AB%E6%8F%8F%E5%97%85%E6%8E%A2%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99/">使用Ubertooth one扫描嗅探低功耗蓝牙</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/IOT/">IOT</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-09-24T09:39:19.000Z">2020-09-24</time></p><p class="title is-6"><a class="link-muted" href="/2020/09/24/IOT/%E8%93%9D%E7%89%99%E5%AE%89%E5%85%A8%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/">蓝牙安全以及相关漏洞研究</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/IOT/">IOT</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-09-22T03:53:39.000Z">2020-09-22</time></p><p class="title is-6"><a class="link-muted" href="/2020/09/22/Android/Hook%E6%A1%86%E6%9E%B6Firada/">Hook框架Firada</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Android/">Android</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-09-17T09:39:41.000Z">2020-09-17</time></p><p class="title is-6"><a class="link-muted" href="/2020/09/17/WEB/Exploit/Pligg%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-CVE-2020-25287/">Pligg远程命令执行(CVE-2020-25287)</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-09-17T09:02:36.000Z">2020-09-17</time></p><p class="title is-6"><a class="link-muted" href="/2020/09/17/WEB/Exploit/Apache-DolphinScheduler%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-CVE-2020-11974/">Apache DolphinScheduler远程代码执行(CVE-2020-11974)</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/06/"><span class="level-start"><span class="level-item">June 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/05/"><span class="level-start"><span class="level-item">May 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/03/"><span class="level-start"><span class="level-item">March 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/360/"><span class="tag">360</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AWD/"><span class="tag">AWD</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Amazon/"><span class="tag">Amazon</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Android/"><span class="tag">Android</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apache/"><span class="tag">Apache</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apache-Cocoon-XML/"><span class="tag">Apache-Cocoon-XML</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BLE/"><span class="tag">BLE</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BadUsb/"><span class="tag">BadUsb</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cisco/"><span class="tag">Cisco</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Drozer/"><span class="tag">Drozer</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/EDR/"><span class="tag">EDR</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Exchange-Server/"><span class="tag">Exchange-Server</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Frida/"><span class="tag">Frida</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Google-Hacking/"><span class="tag">Google-Hacking</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HTTP%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%8D%8F%E8%AE%AE/"><span class="tag">HTTP请求走私协议</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hook/"><span class="tag">Hook</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Horde-Groupware-Webmail-Edition/"><span class="tag">Horde Groupware Webmail Edition</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Huawei/"><span class="tag">Huawei</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/IOT/"><span class="tag">IOT</span><span class="tag is-grey-lightest">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JCG/"><span class="tag">JCG</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MSF/"><span class="tag">MSF</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mac-os/"><span class="tag">Mac os</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mybatis/"><span class="tag">Mybatis</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mysql-python/"><span class="tag">Mysql-python</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NC/"><span class="tag">NC</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHP%E7%BD%91%E7%AB%99/"><span class="tag">PHP网站</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PhpStudy/"><span class="tag">PhpStudy</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Pligg/"><span class="tag">Pligg</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PowerSploit/"><span class="tag">PowerSploit</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RCE/"><span class="tag">RCE</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SDK/"><span class="tag">SDK</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Sql%E6%B3%A8%E5%85%A5/"><span class="tag">Sql注入</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ubertooth-one/"><span class="tag">Ubertooth one</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VIM/"><span class="tag">VIM</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VPN/"><span class="tag">VPN</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/XiaoMi/"><span class="tag">XiaoMi</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ZTE/"><span class="tag">ZTE</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/crunch/"><span class="tag">crunch</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iot/"><span class="tag">iot</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><span class="tag">java反序列化</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/"><span class="tag">nginx解析漏洞</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sangfor/"><span class="tag">sangfor</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/scrcpy/"><span class="tag">scrcpy</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sql%E6%B3%A8%E5%85%A5/"><span class="tag">sql注入</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B8%89%E6%98%9F/"><span class="tag">三星</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91/"><span class="tag">代理转发</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"><span class="tag">内网渗透</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90/"><span class="tag">协议分析</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%90%8E%E6%B8%97%E9%80%8F/"><span class="tag">后渗透</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A0%86/"><span class="tag">堆</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A4%A9%E8%9E%8D%E4%BF%A1/"><span class="tag">天融信</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%8F%E7%97%85%E6%AF%92/"><span class="tag">宏病毒</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%9D%E5%A1%94/"><span class="tag">宝塔</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"><span class="tag">未授权访问漏洞</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B3%9B%E5%BE%AEOA/"><span class="tag">泛微OA</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%A8%E5%8F%8B/"><span class="tag">用友</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%A2%E9%98%9F%E7%99%BE%E7%A7%91%E5%85%A8%E4%B9%A6/"><span class="tag">红队百科全书</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%BF%E7%9B%9F/"><span class="tag">绿盟</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%93%9D%E7%89%99/"><span class="tag">蓝牙</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/"><span class="tag">路由器</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%80%9A%E8%BE%BEOA/"><span class="tag">通达OA</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81/"><span class="tag">默认密码</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA/"><span class="tag">齐治堡垒机</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="1" data-ad-slot="1" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="ol4three" height="28"></a><p class="size-small"><span>&copy; 2020 ol4three</span>  Powered by <a href="https://www.ol4three.com" target="_blank" rel="noopener">ol4three</a> <br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>